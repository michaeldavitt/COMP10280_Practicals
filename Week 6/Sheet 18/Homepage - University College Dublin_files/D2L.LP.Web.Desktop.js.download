D2L.ContentService={Web:{Desktop:{Controls:{}}}};D2L.ContentService.Web.Desktop.Controls.AddContent={SetValue:function(id,value){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(elem===null){return;}elem.value=value;},GetValue:function(id){var element=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(element){return element.value;}return;},GetFileName:function(id){var element=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(element){return element.filename;}return;}};window.D2L=window.D2L||{};window.D2L.LP=window.D2L.LP||{};window.D2L.LP.Web=window.D2L.LP.Web||{};window.D2L.LP.Web.UI=window.D2L.LP.Web.UI||{};window.D2L.LP.Web.UI.Html=window.D2L.LP.Web.UI.Html||{};window.D2L.LP.Globalization=window.D2L.LP.Globalization||{Formatting:{Domain:{Default:{}}}};window.D2L.LP.LayeredArch=window.D2L.LP.LayeredArch||{};window.D2L.LE=window.D2L.LE||{};window.D2L.PT=window.D2L.PT||{};window.D2L.LOR=window.D2L.LOR||{};window.D2L.EP=window.D2L.EP||{};window.D2L.IM=window.D2L.IM||{};window.D2L.WCS=window.D2L.WCS||{};window.D2L.IsNotAnIframedApp=true;D2L.LP.Web.UI.Daylight={IsEnabled:function(){if(!document||!document.body||!document.body.classList){return true;}return document.body.classList.contains('daylight');}};D2L.LP.Web.UI.ObjectRepository={Get:function(key,subKey){var obj=D2L.LP.Web.UI.ObjectRepository.TryGet(key,subKey);if(obj===null){throw'\''+key+'\'['+subKey+'] not found in object repository.';}return obj;},GetDictionary:function(key){if(D2L.OR[key]===undefined){return null;}var resultDic={};for(var subKey in D2L.OR[key]){resultDic[subKey]=D2L.LP.Web.Serialization.Json.Deserialize(D2L.OR[key][subKey]);}return resultDic;},HasKey:function(key){return D2L.OR[key]!==undefined;},HasKeys:function(key,subKey){return D2L.OR[key]!==undefined&&D2L.OR[key][subKey]!==undefined;},Remove:function(key,subKey){if(D2L.OR[key]===undefined){return;}if(subKey===undefined){delete D2L.OR[key];}else{if(D2L.OR[key][subKey]!==undefined){delete D2L.OR[key][subKey];}}},RpcReceivePayloadProvider:function(data){if(data===undefined||data===null){return;}for(var key in data){D2L.OR[key]=data[key];}},TryClone:function(key,subKey,newKey,newSubKey){if(key===undefined||subKey===undefined||newKey===undefined||newSubKey===undefined){return false;}if(D2L.OR[key]===undefined){return false;}if(D2L.OR[newKey]===undefined){D2L.OR[newKey]={};}D2L.OR[newKey][newSubKey]=D2L.OR[key][subKey];return true;},TryGet:function(key,subKey){if(subKey===undefined){subKey="0";}if(D2L.OR[key]===undefined||D2L.OR[key][subKey]===undefined){return null;}return D2L.LP.Web.Serialization.Json.Deserialize(D2L.OR[key][subKey]);}};D2L.O=function(key,subKey){return D2L.LP.Web.UI.ObjectRepository.Get(key,subKey);};D2L.OR={};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(element){"use strict";if(this==null){throw new TypeError();}var t=Object(this);var arrayLength=t.length>>>0;if(arrayLength===0){return-1;}var fromIndex=0;if(arguments.length>0){fromIndex=Number(arguments[1]);if(fromIndex!=fromIndex){fromIndex=0;}else if(fromIndex!=0&&fromIndex!=Infinity&&fromIndex!=-Infinity){fromIndex=(fromIndex>0||-1)*Math.floor(Math.abs(fromIndex));}}if(fromIndex>=arrayLength){return-1;}var elementIndex=fromIndex>=0?fromIndex:Math.max(arrayLength-Math.abs(fromIndex),0);for(;elementIndex<arrayLength;elementIndex++){if(elementIndex in t&&t[elementIndex]===element){return elementIndex;}}return-1;};}D2L.Class=function(){};D2L.Class.prototype.Construct=function(){};D2L.Class.prototype.Dispose=function(){};D2L.Class.Create=function(def){var classDef=function(){if(arguments[0]!==D2L.Class){this.Construct.apply(this,arguments);}};var proto=new this(D2L.Class);for(var n in def){var item=def[n];proto[n]=item;}classDef.prototype=proto;return classDef;};D2L.Class.Extend=function(def){var classDef=function(){if(arguments[0]!==D2L.Class){this.Construct.apply(this,arguments);}};var proto=new this(D2L.Class);var superClass=this.prototype;for(var n in def){var item=def[n];if(item instanceof Function)item.$=superClass;proto[n]=item;}classDef.prototype=proto;classDef.extend=this.extend;classDef.Extend=this.extend;return classDef;};D2L.Class.extend=D2L.Class.Extend;D2L.LP.Web.UI.Events=D2L.LP.Web.UI.Events||{};D2L.LP.Web.UI.Events.AggregateEvents=function(events,callback){var evt=new D2L.LP.Web.UI.Events.Event();var numTriggered=0;var handleTrigger=function(){numTriggered++;if(numTriggered>=events.length){if(callback!==undefined){callback();}evt.Trigger();}};for(var i=0;i<events.length;i++){var e=events[i];if(e===undefined||e===null||e.HasTriggered===undefined||e.HasTriggered()){handleTrigger();}else{e.AddListener(handleTrigger);}}if(events.length===0){setTimeout(handleTrigger,0);}return evt;};D2L.LP.Web.UI.Events.Event=D2L.Class.Create({Construct:function(argumentDelegate){this.m_callbacks=[];this.m_argumentDelegate=argumentDelegate;this.m_hasTriggered=false;this.m_releaseCallbacks=[];},AddListener:function(callback){this.m_callbacks.push(callback);},AddReleaseListener:function(callback){this.m_releaseCallbacks.push(callback);},HasTriggered:function(){return this.m_hasTriggered;},RemoveListener:function(callback){for(var i=0;i<this.m_callbacks.length;i++){if(this.m_callbacks[i]===callback){this.m_callbacks.splice(i,1);}}},Release:function(){for(var i=0;i<this.m_releaseCallbacks.length;i++){this.m_releaseCallbacks[i].apply(this.m_releaseCallbacks[i]);}},Trigger:function(){this.m_hasTriggered=true;var args=arguments;if(typeof this.m_argumentDelegate!=='undefined'){args=this.m_argumentDelegate();}for(var i=0;i<this.m_callbacks.length;i++){var result=this.m_callbacks[i].apply(this.m_callbacks[i],args);if(typeof result!=='undefined'&&result===false){return;}}}});D2L.LP.Web.Http={};D2L.LP.Web.Http.ILocation=function(){};D2L.LP.Web.Http.ILocation.prototype.GetUrl=function(){};D2L.LP.Web.Http.UrlLocation=D2L.Class.Create({Construct:function(url){if(url===undefined||url===null){url='';}this.m_url=url;},_deserialize:function(deserializer){this.m_url=deserializer.GetMember('Url');},_serialize:function(serializer){serializer.AddMember('Url',this.m_url);},GetUrl:function(){return this.m_url;},WithQueryString:function(param,value){var url=this.m_url;var delim=url.indexOf('?',0)==-1?'?':'&';var serializer=new D2L.LP.Web.Serialization.Url.Serializer();serializer.AddMember(param,value);var serializedValue=serializer.Serialize();url+=delim+serializedValue;return new D2L.LP.Web.Http.UrlLocation(url);},HasQueryString:function(param){param=param.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regex=new RegExp("[\\?&]"+param+"=([^&#]*)");return regex.test(this.m_url);},RemoveQueryString:function(name){name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regex=new RegExp("([\\?&])"+name+"=([^&#]*)");if(!regex.test(this.m_url)){return;}var pos=0;var url=this.m_url.replace(regex,function(match,p1,p2,offset){pos=offset;return p1;});if(url.length>pos&&url[pos+1]=='&'){url=url.substr(0,pos+1)+url.substr(pos+2);}else{url=url.substr(0,url.length-1);}this.m_url=url;}});D2L.LP.Web.Http.UrlLocation.Create=function(url,query){var urlLocation=new D2L.LP.Web.Http.UrlLocation(url);for(var key in query){urlLocation=urlLocation.WithQueryString(key,query[key]);}return urlLocation;};D2L.LP.Web.Mvc={RouteLocation:{Create:function(pattern,query,route){for(var key in route){pattern=pattern.replace(new RegExp('\{'+key+'\}','gi'),D2L.LP.Web.UI.Html.JavaScript.UrlEncode(route[key]));}var url=new D2L.LP.Web.Http.UrlLocation(pattern);for(var key in query){url=url.WithQueryString(key,query[key]);}return url;}}};D2L.LP.Web.UI.Files={};D2L.LP.Web.UI.Files.File=D2L.Class.Create({Construct:function(id,fileSystemType,name,size,previewUrl){this.m_id=id;this.m_fileSystemType=fileSystemType;this.m_name=name;this.m_size=size;this.m_previewUrl=previewUrl||'';},_deserialize:function(deserializer){},_serialize:function(serializer){serializer.AddMember('FileSystemType',this.m_fileSystemType);serializer.AddMember('Id',this.m_id);},GetFileSystemType:function(){return this.m_fileSystemType;},GetId:function(){return this.m_id;},GetName:function(){return this.m_name;},GetSize:function(){return this.m_size;},GetPreviewUrl:function(){return this.m_previewUrl;}});D2L.LP.Web.UI.Links={};D2L.LP.Web.UI.Links.Link=D2L.Class.Create({Construct:function(id,name,location,urn){this.m_id=id;this.m_name=name;this.m_location=location;this.m_urn=urn;},_deserialize:function(deserializer){},_serialize:function(serializer){serializer.AddMember('Name',this.m_name);serializer.AddMember('Location',this.m_location);if(this.m_urn){serializer.AddMember('Urn',this.m_urn);}},GetId:function(){return this.m_id;},GetName:function(){return this.m_name;},GetLocation:function(){return this.m_location;},GetUrn:function(){return this.m_urn;}});D2L.LP.Web.UI.FlashMessages={RpcReceivePayloadProvider:function(data){var win=window;while(win!==win.parent&&D2L.LP.Web.UI.Html.Dom.HasSafeParent(win)&&win.parent.D2L!==undefined&&win.parent.D2L.LP!==undefined&&win.parent.D2L.LP.Web!==undefined&&win.parent.D2L.LP.Web.UI!==undefined&&win.parent.D2L.LP.Web.UI.FlashMessages!==undefined){win=win.parent;}win.D2L.LP.Web.UI.Html.Bsi.LoadAssets(['node_modules/@brightspace-ui/core/components/alert/alert-toast.js']).then(function(){var div=win.document.createElement('div');div.innerHTML=data;var node=win.document.body.appendChild(div.firstChild);win.D2L.LP.Web.UI.Events.OnViewRender.Trigger(node);});}};D2L.LP.Web.UI.Rpc={ReceivePayloadProviders:{},SendPayloadProviders:{}};D2L.LP.Web.UI.Rpc.Initialize=function(loginUrl,message,sendPayloadProviders,receivePayloadProviders){if(sendPayloadProviders!==undefined){D2L.LP.Web.UI.Rpc.SendPayloadProviders=sendPayloadProviders;}if(receivePayloadProviders!==undefined){D2L.LP.Web.UI.Rpc.ReceivePayloadProviders=receivePayloadProviders;}D2L.LP.Web.UI.Rpc.OnFailure.AddListener(function(args){var reason=args.reason;var keepAlive=args.keepAlive;if(reason===D2L.LP.Web.UI.Rpc.FailureReasons.NotAuthenticated){if(keepAlive!==undefined&&keepAlive){location.href=loginUrl.GetUrl();}}else{alert(message);}});};D2L.LP.Web.UI.Rpc.Connect=function(verb,loc,params,options){var ret=new D2L.LP.Web.UI.Events.Event();if(verb===undefined||verb===null||verb!='GET'&&verb!='POST'){throw'Invalid RPC verb: \''+verb+'\'.';}if(loc===undefined||loc===null){throw'Invalid RPC location: \''+loc+'\'.';}if(options===undefined||options===null){options={};}if(params===undefined||params===null){params={};}for(var key in params){if(params[key]===null){delete params[key];}}loc=loc.GetUrl();var complete=false;var timedOut=false;var isSynchronous=options.isSynchronous||false;var fail=function(showErrorMsg){ret.Trigger(false);if(showErrorMsg===undefined){showErrorMsg=true;}var errorMsg=function(){D2L.LP.Web.UI.Rpc.OnFailure.Trigger({reason:D2L.LP.Web.UI.Rpc.FailureReasons.Unknown});};if(options.failure!==undefined){var result=options.failure.call(options.failure);var isDelayedReturn=typeof result!=='undefined'?result.Trigger!==undefined:false;var delayedReturnListener=function(returnVal){this.Trigger(returnVal);if(returnVal!==true){errorMsg();}};if(result===true){showErrorMsg=false;}else if(isDelayedReturn){showErrorMsg=false;result.AddListener(delayedReturnListener);}}if(showErrorMsg){errorMsg();}};var xhr=new XMLHttpRequest();var handleXhrResult=function(xhrResult){if(timedOut||xhrResult.readyState!=4){return undefined;}complete=true;if(xhrResult.status==200){var response=xhrResult.responseText.trim();var events=[];if(response.length>0){var payload;try{payload=D2L.LP.Web.Serialization.Json.Deserialize(response.substr(9));}catch(e){throw"Unable to parse JSON response: "+response;}if(payload.Redirect){D2L.LP.Web.UI.Html.Dom.Navigate(payload.Location);return;}var receivePayloadProviders=D2L.LP.Web.UI.Rpc.ReceivePayloadProviders;for(var key in receivePayloadProviders){if(payload.Data[key]!==undefined){events.push(receivePayloadProviders[key].call(receivePayloadProviders[key],payload.Data[key]));}}response=payload.Payload;}D2L.LP.Web.UI.Events.AggregateEvents(events,function(){ret.Trigger(true);if(typeof options.success!=='undefined'){options.success.call(options.success,response);}});return response;}else{if(xhrResult.status==403&&xhrResult.responseText=='Not authenticated.'){ret.Release();if(options.notAuthenticated!==undefined){options.notAuthenticated.call(options.notAuthenticated);}else{D2L.LP.Web.UI.Rpc.OnFailure.Trigger({reason:D2L.LP.Web.UI.Rpc.FailureReasons.NotAuthenticated,keepAlive:options.keepAlive});}return undefined;}var showError=xhrResult.status!=0;fail(showError);return undefined;}};if(!isSynchronous){xhr.onreadystatechange=function(){handleXhrResult(xhr);};}var sendPayloadProviders=D2L.LP.Web.UI.Rpc.SendPayloadProviders;for(var key in sendPayloadProviders){sendPayloadProviders[key].call(sendPayloadProviders[key],params);}var serializeParametersAndSend=function(xsrfToken){params['isXhr']='true';params['requestId']=D2L.LP.Web.UI.Rpc.GetUniqueRequestId();if(xsrfToken){params[D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName()]=xsrfToken;}if(options.keepAlive!==undefined&&!options.keepAlive){params['X-D2L-Session']='no-keep-alive';}var serializedParams=D2L.LP.Web.Serialization.Url.Serialize(params);if(verb==D2L.LP.Web.UI.Rpc.Verbs.GET){var sep=loc.indexOf('?')>-1?'&':'?';loc+=sep+serializedParams;}xhr.open(verb,loc,!isSynchronous);var data=undefined;if(verb==D2L.LP.Web.UI.Rpc.Verbs.POST){xhr.setRequestHeader('Content-type','application/x-www-form-urlencoded');data=serializedParams;}if(options.includeXsrfHeader!==undefined&&options.includeXsrfHeader){xhr.setRequestHeader('X-Csrf-Token',D2L.LP.Web.Authentication.Xsrf.GetXsrfToken());}if(options.timeout!==undefined){setTimeout(function(){if(complete){return;}timedOut=true;fail();},options.timeout);}xhr.send(data);};if(verb==D2L.LP.Web.UI.Rpc.Verbs.POST){var xsrfToken=D2L.LP.Web.Authentication.Xsrf.GetXsrfToken();serializeParametersAndSend(xsrfToken);}else{serializeParametersAndSend(null);}if(isSynchronous){return handleXhrResult(xhr);}return ret;};D2L.LP.Web.UI.Rpc.ConnectPartial=function(placeholderId,verb,loc,params,options){if(options===undefined||options===null){options={};}if(params===undefined||params===null){params={};}var ret=new D2L.LP.Web.UI.Events.Event();params['_d2l_prc']=D2L.LP.Web.UI.Html.PartialRendering.GetPartialRenderContext(placeholderId.GetValue());D2L.LP.Web.UI.Rpc.Connect(verb,loc,params,{success:function(result){ret.Trigger(result);if(typeof options.success!=='undefined'){options.success.call(options.success);}},failure:function(){ret.Trigger(false);if(options.failure!==undefined){options.failure.call(options.failure);}},keepAlive:options.keepAlive,timeout:60000,notAuthenticated:function(){D2L.LP.Web.UI.Rpc.OnFailure.Trigger({reason:D2L.LP.Web.UI.Rpc.FailureReasons.NotAuthenticated});}});return ret;};D2L.LP.Web.UI.Rpc.CreateHistoryConnectPartial=function(verb,loc,params,options){var connectPartial0=function(placeholderId){var connectPartial=function(){return D2L.LP.Web.UI.Rpc.ConnectPartial(placeholderId,verb,loc,params,options);};return connectPartial;};return connectPartial0;};D2L.LP.Web.UI.Rpc.GetUniqueRequestId=function(){var me=D2L.LP.Web.UI.Rpc;if(me.m_requestIdCounter===undefined){me.m_requestIdCounter=1;}me.m_requestIdCounter++;return me.m_requestIdCounter;};D2L.LP.Web.UI.Rpc.ConnectObject=function(verb,loc,params,options){var ret=new D2L.LP.Web.UI.Events.Event();if(options===undefined){options={};}options.success=function(result){ret.Trigger(result);};var connectRet=D2L.LP.Web.UI.Rpc.Connect(verb,loc,params,options);connectRet.AddListener(function(result){if(result===false){ret.Trigger(false);}});connectRet.AddReleaseListener(function(){ret.Release();});return ret;};D2L.LP.Web.UI.Rpc.ConnectObjectSynchronous=function(verb,loc,params,options){if(options===undefined){options={};}options.isSynchronous=true;var ret=D2L.LP.Web.UI.Rpc.Connect(verb,loc,params,options);return ret;};D2L.LP.Web.UI.Rpc.SendBeacon=function(location,data){if(navigator.sendBeacon){var formData=new FormData();formData.append(D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName(),D2L.LP.Web.Authentication.Xsrf.GetXsrfToken());if(data){for(var key in data){formData.append(key,data[key]);}}navigator.sendBeacon(location.GetUrl(),formData);}else{D2L.LP.Web.UI.Rpc.Connect(D2L.LP.Web.UI.Rpc.Verbs.POST,location,data);}};D2L.LP.Web.UI.Rpc.Verbs={GET:'GET',POST:'POST'};D2L.LP.Web.UI.Selection={};D2L.LP.Web.UI.Selection.SelectionInfo=D2L.Class.Create({Construct:function(type,keys){if(type===undefined){type=D2L.LP.LayeredArch.SelectionFilterType.None;}if(keys===undefined){keys=[];}this.m_type=type;this.m_keys=keys;},_deserialize:function(deserializer){this.m_type=deserializer.GetMember('type');this.m_keys=D2L.LP.Web.UI.Selection.DecodeKeys(deserializer.GetMember('keys'));},_serialize:function(serializer){serializer.AddMember('type',this.m_type);serializer.AddMember('values',D2L.LP.Web.UI.Selection.EncodeKeys(this.m_keys));},GetType:function(){return this.m_type;},GetKeys:function(){return this.m_keys;}});D2L.LP.Web.UI.Selection.EncodeKeys=function(keys){var ret='';if(keys.length>0){var delim='';for(var i=0;i<keys.length;i++){ret+=delim+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(keys[i]);delim='&';}}return ret;};D2L.LP.Web.UI.Selection.DecodeKeys=function(keysString){if(keysString==null||keysString.length==0){return[];}var keys=[];var encodedKeys=keysString.split('&');for(var i=0;i<encodedKeys.length;i++){keys.push(D2L.Util.Url.Decode(encodedKeys[i]));}return keys;};D2L.LP.Web.Authentication=D2L.LP.Web.Authentication||{};D2L.LP.Web.Authentication.OAuth2={_Initialized:false,_ClockSkew:0,_StorageKey:'D2L.Fetch.Tokens',_Storage:{},_Inflight:{},GetToken:function(scope){var me=D2L.LP.Web.Authentication.OAuth2;me._Init();var token=this._GetObjectCacheToken(scope)||this._GetLocalStorageToken(scope)||this._RequestTokenDeduped(scope);return Promise.resolve(token);},AddTokenToCache:function(scope,token){var me=D2L.LP.Web.Authentication.OAuth2;me._Init();if(!me._TokenIsForCurrentUser(token)){throw new Error('Token is not for current user');}me._Storage[scope]=token;if(D2L.LP.Web.UI.Html.Dom.Storage.IsSupported()){var localStorage=me._GetLocalStorage()||{};localStorage[scope]=token;D2L.LP.Web.UI.Html.Dom.Storage.Local.Set(me._StorageKey,JSON.stringify(localStorage));}},_Init:function(){var me=D2L.LP.Web.Authentication.OAuth2;if(me._Initialized){return;}me._Initialized=true;window.addEventListener('storage',me._OnStorage);window.addEventListener('d2l-logout',me._ClearAll);},_OnStorage:function(e){var me=D2L.LP.Web.Authentication.OAuth2;switch(e.key){case'Session.Expired':case'Session.UserId':me._ClearAll();break;default:break;}},_GetObjectCacheToken:function(scope){var me=D2L.LP.Web.Authentication.OAuth2;var cache=D2L.LP.Web.Authentication.OAuth2._Storage;var cached=cache[scope];if(!cached){return null;}if(me._TokenIsExpired(cached)){delete cache[scope];return null;}return cached.access_token;},_GetLocalStorageToken:function(scope){var me=D2L.LP.Web.Authentication.OAuth2;if(!D2L.LP.Web.UI.Html.Dom.Storage.IsSupported()){return null;}var storage=me._GetLocalStorage();if(!storage){return null;}var storedToken=storage[scope];if(!storedToken){return null;}if(!me._TokenIsForCurrentUser(storedToken)){me._ClearCachedTokens();return null;}if(me._TokenIsExpired(storedToken)){storage[scope]=undefined;D2L.LP.Web.UI.Html.Dom.Storage.Local.Set(me._StorageKey,JSON.stringify(storage));return null;}me._Storage[scope]=storedToken;return storedToken.access_token;},_GetLocalStorage:function(){var me=D2L.LP.Web.Authentication.OAuth2;var storageVal=D2L.LP.Web.UI.Html.Dom.Storage.Local.Get(me._StorageKey);if(!storageVal){return null;}try{return JSON.parse(storageVal);}catch(e){D2L.LP.Web.UI.Html.Dom.Storage.Local.Remove(me._StorageKey);return null;}},_ClearAll:function(){var me=D2L.LP.Web.Authentication.OAuth2;me._Inflight={};me._ClearCachedTokens();},_ClearCachedTokens:function(){var me=D2L.LP.Web.Authentication.OAuth2;me._Storage={};D2L.LP.Web.UI.Html.Dom.Storage.Local.Remove(me._StorageKey);},_RequestTokenDeduped:function(scope){var me=D2L.LP.Web.Authentication.OAuth2;if(!me._Inflight[scope]){me._Inflight[scope]=me._RequestToken(scope).then(function(token){delete me._Inflight[scope];return token;},function(e){delete me._Inflight[scope];throw e;});}return me._Inflight[scope];},_RequestToken:function(scope){var me=D2L.LP.Web.Authentication.OAuth2;var xsrfToken=D2L.LP.Web.Authentication.Xsrf.GetXsrfToken();var request=new Request('/d2l/lp/auth/oauth2/token',{method:'POST',headers:new Headers({'Content-Type':'application/x-www-form-urlencoded','X-Csrf-Token':xsrfToken}),body:'scope='+scope,credentials:'include'});return window.fetch(request).then(me._AdjustClockSkew).then(function(response){if(!response.ok){throw new Error(response.statusText);}return response.json();}).then(function(token){if(!me._TokenIsForCurrentUser(token)){throw new Error('Session has changed during request');}return token;}).then(function(token){me.AddTokenToCache(scope,token);return token.access_token;});},_AdjustClockSkew:function(response){var me=D2L.LP.Web.Authentication.OAuth2;try{var dateHeader=response.headers.get('Date');if(!dateHeader){return;}var serverTime=new Date(dateHeader).getTime();if(serverTime!==serverTime){return;}serverTime=Math.round(serverTime/1000);var currentTime=D2L.LP.Web.Authentication.OAuth2._Now();me._ClockSkew=serverTime-currentTime;}catch(e){}return response;},_Now:function(){return Math.round(Date.now()/1000);},_TokenIsExpired:function(token){var me=D2L.LP.Web.Authentication.OAuth2;return me._Now()+me._ClockSkew>token.expires_at;},_TokenIsForCurrentUser:function(token){var parts=token.access_token.split('.');if(parts.length!==3)return false;var userId;try{var decoded=JSON.parse(atob(parts[1]));userId=decoded.sub;}catch(e){return false;}if(!userId){return false;}var currentUser=D2L.LP.Web.UI.Html.Dom.Storage.Local.Get('Session.UserId');if(userId!==currentUser){return false;}return true;}};D2L.LP.Web.Authentication.Xsrf={Init:function(xsrfTokenParameterName,xsrfToken,hitCodeSeed){D2L.LP.Web.UI.Html.Dom.Storage.Local.Set('XSRF.HitCodeSeed',hitCodeSeed);D2L.LP.Web.UI.Html.Dom.Storage.Local.Set('XSRF.Token',xsrfToken);},GetHitCodeSeed:function(){var hitCodeSeed=D2L.LP.Web.UI.Html.Dom.Storage.Local.Get('XSRF.HitCodeSeed');return hitCodeSeed;},GetXsrfTokenParameterName:function(){return'd2l_referrer';},GetXsrfToken:function(){var token=D2L.LP.Web.UI.Html.Dom.Storage.Local.Get('XSRF.Token');return token;},CreateXsrfHidden:function(){var hidden=document.createElement('input');hidden.type='hidden';hidden.name=D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName();hidden.value=D2L.LP.Web.Authentication.Xsrf.GetXsrfToken();return hidden;}};D2L.LP.Web.UI.Html.Aria={LogMessage:function(message){D2L.Announce(message);},Politeness:{Off:'off',Polite:'polite',Assertive:'assertive',Rude:'rude'},RemoveAttribute:function(element,attribute){if(element!==undefined&&element!==null){element.removeAttribute('aria-'+attribute);}},SetAttribute:function(element,attribute,value){if(element!==undefined&&element!==null){D2L.LP.Web.UI.Html.Dom.SetAttribute(element,'aria-'+attribute,value);}},SetRole:function(element,role){if(element!==undefined&&element!==null){D2L.LP.Web.UI.Html.Dom.SetAttribute(element,'role',role);}},RpcReceivePayloadProvider:function(data){if(data.Items===undefined||data.Items===null){return;}var messages=data.Items;var message="";for(var i=0;i<messages.length;i++){message+=messages[i].Message;}D2L.LP.Web.UI.Html.Aria.LogMessage(message);}};D2L.LP.Web.UI.Html.Bsi={BaseLocation:'',Env:'prod',Init:function(env,wcPolyfill,useShadyDom,regeneratorRuntime,baseLocation,modules){D2L.LP.Web.UI.Html.Bsi.Env=env;D2L.LP.Web.UI.Html.Bsi.BaseLocation=baseLocation;D2L.LP.Web.UI.Html.Bsi.LoadPolyfills(wcPolyfill,useShadyDom,regeneratorRuntime).then(function(){return D2L.LP.Web.UI.Html.Bsi.LoadAssets(['web-components/bsi-unbundled.js']);}).then(function(){return D2L.LP.Web.UI.Html.Bsi.LoadFiles(modules);}).then(function(){D2L.WebComponentsLoaded();if('interactive'===document.readyState||'complete'===document.readyState){document.body.classList.remove('d2l-body-unresolved');}else{window.addEventListener('DOMContentLoaded',function(){document.body.classList.remove('d2l-body-unresolved');});}});},GetAssetLocation:function(assetPath){var path=assetPath;if(D2L.LP.Web.UI.Html.Bsi.Env==='prod'&&(path.startsWith('node_modules/')||path.startsWith('web-components/'))){var lastSlash=path.lastIndexOf('/');if(lastSlash>0){path=path.substring(lastSlash+1);}path='unbundled/'+path;}var fullPath=D2L.LP.Web.UI.Html.Bsi.BaseLocation+path;return fullPath;},LoadAssets:function(assets){var paths=assets.map(function(path){return D2L.LP.Web.UI.Html.Bsi.GetAssetLocation(path);});return D2L.LP.Web.UI.Html.Bsi.LoadFiles(paths);},LoadFiles:function(files){var supportsDynamicImports=D2L.LP.Web.UI.Html.Bsi.SupportsDynamicImports();var promises=files.map(function(src){if(supportsDynamicImports){return D2L.LP.Web.UI.Html.Bsi.LoadScript(src,'module');}if(D2L.LP.Web.UI.Html.Bsi.Env!=='dev'){var lastSlash=src.lastIndexOf('/')+1;src=src.substring(0,lastSlash)+'nomodule-'+src.substring(lastSlash);}return System['import'](src)['catch'](function noop(){});});return Promise.all(promises);},LoadFilesEventWrapper:function(files){var e=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Html.Bsi.LoadFiles(files).then(function(){requestAnimationFrame(function(){e.Trigger();});});return e;},LoadPolyfills:function(wcPolyfill,useShadyDom,regeneratorRuntime){var loadScript=D2L.LP.Web.UI.Html.Bsi.LoadScript;var polyfills=[];var supportsNoModule=('noModule'in HTMLScriptElement.prototype);if(!D2L.LP.Web.UI.Html.Bsi.SupportsDynamicImports()){polyfills.push(loadScript('https://s.brightspace.com/lib/systemjs/4.1.1/system.min.js').then(function(){if(D2L.LP.Web.UI.Html.Bsi.Env==='dev'){var originalResolve=System.constructor.prototype.resolve;System.constructor.prototype.resolve=function(){return Promise.resolve(originalResolve.apply(this,arguments)).then(function(url){return url+(url.indexOf('?')>0?'&':'?')+'transform-systemjs';});};}}));}if(!supportsNoModule){polyfills.push(loadScript(regeneratorRuntime));}if(!('fetch'in window)||!('Request'in window)||!('signal'in window.Request.prototype)){polyfills.push(loadScript('https://s.brightspace.com/lib/whatwg-fetch/3.0.0/fetch.umd.js'));}if(useShadyDom||!('attachShadow'in Element.prototype)||!('getRootNode'in Element.prototype)){document.addEventListener('WebComponentsReady',function(){D2L.WCRDispatched();});polyfills.push(loadScript(wcPolyfill+'webcomponents-bundle.js'));}else{D2L.WCRDispatched();}if(!supportsNoModule&&'getRootNode'in Element.prototype){polyfills.push(loadScript(wcPolyfill+'custom-elements-es5-adapter.js'));}return Promise.all(polyfills);},LoadScript:function(src,type){return new Promise(function(resolve){function onLoaded(){if(script.parentElement){script.parentElement.removeChild(script);}resolve();}var script=document.createElement('script');script.src=src;script.onload=onLoaded;script.onerror=function(){console.error('[D2L.LP.Web.UI.Html.Bsi.LoadScript] failed to load: "'+src+'" check the network tab for HTTP status. Are you sure your BSI environment is configured correctly?');onLoaded();};if(type)script.type=type;document.head.appendChild(script);});},RpcReceiveJsPayloadProvider:function(data){if(data===undefined||data===null)return true;return D2L.LP.Web.UI.Html.Bsi.LoadFilesEventWrapper(data);},SupportsDynamicImports:function(){try{Function('!function(){import(_)}').call();return true;}catch(err){return false;}}};D2L.LP.Web.UI.Html.ChangeTracking={Tracker:{ChangedItems:{},TrackChanges:function(elem,showChanges){if(!elem)return;if(showChanges===undefined)showChanges=true;var trackerId=new D2L.LP.Web.UI.Html.UniqueHtmlId().GetValue();elem.setAttribute('data-tracker-id',trackerId);elem.setAttribute('data-track-changes','true');var changedItems={};D2L.LP.Web.UI.Html.ChangeTracking.Tracker.ChangedItems[trackerId]=changedItems;elem.addEventListener('vui-change',function(e){var id=e.target?e.target.id:'';if(id==='')return;changedItems[id]=true;if(showChanges&&!e.isChangeShown){elem.classList.add('vui-changed');e.isChangeShown=true;}});elem.addEventListener('vui-restore',function(e){var id=e.target?e.target.id:'';if(id==='')return;if(changedItems[id]!==undefined){delete changedItems[id];}if(showChanges&&Object.keys(changedItems).length===0){elem.classList.remove('vui-changed');}});},ContainsChanges:function(elem){var trackerId=elem.getAttribute('data-tracker-id');if(!trackerId)return false;var changedItems=D2L.LP.Web.UI.Html.ChangeTracking.Tracker.ChangedItems[trackerId];return Object.keys(changedItems).length>0;},TriggerReset:function(elem){elem.dispatchEvent(new CustomEvent('vui-reset',{composed:true,bubbles:true}));}},Trackable:{GetValue:function(elem){var nodeName=elem.nodeName;if(nodeName==='INPUT'){var inputType=elem.getAttribute('type');if(inputType==='checkbox'||inputType==='radio'){return elem.checked;}}return elem.value;},HandleChange:function(elem){var nodeName=elem.nodeName;var selectedId=elem._changeTracking.selectedId;if(nodeName==='INPUT'&&elem.getAttribute('type')==='radio'){var groupName=elem.getAttribute('name');if(groupName){var radioOptions=document.querySelectorAll('input[name="'+groupName+'"]');for(var i=0;i<radioOptions.length;i++){if(radioOptions[i]!==elem&&radioOptions[i].id===selectedId){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.TriggerEvent(radioOptions[i]);}radioOptions[i]._changeTracking.selectedId=elem.id;}}}D2L.LP.Web.UI.Html.ChangeTracking.Trackable.TriggerEvent(elem);},HandleReset:function(elem,tracker){var isParentTracker=D2L.LP.Web.UI.Html.Dom.IsAncestor(tracker,elem);if(!isParentTracker||!elem._changeTracking.hasChanged){return;}elem._changeTracking.originalValue=D2L.LP.Web.UI.Html.ChangeTracking.Trackable.GetValue(elem);elem._changeTracking.hasChanged=false;elem.dispatchEvent(new CustomEvent('vui-restore',{composed:true,bubbles:true}));},StartTracking:function(elem){elem._changeTracking={};var nodeName=elem.nodeName;if(nodeName==='INPUT'&&elem.getAttribute('type')==='radio'){var groupName=elem.getAttribute('name');if(groupName){var selected=document.querySelector('input[name="'+groupName+'"][checked]');if(selected){if(selected.id===''){selected.id=new D2L.LP.Web.UI.Html.UniqueHtmlId().GetValue();}elem._changeTracking.selectedId=selected.id;}}}if(elem.id===''){elem.id=new D2L.LP.Web.UI.Html.UniqueHtmlId().GetValue();}elem._changeTracking.originalValue=D2L.LP.Web.UI.Html.ChangeTracking.Trackable.GetValue(elem);elem._changeTracking.hasChanged=false;elem._changeTracking.resetHandler=function(e){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.HandleReset(elem,e.target);};document.addEventListener('vui-reset',elem._changeTracking.resetHandler);elem.addEventListener('change',function(){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.HandleChange(elem);});},StopTracking:function(elem){if(elem._changeTracking.hasChanged){elem.dispatchEvent(new CustomEvent('vui-restore',{composed:true,bubbles:true}));}document.removeEventListener('vui-reset',elem._changeTracking.resetHandler);},TriggerEvent:function(elem){var hasChanged=D2L.LP.Web.UI.Html.ChangeTracking.Trackable.GetValue(elem)!==elem._changeTracking.originalValue;elem._changeTracking.hasChanged=hasChanged;elem.dispatchEvent(new CustomEvent(hasChanged?'vui-change':'vui-restore',{composed:true,bubbles:true}));},TriggerChange:function(elem){elem.dispatchEvent(new CustomEvent('vui-change',{composed:true,bubbles:true}));},TriggerRestore:function(elem){elem.dispatchEvent(new CustomEvent('vui-restore',{composed:true,bubbles:true}));}}};D2L.LP.Web.UI.Html.DragDrop={};D2L.LP.Web.UI.Html.DragDrop={Install:function(id,ddType,draggableSettings,droppableSettings){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.DragDrop.InstallNode(node,ddType,draggableSettings,droppableSettings);},InstallNode:function(node,ddType,draggableSettings,droppableSettings){if(ddType==D2L.LP.Web.UI.Html.DragDrop.DragDropType.Draggable||ddType==D2L.LP.Web.UI.Html.DragDrop.DragDropType.DraggableDroppable){D2L.LP.Web.UI.Html.DragDrop.MakeDraggableNode(node,draggableSettings);}if(ddType==D2L.LP.Web.UI.Html.DragDrop.DragDropType.Droppable||ddType==D2L.LP.Web.UI.Html.DragDrop.DragDropType.DraggableDroppable){D2L.LP.Web.UI.Html.DragDrop.MakeDroppableNode(node,droppableSettings);}},CreateGhost:function(ghostType,node,initialPos,win){var ghost;if(ghostType==D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow){ghost=win.document.createElement('div');ghost.className='d2l-dragdrop-shadow';}else if(ghostType==D2L.LP.Web.UI.Html.DragDrop.GhostType.CloneShadow){var clearFloat=win.document.createElement('div');clearFloat.className='d2l-clear';var ghostWrapper=win.document.createElement('div');var clonedNode=node.cloneNode(true);clonedNode.style.margin=0;ghostWrapper.appendChild(clonedNode);ghostWrapper.appendChild(clearFloat);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-dragdrop-clone-shadow',ghostWrapper);ghost=ghostWrapper;}ghost.style.left=initialPos.left+'px';ghost.style.top=initialPos.top+'px';ghost.style.width=initialPos.width+1+'px';ghost.style.height=initialPos.height+1+'px';ghost.style.zIndex=win.D2L.LP.Web.UI.Desktop.Controls.Shim.GetZIndex();win.document.body.appendChild(ghost);return ghost;},RemoveDrag:function(dragObject){D2L.LP.Web.UI.Html.Dom.RemoveElement(dragObject.GetDragNode());}};D2L.LP.Web.UI.Html.DragDrop.DragDropEffect={None:0,Move:1};D2L.LP.Web.UI.Html.DragDrop.DragObject=D2L.Class.Create({Construct:function(dragNode,draggableSettings){this.m_dragNode=dragNode;this.m_draggableSettings=draggableSettings;},GetDragNode:function(){return this.m_dragNode;},GetDraggableSettings:function(){return this.m_draggableSettings;}});D2L.LP.Web.UI.Html.DragDrop.DragPosition={Invalid:0,Top:1,Middle:2,Bottom:3};D2L.LP.Web.UI.Html.DragDrop.DropEffect={None:0,Move:1,Swap:2};D2L.LP.Web.UI.Html.DragDrop.DragDropManager={RefreshDroppables:function(){var nodes=D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_droppableNodes;for(var i=0;i<nodes.length;i++){D2L.LP.Web.UI.Html.DragDrop.DragDropManager.RefreshDroppable(nodes[i]);}},RefreshDroppable:function(node){node.m_rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);},AddDroppable:function(node){D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_droppableNodes.push(node);},SetDrag:function(dragObject){D2L.LP.Web.UI.Html.DragDrop.DragDropManager.SetIsDragging(true);D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag=dragObject;},GetDrag:function(){return D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag;},GetDragParam:function(){return D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag.GetDraggableSettings().GetParam();},GetDragKey:function(){return D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag.GetDraggableSettings().GetKey();},IsDragging:function(){return D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_isDragging;},SetIsDragging:function(isDragging){D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_isDragging=isDragging;}};D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag=null;D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_isDragging=false;D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_droppableNodes=[];D2L.LP.Web.UI.Html.DragDrop.DragDropType={Draggable:0,Droppable:1,DraggableDroppable:2};D2L.LP.Web.UI.Html.DragDrop.DraggableSettings=D2L.Class.Create({Construct:function(){this.m_key=null;this.m_handleNode=null;this.m_handleExceptions=[];this.m_ghostType=D2L.LP.Web.UI.Html.DragDrop.GhostType.CloneShadow;this.m_param=null;this.m_isDelayed=true;this.m_isAutoScroll=true;this.m_dragDropEffect=D2L.LP.Web.UI.Html.DragDrop.DragDropEffect.None;this.m_dragStartEvent=new D2L.LP.Web.UI.Events.Event();this.m_dragEndEvent=new D2L.LP.Web.UI.Events.Event();this.m_dragGroup=null;},_deserialize:function(deserializer){this.m_key=deserializer.GetMember('Key');this.m_param=deserializer.GetMember('Param');this.m_dragGroup=deserializer.GetMember('DragGroup');var dragStartFunction=deserializer.GetMember('OnDragStartFunction');if(dragStartFunction!=null){this.GetDragStartEvent().AddListener(dragStartFunction);}},AddHandleException:function(node){this.m_handleExceptions.push(node);},GetIsAutoScroll:function(){return this.m_isAutoScroll;},GetDragDropEffect:function(){return this.m_dragDropEffect;},GetDragGroup:function(){return this.m_dragGroup;},GetDragStartEvent:function(){return this.m_dragStartEvent;},GetDragEndEvent:function(){return this.m_dragEndEvent;},GetGhostType:function(){return this.m_ghostType;},GetHandle:function(){return this.m_handleNode;},GetHandleExceptions:function(){return this.m_handleExceptions;},GetKey:function(){return this.m_key;},GetParam:function(){return this.m_param;},IsDelayed:function(){return this.m_isDelayed;},SetIsDelayed:function(isDelayed){this.m_isDelayed=isDelayed;},SetHandle:function(node){this.m_handleNode=node;},SetDragGroup:function(groupName){this.m_dragGroup=groupName;},SetGhostType:function(ghostType){this.m_ghostType=ghostType;},SetIsAutoScroll:function(autoScroll){this.m_isAutoScroll=autoScroll;},SetDragDropEffect:function(dragDropEffect){this.m_dragDropEffect=dragDropEffect;},SetKey:function(key){this.m_key=key;},SetParam:function(param){this.m_param=param;}});D2L.LP.Web.UI.Html.DragDrop.DroppableSettings=D2L.Class.Create({Construct:function(){this.m_dropEvent=new D2L.LP.Web.UI.Events.Event();this.m_dragInEvent=new D2L.LP.Web.UI.Events.Event();this.m_dragOutEvent=new D2L.LP.Web.UI.Events.Event();this.m_dragOverEvent=new D2L.LP.Web.UI.Events.Event();this.m_dropEffect=D2L.LP.Web.UI.Html.DragDrop.DropEffect.None;this.m_eventPropagation=true;this.m_padding={top:0,left:0,right:0,bottom:0};this.m_acceptableDragGroups=[];},_deserialize:function(deserializer){var dropFunction=deserializer.GetMember('OnDropFunction');if(dropFunction!=null){this.GetDropEvent().AddListener(dropFunction);}var dragInFunction=deserializer.GetMember('OnDragInFunction');if(dragInFunction!=null){this.GetDragInEvent().AddListener(dragInFunction);}var dragOutFunction=deserializer.GetMember('OnDragOutFunction');if(dragOutFunction!=null){this.GetDragOutEvent().AddListener(dragOutFunction);}this.m_dropEffect=deserializer.GetMember('DropEffect');this.m_eventPropagation=deserializer.GetMember('EventPropagation');},AddAcceptableDragGroup:function(groupName){this.m_acceptableDragGroups.push(groupName);},GetAcceptableDragGroups:function(){return this.m_acceptableDragGroups;},GetDropEvent:function(){return this.m_dropEvent;},GetDragInEvent:function(){return this.m_dragInEvent;},GetDragOutEvent:function(){return this.m_dragOutEvent;},GetDragOverEvent:function(){return this.m_dragOverEvent;},GetPadding:function(){return this.m_padding;},GetDropEffect:function(){return this.m_dropEffect;},GetEventPropagation:function(){return this.m_eventPropagation;},SetAcceptableDragGroups:function(acceptableDragGroups){this.m_acceptableDragGroups=acceptableDragGroups;},SetDropEffect:function(dropEffect){this.m_dropEffect=dropEffect;},SetPadding:function(padding){this.m_padding=padding;},SetEventPropagation:function(propagate){this.m_eventPropagation=propagate;}});D2L.LP.Web.UI.Html.DragDrop.DropPosition={Before:0,After:1,On:2,Invalid:3};D2L.LP.Web.UI.Html.DragDrop.GhostType={OriginalShadow:1,CloneShadow:2};D2L.LP.Web.UI.Html.DragDrop.MakeDraggableNode=function(node,draggableSettings,nodeWin,outerWin){if(draggableSettings===undefined){draggableSettings=new D2L.LP.Web.UI.Html.DragDrop.DraggableSettings();}nodeWin=nodeWin||window;outerWin=outerWin||window;var handle=draggableSettings.GetHandle()||node;D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-dragdrop-draggable',handle);var initialCursorPos=null;var initialPos=null;var newPos=null;var shadow=null;var scrollTopTimeout;var scrollTopInstalled;var scrollBottomTimeout;var scrollBottomInstalled;var scrollLeftTimeout;var scrollLeftInstalled;var scrollRightTimeout;var scrollRightInstalled;var scrollSpeed=10;var scrollInterval=50;var scrollZone=40;var clearHorizontalAutoScroll=function(){scrollLeftInstalled=false;scrollRightInstalled=false;clearTimeout(scrollLeftTimeout);clearTimeout(scrollRightTimeout);};var clearVerticalAutoScroll=function(){scrollTopInstalled=false;scrollBottomInstalled=false;clearTimeout(scrollTopTimeout);clearTimeout(scrollBottomTimeout);};var clearAutoScroll=function(){clearHorizontalAutoScroll();clearVerticalAutoScroll();};var MouseMove=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);if(initialCursorPos===null||initialPos===null||shadow===null){return;}var newCursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(outerWin,evt);newPos={x:initialPos.left+newCursorPos.x-initialCursorPos.x,y:initialPos.top+newCursorPos.y-initialCursorPos.y};var pageSize=D2L.LP.Web.UI.Html.Dom.GetPageSize(outerWin);var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(outerWin);var dialogBox=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(shadow);var scroll=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(outerWin);if(newPos.x+dialogBox.width>pageSize.width){newPos.x=pageSize.width-dialogBox.width;}if(newPos.y+dialogBox.height>viewport.height+scroll.top){newPos.y=viewport.height+scroll.top-dialogBox.height;}if(newPos.x<0){newPos.x=0;}if(newPos.y<scroll.top){newPos.y=scroll.top;}shadow.style.left=newPos.x+'px';shadow.style.top=newPos.y+'px';if(draggableSettings.GetIsAutoScroll()){var viewPortSize=D2L.LP.Web.UI.Html.Dom.GetViewportSize();var scrollPosition=D2L.LP.Web.UI.Html.Dom.GetScrollPosition();var topDelta=newCursorPos.y-scrollPosition.top;var bottomDelta=scrollPosition.top+viewPortSize.height-newCursorPos.y;if(topDelta<scrollZone){var scrollTop=function(){if(D2L.LP.Web.UI.Html.Dom.GetScrollPosition().top>0){scrollTopInstalled=true;scrollTopTimeout=setTimeout(function(){scrollBy(0,-scrollSpeed);shadow.style.top=shadow.offsetTop-scrollSpeed+'px';scrollTop();},scrollInterval);}};if(!scrollTopInstalled){scrollTop();}}else if(bottomDelta<scrollZone){var scrollBottom=function(){scrollBottomInstalled=true;scrollBottomTimeout=setTimeout(function(){scrollBy(0,scrollSpeed);shadow.style.top=shadow.offsetTop+scrollSpeed+'px';scrollBottom();},scrollInterval);};if(!scrollBottomInstalled){scrollBottom();}}else{clearVerticalAutoScroll();}var leftDelta=newCursorPos.x-scrollPosition.left;var rightDelta=scrollPosition.left+viewPortSize.width-newCursorPos.x;if(leftDelta<scrollZone){var scrollLeft=function(){if(D2L.LP.Web.UI.Html.Dom.GetScrollPosition().left>0){scrollLeftInstalled=true;scrollLeftTimeout=setTimeout(function(){scrollBy(-scrollSpeed,0);shadow.style.left=shadow.offsetLeft-scrollSpeed+'px';scrollLeft();},scrollInterval);}};if(!scrollLeftInstalled){scrollLeft();}}else if(rightDelta<scrollZone){var scrollRight=function(){scrollRightInstalled=true;scrollRightTimeout=setTimeout(function(){scrollBy(scrollSpeed,0);shadow.style.left=shadow.offsetLeft+scrollSpeed+'px';scrollRight();},scrollInterval);};if(!scrollRightInstalled){scrollRight();}}else{clearHorizontalAutoScroll();}}};var Finish=function(e){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(e);outerWin.D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(MouseMove);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(Finish);shadow.parentNode.removeChild(shadow);if(draggableSettings.GetDragDropEffect()==D2L.LP.Web.UI.Html.DragDrop.DragDropEffect.Move){node.style.left=newPos.x+'px';node.style.top=newPos.y+'px';node.style.display='block';}D2L.LP.Web.UI.Html.DragDrop.DragDropManager.SetIsDragging(false);clearAutoScroll();draggableSettings.GetDragEndEvent().Trigger(e);};var Start=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);var target=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(evt);var handleExceptions=draggableSettings.GetHandleExceptions();for(var i=0;i<handleExceptions.length;i++){if(handleExceptions[i]==target||$.contains(handleExceptions[i],target)){return;}}var dragObject=new D2L.LP.Web.UI.Html.DragDrop.DragObject(node,draggableSettings);D2L.LP.Web.UI.Html.DragDrop.DragDropManager.SetDrag(dragObject);D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);initialPos=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);newPos={x:initialPos.left,y:initialPos.top};initialCursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(nodeWin,evt);initialCursorPos={x:initialCursorPos.x+(nodeWin!=outerWin?initialPos.left:0),y:initialCursorPos.y+(nodeWin!=outerWin?initialPos.top:0)};shadow=D2L.LP.Web.UI.Html.DragDrop.CreateGhost(draggableSettings.GetGhostType(),node,initialPos,outerWin);if(draggableSettings.GetGhostType()==D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow){node.style.display='none';}setTimeout(function(){D2L.LP.Web.UI.Html.DragDrop.DragDropManager.RefreshDroppables();});outerWin.D2L.LP.Web.UI.Events.OnMouseMove.AddListener(MouseMove);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.AddListener(Finish);draggableSettings.GetDragStartEvent().Trigger(evt);};var BeforeStart=function(clickEvt){var cancelDrag=false;D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(clickEvt);var onDownCursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,clickEvt);if(draggableSettings.IsDelayed()){var moveThreshold=3;var moved=false;var MoveTimer=function(e){var onMoveCursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,e);if(Math.abs(onMoveCursorPos.y-onDownCursorPos.y)>moveThreshold||Math.abs(onMoveCursorPos.x-onDownCursorPos.x)>moveThreshold){outerWin.D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(MoveTimer);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(UpTimer);if(!cancelDrag){Start(clickEvt);}moved=true;}};var UpTimer=function(e){D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(MoveTimer);D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(UpTimer);cancelDrag=true;if(!moved){if(clickEvt.changedTouches!==undefined||clickEvt.targetTouches!==undefined){D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(clickEvt));}}return false;};outerWin.D2L.LP.Web.UI.Events.OnMouseMove.AddListener(MoveTimer);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.AddListener(UpTimer);}else{Start(clickEvt);}};var BeforeStartTouch=function(touchEvt){var isDragEvent=true;var touchMoveTimer=function(){isDragEvent=false;};var touchUpTimer=function(){isDragEvent=false;};setTimeout(function(){D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(touchMoveTimer);D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(touchUpTimer);if(isDragEvent){BeforeStart(touchEvt);}},50);outerWin.D2L.LP.Web.UI.Events.OnMouseMove.AddListener(touchMoveTimer);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.AddListener(touchUpTimer);};if(handle.m_dragInstalled){return;}D2L.LP.Web.UI.Html.Dom.AddEventListener('touchstart',handle,BeforeStartTouch);D2L.LP.Web.UI.Html.Dom.AddEventListener('mousedown',handle,BeforeStart);handle.m_dragInstalled=true;};D2L.LP.Web.UI.Html.DragDrop.MakeDroppableNode=function(node,droppableSettings){if(droppableSettings===undefined){droppableSettings=new D2L.LP.Web.UI.Html.DragDrop.DroppableSettings();}var isDragIn=false;D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-dragdrop-droppable',node);var IsOverNode=function(targetDroppableNode,targetEvent,forgivenessPadding){var cursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,targetEvent);return cursorPos.x>=targetDroppableNode.m_rect.left-forgivenessPadding.left&&cursorPos.x<=targetDroppableNode.m_rect.right+forgivenessPadding.right&&cursorPos.y>=targetDroppableNode.m_rect.top-forgivenessPadding.top&&cursorPos.y<=targetDroppableNode.m_rect.bottom+forgivenessPadding.bottom;};var IsOver=function(evt){if(node.m_rect===undefined||!D2L.LP.Web.UI.Html.DragDrop.DragDropManager.IsDragging()){return false;}var forgivenessPadding=droppableSettings.GetPadding();var acceptableDragGroups=droppableSettings.GetAcceptableDragGroups();var dragObject=D2L.LP.Web.UI.Html.DragDrop.DragDropManager.GetDrag();var dragGroup=dragObject.GetDraggableSettings().GetDragGroup();if(acceptableDragGroups.length>0){if(dragGroup==null){return false;}var containsGroup=false;for(var i=0;i<acceptableDragGroups.length;i++){if(acceptableDragGroups[i]===dragGroup){containsGroup=true;}}if(!containsGroup){return false;}}var propagateEvent=droppableSettings.GetEventPropagation();if(!propagateEvent){var descendantDroppables=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-dragdrop-droppable",node);for(var i=0;i<descendantDroppables.length;i++){if(IsOverNode(descendantDroppables[i],evt,forgivenessPadding)){return false;}}}var cursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,evt);var isOverResult=IsOverNode(node,evt,forgivenessPadding);if(isOverResult){var mouseDelta={topDelta:cursorPos.y-node.m_rect.top,rightDelta:node.m_rect.right-cursorPos.x,bottomDelta:node.m_rect.bottom-cursorPos.y,leftDelta:cursorPos.x-node.m_rect.left,nodeHeight:node.m_rect.height};droppableSettings.GetDragOverEvent().Trigger(dragObject,mouseDelta);}return isOverResult;};var MouseUp=function(evt){if(isDragIn){var dragObject=D2L.LP.Web.UI.Html.DragDrop.DragDropManager.GetDrag();if(droppableSettings.GetDropEffect()==D2L.LP.Web.UI.Html.DragDrop.DropEffect.Move){node.appendChild(dragObject.GetDragNode());}else if(droppableSettings.GetDropEffect()==D2L.LP.Web.UI.Html.DragDrop.DropEffect.Swap){D2L.LP.Web.UI.Html.Dom.SwapElements(node,dragObject.GetDragNode());}droppableSettings.GetDropEvent().Trigger(dragObject);}};var MouseOut=function(evt){var dragObject=D2L.LP.Web.UI.Html.DragDrop.DragDropManager.GetDrag();isDragIn=false;droppableSettings.GetDragOutEvent().Trigger(dragObject);};var MouseIn=function(evt){var dragObject=D2L.LP.Web.UI.Html.DragDrop.DragDropManager.GetDrag();isDragIn=true;droppableSettings.GetDragInEvent().Trigger(dragObject);};D2L.LP.Web.UI.Events.OnMouseUp.AddListener(MouseUp);if(node.m_dropInstalled){return;}var mouseIn=false;var BeforeMouseMove=function(evt){if(IsOver(evt)){if(!mouseIn){mouseIn=true;MouseIn(evt);}}else{if(mouseIn){mouseIn=false;MouseOut(evt);}}};D2L.LP.Web.UI.Html.DragDrop.DragDropManager.AddDroppable(node);D2L.LP.Web.UI.Events.OnMouseMove.AddListener(BeforeMouseMove);node.m_dropInstalled=true;};D2L.LP.Web.UI.Html.DragDrop.MakeResizeableNode=function(node,settings,nodeWin,outerWin){var ghost;var initialPos;var initialMousePos;var newWidth=200;var newHeight=200;var maxWidth=500;var maxHeight=500;var resizeEvent=new D2L.LP.Web.UI.Events.Event();var MouseMove=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);var newMousePos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(outerWin,evt);newWidth=Math.min(Math.max(initialPos.width+newMousePos.x-initialMousePos.x,200),maxWidth);newHeight=Math.min(Math.max(initialPos.height+newMousePos.y-initialMousePos.y,200),maxHeight);ghost.style.width=newWidth+'px';ghost.style.height=newHeight+'px';};var Finish=function(){outerWin.D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(MouseMove);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(Finish);ghost.parentNode.removeChild(ghost);if(settings.DisplayType=='none'){node.style.display='';}else{node.style.visibility='';settings.Handle.style.visibility='';}resizeEvent.Trigger({width:newWidth,height:newHeight});node.style.display='block';};var Start=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);initialPos=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);newWidth=initialPos.width;newHeight=initialPos.height;initialMousePos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(nodeWin,evt);initialMousePos={x:initialMousePos.x+(outerWin!=nodeWin?initialPos.left:0),y:initialMousePos.y+(outerWin!=nodeWin?initialPos.top:0)};var scroll=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(outerWin);var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(outerWin);maxWidth=scroll.left+viewport.width-initialPos.left-20;maxHeight=scroll.top+viewport.height-initialPos.top-20;ghost=D2L.LP.Web.UI.Html.DragDrop.CreateGhost(D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow,node,initialPos,outerWin);ghost.style.cursor='nw-resize';if(settings.DisplayType=='none'){node.style.display='none';}else{node.style.visibility='hidden';settings.Handle.style.visibility='hidden';}outerWin.D2L.LP.Web.UI.Events.OnMouseMove.AddListener(MouseMove);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.AddListener(Finish);};if(settings.Handle.m_resizeInstalled){return;}D2L.LP.Web.UI.Html.Dom.AddEventListener('mousedown',settings.Handle,Start);D2L.LP.Web.UI.Html.Dom.AddEventListener('touchstart',settings.Handle,Start);settings.Handle.m_resizeInstalled=true;return resizeEvent;};D2L.LP.Web.UI.Html.Files={};D2L.LP.Web.UI.Html.Files.FetchFiles={FreeRangeAppIFramePlugin:function(){return function(host){var getFile=function(src){return window.fetch(src).then(function(response){return response.blob();});};var service={getContentFile:function(orgUnitPath,fileSubPath){var src='{0}{1}'.replace('{0}',orgUnitPath).replace('{1}',fileSubPath);return getFile(src);},getSharedFile:function(fileSubPath){var src='/shared/{0}'.replace('{0}',fileSubPath);return getFile(src);},getTempFile:function(fileId){var src='/d2l/lp/files/temp/{0}/View'.replace('{0}',fileId);return getFile(src);}};host.registerService('fetch-files','0.1',service);};}};D2L.LP.Web.UI.Html.Files.FileUpload={Upload:function(uploadLocation,files,params){var me=D2L.LP.Web.UI.Html.Files.FileUpload;var uploadStatus=D2L.LP.Web.UI.Html.Files.FileUpload.Status;var errorsNode;var progressNode;var progressFileNode;var progressFileNodes;if(params.IsStatusEnabled){if(progressNode===undefined||errorsNode===undefined){errorsNode=uploadStatus.GetErrorsContainerNode();progressNode=uploadStatus.GetProgressContainerNode();}uploadStatus.RemoveErrorMessages(errorsNode);}var isUploading=false;var uploadHandle=null;var fileNumber=0;var raiseError=function(errorNumber){if(params.IsStatusEnabled){uploadStatus.AddErrorMessage(errorsNode,params.ErrorMessages[errorNumber-1]);}params.OnError.call(params.OnError,errorNumber);};var removeAllProgressFiles=function(){if(params.IsStatusEnabled){for(var k=0;k<progressFileNodes.length;k++){uploadStatus.RemoveFile(progressFileNodes[k]);}uploadStatus.SetIsProgressContainerVisible(progressNode,false);}};var resetUpload=function(){isUploading=false;uploadHandle=null;};if(!params.IsMultipleAllowed&&files.length>1){raiseError(1);return;}for(var i=0;i<files.length;i++){if(files[i].name.length>params.MaxFileNameLength){raiseError(7);return;}if(!me.IsExtensionValid(files[i].name,params.Extensions,params.RestrictedExtensions)){raiseError(2);return;}if(params.MaxFileSize>0&&files[i].size>params.MaxFileSize){raiseError(3);return;}if(!me.IsFileNameValid(files[i].name)){raiseError(5);return;}if(files[i].size===0){raiseError(6);return;}}var requestParams={BytesPerSlice:params.BytesPerSlice,OnFileStarted:function(fileName){if(params.IsStatusEnabled){progressFileNode=progressFileNodes[fileNumber];fileNumber+=1;}},OnProgress:function(progress){if(params.IsStatusEnabled){uploadStatus.UpdateFile(progressFileNode,progress.GetFileName(),progress.GetFilePercent());}params.OnProgress.call(params.OnProgress,progress);},OnFileComplete:function(tempFile){if(params.IsStatusEnabled){uploadStatus.SetIsFileCompleted(progressFileNode,tempFile.FileName);}var file=new D2L.LP.Web.UI.Files.File(tempFile.FileId,'Temp',tempFile.FileName,tempFile.Size,'');params.OnFileComplete.call(params.OnFileComplete,file);},OnFilesComplete:function(){if(params.IsStatusEnabled){uploadStatus.SetIsProgressContainerVisible(progressNode,false);}params.OnFilesComplete.call(params.OnFilesComplete);resetUpload();},OnAbort:function(){removeAllProgressFiles();params.OnAbort.call(params.OnAbort);resetUpload();params.OnProgress.call(params.OnProgress,new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress('',0,0,0,0));},OnError:function(){resetUpload();raiseError(4);},UploadLocation:uploadLocation};params.OnProgress.call(params.OnProgress,new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress('',0,0,0,0));isUploading=true;params.OnFilesStarted.call(params.OnFilesStarted);if(params.IsStatusEnabled){progressFileNodes=[];for(var j=0;j<files.length;j++){progressFileNodes.push(uploadStatus.AddFile(progressNode,files[j].name));}setTimeout(function(){if(isUploading){uploadStatus.SetIsProgressContainerVisible(progressNode,true);}},500);}uploadHandle=D2L.LP.Web.UI.Html.Files.FileUpload.XmlHttpRequest.UploadFiles(files,requestParams);return uploadHandle;},GetFileExtension:function(fileName){var extStart=fileName.lastIndexOf('.');if(extStart<0){return null;}return fileName.substr(extStart+1).toLowerCase();},IsFileNameValid:function(fileName){var filenameRegex=/^([^\\\\/:\*\?\"<>\|]{0,127}[^\\\./:\*\?\"<>\|])\.*[^\\\./:\*\?\"<>\|]*$/;var match=filenameRegex.exec(fileName);return match!==null;},IsExtensionValid:function(fileName,extensions,restrictedExtensions){var me=D2L.LP.Web.UI.Html.Files.FileUpload;var extension=me.GetFileExtension(fileName);if(extension!==null){if(D2L.LP.Web.UI.Html.Dom.IndexOf(restrictedExtensions,extension)!==-1){return false;}if(D2L.LP.Web.UI.Html.Dom.IndexOf(extensions,'*.*')===-1&&D2L.LP.Web.UI.Html.Dom.IndexOf(extensions,extension)===-1){return false;}}else{return false;}return true;}};D2L.LP.Web.UI.Html.Files.FileUpload.IFrameRequest={CallbackNumber:0,ERRCODE_MAXFILESIZE:'1000',ERRCODE_TOTALFILESIZE:'1001',ERRCODE_RESTRICTEDFILEEXT:'1002',Upload:function(openerId,uploadLocation,fileNode,params){var me=D2L.LP.Web.UI.Html.Files.FileUpload.IFrameRequest;var fileUpload=D2L.LP.Web.UI.Html.Files.FileUpload;var uploadStatus=D2L.LP.Web.UI.Html.Files.FileUpload.Status;var errorsNode;var progressNode;var progressFileNode;if(params.IsStatusEnabled){if(progressNode===undefined||errorsNode===undefined){errorsNode=uploadStatus.GetErrorsContainerNode();progressNode=uploadStatus.GetProgressContainerNode();}uploadStatus.RemoveErrorMessages(errorsNode);}var raiseError=function(errorNumber){if(params.IsStatusEnabled){uploadStatus.AddErrorMessage(errorsNode,params.ErrorMessages[errorNumber-1]);}params.OnError.call(params.OnError,errorNumber);};if(!fileUpload.IsExtensionValid(fileNode.value,params.Extensions,params.RestrictedExtensions)){raiseError(2);return;}var iFrameId=openerId.GetValue()+'_iframe_'+me.CallbackNumber;var iFrameNode=D2L.LP.Web.UI.Html.Dom.GetElementById(iFrameId);if(iFrameNode==null){iFrameNode=document.createElement('IFRAME');D2L.LP.Web.UI.Html.Dom.SetAttribute(iFrameNode,'id',iFrameId);D2L.LP.Web.UI.Html.Dom.SetAttribute(iFrameNode,'name',iFrameId);D2L.LP.Web.UI.Html.Dom.SetAttribute(iFrameNode,'src','/d2l/tools/blank.html');D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-offscreen',iFrameNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',iFrameNode);D2L.LP.Web.UI.Html.Dom.InsertElementAfter(iFrameNode,fileNode);}D2L.LP.Web.UI.Html.Dom.SetAttribute(fileNode,'name','uploadFile');var uploadHandle={Abort:function(){if(this.IsUploading){if(params.IsStatusEnabled){uploadStatus.SetIsFileCompleted(progressFileNode);uploadStatus.SetIsProgressContainerVisible(progressNode,false);}if(params.OnAbort!=null){params.OnAbort.call(params.OnAbort);}}},IsUploading:false};var uploadCallback=function(fileData){uploadHandle.IsUploading=false;var json=fileData;var response=D2L.LP.Web.Serialization.Json.Deserialize(json);var failCode=response.ResponseCode;var failReason=response.Message;if(failCode!='0'||response.File==null){if(failCode==me.ERRCODE_MAXFILESIZE||failCode==me.ERRCODE_TOTALFILESIZE){raiseError(3);}else if(failCode==me.ERRCODE_RESTRICTEDFILEEXT){raiseError(2);}if(params.IsStatusEnabled){uploadStatus.SetIsFileCompleted(progressFileNode);uploadStatus.SetIsProgressContainerVisible(progressNode,false);}return;}var file=new D2L.LP.Web.UI.Files.File(response.File.FileId,response.File.FileSystemType,response.File.FileName,response.File.Size);if(params.IsStatusEnabled){uploadStatus.SetIsFileCompleted(progressFileNode,response.File.FileName);uploadStatus.SetIsProgressContainerVisible(progressNode,false);}params.OnFileComplete.call(params.OnFileComplete,file);params.OnFilesComplete.call(params.OnFilesComplete);};var callbackId=me.GetUniqueCallbackId(iFrameId);window[callbackId]=uploadCallback;var fileName=me.StripFilePath(fileNode.value);var location=uploadLocation.WithQueryString('cb',callbackId).WithQueryString('fileName',fileName).WithQueryString('iframe',true).GetUrl();var formNode=document.createElement('FORM');D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,'action',location);D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,'id',openerId.GetValue()+'_form');D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,'method','post');D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,'enctype','multipart/form-data');D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,'encoding','multipart/form-data');formNode.appendChild(D2L.LP.Web.Authentication.Xsrf.CreateXsrfHidden());formNode.target=iFrameId;formNode.onsubmit="return false;";fileNode.parentNode.removeChild(fileNode);formNode.appendChild(fileNode);var doLoad=true;D2L.LP.Web.UI.Html.Dom.AddEventListener('load',iFrameNode,function(){if(doLoad){doLoad=false;uploadHandle.IsUploading=true;params.OnFilesStarted.call(params.OnFilesStarted);params.OnProgress.call(params.OnProgress.call,new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress(fileName));if(params.IsStatusEnabled){progressFileNode=uploadStatus.AddFile(progressNode,fileName);uploadStatus.UpdateFile(progressFileNode,fileName);setTimeout(function(){if(uploadHandle.IsUploading){uploadStatus.SetIsProgressContainerVisible(progressNode,true);}},500);}var iFrameBodyNode=iFrameNode.contentDocument.body;iFrameBodyNode.appendChild(formNode);formNode.submit();}else if(uploadHandle.IsUploading){uploadHandle.IsUploading=false;raiseError(3);}});return uploadHandle;},GetUniqueCallbackId:function(iFrameId){var me=D2L.LP.Web.UI.Html.Files.FileUpload.IFrameRequest;var date=new Date();var time=date.getTime();me.CallbackNumber+=1;return iFrameId+'_cb_'+time+'_'+me.CallbackNumber;},StripFilePath:function(fileName){var index=fileName.lastIndexOf("\\");return fileName.substring(index+1);}};D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress=D2L.Class.Create({Construct:function(fileName,fileSentBytes,fileSizeBytes,totalSentBytes,totalSizeBytes){this.m_fileName=fileName;this.m_fileSentBytes=fileSentBytes;this.m_fileSizeBytes=fileSizeBytes;this.m_totalSentBytes=totalSentBytes;this.m_totalSizeBytes=totalSizeBytes;},_deserialize:function(deserializer){},_serialize:function(serializer){serializer.AddMember('FileName',this.m_fileName);serializer.AddMember('FileSentBytes',this.m_fileSentBytes);serializer.AddMember('FileSizeBytes',this.m_fileSizeBytes);serializer.AddMember('TotalSentBytes',this.m_totalSentBytes);serializer.AddMember('TotalSizeBytes',this.m_totalSizeBytes);},GetFileName:function(){return this.m_fileName;},GetFileSentBytes:function(){return this.m_fileSentBytes;},GetFileSizeBytes:function(){return this.m_fileSizeBytes;},GetFilePercent:function(){if(this.m_fileSizeBytes===0){return 0;}else{if(this.m_fileSentBytes>this.m_fileSizeBytes){this.m_fileSentBytes=this.m_fileSizeBytes;}return Math.round(this.m_fileSentBytes*100/this.m_fileSizeBytes);}},GetTotalSentBytes:function(){return this.m_totalSentBytes;},GetTotalSizeBytes:function(){return this.m_totalSizeBytes;},GetTotalPercent:function(){if(this.m_totalSizeBytes===0){return 0;}else{return Math.round(this.m_totalSentBytes*100/this.m_totalSizeBytes);}}});D2L.LP.Web.UI.Html.Files.FileUpload.Status={AddFile:function(node,fileName){var fileNode=document.createElement('li');fileNode.className='d2l-filedrop-status-file';fileNode.innerHTML=fileName;fileNode.d2l_isComplete=false;return node.childNodes[0].appendChild(fileNode);},AddErrorMessage:function(node,message){node.childNodes[1].innerHTML=message;if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-filedrop-status-errors-hidden',node)){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-filedrop-status-errors-hidden',node);}if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-filedrop-status-container-hidden',node.parentNode)){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-filedrop-status-container-hidden',node.parentNode);}},GetContainerNode:function(){var node=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-filedrop-status-container');if(node!=null){return node;}node=document.createElement('div');node.className='d2l-filedrop-status-container';var errorNode=document.createElement('div');errorNode.className='d2l-filedrop-status-errors d2l-filedrop-status-errors-hidden';node.appendChild(errorNode);var errorCloseNode=document.createElement('span');errorCloseNode.className='d2l-filedrop-status-errors-close';D2L.LP.Web.UI.Html.Dom.AddEventListener('click',errorCloseNode,function(){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-filedrop-status-errors-hidden',errorNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-filedrop-status-container-hidden',node);});errorNode.appendChild(errorCloseNode);var errorTextNode=document.createElement('span');errorNode.appendChild(errorTextNode);var progressNode=document.createElement('div');progressNode.className='d2l-filedrop-status-progress d2l-filedrop-status-progress-hidden';node.appendChild(progressNode);var filesNode=document.createElement('ul');filesNode.className='d2l-filedrop-status-files';progressNode.appendChild(filesNode);return document.body.appendChild(node);},GetErrorsContainerNode:function(){var me=D2L.LP.Web.UI.Html.Files.FileUpload.Status;return me.GetContainerNode().childNodes[0];},GetProgressContainerNode:function(){var me=D2L.LP.Web.UI.Html.Files.FileUpload.Status;return me.GetContainerNode().childNodes[1];},SetIsProgressContainerVisible:function(node,isVisible){if(isVisible){if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-filedrop-status-progress-hidden',node)){var fileCount=node.childNodes[0].childNodes.length;for(var i=0;i<fileCount;i++){var fileNode=node.childNodes[0].childNodes[i];if(fileNode.d2l_isComplete){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',fileNode);}}D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-filedrop-status-progress-hidden',node);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-filedrop-status-container-hidden',node.parentNode);}}else{var fileCount=node.childNodes[0].childNodes.length;for(var i=0;i<fileCount;i++){var fileNode=node.childNodes[0].childNodes[i];if(!fileNode.d2l_isComplete){return;}}D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-filedrop-status-progress-hidden',node);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-filedrop-status-container-hidden',node.parentNode);}},SetIsFileCompleted:function(node,fileName){node.d2l_isComplete=true;this.UpdateFile(node,fileName,100);},RemoveErrorMessages:function(node){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-filedrop-status-errors-hidden',node);node.childNodes[1].innerHTML='';},RemoveFile:function(node){node.d2l_isComplete=true;D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-filedrop-status-file-hidden',node);},UpdateFile:function(node,fileName,percent){if(node==null){return;}if(percent!==undefined){node.innerHTML=fileName+' - '+percent+'%';}else{node.innerHTML=fileName+' - '+'Uploading';}}};D2L.LP.Web.UI.Html.Files.FileUpload.XmlHttpRequest={FreeRangeAppIFramePlugin:function(location){return function(host){var service={uploadFile:function(fileName,file,maxFileSize){return new Promise(function(resolve,reject){if(maxFileSize!==undefined){location=location.WithQueryString('maxFileSize',maxFileSize);}var fileToUpload=file.name?file:new File([file],fileName,{type:file.type});D2L.LP.Web.UI.Html.Files.FileUpload.XmlHttpRequest.UploadFiles([fileToUpload],{UploadLocation:location,OnFileComplete:function(uploadedFile){resolve(uploadedFile);},OnAbort:function(errorResponse){reject(errorResponse);},OnError:function(errorResponse){reject(errorResponse);},OnProgress:function(){}});});}};host.registerService('file-upload','0.1',service);};},UploadFiles:function(files,params){var me=D2L.LP.Web.UI.Html.Files.FileUpload.XmlHttpRequest;if(files===undefined||files.length==0){return;}var fileNumber=0;var fileCount=files.length;var fileUploadHandle;var handle={Abort:function(){if(fileUploadHandle!=null){fileUploadHandle.Abort();}}};var totalLoaded=0;var totalFileSize=0;for(var i=0;i<files.length;i++){totalFileSize+=files[i].size;}var onProgress=params.OnProgress;params.OnProgress=function(progress){if(onProgress==null){return;}progress=new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress(progress.GetFileName(),progress.GetFileSentBytes(),progress.GetFileSizeBytes(),totalLoaded+progress.GetFileSentBytes(),totalFileSize);onProgress.call(onProgress,progress);};var onFileComplete=params.OnFileComplete;params.OnFileComplete=function(file){totalLoaded+=files[fileNumber].size;onFileComplete.call(onFileComplete,file);fileUploadHandle=null;fileNumber+=1;if(fileNumber<fileCount){fileUploadHandle=me.UploadFile(files[fileNumber],params);}else{if(params.OnFilesComplete!=null){params.OnFilesComplete.call(params.OnFilesComplete);}}};onProgress.call(onProgress,new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress('',0,1,0,1));fileUploadHandle=me.UploadFile(files[fileNumber],params);return handle;},UploadFile:function(file,params){if(file===undefined){return;}var fileSize=file.size;var xhr;var handle={Abort:function(){if(this.IsUploading&&xhr!=null){xhr.abort();}},IsUploading:false};var bytesLoaded=0;var onProgress=function(evt){if(params.OnProgress==null){return;}if(evt.lengthComputable){var progress=new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress(file.name,bytesLoaded+evt.loaded,fileSize,bytesLoaded+evt.loaded,fileSize);params.OnProgress.call(params.OnProgress,progress);}};var sliceFunc;if(file.slice!==undefined){sliceFunc='slice';}else if(file.mozSlice!==undefined){sliceFunc='mozSlice';}else if(file.webkitSlice){sliceFunc='webkitSlice';}var bytesPerSlice=params.BytesPerSlice;if(sliceFunc===undefined||bytesPerSlice===undefined){bytesPerSlice=0;}var getEndByte=function(startByte){var endByte=startByte+bytesPerSlice;if(endByte<fileSize){return endByte;}else{return fileSize;}};var isLastSlice=false;var uploadSlice=function(startByte,streamId){var endByte=getEndByte(startByte);var slice;if(bytesPerSlice>0){slice=file[sliceFunc](startByte,endByte);if(endByte>=fileSize){isLastSlice=true;}}else{slice=file;isLastSlice=true;}var location=params.UploadLocation.WithQueryString('isLastSlice',isLastSlice);if(streamId!==undefined){location=location.WithQueryString('streamId',streamId);}location=location.GetUrl();var formData=new FormData();formData.append('fileName',file.name);formData.append('uploadFile',slice);formData.append(D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName(),D2L.LP.Web.Authentication.Xsrf.GetXsrfToken());xhr=new XMLHttpRequest();D2L.LP.Web.UI.Html.Dom.AddEventListener('progress',xhr.upload,onProgress);D2L.LP.Web.UI.Html.Dom.AddEventListener('load',xhr.upload,onProgress);xhr.onload=function(evt){if(xhr.status==200){bytesLoaded+=slice.size;var json=evt.target.responseText;var response=D2L.LP.Web.Serialization.Json.Deserialize(json);if(response.ResponseCode=='0'){if(response.File!==undefined){handle.IsUploading=false;params.OnFileComplete.call(params.OnFileComplete,response.File);}else{startByte=endByte;if(!isLastSlice){uploadSlice(startByte,response.StreamId);}}}else{handle.IsUploading=false;if(params.OnError!=null){params.OnError.call(params.OnError);}}}else{handle.IsUploading=false;if(params.OnError!=null){params.OnError.call(params.OnError);}}slice=null;};xhr.onerror=function(){handle.IsUploading=false;if(params.OnError!=null){params.OnError.call(params.OnError);}};xhr.onabort=function(){handle.IsUploading=false;if(params.OnAbort!=null){params.OnAbort.call(params.OnAbort);}};xhr.open("POST",location);xhr.send(formData);};handle.IsUploading=true;if(params.OnFileStarted!=null){params.OnFileStarted.call(params.OnFileStarted,file.name);}uploadSlice(0);return handle;}};D2L.LP.Web.UI.Html.Files.FileUpload.FileBrowse={};D2L.LP.Web.UI.Html.Files.FileUpload.FileBrowse.Default={Abort:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());if(node.d2l_fu_handles===undefined){return;}for(var i=0;i<node.d2l_fu_handles.length;i++){node.d2l_fu_handles[i].Abort();node.d2l_fu_handles.splice(0,1);}},Browse:function(openerId,settings){var me=D2L.LP.Web.UI.Html.Files.FileUpload.FileBrowse.Default;var inputNode=me.CreateInputNode(openerId,settings);me.ClickInputNode(inputNode);},CreateInputNode:function(openerId,settings){var me=D2L.LP.Web.UI.Html.Files.FileUpload.FileBrowse.Default;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());var inputNode=document.createElement('input');inputNode.className='d2l-fileinput-input';inputNode.type='file';if(settings.IsMultipleAllowed){inputNode.setAttribute('multiple','multiple');}var params={BytesPerSlice:settings.BytesPerSlice,ErrorMessages:settings.ErrorMessages,Extensions:settings.Extensions,RestrictedExtensions:settings.RestrictedExtensions,IsMultipleAllowed:settings.IsMultipleAllowed,IsStatusEnabled:settings.IsStatusEnabled,MaxFileSize:settings.MaxFileSize,MaxFileNameLength:settings.MaxFileNameLength,OnFilesStarted:function(){if(settings.OnFilesStarted!==null){settings.OnFilesStarted.call(settings.OnFilesStarted);}},OnProgress:function(progress){node.d2l_fu_progress=progress;if(settings.OnProgress!=null){settings.OnProgress.call(settings.OnProgress);}},OnFileComplete:function(file){node.d2l_fu_files.push(file);node.d2l_fu_files_queued+=1;if(settings.OnFileComplete!==null){settings.OnFileComplete.call(settings.OnFileComplete);}},OnFilesComplete:function(){if(settings.OnFilesComplete!==null){settings.OnFilesComplete.call(settings.OnFilesComplete);}},OnAbort:function(){if(settings.OnAbort!==null){settings.OnAbort.call(settings.OnAbort);}},OnError:function(errorNumber){node.d2l_fu_errorNumber=errorNumber;if(settings.OnError!==null){settings.OnError.call(settings.OnError);}}};D2L.LP.Web.UI.Html.Dom.AddEventListener('change',inputNode,function(){if(node.d2l_fu_files===undefined){node.d2l_fu_files=[];}if(node.d2l_fu_files_queued===undefined){node.d2l_fu_files_queued=0;}if(node.d2l_fu_handles===undefined){node.d2l_fu_handles=[];}node.d2l_fu_handles.push(D2L.LP.Web.UI.Html.Files.FileUpload.Upload(settings.UploadLocation,inputNode.files,params));});D2L.LP.Web.UI.Html.Dom.InsertElementAfter(inputNode,node);return inputNode;},ClickInputNode:function(inputNode){D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',inputNode,{'cancelable':false});},GetErrorNumber:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());var errorNumber=node.d2l_fu_errorNumber;return errorNumber;},GetFile:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());var files=node.d2l_fu_files;if(files.length===0||files.length<node.d2l_fu_files_queued){return;}var file=files[files.length-node.d2l_fu_files_queued];node.d2l_fu_files_queued-=1;return file;},GetFiles:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());if(node===null){return;}var files=node.d2l_fu_files;if(files.length===0||files.length<node.d2l_fu_files_queued){return;}var queuedFiles=[];var queuedIndex=files.length-node.d2l_fu_files_queued;for(var i=queuedIndex;i<files.length;i++){queuedFiles.push(files[i]);node.d2l_fu_files_queued-=1;}return queuedFiles;},GetProgress:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());var progress=node.d2l_fu_progress;return progress;}};D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop={};D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default={Abort:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.d2l_fd_handles===undefined){return;}for(var i=0;i<node.d2l_fd_handles.length;i++){node.d2l_fd_handles[i].Abort();}},GetVerticalDragPosition:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.m_verticalDragPosition){return node.m_verticalDragPosition;}else{return null;}},GetErrorNumber:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var errorNumber=node.d2l_fd_errorNumber;return errorNumber;},GetFile:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var files=node.d2l_fd_files;if(files.length===0||files.length<node.d2l_fd_files_queued){return;}var file=files[files.length-node.d2l_fd_files_queued];node.d2l_fd_files_queued-=1;return file;},GetFiles:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var files=node.d2l_fd_files;if(files.length===0||files.length<node.d2l_fd_files_queued){return;}var queuedFiles=[];var queuedIndex=files.length-node.d2l_fd_files_queued;for(var i=queuedIndex;i<files.length;i++){queuedFiles.push(files[i]);node.d2l_fd_files_queued-=1;}return queuedFiles;},GetProgress:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var progress=node.d2l_fd_progress;return progress;},IsMultipleAllowedByNode:function(node){return node.d2l_fd_isMultipleAllowed;},MakeFileDropNode:function(node){var me=D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default;var dropStatus=D2L.LP.Web.UI.Html.Files.FileUpload.Status;var bytesPerSlice=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'bytesPerSlice');var maxFileSize=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'maxFileSize');var maxFileNameLength=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'maxFileNameLength');var extensions=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'extensions');var uploadLocation=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'uploadLocation');var restrictedExtensions=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'x-extensions');var statusIndicator=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'statusIndicator');var isMultiple=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'isMultipleAllowed');var errorMessages=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'errorMessages');var onProgress=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onProgress');var onFileOver=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onFileOver');var onFileEnter=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onFileEnter');var onFileLeave=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onFileLeave');var fileOverCssClass=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'fileOverCssClass');var isStatusEnabled=statusIndicator==='auto';node.d2l_fd_isUploading=false;node.d2l_fd_files=[];node.d2l_fd_files_queued=0;node.d2l_fd_handles=[];me.SetIsEnabledByNode(node,true);me.SetIsMultipleAllowedByNode(node,isMultiple);var errorsNode;var progressNode;var progressFileNode;var progressFileNodes;var noopHandler=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(evt);D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);};var isFileDropValid=function(evt){if(node.d2l_fd_isAllowed&&!node.d2l_fd_isUploading&&evt.dataTransfer!=null&&evt.dataTransfer.types!=null){var dataTypes=evt.dataTransfer.types;for(var i=0;i<dataTypes.length;i++){if(dataTypes[i]=='application/x-moz-file-promise'){return false;}if(dataTypes[i]=='Files'){return true;}}}return false;};var dragEnterCount=0;var onDropFiles=function(evt){dragEnterCount=0;D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-filedrop-drag',node);if(fileOverCssClass){D2L.LP.Web.UI.Html.Dom.RemoveClassName(fileOverCssClass,node);}if(onFileLeave){onFileLeave.call(onFileLeave);}if(!isFileDropValid(evt)){return;}var files=evt.dataTransfer.files;if(files==null||files.length==0){return;}var resetUpload=function(){node.d2l_fd_isUploading=false;};var params={BytesPerSlice:bytesPerSlice,ErrorMessages:errorMessages,Extensions:extensions,RestrictedExtensions:restrictedExtensions,IsMultipleAllowed:isMultiple,IsStatusEnabled:isStatusEnabled,MaxFileSize:maxFileSize,MaxFileNameLength:maxFileNameLength,OnFilesStarted:function(){var onFilesStarted=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onFilesStarted');if(onFilesStarted!=null){onFilesStarted.call(onFilesStarted);}},OnProgress:function(progress){node.d2l_fd_progress=progress;if(onProgress!=null){onProgress.call(onProgress);}},OnFileComplete:function(file){node.d2l_fd_files.push(file);node.d2l_fd_files_queued+=1;var onFileComplete=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onFileComplete');if(onFileComplete!=null){onFileComplete.call(onFileComplete);}},OnFilesComplete:function(){var onFilesComplete=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onFilesComplete');if(onFilesComplete!=null){onFilesComplete.call(onFilesComplete);}resetUpload();},OnAbort:function(){var onAbort=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onAbort');if(onAbort!=null){onAbort.call(onAbort);}resetUpload();},OnError:function(errorNumber){resetUpload();node.d2l_fd_errorNumber=errorNumber;var onError=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onError');if(onError!=null){onError.call(onError);}}};node.d2l_fd_isUploading=true;node.d2l_fd_handles.push(D2L.LP.Web.UI.Html.Files.FileUpload.Upload(uploadLocation,files,params));};D2L.LP.Web.UI.Html.Dom.AddEventListener('dragenter',node,function(evt){dragEnterCount++;if(isFileDropValid(evt)){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-filedrop-drag',node);if(fileOverCssClass){D2L.LP.Web.UI.Html.Dom.AddClassName(fileOverCssClass,node);}if(onFileEnter){onFileEnter.call(onFileEnter);}}noopHandler(evt);});D2L.LP.Web.UI.Html.Dom.AddEventListener('dragleave',node,function(evt){node.m_rect=null;dragEnterCount--;if(evt.relatedTarget!=null){var relatedTarget=evt.relatedTarget;if(relatedTarget!=node){var tempNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-filedrop-drag',relatedTarget);if(tempNode==null||tempNode!=node){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-filedrop-drag',node);if(fileOverCssClass){D2L.LP.Web.UI.Html.Dom.RemoveClassName(fileOverCssClass,node);}if(onFileLeave){onFileLeave.call(onFileLeave);}noopHandler(evt);}}}else{if(dragEnterCount==0){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-filedrop-drag',node);if(fileOverCssClass){D2L.LP.Web.UI.Html.Dom.RemoveClassName(fileOverCssClass,node);}if(onFileLeave){onFileLeave.call(onFileLeave);}}}});var onDragOverHandler=function(evt){if(onFileOver){if(isFileDropValid(evt)){var cursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,evt);if(!node.m_rect){node.m_rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);}var topDelta=cursorPos.y-node.m_rect.top;node.m_verticalDragPosition=topDelta/node.m_rect.height;onFileOver.call(onFileOver);}}noopHandler(evt);};D2L.LP.Web.UI.Html.Dom.AddEventListener('dragover',node,onDragOverHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener('drop',node,function(evt){noopHandler(evt);onDropFiles(evt);node.m_rect=null;});},SetIsEnabled:function(id,isEnabled){var me=D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.SetIsEnabledByNode(node,isEnabled);},SetIsEnabledByNode:function(node,isAllowed){if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-filedrop',node)){return;}node.d2l_fd_isAllowed=isAllowed;if(isAllowed){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-filedrop-add',node);}else{D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-filedrop-add',node);}},SetIsMultipleAllowedByNode:function(node,isAllowed){node.d2l_fd_isMultipleAllowed=isAllowed;}};D2L.LP.Web.UI.Html.Ids={};D2L.LP.Web.UI.Html.AbsoluteHtmlId=D2L.Class.Create({Construct:function(value){if(value===undefined||value===null){value='';}this.m_value=value;},_deserialize:function(deserializer){this.m_value=deserializer.GetMember('Value');},_serialize:function(serializer){serializer.AddMember('Value',this.m_value);},GetValue:function(){return this.m_value;},$:function(){var node=document.getElementById(this.m_value);return $(node);}});D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create=function(id){return new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id);};D2L.LP.Web.UI.Html.Ids.Index=0;D2L.LP.Web.UI.Html.UniqueHtmlId=D2L.Class.Create({Construct:function(){D2L.LP.Web.UI.Html.Ids.Index++;this.m_value='d2l_c_'+D2L.LP.Web.UI.Html.Ids.Index+'_'+Math.floor(Math.random()*1000);},_deserialize:function(deserializer){this.m_value=deserializer.GetMember('Value');},_serialize:function(serializer){serializer.AddMember('Value',this.m_value);},GetValue:function(){return this.m_value;},$:function(){var node=document.getElementById(this.m_value);return $(node);}});D2L.LP.Web.UI.Html.JavaScript=D2L.LP.Web.UI.Html.JavaScript||{};D2L.LP.Web.UI.Html.JavaScript.CompareBoolean=function(type,left,right){if(type===0){return left!=right;}else{return left==right;}};D2L.LP.Web.UI.Html.JavaScript.CompareDateTime=function(type,left,right){left=D2L.LocalDateTime.ToJavaScriptDate(left).getTime();right=D2L.LocalDateTime.ToJavaScriptDate(right).getTime();return D2L.LP.Web.UI.Html.JavaScript.CompareNumber(type,left,right);};D2L.LP.Web.UI.Html.JavaScript.CompareNumber=function(type,left,right){if(type>0&&type<5){if(typeof left=='string'){left=parseFloat(left);}if(typeof right=='string'){right=parseFloat(right);}}if(type===0){return left==right;}else if(type==1){return left<right;}else if(type==2){return left>right;}else if(type==3){return left<=right;}else if(type==4){return left>=right;}else{return left!=right;}};D2L.LP.Web.UI.Html.JavaScript.CompareObjects=function(type,left,right){if(type===0){return left!==right;}else{return left===right;}};D2L.LP.Web.UI.Html.JavaScript.CompareString=function(type,haystack,needle){if(typeof haystack!='string'){throw'CompareString Error: Haystack expression is not a string.';}if(typeof needle!='string'){throw'CompareString Error: Needle expression is not a string.';}if(type===0){return haystack!=needle;}else if(type===1){return haystack==needle;}else if(type===2){return haystack.indexOf(needle)!==-1;}else if(type===3){return haystack.slice(0,needle.length)==needle;}else if(type===4){return haystack.slice(-needle.length)==needle;}};D2L.LP.Web.UI.Html.JavaScript.ElementWithIdExists=function(value){var element=D2L.LP.Web.UI.Html.Dom.GetElementById(value);return!!element;};D2L.LP.Web.UI.Html.JavaScript.ElementWithIdDoesNotExists=function(value){var found=D2L.LP.Web.UI.Html.JavaScript.ElementWithIdExists(value);return!found;};D2L.LP.Web.UI.Html.JavaScript.IsNull=function(value){var isNull=value===undefined||value===null;return isNull;};D2L.LP.Web.UI.Html.JavaScript.IsNotNull=function(value){var isNull=D2L.LP.Web.UI.Html.JavaScript.IsNull(value);return!isNull;};D2L.LP.Web.UI.Html.JavaScript.Console={Error:function(){if(!D2L.LP.Web.UI.Html.JavaScript.Console.IsEnabled()||window.console===undefined||window.console.error===undefined){return;}if(window.console.error.apply!==undefined){window.console.error.apply(window.console,arguments);}else{window.console.error(Array.prototype.slice.call(arguments));}},Info:function(){if(!D2L.LP.Web.UI.Html.JavaScript.Console.IsEnabled()||window.console===undefined||window.console.info===undefined){return;}if(window.console.info.apply!==undefined){window.console.info.apply(window.console,arguments);}else{window.console.info(Array.prototype.slice.call(arguments));}},Log:function(){if(!D2L.LP.Web.UI.Html.JavaScript.Console.IsEnabled()||window.console===undefined||window.console.log===undefined){return;}if(window.console.log.apply!==undefined){window.console.log.apply(window.console,arguments);}else{window.console.log(Array.prototype.slice.call(arguments));}},Warn:function(){if(!D2L.LP.Web.UI.Html.JavaScript.Console.IsEnabled()||window.console===undefined||window.console.warn===undefined){return;}if(window.console.warn.apply!==undefined){window.console.warn.apply(window.console,arguments);}else{window.console.warn(Array.prototype.slice.call(arguments));}},Debug:function(){if(!D2L.LP.Web.UI.Html.JavaScript.Console.IsEnabled()||window.console===undefined){return;}if(window.console.debug!==undefined){if(window.console.debug.apply!==undefined){window.console.debug.apply(window.console,arguments);}else{window.console.debug(Array.prototype.slice.call(arguments));}}else{D2L.LP.Web.UI.Html.JavaScript.Console.Info.apply(D2L.LP.Web.UI.Html.JavaScript.Console,arguments);}},IsEnabled:function(){return!!window.d2lConsoleEnabled;}};D2L.LP.Web.UI.Html.Dom=D2L.LP.Web.UI.Html.Dom||{};D2L.LP.Web.UI.Html.Dom.ClassDestructors={};D2L.LP.Web.UI.Html.Dom.AddClassDestructor=function(className,callback){if(D2L.LP.Web.UI.Html.Dom.ClassDestructors[className]===undefined){D2L.LP.Web.UI.Html.Dom.ClassDestructors[className]=[];}D2L.LP.Web.UI.Html.Dom.ClassDestructors[className].push(callback);};D2L.LP.Web.UI.Html.Dom.ClassInitializers={};D2L.LP.Web.UI.Html.Dom.AddClassInitializer=function(className,callback){if(D2L.LP.Web.UI.Html.Dom.ClassInitializers[className]===undefined){D2L.LP.Web.UI.Html.Dom.ClassInitializers[className]=[];}D2L.LP.Web.UI.Html.Dom.ClassInitializers[className].push(callback);};D2L.LP.Web.UI.Html.Dom.AddClassName=function(className,domNode){if(!className||!domNode||domNode.className===undefined){return;}$(domNode).addClass(className);};D2L.LP.Web.UI.Html.Dom.AddClassNameById=function(className,id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node!==null){D2L.LP.Web.UI.Html.Dom.AddClassName(className,node);}};D2L.LP.Web.UI.Html.Dom.AddEventListener=function(eventName,domNode,callback,useCapture){if(!domNode){return;}if(domNode.addEventListener){useCapture=useCapture||false;if(eventName.length>2&&eventName.substr(0,2)=='on'){eventName=eventName.substr(2);}domNode.addEventListener(eventName,callback,useCapture);}else if(domNode.attachEvent){if(eventName.substr(0,2)!='on'){eventName='on'+eventName;}domNode.attachEvent(eventName,callback);}};D2L.LP.Web.UI.Html.Dom.AddKeyDownEventListener=function(domNode,callback){var handleKeyDown=function(e){var args=new D2L.LP.Web.UI.Html.Dom.KeyDownEventArgs(e);return callback.call(callback,args);};D2L.LP.Web.UI.Html.Dom.AddEventListener('keydown',domNode,handleKeyDown);};D2L.LP.Web.UI.Html.Dom.KeyDownEventArgs=D2L.Class.extend({Construct:function(e){this.m_event=e;},GetKey:function(){return this.m_event.keyCode;},GetEventObject:function(){return this.m_event;}});D2L.LP.Web.UI.Html.Dom.KeyDownEventArgs.Key={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Escape:27,End:35,Home:36,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Delete:46};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener=function(domNode,callback){var handleKeyPress=function(e){var args=new D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs(e);if(args.IsCtrl()){D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.IsControlPressed=true;}var result=callback.call(callback,args);return result;};var handleKeyUp=function(e){var args=new D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs(e);if(args.IsCtrl()){D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.IsControlPressed=false;}};D2L.LP.Web.UI.Html.Dom.AddEventListener('keydown',domNode,handleKeyPress);D2L.LP.Web.UI.Html.Dom.AddEventListener('keyup',domNode,handleKeyUp);};D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs=D2L.Class.extend({Construct:function(e){this.m_event=e;},GetKey:function(){return this.m_event.keyCode;},GetEventObject:function(){return this.m_event;},GetTarget:function(){return D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(this.m_event);},IsCtrl:function(){return this.m_event.keyCode==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Control;}});D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Escape:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Delete:46};D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.IsControlPressed=false;D2L.LP.Web.UI.Html.Dom.AddKeyUpEventListener=function(domNode,callback){var handleKeyUp=function(e){var args=new D2L.LP.Web.UI.Html.Dom.KeyUpEventArgs(e);return callback.call(callback,args);};D2L.LP.Web.UI.Html.Dom.AddEventListener('keyup',domNode,handleKeyUp);};D2L.LP.Web.UI.Html.Dom.KeyUpEventArgs=D2L.Class.extend({Construct:function(e){this.m_event=e;},GetKey:function(){return this.m_event.keyCode;},GetEventObject:function(){return this.m_event;}});D2L.LP.Web.UI.Html.Dom.KeyUpEventArgs.Key={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Escape:27,End:35,Home:36,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Delete:46};D2L.LP.Web.UI.Html.Dom.AddRemoveClassName=function(className,domNode,doAdd){if(doAdd){D2L.LP.Web.UI.Html.Dom.AddClassName(className,domNode);}else{D2L.LP.Web.UI.Html.Dom.RemoveClassName(className,domNode);}};D2L.LP.Web.UI.Html.Dom.ApplyClassFunctions=function(classFunctions,node){for(var className in classFunctions){var elems=Array.prototype.slice.call(node.querySelectorAll('.'+className));if(node.classList&&node.classList.contains(className)){elems.push(node);}for(var i=0;i<elems.length;i++){for(var j=0;j<classFunctions[className].length;j++){classFunctions[className][j].call(classFunctions[className][j],elems[i]);}}}};D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour=function(e){if(e.preventDefault!==undefined){e.preventDefault();}else{e.returnValue=false;}};D2L.LP.Web.UI.Html.Dom.CancelEventBubble=function(e){if(e.stopPropagation!==undefined){e.stopPropagation();}else if(e.cancelBubble!==undefined){e.cancelBubble=true;}};D2L.LP.Web.UI.Html.Dom.DispatchEvent=function(eventName,node,options){if(document.createEvent){if(!options){options={'cancelable':true};}else{if(options.cancelable===undefined){options.cancelable=true;}}var evt;if(eventName=='click'){evt=document.createEvent('MouseEvents');evt.initMouseEvent('click',true,options.cancelable,window,0,0,0,0,0,false,false,false,false,0,null);}else{evt=document.createEvent('HTMLEvents');evt.initEvent(eventName,true,options.cancelable);}return!node.dispatchEvent(evt);}else if(node.fireEvent){return node.fireEvent('on'+eventName);}return false;};D2L.LP.Web.UI.Html.Dom.ElementExists=function(id){var elementId=id;if(elementId.GetValue){elementId=elementId.GetValue();}return $('#'+elementId).length;};D2L.LP.Web.UI.Html.Dom.Focus=function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.FocusNode(node);};D2L.LP.Web.UI.Html.Dom.FocusNode=function(node){if(!node||node.focus==undefined){return;}try{node.focus();}catch(e){}};D2L.LP.Web.UI.Html.Dom.FocusCycle={Init:function(firstElem,lastElem){if(!firstElem||!firstElem.parentNode||!lastElem||!lastElem.parentNode){return null;}var doc=firstElem.ownerDocument;var startTrap=doc.createElement('span');startTrap.tabIndex=-1;startTrap.className='d2l-offscreen';D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',startTrap,function(){if(handle.endFocusElem!==null){handle.endFocusElem.focus();}});firstElem.parentNode.insertBefore(startTrap,firstElem);var endTrap=doc.createElement('span');endTrap.tabIndex=-1;endTrap.className='d2l-offscreen';D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',endTrap,function(){if(handle.startFocusElem!==null){handle.startFocusElem.focus();}});if(lastElem.nextSibling){lastElem.parentNode.insertBefore(endTrap,lastElem.nextSibling);}else{lastElem.parentNode.appendChild(endTrap);}var nextFocusableElem=D2L.LP.Web.UI.Html.Dom.GetNextFocusableElement(firstElem,true);var prevFocusableElem=D2L.LP.Web.UI.Html.Dom.GetPreviousFocusableElement(lastElem,true);var handle={startFocusElem:nextFocusableElem,startTrap:startTrap,endFocusElem:prevFocusableElem,endTrap:endTrap};return handle;},SetIsEnabled:function(handle,isEnabled){handle.startTrap.tabIndex=isEnabled?0:-1;handle.endTrap.tabIndex=isEnabled?0:-1;}};D2L.LP.Web.UI.Html.Dom.GetActiveElement=function(doc){if(doc===null||doc===undefined){var activeElement=null;try{activeElement=document.activeElement;}catch(e){}return activeElement;}else{return doc.activeElement;}};D2L.LP.Web.UI.Html.Dom.GetAncestorElementsByClassName=function(className,elem){if(elem===undefined||elem===null||className===undefined||className===null){return null;}var result=[];var parentElem=elem.parentNode;className=className.replace(/\-/g,'\\-');var oRegExp=new RegExp('(^|\\s)'+className+'(\\s|$)');while(parentElem!==null){if(oRegExp.test(parentElem.className)){result.push(parentElem);}parentElem=parentElem.parentNode;}return result;};D2L.LP.Web.UI.Html.Dom.GetAttribute=function(node,attrName){return node.getAttribute(attrName);};D2L.LP.Web.UI.Html.Dom.GetElementsByClassName=function(className,elem){var elems;if(elem===undefined||elem===null||elem===document){elems=$('.'+className);}else{elems=$(elem).find('.'+className);}return $.makeArray(elems);};D2L.LP.Web.UI.Html.Dom.GetElementsByName=function(name,elem){if(elem===undefined){elem=document;}var ret=[];var inputs=elem.getElementsByTagName('input');for(var i=0;i<inputs.length;i++){if(inputs[i].name!==undefined&&inputs[i].name==name){ret.push(inputs[i]);}}return ret;};D2L.LP.Web.UI.Html.Dom.GetElementById=function(id,doc){if(id===undefined||id===null||id===''){return null;}if(id.GetValue!==undefined){id=id.GetValue();}doc=doc||document;var elem=null;if(doc['__shady_native_getElementById']!==undefined){elem=doc.__shady_native_getElementById(id);}if(elem===null){elem=doc.getElementById(id);}if(elem!==null&&elem.id!=id){if(doc.all){var possibleNodes=doc.all[id];for(var i=0;i<possibleNodes.length;i++){if(possibleNodes[i].id==id){return possibleNodes[i];}}return null;}else{return null;}}else{return elem;}};D2L.LP.Web.UI.Html.Dom.GetEventTargetElement=function(e){return e.srcElement||e.target;};D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName=function(className,elem){for(var i=0;i<elem.childNodes.length;i++){var childNode=elem.childNodes[i];if(D2L.LP.Web.UI.Html.Dom.HasClassName(className,childNode)){return childNode;}}return null;};D2L.LP.Web.UI.Html.Dom.GetImmediateChildElementsByClassName=function(className,elem){var childNodes=new Array();for(var i=0;i<elem.childNodes.length;i++){var childNode=elem.childNodes[i];if(D2L.LP.Web.UI.Html.Dom.HasClassName(className,childNode)){childNodes.push(childNode);}}return childNodes;};D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName=function(className,elem){if(elem===undefined||elem===null){elem=document;}if(elem.getElementsByClassName!==undefined||elem.querySelectorAll!==undefined){var nodes;if(elem.getElementsByClassName!==undefined){nodes=elem.getElementsByClassName(className);}else{nodes=elem.querySelectorAll('.'+className);}if(nodes.length>0){return nodes[0];}return null;}var allElems=elem.all?elem.all:elem.getElementsByTagName('*');var elems=[];className=className.replace(/\-/g,'\\-');var oRegExp=new RegExp('(^|\\s)'+className+'(\\s|$)');for(var i=0;i<allElems.length;i++){if(oRegExp.test(allElems[i].className)){return allElems[i];}}return null;};D2L.LP.Web.UI.Html.Dom.GetFirstElementChild=function(elem){if(elem.firstElementChild!==undefined){return elem.firstElementChild;}var childrenCount=elem.childNodes.length;for(var i=0;i<childrenCount;i++){if(elem.childNodes[i].nodeType==1){return elem.childNodes[i];}}return null;};D2L.LP.Web.UI.Html.Dom.GetBoundingRect=function(elem,baseOnDocumentCoordinates){if(baseOnDocumentCoordinates===undefined){baseOnDocumentCoordinates=true;}var offsetParent=elem.offsetParent,doc=elem.ownerDocument,docElem=doc.documentElement,body=doc.body,top=elem.offsetTop,left=elem.offsetLeft;var width=elem.offsetWidth;var height=elem.offsetHeight;var positionedOffsetParent;if(!baseOnDocumentCoordinates){positionedOffsetParent=D2L.LP.Web.UI.Html.Dom.GetPositionedOffsetParent(elem);}while((elem=elem.parentNode)&&elem!==body&&elem!==docElem){if(!baseOnDocumentCoordinates&&elem===positionedOffsetParent){break;}top-=elem.scrollTop;left-=elem.scrollLeft;if(elem===offsetParent){top+=elem.offsetTop;left+=elem.offsetLeft;offsetParent=elem.offsetParent;}}return{top:top,right:left+width,bottom:top+height,left:left,width:width,height:height};};D2L.LP.Web.UI.Html.Dom.GetLastElementChild=function(elem){if(elem.lastElementChild!==undefined){return elem.lastElementChild;}var childrenCount=elem.childNodes.length;for(var i=childrenCount-1;i>=0;i--){if(elem.childNodes[i].nodeType==1){return elem.childNodes[i];}}return null;};D2L.LP.Web.UI.Html.Dom.GetMousePosition=function(win,evt){var pos={x:0,y:0};if(evt.targetTouches&&evt.targetTouches[0]){pos.x=evt.targetTouches[0].pageX;pos.y=evt.targetTouches[0].pageY;}else if(evt.changedTouches&&evt.changedTouches[0]){pos.x=evt.changedTouches[0].pageX;pos.y=evt.changedTouches[0].pageY;}else if(win.event){pos.x=win.event.clientX+win.document.documentElement.scrollLeft+win.document.body.scrollLeft;pos.y=win.event.clientY+win.document.documentElement.scrollTop+win.document.body.scrollTop;}else{pos.x=evt.clientX+win.scrollX;pos.y=evt.clientY+win.scrollY;}return pos;};D2L.LP.Web.UI.Html.Dom.GetNextElementSibling=function(elem){if(elem.nextElementSibling!==undefined){return elem.nextElementSibling;}var sibling=elem.nextSibling;while(sibling!==null){if(sibling.nodeType==1){return sibling;}sibling=sibling.nextSibling;}return null;};D2L.LP.Web.UI.Html.Dom.GetNextFocusableElement=function(domNode,includeHidden){if(domNode===undefined||domNode===null){return null;}if(includeHidden===undefined){includeHidden=false;}var checkDecendents=function(node){var children=node.childNodes;for(var i=0;i<children.length;i++){var isFocusable=D2L.LP.Web.UI.Html.Dom.IsFocusable(children[i],includeHidden);if(isFocusable){return children[i];}var childResult=checkDecendents(children[i]);if(childResult){return childResult;}}return null;};var recursiveFunc=function(node,skipFocusCheck,ignoreChildren){if(!skipFocusCheck&&D2L.LP.Web.UI.Html.Dom.IsFocusable(node,includeHidden)){return node;}if(!ignoreChildren){var childResult=checkDecendents(node);if(childResult){return childResult;}}var nextSibling=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);if(nextSibling){var siblingResult=recursiveFunc(nextSibling,false,false);if(siblingResult){return siblingResult;}return null;}var parent=null;if(node.parentNode){parent=node.parentNode;}else{var win=null;if(node.defaultView){win=node.defaultView;}else if(node.parentWindow){win=node.parentWindow;}if(win!=null&&win.D2L){if(win.frameElement){if(win.frameElement.parentNode){parent=win.frameElement.parentNode;}}}}if(!parent){return null;}var nextSiblingOfParent=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(parent);if(nextSiblingOfParent){var r=recursiveFunc(nextSiblingOfParent,false,false);if(r){return r;}}return null;};var result=recursiveFunc(domNode,true,false);return result;};D2L.LP.Web.UI.Html.Dom.GetPageSize=function(w){var ret={width:0,height:0};var doc=undefined;try{doc=w.document;}catch(e){}if(doc===undefined){return ret;}var dh=0;var dw=0;var sh=0;var sw=0;var oh=0;var ow=0;var dbH=0;var dbW=0;if(doc.height!==undefined){dh=doc.height;dw=doc.width;}if(doc.body!==undefined&&doc.body!==null){if(doc.body.scrollHeight!==undefined)sh=doc.body.scrollHeight;if(doc.body.scrollWidth!==undefined)sw=doc.body.scrollWidth;if(doc.body.offsetHeight!==undefined)oh=doc.body.offsetHeight;if(doc.body.offsetWidth!==undefined)ow=doc.body.offsetWidth;if(doc.documentElement.scrollHeight!==undefined)dbH=doc.documentElement.scrollHeight;if(doc.documentElement.scrollWidth!==undefined)dbW=doc.documentElement.scrollWidth;}ret.height=Math.min(dbH,Math.max(Math.max(dh,sh),oh));ret.width=Math.min(dbW,Math.max(Math.max(dw,sw),ow));return ret;};D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName=function(className,elem){if(elem===undefined||elem===null||className===undefined||className===null){return null;}var parentElem;try{parentElem=elem.parentNode;}catch(e){return null;}className=className.replace(/\-/g,'\\-');var oRegExp=new RegExp('(^|\\s)'+className+'(\\s|$)');while(parentElem!==undefined&&parentElem!==null){if(oRegExp.test(parentElem.className)){return parentElem;}parentElem=parentElem.parentNode;}return null;};D2L.LP.Web.UI.Html.Dom.GetParentElementsByClassName=function(className,elem){if(elem===undefined||elem===null||className===undefined||className===null){return null;}var parentElems=new Array();var parentElem;try{parentElem=elem.parentNode;}catch(e){return null;}className=className.replace(/\-/g,'\\-');var oRegExp=new RegExp('(^|\\s)'+className+'(\\s|$)');while(parentElem!==null){if(oRegExp.test(parentElem.className)){parentElems.push(parentElem);}parentElem=parentElem.parentNode;}return parentElems;};D2L.LP.Web.UI.Html.Dom.GetPositionedOffsetParent=function(elem){var offsetParent=elem.offsetParent||document.body;while(offsetParent&&D2L.LP.Web.UI.Html.Css.GetStyle(offsetParent,"position")==="static"&&offsetParent!==document.body&&offsetParent!==document.documentElement){offsetParent=offsetParent.offsetParent;}return offsetParent;};D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling=function(elem){if(elem===undefined||elem===null){return null;}if(elem.previousElementSibling!==undefined){return elem.previousElementSibling;}var sibling=elem.previousSibling;while(sibling!==null){if(sibling.nodeType==1){return sibling;}sibling=sibling.previousSibling;}return null;};D2L.LP.Web.UI.Html.Dom.GetPreviousFocusableElement=function(domNode,includeHidden){if(domNode===undefined||domNode===null){return null;}if(includeHidden===undefined){includeHidden=false;}var checkDecendents=function(node){var children=node.childNodes;for(var i=children.length-1;i>=0;i--){var childResult=checkDecendents(children[i]);if(childResult){return childResult;}var isFocusable=D2L.LP.Web.UI.Html.Dom.IsFocusable(children[i],includeHidden);if(isFocusable){return children[i];}}return null;};var recursiveFunc=function(node,skipFocusCheck,ignoreChildren){if(!skipFocusCheck&&D2L.LP.Web.UI.Html.Dom.IsFocusable(node,includeHidden)){return node;}if(!ignoreChildren){var childResult=checkDecendents(node);if(childResult){return childResult;}}var prevSibling=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);if(prevSibling){var siblingResult=recursiveFunc(prevSibling,false,false);if(siblingResult){return siblingResult;}return null;}var parent=null;if(node.parentNode){parent=node.parentNode;}else{var win=null;if(node.defaultView){win=node.defaultView;}else if(node.parentWindow){win=node.parentWindow;}if(win!=null&&win.D2L){if(win.frameElement){if(win.frameElement.parentNode){parent=win.frameElement.parentNode;}}}}if(!parent){return null;}var prevSiblingOfParent=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(parent);if(prevSiblingOfParent){var r=recursiveFunc(prevSiblingOfParent,false,false);if(r){return r;}}return null;};var result=recursiveFunc(domNode,true,true);return result;};D2L.LP.Web.UI.Html.Dom.GetScrollPosition=function(w){w=w||window;var ret={top:0,left:0};if(w.pageYOffset!==undefined){ret.top=w.pageYOffset;ret.left=w.pageXOffset;}else if(w.document.documentElement!==undefined&&w.document.documentElement.scrollTop!==undefined){ret.top=w.document.documentElement.scrollTop;ret.left=w.document.documentElement.scrollLeft;}else if(w.document.body!==undefined){ret.top=w.document.body.scrollTop;ret.left=w.document.body.scrollLeft;}return ret;};D2L.LP.Web.UI.Html.Dom.GetTextContent=function(node){if(node==null){return null;}if(node.textContent!==undefined){return node.textContent;}else if(node.innerText!==undefined){return node.innerText;}else{return null;}};D2L.LP.Web.UI.Html.Dom.GetViewportSize=function(w){w=w||window;var ret={width:0,height:0};if(w.innerWidth!==undefined){ret.width=w.innerWidth;ret.height=w.innerHeight;}else if(w.document.documentElement&&w.document.documentElement.clientWidth){ret.width=w.document.documentElement.clientWidth;ret.height=w.document.documentElement.clientHeight;}else if(w.document.body){ret.width=w.document.body.clientWidth;ret.height=w.document.body.clientHeight;}return ret;};D2L.LP.Web.UI.Html.Dom.HasAnyClassName=function(classNames,domNode){if(!classNames||!domNode||domNode.className===undefined){return false;}for(var i=0;i<classNames.length;i++){var hasClass=$(domNode).hasClass(classNames[i]);if(hasClass){return true;}}return false;};D2L.LP.Web.UI.Html.Dom.HasAttribute=function(node,attrName){if(node.hasAttribute!==undefined){return node.hasAttribute(attrName);}else{var val=node.getAttribute(attrName);return val!==null&&val.length>0;}};D2L.LP.Web.UI.Html.Dom.HasClassName=function(className,domNode){if(!className||!domNode||domNode.className===undefined){return false;}var hasClass=$(domNode).hasClass(className);return hasClass;};D2L.LP.Web.UI.Html.Dom.HasFocus=function(elem){if(!elem){return false;}return D2L.LP.Web.UI.Html.Dom.GetActiveElement()===elem;};D2L.LP.Web.UI.Html.Dom.HasSafeParent=function(win){try{var throwsIfXDomain=win.parent.document;return true;}catch(xdomainErr){return false;}};D2L.LP.Web.UI.Html.Dom.IndexOf=function(source,searchValue,from){from=from||0;if(source.indexOf!==undefined){return source.indexOf(searchValue,from);}if(!D2L.LP.Web.UI.Html.JavaScript.IsArray(source)){return;}if(from>=source.length){return-1;}for(;from<source.length;from++){if(source[from]===searchValue){return from;}}return-1;};D2L.LP.Web.UI.Html.Dom.IndexOfElement=function(elem){var i=0;var e=elem;while(e=e.previousSibling){if(e.nodeType==1){i++;}}return i;};D2L.LP.Web.UI.Html.Dom.InsertElementAfter=function(elem,insertAfterElem){var nextElement=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(insertAfterElem);var parent=insertAfterElem.parentNode;if(nextElement===elem){return;}if(nextElement!=null){parent.insertBefore(elem,nextElement);}else{parent.appendChild(elem);}};D2L.LP.Web.UI.Html.Dom.IsAncestor=function(ancestorNode,node){var cur=node;while(cur){if(cur===ancestorNode){return true;}cur=cur.parentNode;}return false;};D2L.LP.Web.UI.Html.Dom.FocusableElements={a:true,body:true,button:true,frame:true,iframe:true,img:true,input:true,isindex:true,object:true,select:true,textarea:true};D2L.LP.Web.UI.Html.Dom.IsFocusable=function(node,includeHidden){if(node===undefined||node===null||node.disabled){return false;}if(!includeHidden){var isVisible=D2L.LP.Web.UI.Html.Dom.IsVisible(node);if(!isVisible){return false;}}return node.tabIndex>=0;};D2L.LP.Web.UI.Html.Dom.IsVisible=function(domNode){if(domNode===undefined||domNode===null){return false;}var isVisible=function(node){if(node.style===undefined){return true;}if(node.style.visibility&&node.style.visibility!='visible'&&node.style.visibility!='inherit'){return false;}if(node.style.display&&node.style.display=='none'){return false;}if(D2L.LP.Web.UI.Html.Css.GetStyle(node,"visibility")!='visible'&&D2L.LP.Web.UI.Html.Css.GetStyle(node,"visibility")!='inherit'){return false;}if(D2L.LP.Web.UI.Html.Css.GetStyle(node,'display')=='none'){return false;}return true;};var visible=isVisible(domNode);if(visible){var _parentNode=domNode.parentNode;while(_parentNode!=null){var doc=null;var win=null;if(_parentNode.nodeName.toLowerCase()=='document'){doc=_parentNode;}else{if(_parentNode.ownerDocument){doc=_parentNode.ownerDocument;}}if(doc!=null){win=doc.defaultView?doc.defaultView:doc.parentWindow;}if(win!=null&&win.D2L){visible=isVisible(_parentNode);if(visible){_parentNode=_parentNode.parentNode;}else{break;}}else{break;}}}return visible;};D2L.LP.Web.UI.Html.Dom.IsVisibleInContainer=function(elem,container){if(!container){container=window;}var $container=$(container);var containerTop=$container.scrollTop();var containerBottom=containerTop+$container.height();var elemOffsetTop=$(elem).offset().top;return elemOffsetTop>=containerTop&&elemOffsetTop<=containerBottom;};D2L.LP.Web.UI.Html.Dom.Navigate=function(location,formId){if(formId!==undefined&&formId!==null){D2L.LP.Web.UI.Desktop.Controls.Form.StopChangeTracking(formId);}window.location.assign(location.GetUrl());};D2L.LP.Web.UI.Html.Dom.OpenWindow=function(windowName,location,width,height,hasMenubar,hasToolbar,callback,noopener){if(hasMenubar===undefined){hasMenubar=false;}if(hasToolbar===undefined){hasToolbar=false;}windowName=windowName.replace(/[^a-zA-Z0-9]+/g,'_');var features="";if(noopener){features+='noopener,';}if(width>0){features+='width='+width+",";}if(height>0){features+='height='+height+",";}features+='location=1,'+'menubar='+(hasMenubar?'1':'0')+','+'resizable=1,'+'status=1,'+'scrollbars=1,'+'toolbar='+(hasToolbar?'1':'0');var w=window.open(location.GetUrl(),windowName,features);if(w){w.focus();}if(callback){callback.apply(callback);}};D2L.LP.Web.UI.Html.Dom.OverlayElement=function(elem,targetElem,insertAfterElem,position,verticalOffset,horizontalOffset,isAutoPosition,isAutoScroll,attachToBody){if(attachToBody===undefined){attachToBody=false;}if(isAutoPosition===undefined){isAutoPosition=true;}if(isAutoScroll===undefined){isAutoScroll=false;}if(insertAfterElem===undefined){insertAfterElem=targetElem;}if(position===undefined){position=D2L.LP.Web.UI.Html.Style.OverlayPosition.Mouse;}if(verticalOffset===undefined){verticalOffset=0;}if(horizontalOffset===undefined){horizontalOffset=0;}var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;if(isRTL){var RTLposition=position;if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Left){RTLposition=D2L.LP.Web.UI.Html.Style.OverlayPosition.Right;}else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Right){RTLposition=D2L.LP.Web.UI.Html.Style.OverlayPosition.Left;}position=RTLposition;horizontalOffset=-horizontalOffset;}if(attachToBody){insertAfterElem=document.body.lastChild;}D2L.LP.Web.UI.Html.Dom.InsertElementAfter(elem,insertAfterElem);elem.style.left='';elem.style.right='';elem.style.top='';elem.style.bottom='';var targetRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(targetElem,attachToBody);var elemRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(elem,attachToBody);var viewPortSize=D2L.LP.Web.UI.Html.Dom.GetViewportSize();var left;var top;if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Mouse){var clickPos=D2L.LP.Web.UI.Events.m_lastMouseDownPosition;var scrollPos=D2L.LP.Web.UI.Html.Dom.GetScrollPosition();left=clickPos.x-scrollPos.left;top=clickPos.y-scrollPos.top;elem.style.position='fixed';}else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Top){left=targetRect.left;top=targetRect.top-elemRect.height;}else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Right){left=targetRect.left+targetRect.width;top=targetRect.top;}else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Bottom){left=targetRect.left+(isRTL?targetRect.width:0);top=targetRect.top+targetRect.height;}else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Left){left=targetRect.left;top=targetRect.top;}else{throw'Invalid Overlay Position';}left+=horizontalOffset;top+=verticalOffset;if(isRTL&&position!=D2L.LP.Web.UI.Html.Style.OverlayPosition.Mouse){left=left-elemRect.width;}elem.style.left=left+'px';elem.style.top=top+'px';if(isAutoPosition||isAutoScroll){var offsetParent=D2L.LP.Web.UI.Html.Dom.GetPositionedOffsetParent(elem);var offsetParentRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(offsetParent);var elemNewRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(elem);var body=document.body;if(offsetParent==body){offsetParentRect.bottom=viewPortSize.height;elemNewRect.bottom-=document.documentElement.scrollTop;offsetParentRect.top=0;elemNewRect.top-=document.documentElement.scrollTop;}var rightDelta=offsetParentRect.right-elemNewRect.right;var leftDelta=elemNewRect.left-offsetParentRect.left;var topDelta=elemNewRect.top-offsetParentRect.top;var bottomDelta=offsetParentRect.bottom-elemNewRect.bottom;if(isRTL){leftDelta=elemNewRect.left;rightDelta=elemNewRect.right;}var flipX;if(isAutoPosition){if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Mouse){if(left+elemRect.width>viewPortSize.width){left=left-elemRect.width;}if(top+elemRect.height>viewPortSize.height){top=top-elemRect.height;}}else{if(!isRTL&&rightDelta<0&&leftDelta>=0){left=targetRect.left-(isRTL?0:elemRect.width);}if(isRTL&&leftDelta<0&&rightDelta>=0){left=targetRect.left-(isRTL?0:elemRect.width);}if(bottomDelta<0&&topDelta>=0){flipX=true;top=targetRect.top-elemRect.height-verticalOffset;}}if(left>=0){elem.style.left=left+'px';}D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-overlay-flip-x',elem);if(top>=0){if(flipX){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-overlay-flip-x',elem);}elem.style.top=top+'px';}}if(isAutoScroll){var scroll=false;var xScrollBy=0;var yScrollBy=0;if(rightDelta<0){xScrollBy=Math.abs(rightDelta)+10;scroll=true;}if(leftDelta<0){xScrollBy=leftDelta-10;scroll=true;}if(bottomDelta<0){yScrollBy=Math.abs(bottomDelta)+10;scroll=true;}if(topDelta<0){yScrollBy=topDelta-10;scroll=true;}if(scroll){scrollBy(xScrollBy,yScrollBy);}}}};D2L.LP.Web.UI.Html.Dom.RemoveAttribute=function(node,attrName){node.removeAttribute(attrName);};D2L.LP.Web.UI.Html.Dom.RemoveChildElements=function(domNode){if(domNode){domNode.innerHTML='';}};D2L.LP.Web.UI.Html.Dom.RemoveClassName=function(className,domNode){if(!className||!domNode||domNode.className===undefined){return;}$(domNode).removeClass(className);};D2L.LP.Web.UI.Html.Dom.RemoveClassNameById=function(className,id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node!==null){D2L.LP.Web.UI.Html.Dom.RemoveClassName(className,node);}};D2L.LP.Web.UI.Html.Dom.RemoveElement=function(elem){if(elem&&elem.parentNode){elem.parentNode.removeChild(elem);}};D2L.LP.Web.UI.Html.Dom.RemoveElementById=function(id){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.RemoveElement(elem);};D2L.LP.Web.UI.Html.Dom.RemoveEventListener=function(eventName,domNode,callback,useCapture){if(domNode.removeEventListener){useCapture=useCapture||false;if(eventName.length>2&&eventName.substr(0,2)=='on'){eventName=eventName.substr(2);}domNode.removeEventListener(eventName,callback,useCapture);}else if(domNode.detachEvent){if(eventName.substr(0,2)!='on'){eventName='on'+eventName;}domNode.detachEvent(eventName,callback);}};D2L.LP.Web.UI.Html.Dom.ScrollToElement=function(elem,delay,toMiddleOfView,animate){var evt=new D2L.LP.Web.UI.Events.Event();if(delay===undefined){delay=300;}var animationSpeed=500;var animationEasing='easeOutCirc';var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(elem);var top=rect.top;if(toMiddleOfView){var viewPort=D2L.LP.Web.UI.Html.Dom.GetViewportSize();top-=viewPort.height/2;}var minibar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-minibar-placeholder-fixed');if(minibar){var minibarHeight=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(minibar).height;var minibarOffset=3;top-=minibarHeight+minibarOffset;}if(top<0){top=0;}var animate=function(jqNode){jqNode.animate({scrollTop:top},animationSpeed,animationEasing,function(){evt.Trigger();});};setTimeout(function(){var dialogBody=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-dialog-body');if(dialogBody){if(animate){animate($(dialogBody));}else{dialogBody.scrollTop=top;evt.Trigger();}}else{if(animate){animate($('html, body'));}else{window.scrollTo(0,top);evt.Trigger();}}},delay);return evt;};D2L.LP.Web.UI.Html.Dom.ScrollToPosition=function(top){var evt=new D2L.LP.Web.UI.Events.Event();if(document.body.scrollTop===top){return evt;}setTimeout(function(){$('html, body').animate({scrollTop:top},500,'easeOutCirc',function(){evt.Trigger();});},300);return evt;};D2L.LP.Web.UI.Html.Dom.ScrollToElementById=function(id,delay,toMiddleOfView,animate){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!elem){return;}return D2L.LP.Web.UI.Html.Dom.ScrollToElement(elem,delay,toMiddleOfView,animate);};D2L.LP.Web.UI.Html.Dom.ScrollToElementPosition=function(id){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!elem){return;}var rect=elem.getBoundingClientRect();var top=rect.top+(document.documentElement.scrollTop||document.body.scrollTop);if(top<0){top=0;}setTimeout(function(){D2L.LP.Web.UI.Html.Dom.ScrollToPosition(top);},1);return true;};D2L.LP.Web.UI.Html.Dom.SetAttribute=function(node,attrName,attrValue){node.setAttribute(attrName,attrValue);};D2L.LP.Web.UI.Html.Dom.SetIsDisplayed=function(id,isDisplayed){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node){D2L.LP.Web.UI.Html.JavaScript.Console.Warn('SetIsDisplayed Error. Node does not exist: \''+id.GetValue()+'\'.');return;}D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,isDisplayed);};D2L.LP.Web.UI.Html.Dom.SetIsDisplayedMultiple=function(ids,isDisplayed){for(var i=0;i<ids.length;i++){D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(ids[i],isDisplayed);}};D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode=function(node,isDisplayed){if(isDisplayed){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',node);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',node);}D2L.LP.Web.UI.Events.OnVisibilityChange.Trigger(node,isDisplayed);};D2L.LP.Web.UI.Html.Dom.SetIsEnabled=function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node){return;}D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode(node,isEnabled);};D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode=function(node,isEnabled){if(node.disabled!==undefined){node.disabled=!isEnabled;}};D2L.LP.Web.UI.Html.Dom.Storage={m_isSupported:undefined,IsSupported:function(){var me=D2L.LP.Web.UI.Html.Dom.Storage;if(me.m_isSupported!==undefined){return me.m_isSupported;}if(!window.localStorage){me.m_isSupported=false;return false;}try{window.localStorage.setItem('test','');window.localStorage.removeItem('test');}catch(e){return false;}return true;},Repo:{},Common:{Get:function(storage,key){var me=D2L.LP.Web.UI.Html.Dom.Storage;var val;if(me.IsSupported()){val=storage.getItem(key);}else{val=D2L.LP.Web.UI.Html.Dom.Storage.Repo[key];}if(val===undefined){val=null;}return val;},Remove:function(storage,key,triggerLocalEvent){if(triggerLocalEvent===undefined){triggerLocalEvent=true;}var me=D2L.LP.Web.UI.Html.Dom.Storage;var oldValue=D2L.LP.Web.UI.Html.Dom.Storage.Common.Get(storage,key);if(me.IsSupported()){storage.removeItem(key);}else{D2L.LP.Web.UI.Html.Dom.Storage.Repo[key]=null;}var newValue=D2L.LP.Web.UI.Html.Dom.Storage.Common.Get(storage,key);if(oldValue==newValue){return;}if(triggerLocalEvent){D2L.LP.Web.UI.Events.OnStorage.Trigger({Key:key,NewValue:null,OldValue:oldValue});}},Set:function(storage,key,value,triggerLocalEvent){var me=D2L.LP.Web.UI.Html.Dom.Storage;if(triggerLocalEvent===undefined){triggerLocalEvent=true;}value=value.toString();var oldValue=me.Common.Get(storage,key);if(oldValue==value){return;}var success=false;if(me.IsSupported()){try{storage.setItem(key,value);success=true;}catch(e){D2L.LP.Web.UI.Html.JavaScript.Console.Error('Local storage: disabled or limit reached.',e);}}if(!success){me.Repo[key]=value;}if(triggerLocalEvent){D2L.LP.Web.UI.Events.OnStorage.Trigger({Key:key,NewValue:value,OldValue:oldValue});}}},Local:{Get:function(key){return D2L.LP.Web.UI.Html.Dom.Storage.Common.Get(window.localStorage,key);},Remove:function(key,triggerLocalEvent){var hasStorage=false;try{if(window.localStorage){hasStorage=true;}}catch(e){hasStorage=false;}if(!hasStorage){return;}D2L.LP.Web.UI.Html.Dom.Storage.Common.Remove(window.localStorage,key,triggerLocalEvent);},Set:function(key,value,triggerLocalEvent){var hasStorage=false;try{if(window.localStorage){hasStorage=true;}}catch(e){hasStorage=false;}if(!hasStorage){return;}D2L.LP.Web.UI.Html.Dom.Storage.Common.Set(window.localStorage,key,value,triggerLocalEvent);}},OnStorage:function(e){if(e.oldValue===e.newValue){return;}try{D2L.LP.Web.UI.Events.OnStorage.Trigger({Key:e.key,NewValue:e.newValue,OldValue:e.oldValue});}catch(e){}},Session:{Get:function(key){return D2L.LP.Web.UI.Html.Dom.Storage.Common.Get(window.sessionStorage,key);},Remove:function(key,triggerLocalEvent){D2L.LP.Web.UI.Html.Dom.Storage.Common.Remove(window.sessionStorage,key,triggerLocalEvent);},Set:function(key,value,triggerLocalEvent){D2L.LP.Web.UI.Html.Dom.Storage.Common.Set(window.sessionStorage,key,value,triggerLocalEvent);}}};D2L.LP.Web.UI.Html.Dom.SwapElements=function(elem1,elem2){var elem2NextSibling=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(elem2);var elem2Parent=elem2.parentNode;elem1.parentNode.replaceChild(elem2,elem1);if(elem2NextSibling!=null){elem2Parent.insertBefore(elem1,elem2NextSibling);}else{elem2Parent.appendChild(elem1);}};D2L.LP.Web.UI.Html.Dom.SwapControls=function(id1,id2){var node1=D2L.LP.Web.UI.Html.Dom.GetElementById(id1.GetValue());var node2=D2L.LP.Web.UI.Html.Dom.GetElementById(id2.GetValue());D2L.LP.Web.UI.Html.Dom.SwapElements(node1,node2);};D2L.LP.Web.UI.Html.Dom.ToggleClassName=function(className,domNode,force){if(!className||!domNode||domNode.className===undefined){return;}$(domNode).toggleClass(className,force);};D2L.LP.Web.UI.Html.Dom.ToggleClassNameById=function(className,id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node!==null){D2L.LP.Web.UI.Html.Dom.ToggleClassName(className,node);}};D2L.LP.Web.UI.Html.Dom.ToggleVisibility=function(id,animate){var $node=id.$();if($node.length===0){D2L.LP.Web.UI.Html.JavaScript.Console.Warn('Toggle Visiblity Error. Node does not exist: \''+id.GetValue()+'\'.');return;}if(animate){if($node.hasClass('d2l-hidden')){$node.css('display','none').removeClass('d2l-hidden').slideToggle();}else{$node.slideToggle();}}else{$node.toggleClass('d2l-hidden');}};D2L.LP.Web.UI.Html.JavaScript.If=function(){var args=arguments;var ret=new D2L.LP.Web.UI.Events.Event();var executeStatement=function(index){if(index==args.length){ret.Trigger();return;}var condition=args[index];var func=args[index+1];if(!condition){index=index+2;executeStatement(index);return;}var val=undefined;if(func!==undefined&&func!==null){val=func.call(func);}if(val===undefined||val===null||val.AddListener===undefined){ret.Trigger();return;}val.AddListener(function(){ret.Trigger();});val.AddReleaseListener(function(){ret.Release();});};setTimeout(function(){executeStatement(0);});return ret;};D2L.LP.Web.UI.Html.JavaScript.LogicalAnd=function(){var args=arguments;var result=args[0];for(var i=1;i<args.length;i++){result=result&&args[i];}return result;};D2L.LP.Web.UI.Html.JavaScript.LogicalNegate=function(booleanValue){return!booleanValue;};D2L.LP.Web.UI.Html.JavaScript.LogicalOr=function(){var args=arguments;var result=args[0];for(var i=1;i<args.length;i++){result=result||args[i];}return result;};D2L.LP.Web.UI.Html.JavaScript.Add=function(){var args=arguments;var result=0;for(var i=0;i<args.length;i++){result+=parseInt(args[i]);}return result;};D2L.LP.Web.UI.Html.JavaScript.Array=function(){var args=arguments;var values=[];for(var i=0;i<args.length;i++){values.push(args[i]);}return values;};D2L.LP.Web.UI.Html.JavaScript.ArrayLength=function(array){return array.length;};D2L.LP.Web.UI.Html.JavaScript.Bool={Parse:function(value){if(value===undefined||value===null){return false;}value=$.trim(value.toString().toLowerCase());if(value==='0'||value==='false'||value===''){return false;}return true;},ToStringExpression:function(value){var strValue=value?'true':'false';return strValue;}};D2L.LP.Web.UI.Html.JavaScript.CallFunctionPipeline=function(){return D2L.LP.Web.UI.Html.JavaScript.CallFunctionArrayPipeline(arguments);};D2L.LP.Web.UI.Html.JavaScript.CallFunctionArrayPipeline=function(funcs){var ret=new D2L.LP.Web.UI.Events.Event();var handleResult=function(result,index){if(typeof result!=='undefined'&&(result===null||result===false)){ret.Trigger(false);return;}if(typeof result!=='undefined'&&result.AddListener!==undefined){result.AddListener(function(r){handleResult(r,index);});result.AddReleaseListener(function(){ret.Release();});}else{callFunction(++index);}};var callFunction=function(index){if(index==funcs.length){ret.Trigger(true);return;}if(funcs[index]===undefined||funcs[index]===null){callFunction(++index);}else{var result=funcs[index].apply(funcs[index]);handleResult(result,index);}};setTimeout(function(){callFunction(0);},0);return ret;};D2L.LP.Web.UI.Html.JavaScript.Concat=function(){var args=arguments;var result='';for(var i=0;i<args.length;i++){result+=args[i].toString();}return result;};D2L.LP.Web.UI.Html.JavaScript.HtmlEncode=function(value){if(value==undefined||value==null){return value;}if(value.indexOf('&')!=-1){value=value.replace(/&/g,'&amp;');}if(value.indexOf('<')!=-1){value=value.replace(/</g,'&lt;');}if(value.indexOf('>')!=-1){value=value.replace(/>/g,'&gt;');}if(value.indexOf('"')!=-1){value=value.replace(/"/g,'&quot;');}return value;};D2L.LP.Web.UI.Html.JavaScript.IncludeScript=function(src,params){var evt=new D2L.LP.Web.UI.Events.Event();var sep=src.indexOf('?')>-1?'&':'?';for(var key in params){src+=sep+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(key)+'='+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(params[key]);sep='&';}var scripts=document.body.getElementsByTagName('script');for(var i=0;i<scripts.length;i++){if(scripts[i].src.length>=src.length&&scripts[i].src.substr(scripts[i].src.length-src.length)==src){setTimeout(function(){evt.Trigger();},0);return evt;}}var script=document.createElement('script');if(script.readyState){script.onreadystatechange=function(){if(script.readyState=='loaded'||script.readyState=='complete'){script.onreadystatechange=null;evt.Trigger();}};}else{script.onload=function(){evt.Trigger();};}script.src=src;document.body.appendChild(script);return evt;};D2L.LP.Web.UI.Html.JavaScript.IncludeScriptBlock=function(js){var script=document.createElement('script');script.appendChild(document.createTextNode(js));document.body.appendChild(script);return script;};D2L.LP.Web.UI.Html.JavaScript.Int={Parse:function(value){var val=D2L.LP.Web.UI.Html.JavaScript.Int.TryParse(value,null);return val;},TryParse:function(value,defaultValue){if(value===undefined||value===null){return defaultValue;}var val=parseInt(value);if(isNaN(val)){return defaultValue;}return val;}};D2L.LP.Web.UI.Html.JavaScript.IsArray=function(obj){if(obj&&obj.pop&&obj.push){return true;}return false;};D2L.LP.Web.UI.Html.JavaScript.NameValuePair=function(pairName,pairValue){return{name:pairName,value:pairValue};};D2L.LP.Web.UI.Html.JavaScript.ObjectAccessor=function(obj,property){if(obj[property]!==undefined){if(typeof obj[property]==='function'){return obj[property]();}else{return obj[property];}}return null;};D2L.LP.Web.UI.Html.JavaScript.Poll=function(getMethod,frequency,condition){var handleConditionVal=function(val,evt){if(val===undefined||val===null){evt.Trigger(false);return;}if(val===false||val===true){evt.Trigger(val);return;}if(val.AddListener===undefined){evt.Trigger(true);return;}val.AddListener(function(v){handleConditionVal(v,evt);});val.AddReleaseListener(function(){evt.Release();});};var getCondition=function(){var evt=new D2L.LP.Web.UI.Events.Event();if(condition===undefined||condition===null){setTimeout(function(){evt.Trigger(true);});return evt;}var val=condition();setTimeout(function(){handleConditionVal(val,evt);});return evt;};var func=function(){var cond=getCondition();cond.AddListener(function(val){if(val){var method=getMethod();method();}setTimeout(func,frequency);});};setTimeout(func,frequency);};D2L.LP.Web.UI.Html.JavaScript.Print=function(windowName){var win=window;if(windowName!==null&&windowName!==undefined&&window.name!==windowName){windowName=windowName.toLowerCase();var iframes=document.getElementsByTagName('iframe');for(var i=0;i<iframes.length;i++){if(iframes[i].contentWindow.name.toLowerCase()===windowName){win=iframes[i].contentWindow;break;}}}win.focus();if(win.document.readyState=='complete'){win.print();}else{$(win).load(function(){setTimeout(win.print,50);});}};D2L.LP.Web.UI.Html.JavaScript.RpcReceiveJsPayloadProvider=function(data){if(data===undefined||data===null){return true;}var events=[];for(var i=0;i<data.length;i++){var item=data[i];if(item.Type=='File'){events.push(D2L.LP.Web.UI.Html.JavaScript.IncludeScript(item.Content,undefined));}else{D2L.LP.Web.UI.Html.JavaScript.IncludeScriptBlock(item.Content);}}var evt=D2L.LP.Web.UI.Events.AggregateEvents(events);return evt;};D2L.LP.Web.UI.Html.JavaScript.RpcReceiveCssPayloadProvider=function(data){if(data===undefined||data===null){return;}var itemContent=null;var includeStyleBlock=function(){if(itemContent!==null){D2L.LP.Web.UI.Html.Style.IncludeStyleBlock(itemContent);itemContent=null;}};for(var i=0;i<data.length;i++){var item=data[i];if(item.Type==='File'){includeStyleBlock();D2L.LP.Web.UI.Html.Style.IncludeStyleSheet(item.Content);}else if(item.Type==='Block'){if(itemContent===null){itemContent=item.Content;}else{itemContent+=item.Content;}}}includeStyleBlock();};window.oldSetTimeout=window.setTimeout;window.setTimeout=function(method,time){if(time===undefined||time===0){return D2L.LP.Web.UI.Html.JavaScript.SetImmediate(method);}else{return window.oldSetTimeout(method,time);}};D2L.LP.Web.UI.Html.JavaScript.SetImmediate=function(handle){if(window.setImmediate!==undefined){return window.setImmediate(handle);}else if(window.msSetImmediate!==undefined){return window.msSetImmediate(handle);}else{return window.oldSetTimeout(handle);}};D2L.LP.Web.UI.Html.JavaScript.SetTimeoutWithEvent=function(method,time){var evt=new D2L.LP.Web.UI.Events.Event();setTimeout(function(){var result=method.call(method);if(result===undefined||result===null||result.AddListener===undefined){evt.Trigger(result);return;}result.AddListener(function(r){evt.Trigger(r);});result.AddReleaseListener(function(){evt.Release();});},time);return evt;};D2L.LP.Web.UI.Html.JavaScript.TrimString=function(type,str){if(typeof str!='string'){throw'TrimString Error: given variable is not a string.';}if(type===0){return str.replace(/^\s+|\s+$/g,'');}else if(type===1){return str.replace(/^\s+/,'');}else if(type===2){return str.replace(/\s+$/,'');}};D2L.LP.Web.UI.Html.JavaScript.UrlEncode=function(value){if(value==undefined||value==null){return value;}var encodedValue=encodeURIComponent(value);return encodedValue;};D2L.LP.Web.UI.Html.JavaScript.UrlEncodePath=function(value){if(value==undefined||value==null){return value;}var encodedValue='';var urlComponents=value.split('/');for(var i=0;i<urlComponents.length;i++){if(i==0){encodedValue+=encodeURIComponent(urlComponents[i]);}else{encodedValue+='/'+encodeURIComponent(urlComponents[i]);}}return encodedValue;};D2L.LP.Web.UI.Html.JavaScript.WidgetAccessor=function(id,widgetName,methodName){if(id===undefined||widgetName===undefined||methodName===undefined){return;}var instance=id.$();if(instance[widgetName]===undefined){return;}var args=Array.prototype.slice.call(arguments,2);instance[widgetName].apply(instance,args);};D2L.LP.Web.UI.Html.Css={};D2L.LP.Web.UI.Html.Css.GetStyle=function(elem,styleAttribute){if(elem!=null&&elem!=undefined){if(window.getComputedStyle!==undefined){return window.getComputedStyle(elem,null).getPropertyValue(styleAttribute);}else{if(elem.currentStyle[styleAttribute]){return elem.currentStyle[styleAttribute];}}}};D2L.LP.Web.UI.Html.Css.Capability={SupportsTransition:function(){return document.body.style.transition!==undefined||document.body.style.MozTransition!==undefined||document.body.style.webkitTransition!==undefined||document.body.style.msTransition!==undefined;}};D2L.VS=function(varName,obj){D2L.V[varName]=obj;};D2L.VG=function(varName){return D2L.V[varName];};D2L.VR=function(varName){delete D2L.V[varName];};D2L.VINS=function(varName){return D2L.V[varName]===undefined;};D2L.V={};D2L.VDS=function(dictName,varName,obj){if(!D2L.VD[dictName]){D2L.VD[dictName]={};}D2L.VD[dictName][varName]=obj;};D2L.VDG=function(dictName,varName){if(D2L.VD[dictName]){return D2L.VD[dictName][varName];}return null;};D2L.VD={};D2L.VAA=function(arrayName,obj){if(!D2L.VA[arrayName]){D2L.VA[arrayName]=[];}D2L.VA[arrayName].push(obj);};D2L.VAG=function(arrayName,index){if(D2L.VA[arrayName]){return D2L.VA[arrayName][index];}return null;};D2L.VAGA=function(arrayName){if(D2L.VA[arrayName]){return D2L.VA[arrayName];}return[];};D2L.VA={};D2L.LP.Web.UI.Html.Math={AnnotateMathML:function(encoding,title,originalMath,mathML){if(title===undefined){title="";}var mathStartRegEx=/<math[^>]*>/i;var mathBlockRegEx=/(display="block"|display='block')/gi;var mathStyleRegEx=/(style="(.*?)")/i;var mathStart=mathStartRegEx.exec(mathML);var mathMLContent=mathML.replace(/<math[^>]*>/gi,'').replace(/<\/math>/gi,'');var latexInlineRegEx=/\\\(.*\\\)/gi;var mathDisplayStyle=' display="block"';if(!mathBlockRegEx.test(mathStart)){mathDisplayStyle=' display="inline"';}if(encoding==="latex"&&latexInlineRegEx.test(originalMath)){mathDisplayStyle=' display="inline"';}var mathStyleMatch=mathStyleRegEx.exec(mathStart);var style='';var encode;if(D2L.LP.Web.UI.Html.JavaScript.HtmlEncode!=undefined){encode=D2L.LP.Web.UI.Html.JavaScript.HtmlEncode;}else{encode=D2L.Util.Html.Encode;}if(mathStyleMatch!=null){style=mathStyleMatch[1];}var encodedMath=encode(originalMath);var annotatedMathML='<math title="'+title+'" '+style+' xmlns="http://www.w3.org/1998/Math/MathML"'+mathDisplayStyle+'><semantics><mstyle>'+mathMLContent+'</mstyle><annotation encoding=\"'+encoding+'\">'+'{"version":"1.1","math":"'+encodedMath+'"}'+'</annotation></semantics></math>';return annotatedMathML;},DecodeMathML:function(str){if(str.indexOf('&')!=-1){str=str.replace(/&amp;/g,"&");str=str.replace(/&lt;/g,'<');str=str.replace(/&gt;/g,'>');str=str.replace(/&quot;/g,'"');}return str;},GetMath:function(node,callback){if(!window.MathJax){return;}MathJax.Hub.Queue(function(){var math=[];var allJax=MathJax.Hub.getAllJax(node);if(Array.isArray(allJax)){allJax.forEach(function(jax){if(jax.root&&jax.root.toMathML){math.push({"originalMath":jax.originalText,"mathML":jax.root.toMathML()});}});}if(callback&&callback.call){callback.call(callback,math);}});return;},Update:function(callback){D2L.LP.Web.UI.Html.Math.UpdateNode(null,callback);},UpdateNode:function(node,callback){if(D2LMathML.ReadyState!=='ready'){return;}if(node){if(node.nodeType!==1&&node.nodeType!==9||node.tagName.toLowerCase()==='template'){return;}}if(!window.MathJax){if(callback&&callback.call){callback.call(callback);}return;}if(MathJax.InputJax.TeX){try{MathJax.Hub.Queue(["resetEquationNumbers",MathJax.InputJax.TeX]);}catch(e){}}if(node){MathJax.Hub.Queue(["Typeset",MathJax.Hub,node]);}else{MathJax.Hub.Queue(["PreProcess",MathJax.Hub],["Reprocess",MathJax.Hub]);}if(callback&&callback.call){MathJax.Hub.Queue(function(){callback.call(callback);});}}};D2LMathML={IsLatex:false,IsMathJaxRequested:false,ReadyState:null,m_message:'',m_afterPartialHandler:null,m_hasAfterPartialEvent:function(){return window.D2L&&window.D2L.LP&&window.D2L.LP.Web&&window.D2L.LP.Web.UI&&window.D2L.LP.Web.UI.Html&&window.D2L.LP.Web.UI.Html.PartialRendering&&window.D2L.LP.Web.UI.Html.PartialRendering.OnAfter;},DesktopInit:function(mathMLUrl,latexUrl,scalingFactor,renderLatex){var isMathJaxLoaded=function(){if(document.head.querySelector('#mathJax')){return true;}return false;};var isMathJaxRequired=function(){if(this.IsLatex||this.IsMathJaxRequested||document.querySelector('math')||renderLatex&&document.body&&document.body.innerText&&/\$\$|\\\(|\\\[|\\begin{|\\ref{/.test(document.body.innerText)){return true;}return false;}.bind(this);var loadMathJax=function(){if(D2LMathML.ReadyState){return;}D2LMathML.ReadyState='loading';var mathJaxConfig={delayStartupUntil:"onload",showProcessingMessages:false,messageStyle:"none",menuSettings:{context:"MathJax",zoom:"None"},NativeMML:{showMathMenuMSIE:false,scale:scalingFactor+10},"HTML-CSS":{linebreaks:{automatic:true,width:"container"},imageFont:null,scale:scalingFactor},styles:{".MathJax .merror":{"background-color":"#fff !important",color:"#494c4e !important",border:"1px solid #cd2026 !important"}}};if(renderLatex){mathJaxConfig.tex2jax={displayMath:[['$$','$$'],['\\[','\\]']],inlineMath:[['\\(','\\)']]};}var configScript='MathJax.Hub.Config('+JSON.stringify(mathJaxConfig)+');';var script=document.createElement('script');script.type='text/x-mathjax-config';script.textContent=configScript;document.head.appendChild(script);var mathJaxScript=document.createElement('script');mathJaxScript.id='mathJax';mathJaxScript.async='async';mathJaxScript.onload=function(){D2LMathML.ReadyState='ready';};mathJaxScript.src=D2LMathML.IsLatex||renderLatex?latexUrl:mathMLUrl;document.head.appendChild(mathJaxScript);}.bind(this);if(isMathJaxLoaded()){return;}if(isMathJaxRequired()){loadMathJax();}else if(this.m_hasAfterPartialEvent()&&!this.m_afterPartialHandler){this.m_afterPartialHandler=function(){if(isMathJaxLoaded()||!isMathJaxRequired()){return;}loadMathJax();D2L.LP.Web.UI.Html.PartialRendering.OnAfter.RemoveListener(this.m_afterPartialHandler);D2L.LP.Web.UI.Desktop.Controls.HtmlBlock.OnAfterRender.RemoveListener(this.m_afterPartialHandler);this.m_afterPartialHandler=null;}.bind(this);D2L.LP.Web.UI.Html.PartialRendering.OnAfter.AddListener(this.m_afterPartialHandler);D2L.LP.Web.UI.Desktop.Controls.HtmlBlock.OnAfterRender.AddListener(this.m_afterPartialHandler);}}};D2L.LP.Web.UI.Html.Mentions={FreeRangeAppIFramePlugin:function(orgUnitId){return function(host){var service={queryUsers:function(term){return new Promise(function(resolve){D2L.LP.Web.UI.Rpc.Connect(D2L.LP.Web.UI.Rpc.Verbs.GET,new D2L.LP.Web.Http.UrlLocation('/d2l/lp/htmleditor/mentionssearch?ou='+orgUnitId),{searchTerm:term},{success:resolve});});}};host.registerService('mentions','0.1',service);};}};D2L.LP.Web.UI.Html.PartialRendering={};D2L.LP.Web.UI.Html.PartialRendering={_includeClasses:[],AddClassNameToFocusIncludeList:function(className){D2L.LP.Web.UI.Html.PartialRendering._includeClasses[className]=true;},InjectResult:function(placeholder,result,animationType,isInnerReplacement,activeNode,spinnerCheckmarkElementClassName,spinnerCheckmarkSize,animationOverlay){var ret=new D2L.LP.Web.UI.Events.Event();animationType=animationType||D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.None;var hasAnimation=animationType!=D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.None;var placeholderId=placeholder.getAttribute('id');var prc=D2L.LP.Web.UI.Html.PartialRendering.GetPartialRenderContext(placeholderId);var doInnerReplacement=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-placeholder-inner',placeholder);var firstNewNode=null;var canSetSelection=D2L.LP.Web.UI.Html.PartialRendering.CanSetSelection(activeNode);var activeSelection={"selectionStart":canSetSelection?activeNode.selectionStart:0,"selectionEnd":canSetSelection?activeNode.selectionEnd:0};var pathToActiveNode=D2L.LP.Web.UI.Html.PartialRendering.GeneratePathToNode(activeNode,placeholder);var parentNode=placeholder.parentNode;if(parentNode!==null){var validClassNames=[];var validateClassNames=false;if(prc!==null){validClassNames=prc.GetValidClassNames();validateClassNames=validClassNames!==null&&validClassNames.length>0;}var temp=document.createElement('div');temp.innerHTML=result.Html;var nodes=[];var fragment=document.createDocumentFragment();while(temp.firstChild){var isClassNameValid=true;if(validateClassNames&&temp.firstChild.nodeType==1){isClassNameValid=D2L.LP.Web.UI.Html.Dom.HasAnyClassName(validClassNames,temp.firstChild);}if(!isClassNameValid){throw' The partial view contains nodes that are not valid in '+'the current context.  The partial view node has class name: '+temp.firstChild.className+', but the valid class names '+'for this context are: '+prc.GetValidClassNames()+'.';}var newChild=fragment.appendChild(temp.firstChild);if(firstNewNode===null&&newChild.nodeType==1){firstNewNode=newChild;}nodes.push(newChild);}var placeholderClone=null;if(hasAnimation){placeholderClone=D2L.LP.Web.UI.Html.PartialRendering.Animation.CloneForAnimation(placeholder);}placeholder.innerHTML='';if(doInnerReplacement){placeholder.appendChild(fragment);window.requestAnimationFrame(function(){D2L.LP.Web.UI.Events.OnViewRender.Trigger(placeholder);finish();});}else{parentNode.insertBefore(fragment,placeholder);parentNode.removeChild(placeholder);for(var i=0;i<nodes.length;i++){(function(n,isLast){window.requestAnimationFrame(function(){D2L.LP.Web.UI.Events.OnViewRender.Trigger(n);if(isLast){finish();}});})(nodes[i],i===nodes.length-1);}}}function finish(){for(var i=0;i<result.OnInit.length;i++){eval(result.OnInit[i]);}for(var i=0;i<result.OnLoad.length;i++){eval(result.OnLoad[i]);}var startAnimation=function(){if(animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.Checkmark){D2L.LP.Web.UI.Html.PartialRendering.Animation.AnimateCheckmark(firstNewNode,spinnerCheckmarkElementClassName,spinnerCheckmarkSize,animationOverlay);return;}var newNodesClone=[];for(var i=0;i<nodes.length;i++){newNodesClone.push(D2L.LP.Web.UI.Html.PartialRendering.Animation.CloneForAnimation(nodes[i]));}D2L.LP.Web.UI.Html.PartialRendering.Animation.AnimateResult(animationType,firstNewNode,placeholderClone,newNodesClone);};if(hasAnimation&&D2L.LP.Web.UI.Html.Css.Capability.SupportsTransition()){startAnimation();}var currNode=D2L.LP.Web.UI.Html.PartialRendering.FindElementByPath(pathToActiveNode,isInnerReplacement?placeholder:firstNewNode);if(currNode===null){var ph=D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId);currNode=D2L.LP.Web.UI.Html.Dom.GetNextFocusableElement(ph);}if(D2L.LP.Web.UI.Html.PartialRendering.CanSetSelection(currNode)){currNode.selectionStart=activeSelection.selectionStart;currNode.selectionEnd=activeSelection.selectionEnd;}D2L.LP.Web.UI.Html.Dom.FocusNode(currNode);ret.Trigger(firstNewNode);}return ret;},PartialRender:function(id,provider,animationType,hideSpinner,spinnerCheckmarkOption){var spinnerCheckmarkElementClassName=null;var spinnerCheckmarkSize=D2L.LP.Web.UI.Html.PartialRendering.SpinnerCheckmarkSizes.Small;var loadingDelayInMilliseconds=0;var hasSpinnerCheckmarkAnimation=false;if(spinnerCheckmarkOption){hasSpinnerCheckmarkAnimation=true;spinnerCheckmarkSize=spinnerCheckmarkOption.Size;spinnerCheckmarkElementClassName=spinnerCheckmarkOption.ElementClassName;loadingDelayInMilliseconds=spinnerCheckmarkOption.LoadingDelay;}D2L.LP.Web.UI.Html.PartialRendering.OnBefore.Trigger(id);var ret=new D2L.LP.Web.UI.Events.Event();var placeholder=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(placeholder===null){ret.Release();throw'Placeholder not found: \''+id.GetValue()+'\'.';}var isInnerReplacement=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-placeholder-inner',placeholder);var hasLoading=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-loading',placeholder).length>0;var shim=null,shim2=null;var done=false;var animationOverlay=null;var getSize=function(size){switch(size){case D2L.LP.Web.UI.Html.PartialRendering.SpinnerCheckmarkSizes.Small:return 50;case D2L.LP.Web.UI.Html.PartialRendering.SpinnerCheckmarkSizes.Large:return 100;}return 50;};var spinnerCheckmarkLoad=function(){var animationNode=placeholder;if(spinnerCheckmarkElementClassName){var elements=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName(spinnerCheckmarkElementClassName,placeholder);for(var i=0;i<elements.length;i++){if(placeholder.contains(elements[i])){animationNode=elements[i];break;}}}var animationContainer=document.createElement('div');animationContainer.className='d2l-partial-render-animation-container';animationContainer.setAttribute('change-image-loading','');var animationParentNode=animationNode.parentNode;animationParentNode.replaceChild(animationContainer,animationNode);animationContainer.appendChild(animationNode);D2L.LP.Web.UI.Html.Bsi.LoadAssets(['node_modules/@brightspace-ui/core/components/loading-spinner/loading-spinner.js']).then(function(){var spinner=document.createElement('d2l-loading-spinner');spinner.setAttribute('size',getSize(spinnerCheckmarkSize).toString());animationContainer.appendChild(spinner);});var animationRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(animationNode);animationOverlay=document.createElement('div');animationOverlay.className='d2l-partial-render-animation-overlay';animationOverlay.style.top=animationRect.top+'px';animationOverlay.style.left=animationRect.left+'px';animationOverlay.style.width=animationRect.width+'px';animationOverlay.style.height=animationRect.height+'px';document.body.appendChild(animationOverlay);};var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(placeholder);if(rect!==null){shim=document.createElement('div');shim.className='d2l-partial-render-shim1';shim2=document.createElement('div');shim2.className='d2l-partial-render-shimbg1';shim.style.top=shim2.style.top=rect.top+'px';shim.style.left=shim2.style.left=rect.left+'px';shim.style.width=shim2.style.width=rect.width+'px';shim.style.height=shim2.style.height=rect.height+'px';document.body.appendChild(shim);document.body.appendChild(shim2);setTimeout(function(){if(!hasLoading&&!done){if(hasSpinnerCheckmarkAnimation){spinnerCheckmarkLoad();}else if(!hideSpinner){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-partial-render-shim2',shim);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-partial-render-shimbg2',shim2);}}},500);}var deleteShim=function(){if(shim!==null&&shim.parentNode!==null){shim.parentNode.removeChild(shim);}if(shim2!==null&&shim2.parentNode!==null){shim2.parentNode.removeChild(shim2);}};var finish=function(val){deleteShim();ret.Trigger(val);D2L.LP.Web.UI.Html.PartialRendering.OnAfter.Trigger(id);};var activeElement=D2L.LP.Web.UI.Html.Dom.GetActiveElement(document);var handleResult=function(result){if(hasSpinnerCheckmarkAnimation){animationType=D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.Checkmark;}done=true;if(!result){finish(false);return;}placeholder=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(placeholder===null){finish(false);return;}var hasHistoryEntry=result.HistoryEntryUrl!==null&&result.HistoryEntryUrl!==undefined&&result.HistoryEntryProvider!==null&&result.HistoryEntryProvider!==undefined;if(hasHistoryEntry){var historyEntryProvider=eval(result.HistoryEntryProvider)(id);var historyEntryReviver=D2L.LP.Web.UI.Html.PartialRendering.CreateReviver(id,historyEntryProvider,animationType,hideSpinner);D2L.LP.Web.UI.Html.PartialRendering.History.PushState(id,result.HistoryEntryUrl,result.HistoryEntryTitle,historyEntryReviver);}var injectEvt=D2L.LP.Web.UI.Html.PartialRendering.InjectResult(placeholder,result,animationType,isInnerReplacement,activeElement,spinnerCheckmarkElementClassName,spinnerCheckmarkSize,animationOverlay);injectEvt.AddListener(function(){finish(true);});};var delayedHandleResult=function(result){setTimeout(function(){handleResult(result);},loadingDelayInMilliseconds);};var resultHandler=hasSpinnerCheckmarkAnimation&&loadingDelayInMilliseconds>0?delayedHandleResult:handleResult;var evt=provider.call(provider);evt.AddListener(resultHandler);evt.AddReleaseListener(function(){ret.Release();});return ret;},CreateReviver:function(id,provider,animationType,hideSpinner){var reviver=function(){return D2L.LP.Web.UI.Html.PartialRendering.PartialRender(id,provider,animationType,hideSpinner);};return reviver;},GetPartialRenderContext:function(placeholderId){var prc=null;if(placeholderId!==null){prc=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId,0);}if(prc===null){prc=new D2L.LP.Web.UI.Html.PartialRendering.PartialHtmlRenderContext();}var placeholderNode=D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId);if(placeholderNode&&D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-form-primary',placeholderNode)!=null){prc.SetHasActiveForm(true);}return prc;},GetInitialRenderProvider:function(placeholderId){var provider=null;if(placeholderId!==null&&placeholderId!==undefined){provider=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId,"InitialRenderProvider");}return provider;},CanSetSelection:function(selectionNode){if(!selectionNode||!("selectionStart"in selectionNode)||!("selectionEnd"in selectionNode)||!selectionNode.tagName){return false;}var tagName=selectionNode.tagName.toLowerCase();if(tagName=='textarea'){return true;}if(tagName!='input'){return false;}var attributeType=selectionNode.getAttribute('type').toLowerCase();if(attributeType=='text'||attributeType=='password'||attributeType=='search'||attributeType=='telephone'||attributeType=='url'){return true;}return false;},GeneratePathToNode:function(startNode,endNode){var path=[];var currElement=startNode;if(startNode==null||startNode==undefined||endNode==null||endNode==undefined){return[];}while(true){var nodeIndex=D2L.LP.Web.UI.Html.Dom.IndexOfElement(currElement);path.push({tagName:currElement.tagName,className:currElement.className,childIndex:nodeIndex});if(currElement==endNode){break;}currElement=currElement.parentNode;if(currElement==null){path=[];break;}}return path;},FindElementByPath:function(path,rootNode){if(path===undefined||path===null||path.length===0){return false;}if(!D2L.LP.Web.UI.Html.PartialRendering.CompareElements(path[path.length-1],rootNode)){return false;}var currNode=rootNode;for(var j=path.length-2;j>=0;j--){var pathElem=D2L.LP.Web.UI.Html.PartialRendering.FindMatchingElementInChildren(path[j],currNode);if(pathElem===null){currNode=null;break;}currNode=pathElem;}return currNode;},FindMatchingElementInChildren:function(refElem,parent){if(parent===undefined||parent===null){return null;}var children=D2L.LP.Web.UI.Html.PartialRendering.GetChildNodes(parent);for(var i=0;i<children.length;i++){if(D2L.LP.Web.UI.Html.Dom.IndexOfElement(children[i])==refElem.childIndex&&D2L.LP.Web.UI.Html.PartialRendering.CompareElements(refElem,children[i])){return children[i];}}return null;},GetChildNodes:function(parent){var children=[];var parentChildren=parent.childNodes;for(var i=parentChildren.length;i>=0;i--){if(parentChildren[i]!==undefined&&parentChildren[i]!==null&&parentChildren[i].nodeType==1){children.push(parentChildren[i]);}}return children;},RegexD2lClassName:/d2l_[0-9]*_[0-9]*_[0-9]*/,CompareElements:function(elem1,elem2){if(elem1==null||elem1==undefined||elem2==null||elem2==undefined){return false;}if(elem1.tagName!=elem2.tagName){return false;}var classes=D2L.LP.Web.UI.Html.PartialRendering.GetClassNamesForMatching(elem1);var classes2=D2L.LP.Web.UI.Html.PartialRendering.GetClassNamesForMatching(elem2);if(classes.length!=classes2.length){return false;}var numClassNameMatches=0;for(var i=0;i<classes.length;i++){if(!D2L.LP.Web.UI.Html.PartialRendering.RegexD2lClassName.test(classes[i])){if(!D2L.LP.Web.UI.Html.Dom.HasClassName(classes[i],elem2)){break;}}numClassNameMatches++;}return numClassNameMatches==classes.length;},GetClassNamesForMatching:function(elem){var classNames=elem.className.split(' ');var validClassNames=[];for(var i=classNames.length-1;i>=0;i--){var className=classNames[i];if(className in D2L.LP.Web.UI.Html.PartialRendering._includeClasses){validClassNames.push(className);}}return validClassNames;},History:{IsAvailable:'history'in window&&'pushState'in window.history,IsReviving:false,Revivers:{},AddPopStateListener:function(){if(!D2L.LP.Web.UI.Html.PartialRendering.History.IsAvailable){return;}D2L.LP.Web.UI.Html.Dom.AddEventListener('popstate',window,D2L.LP.Web.UI.Html.PartialRendering.History.HandlePopState);},QueueEvent:null,QueueHistoryTask:function(func){var event=new D2L.LP.Web.UI.Events.Event();var callFunc=function(){func(event);};var event0=D2L.LP.Web.UI.Html.PartialRendering.History.QueueEvent;if(event0!==null&&event0!==undefined){event0.AddListener(callFunc);event0.AddReleaseListener(function(){event.Release();});}else{setTimeout(callFunc,0);}D2L.LP.Web.UI.Html.PartialRendering.History.QueueEvent=event;var clearQueueEvent=function(){if(D2L.LP.Web.UI.Html.PartialRendering.History.QueueEvent===event){D2L.LP.Web.UI.Html.PartialRendering.History.QueueEvent=null;}};event.AddListener(clearQueueEvent);event.AddReleaseListener(clearQueueEvent);return event;},HandlePopState:function(event){var stateObj=event.state;var popStateTask=function(evt){return D2L.LP.Web.UI.Html.PartialRendering.History.PopStateImpl(evt,stateObj);};return D2L.LP.Web.UI.Html.PartialRendering.History.QueueHistoryTask(popStateTask);},PopStateImpl:function(event,stateObj){if(stateObj===null||stateObj===undefined||stateObj.Key===undefined){event.Trigger();return;}var reviver=D2L.LP.Web.UI.Html.PartialRendering.History.Revivers[stateObj.Key];if(reviver===undefined){if(stateObj.Url!==undefined){window.location=stateObj.Url;}event.Release();return;}D2L.LP.Web.UI.Html.PartialRendering.History.IsReviving=true;var reviveEvent=reviver();reviveEvent.AddListener(function(){D2L.LP.Web.UI.Html.PartialRendering.History.IsReviving=false;if(stateObj.Title!==null&&stateObj.Title!==undefined){document.title=stateObj.Title;}event.Trigger();});reviveEvent.AddReleaseListener(function(){event.Release();});},StripSchemeAndAuthority:function(urlObject){return urlObject.pathname+urlObject.search+urlObject.hash;},TrySaveInitialState:function(id){var stateObj=window.history.state;var isInitialState=stateObj===null||stateObj===undefined||stateObj.Key===undefined||D2L.LP.Web.UI.Html.PartialRendering.History.Revivers[stateObj.Key]===undefined;if(!isInitialState){return;}var url=D2L.LP.Web.UI.Html.PartialRendering.History.StripSchemeAndAuthority(window.location);var title=window.document.title;var placeholderId=id.GetValue();var key=placeholderId+","+url;stateObj={Key:key,PlaceholderId:placeholderId,Title:title,Url:url};var initialRenderProvider=D2L.LP.Web.UI.Html.PartialRendering.GetInitialRenderProvider(placeholderId);if(initialRenderProvider!==null){D2L.LP.Web.UI.Html.PartialRendering.History.Revivers[stateObj.Key]=D2L.LP.Web.UI.Html.PartialRendering.CreateReviver(id,initialRenderProvider);}if(!D2L.LP.Web.UI.Html.PartialRendering.History.IsReviving){window.history.replaceState(stateObj,stateObj.Title,stateObj.Url);}},PushState:function(id,url,title,reviver){if(!D2L.LP.Web.UI.Html.PartialRendering.History.IsAvailable){return;}D2L.LP.Web.UI.Html.PartialRendering.History.TrySaveInitialState(id);var placeholderId=id.GetValue();var key=placeholderId+","+url;var stateObj={Key:key,PlaceholderId:placeholderId,Title:title,Url:url};D2L.LP.Web.UI.Html.PartialRendering.History.Revivers[stateObj.Key]=reviver;if(!D2L.LP.Web.UI.Html.PartialRendering.History.IsReviving){window.history.pushState(stateObj,title,url);}if(title!==null&&title!==undefined){document.title=title;}}}};D2L.LP.Web.UI.Html.PartialRendering.SpinnerCheckmarkSizes={Small:0,Large:1};D2L.LP.Web.UI.Html.PartialRendering.Animation={AnimateResult:function(animationType,firstNewNode,placeholderClone,newNodesClone){switch(animationType){case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeft:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideRight:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeftWithFade:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideRightWithFade:var isSlideLeft=animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeftWithFade||animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeft;var hasHFade=animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeftWithFade||animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideRightWithFade;D2L.LP.Web.UI.Html.PartialRendering.Animation.AnimateHorizontalSlide(isSlideLeft,hasHFade,firstNewNode,placeholderClone,newNodesClone);break;case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUp:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideDown:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUpWithFade:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideDownWithFade:var isSlideUp=animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUpWithFade||animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUp;var hasVFade=animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUpWithFade||animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideDownWithFade;D2L.LP.Web.UI.Html.PartialRendering.Animation.AnimateVerticalSlide(isSlideUp,hasVFade,firstNewNode,placeholderClone,newNodesClone);break;}},AnimateCheckmark:function(firstNewNode,spinnerCheckmarkElementClassName,size,animationOverlay){var animationNode=firstNewNode;if(spinnerCheckmarkElementClassName){var elements=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName(spinnerCheckmarkElementClassName,firstNewNode);for(var i=0;i<elements.length;i++){if(firstNewNode.contains(elements[i])){animationNode=elements[i];break;}}}var animationParentNode=animationNode.parentNode;var animationContainer=null;if(animationParentNode.className==='d2l-partial-render-animation-container'){animationContainer=animationParentNode;if(animationContainer.hasAttribute('change-image-loading')){animationContainer.removeAttribute('change-image-loading');}animationParentNode=animationParentNode.parentNode;}else{animationContainer=document.createElement('div');animationContainer.className='d2l-partial-render-animation-container';animationParentNode.replaceChild(animationContainer,animationNode);animationContainer.appendChild(animationNode);}animationContainer.setAttribute('change-image-success','');var checkmarkContainer=document.createElement('div');checkmarkContainer.className='d2l-partial-render-animation-checkmark-container';D2L.LP.Web.UI.Html.Bsi.LoadAssets(['node_modules/@brightspace-ui/core/components/icons/icon.js']).then(function(){var checkmark=document.createElement('d2l-icon');checkmark.className='d2l-partial-render-animation-checkmark';checkmark.setAttribute('icon','d2l-tier2:check');checkmarkContainer.appendChild(checkmark);switch(size){case D2L.LP.Web.UI.Html.PartialRendering.SpinnerCheckmarkSizes.Small:D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-partial-render-animation-checkmark-container-small',checkmarkContainer);break;case D2L.LP.Web.UI.Html.PartialRendering.SpinnerCheckmarkSizes.Large:D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-partial-render-animation-checkmark-container-large',checkmarkContainer);break;}animationContainer.appendChild(checkmarkContainer);var animationDuration=400;var startAnimation=function(){setTimeout(finishAnimation,animationDuration);};var finishAnimation=function(){animationParentNode.replaceChild(animationNode,animationContainer);if(animationOverlay!==null&&animationOverlay.parentNode!==null){animationOverlay.parentNode.removeChild(animationOverlay);}};setTimeout(startAnimation,0);});},AnimateHorizontalSlide:function(isSlideLeft,hasFade,firstNewNode,placeholderClone,newNodesClone){var isRTLCulture=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;if(isRTLCulture){isSlideLeft=!isSlideLeft;}var animationDuration=400;var separatorWidth=10;var prevWidth=placeholderClone.d2l_boundingRect.width;var sliderOpener=document.createElement('div');sliderOpener.className='d2l-partial-render-animation-horizontal-slider-opener';D2L.LP.Web.UI.Html.Aria.SetRole(sliderOpener,'presentation');var sliderWindow=document.createElement('div');sliderWindow.className='d2l-partial-render-animation-horizontal-slider-window';sliderOpener.appendChild(sliderWindow);var slider=document.createElement('div');slider.className='d2l-partial-render-animation-horizontal-slider';sliderWindow.appendChild(slider);var sliderPrevPanel=document.createElement('div');sliderPrevPanel.className='d2l-partial-render-animation-horizontal-slider-prev';sliderPrevPanel.style.width=prevWidth+'px';D2L.LP.Web.UI.Html.Aria.SetRole(sliderPrevPanel,'presentation');var separatorPanel=document.createElement('div');separatorPanel.className='d2l-partial-render-animation-horizontal-slider-separator';separatorPanel.style.width=separatorWidth+'px';separatorPanel.style.height='1px';var sliderNextPanel=document.createElement('div');sliderNextPanel.className='d2l-partial-render-animation-horizontal-slider-next';D2L.LP.Web.UI.Html.Aria.SetRole(sliderNextPanel,'presentation');if(isSlideLeft){slider.appendChild(sliderPrevPanel);slider.appendChild(separatorPanel);slider.appendChild(sliderNextPanel);if(isRTLCulture){slider.style.left=prevWidth+'px';}else{slider.style.left='0px';}}else{slider.appendChild(sliderNextPanel);slider.appendChild(separatorPanel);slider.appendChild(sliderPrevPanel);if(isRTLCulture){slider.style.left='0px';}else{slider.style.left=-(prevWidth+separatorWidth)+'px';}}if(hasFade){sliderNextPanel.style.opacity=0;sliderPrevPanel.style.opacity=1;}var clearFloat=document.createElement('div');clearFloat.className='d2l-clear';slider.appendChild(clearFloat);sliderPrevPanel.appendChild(placeholderClone);for(var i=0;i<newNodesClone.length;i++){sliderNextPanel.appendChild(newNodesClone[i]);}firstNewNode.parentNode.insertBefore(sliderOpener,firstNewNode);var newContentBoundingRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(sliderNextPanel);slider.style.width=prevWidth+newContentBoundingRect.width+separatorWidth+'px';sliderWindow.style.width=newContentBoundingRect.width+'px';var startAnimation=function(){setTimeout(finishAnimation,animationDuration);if(isSlideLeft){if(isRTLCulture){slider.style.left='0px';}else{slider.style.left=-(prevWidth+separatorWidth)+'px';}}else{if(isRTLCulture){slider.style.left=prevWidth+separatorWidth+'px';}else{slider.style.left='0px';}}if(hasFade){sliderNextPanel.style.opacity=1;sliderPrevPanel.style.opacity=0;}};var finishAnimation=function(){sliderOpener.parentNode.removeChild(sliderOpener);};setTimeout(startAnimation,0);},AnimateVerticalSlide:function(isSlideUp,hasFade,firstNewNode,placeholderClone,newNodesClone){var animationDuration=400;var separatorHeight=10;var prevHeight=placeholderClone.d2l_boundingRect.height;var sliderOpener=document.createElement('div');sliderOpener.className='d2l-partial-render-animation-vertical-slider-opener';D2L.LP.Web.UI.Html.Aria.SetRole(sliderOpener,'presentation');var sliderWindow=document.createElement('div');sliderWindow.className='d2l-partial-render-animation-vertical-slider-window';sliderOpener.appendChild(sliderWindow);var slider=document.createElement('div');slider.className='d2l-partial-render-animation-vertical-slider';sliderWindow.appendChild(slider);var sliderPrevPanel=document.createElement('div');sliderPrevPanel.className='d2l-partial-render-animation-vertical-slider-prev';sliderPrevPanel.style.height=prevHeight+'px';D2L.LP.Web.UI.Html.Aria.SetRole(sliderPrevPanel,'presentation');var separatorPanel=document.createElement('div');separatorPanel.className='d2l-partial-render-animation-vertical-slider-separator';separatorPanel.style.height=separatorHeight+'px';separatorPanel.style.width='1px';var sliderNextPanel=document.createElement('div');sliderNextPanel.className='d2l-partial-render-animation-vertical-slider-next';D2L.LP.Web.UI.Html.Aria.SetRole(sliderNextPanel,'presentation');if(isSlideUp){slider.appendChild(sliderPrevPanel);slider.appendChild(separatorPanel);slider.appendChild(sliderNextPanel);slider.style.top='0px';}else{slider.appendChild(sliderNextPanel);slider.appendChild(separatorPanel);slider.appendChild(sliderPrevPanel);slider.style.top=-(prevHeight+separatorHeight)+'px';}if(hasFade){sliderNextPanel.style.opacity=0;sliderPrevPanel.style.opacity=1;}sliderPrevPanel.appendChild(placeholderClone);for(var i=0;i<newNodesClone.length;i++){sliderNextPanel.appendChild(newNodesClone[i]);}firstNewNode.parentNode.insertBefore(sliderOpener,firstNewNode);var newContentBoundingRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(sliderNextPanel);slider.style.height=prevHeight+newContentBoundingRect.height+separatorHeight+'px';sliderWindow.style.height=newContentBoundingRect.height+'px';var startAnimation=function(){setTimeout(finishAnimation,animationDuration);if(isSlideUp){slider.style.top=-(prevHeight+separatorHeight)+'px';}else{slider.style.top='0px';}if(hasFade){sliderNextPanel.style.opacity=1;sliderPrevPanel.style.opacity=0;}};var finishAnimation=function(){sliderOpener.parentNode.removeChild(sliderOpener);};setTimeout(startAnimation,0);},CloneForAnimation:function(node){var cleanupAttributes=function(attrElement){D2L.LP.Web.UI.Html.Aria.RemoveAttribute(attrElement,'live');attrElement.removeAttribute('name');attrElement.removeAttribute('id');};var clone=node.cloneNode(true);if(clone.nodeType==1){var allElems=clone.all?clone.all:clone.getElementsByTagName('*');for(var i=0;i<allElems.length;i++){var elem=allElems[i];cleanupAttributes(elem);}cleanupAttributes(clone);var boundingRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);clone.style.width=boundingRect.width+'px';clone.d2l_boundingRect=boundingRect;}return clone;}};D2L.LP.Web.UI.Html.PartialRendering.Animation.Types={None:0,SlideLeft:1,SlideRight:2,SlideLeftWithFade:3,SlideRightWithFade:4,SlideUp:5,SlideDown:6,SlideUpWithFade:7,SlideDownWithFade:8,Checkmark:9};D2L.LP.Web.UI.Html.PartialRendering.PartialHtmlRenderContext=D2L.Class.Create({Construct:function(){this.m_headingLevel=1;this.m_scope='';this.m_childScopeCounters='';this.m_validClassNames=[];this.m_hasActiveForm=false;this.m_isPrintMode=false;},_deserialize:function(deserializer){this.m_headingLevel=deserializer.GetMember('HeadingLevel');this.m_scope=deserializer.GetMember('Scope');if(deserializer.HasMember('ChildScopeCounters')){this.m_childScopeCounters=deserializer.GetMember('ChildScopeCounters');}this.m_validClassNames=deserializer.GetMember('ValidClassNames');if(deserializer.HasMember('IsPrintMode')){this.m_isPrintMode=deserializer.GetMember('IsPrintMode');}},_serialize:function(serializer){serializer.AddMember('headingLevel',this.m_headingLevel);serializer.AddMember('scope',this.m_scope);if(this.m_childScopeCounters){serializer.AddMember('childScopeCounters',this.m_childScopeCounters);}serializer.AddMember('validClassNames',this.m_validClassNames);serializer.AddMember('hasActiveForm',this.m_hasActiveForm);if(this.m_isPrintMode){serializer.AddMember('isPrintMode',this.m_isPrintMode);}},GetValidClassNames:function(){return this.m_validClassNames;},SetHasActiveForm:function(hasActiveForm){this.m_hasActiveForm=hasActiveForm;}});D2L.LP.Web.UI.Html.PartialRendering.OnBefore=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Html.PartialRendering.OnAfter=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Html.ReturnPoints={LocalStorageKey:'ReturnPoints',Get:function(key,defaultLocation){var me=D2L.LP.Web.UI.Html.ReturnPoints;me.ValidateKey(key);me.ValidateLocation(defaultLocation);var data=me.Read();for(var i=data.length-1;i>-1;i--){if(data[i].key===key){var location=new D2L.LP.Web.Http.UrlLocation(data[i].url);data=data.slice(0,i);me.Write(data);return location;}}return defaultLocation;},Set:function(key,location){var me=D2L.LP.Web.UI.Html.ReturnPoints;if(location===undefined){location=new D2L.LP.Web.Http.UrlLocation(document.location.href);}location.RemoveQueryString('dst');if(!location.HasQueryString("returnPoint")){location=location.WithQueryString("returnPoint","1");}me.ValidateKey(key);me.ValidateLocation(location);var data=me.Read();var entry={key:key,url:location.GetUrl()};data.push(entry);me.Write(data);},TryPeek:function(key){var me=D2L.LP.Web.UI.Html.ReturnPoints;me.ValidateKey(key);var data=me.Read();for(var i=data.length-1;i>-1;i--){if(data[i].key===key){var location=new D2L.LP.Web.Http.UrlLocation(data[i].url);return location;}}return null;},Read:function(){var me=D2L.LP.Web.UI.Html.ReturnPoints;var json=D2L.LP.Web.UI.Html.Dom.Storage.Session.Get(me.LocalStorageKey);if(json===undefined||json===null||json.length===0){return[];}var data=D2L.LP.Web.Serialization.Json.Deserialize(json);return data;},Reset:function(){var me=D2L.LP.Web.UI.Html.ReturnPoints;D2L.LP.Web.UI.Html.Dom.Storage.Session.Remove(me.LocalStorageKey);},ValidateKey:function(key){if(key===undefined||key===null||key.length===0){throw'Invalid key.';}},ValidateLocation:function(location){if(location===undefined||location===null){throw'Invalid location.';}},Write:function(data){var me=D2L.LP.Web.UI.Html.ReturnPoints;if(data.length===0){me.Reset();}var json=JSON.stringify(data);D2L.LP.Web.UI.Html.Dom.Storage.Session.Set(me.LocalStorageKey,json,false);}};D2L.LP.Web.UI.Html.Style={};D2L.LP.Web.UI.Html.Style.IncludeStyleSheet=function(src,params){var head=document.getElementsByTagName('head');if(head.length!=1){return;}var sep=src.indexOf('?')>-1?'&':'?';for(var key in params){src+=sep+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(key)+'='+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(params[key]);sep='&';}var styles=document.getElementsByTagName('style');if(styles.length>0){var reSrc=src.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");if(styles[0].innerHTML.search(new RegExp('@import url\\(\'.*'+reSrc+'\'\\);','gm'))>-1){return;}}var links=document.getElementsByTagName('link');for(var i=0;i<links.length;i++){var href=links[i].href;if(href.length>=src.length){var end=href.substr(href.length-src.length);if(end==src){return;}}}var link=document.createElement('link');link.rel='stylesheet';link.type='text/css';link.href=src;head[0].appendChild(link);};D2L.LP.Web.UI.Html.Style.IncludeStyleBlock=function(css){var head=document.getElementsByTagName('head');if(head.length!=1){return;}var lastStyle=document.getElementById('d2l-style-block');if(lastStyle){css=lastStyle.innerHTML+css;lastStyle.parentNode.removeChild(lastStyle);}var style=document.createElement('style');style.id='d2l-style-block';try{style.appendChild(document.createTextNode(css));}catch(e){if(style.styleSheet){style.styleSheet.cssText=css;}}head[0].appendChild(style);return style;};D2L.LP.Web.UI.Html.Style.OverlayPosition={Top:1,Right:2,Bottom:3,Left:4,Mouse:5};D2L.LocalDateTime=D2L.Class.Create({Construct:function(year,month,day,hour,minute,second){var now=new Date();this.m_year=year!==undefined?year:now.getFullYear();this.m_month=month!==undefined?month:now.getMonth()+1;this.m_day=day!==undefined?day:now.getDate();this.m_hour=hour!==undefined?hour:now.getHours();this.m_minute=minute!==undefined?minute:now.getMinutes();this.m_second=second!==undefined?second:now.getSeconds();},_deserialize:function(deserializer){this.m_year=deserializer.GetMember('Year');this.m_month=deserializer.GetMember('Month');this.m_day=deserializer.GetMember('Day');this.m_hour=deserializer.GetMember('Hour');this.m_minute=deserializer.GetMember('Minute');this.m_second=deserializer.GetMember('Second');},_serialize:function(serializer){serializer.AddMember('Year',this.m_year);serializer.AddMember('Month',this.m_month);serializer.AddMember('Day',this.m_day);serializer.AddMember('Hour',this.m_hour);serializer.AddMember('Minute',this.m_minute);serializer.AddMember('Second',this.m_second);},GetYear:function(){return this.m_year;},GetMonth:function(){return this.m_month;},GetDay:function(){return this.m_day;},GetHour:function(){return this.m_hour;},GetMinute:function(){return this.m_minute;},GetSecond:function(){return this.m_second;},GetDateString:function(){var ret;ret=this.GetYear();ret+=this.PadInt(this.GetMonth(),2);ret+=this.PadInt(this.GetDay(),2);ret+=this.PadInt(this.GetHour(),2);ret+=this.PadInt(this.GetMinute(),2);return ret;},GetTimestamp:function(){var date=new Date(this.GetYear(),this.GetMonth()-1,this.GetDay(),this.GetHour(),this.GetMinute(),this.GetSecond(),0);return date.getTime();},PadInt:function(val,digits){var ret=val.toString();while(ret.length<digits){ret='0'+ret;}return ret;}});D2L.LocalDateTime.ToJavaScriptDate=function(localDateTime){return new Date(localDateTime.GetYear(),localDateTime.GetMonth()-1,localDateTime.GetDay(),localDateTime.GetHour(),localDateTime.GetMinute(),localDateTime.GetSecond(),0);};D2L.LocalDateTime.FromJavaScriptDate=function(jsDate){return new D2L.LocalDateTime(jsDate.getFullYear(),jsDate.getMonth()+1,jsDate.getDate(),jsDate.getHours(),jsDate.getMinutes(),jsDate.getSeconds());};D2L.LocalDateTime.Compare=function(first,second,ignoreTime){if(ignoreTime){first=new D2L.LocalDateTime(first.GetYear(),first.GetMonth(),first.GetDay());second=new D2L.LocalDateTime(second.GetYear(),second.GetMonth(),second.GetDay());}var firstJsDate=D2L.LocalDateTime.ToJavaScriptDate(first);var secondJsDate=D2L.LocalDateTime.ToJavaScriptDate(second);if(firstJsDate<secondJsDate){return-1;}else if(firstJsDate>secondJsDate){return 1;}else{return 0;}};D2L.LocalTime=D2L.Class.Create({Construct:function(hour,minute,second){var now=new Date();this.m_hour=hour!==undefined?hour:now.getHours();this.m_minute=minute!==undefined?minute:now.getMinutes();this.m_second=second!==undefined?second:now.getSeconds();},_deserialize:function(deserializer){this.m_hour=deserializer.GetMember('Hour');this.m_minute=deserializer.GetMember('Minute');this.m_second=deserializer.GetMember('Second');},_serialize:function(serializer){serializer.AddMember('Hour',this.m_hour);serializer.AddMember('Minute',this.m_minute);serializer.AddMember('Second',this.m_second);},GetHour:function(){return this.m_hour;},GetMinute:function(){return this.m_minute;},GetSecond:function(){return this.m_second;}});D2L.UtcDateTime=D2L.Class.Create({Construct:function(){this.m_ticks=null;},_deserialize:function(deserializer){if(deserializer.HasMember('Ticks')){this.m_ticks=deserializer.GetMember('Ticks');}},_serialize:function(serializer){if(this.m_ticks!=null){serializer.AddMember('Ticks',this.m_ticks);}}});D2L.LP.LayeredArch.SelectionFilterType={None:0,All:1,AllExcept:2,Some:3};D2L.LP.Web.Serialization={Json:{},Url:{}};D2L.LP.Web.Serialization.Serializer=D2L.Class.Extend({Construct:function(){this.m_scopeString='';this.m_values=[];},AddMember:function(name,value){var type=typeof value;if(type==='undefined'||type==='function'){return;}if(type==='number'||type==='boolean'||type==='string'||value===null){this.m_values.push([this.m_scopeString+name,value]);}else if(D2L.LP.Web.UI.Html.JavaScript.IsArray(value)){var isObjArray=value.length>0&&typeof value[0]==='object';for(var i=0;i<value.length;i++){if(isObjArray&&i>0){this.AddMember(name+'`'+i,value[i]);}else{this.AddMember(name,value[i]);}}}else if(type==='object'){this.m_scopeString+=name+'$';if(value._serialize!==undefined){value._serialize(this);}else{for(var key in value){this.AddMember(key,value[key]);}}this.m_scopeString=this.m_scopeString.substr(0,this.m_scopeString.length-(name.length+1));}},GetMembers:function(){return this.m_values;}});D2L.LP.Web.Serialization.Json.Deserialize=function(jsonString){if(jsonString===undefined||jsonString===null||typeof jsonString!=='string'){return undefined;}var typeReviver=function(value){var type=D2L.LP.Web.Serialization.Json.GetType(this,value._type);if(type!==undefined&&type.func!==undefined){var obj=new type.func();if(obj._deserialize!==undefined){obj._deserialize(new D2L.LP.Web.Serialization.Json.Deserializer(value));value=obj;}}return value;};var functionReviver=function(value){return D2L.LP.Web.Serialization.Json.FunctionReviver(this,value);};var dictionaryReviver=function(value){return D2L.LP.Web.Serialization.Json.DictionaryReviver(this,value);};var normalizeType=function(t){if(t=='url'){return'D2L.LP.Web.Http.UrlLocation';}else if(t=='id'){return'D2L.LP.Web.UI.Html.AbsoluteHtmlId';}return t;};var json=JSON.parse(jsonString,function(key,value){if(value===undefined||value===null||value._type===undefined){return value;}var ret;value._type=normalizeType(value._type);if(value._type=='D2L.LP.Util.Dictionary'){ret=dictionaryReviver(value);}else if(value._type=='call'){ret=functionReviver(value);ret._isCall=true;}else if(value._type=='func'){ret=functionReviver(value);}else if(value._type=='pipe'){value.N='D2L.LP.Web.UI.Html.JavaScript.CallFunctionPipeline';value.D=true;ret=functionReviver(value);}else{ret=typeReviver(value);}return ret;});return json;};D2L.LP.Web.Serialization.Json.Deserializer=D2L.Class.Create({Construct:function(json){this.m_json=json;},GetMember:function(name,defaultValue){return this.HasMember(name)?this.m_json[name]:defaultValue;},HasMember:function(name){return this.m_json[name]!==undefined;}});D2L.LP.Web.Serialization.Json.DictionaryReviver=function(win,dict){delete dict['_type'];var isDelayed=false;var dictKeys=[];var newDict={};for(var key in dict){var val=dict[key];dictKeys.push(key);if(val!==undefined&&val!==null&&val._isDelayed===true){isDelayed=true;}}if(!isDelayed){return dict;}var fixParam=D2L.LP.Web.Serialization.Json.FunctionReviver.FixParam;var evt=new D2L.LP.Web.UI.Events.Event();evt._isDelayed=true;var buildParam=function(index){if(index==dictKeys.length){evt.Trigger(newDict);return;}var p=dict[dictKeys[index]];if(p===undefined||p===null||p._isDelayed===undefined||p._isDelayed===false){newDict[dictKeys[index]]=fixParam(p);buildParam(++index);return;}if(p._isCall===true){p=p();}p.AddListener(function(v){newDict[dictKeys[index]]=fixParam(v);buildParam(++index);});p.AddReleaseListener(function(){evt.Release();});};setTimeout(function(){buildParam(0);},0);return evt;};D2L.LP.Web.Serialization.Json.GetType=function(type,typeString){var typeSegments=typeString.replace(/\+/g,'.').split('.');var prevType=type;for(var i=0;i<typeSegments.length;i++){if(type[typeSegments[i]]===undefined){return undefined;}prevType=type;type=type[typeSegments[i]];}if(i!=typeSegments.length){return undefined;}return{obj:prevType,func:type};};D2L.LP.Web.Serialization.Json.FunctionReviver=function(win,value){var type=D2L.LP.Web.Serialization.Json.GetType(win,value.N);if(type===undefined){throw'Unrecognized function \''+value.N+'\'.';}if(value.P===undefined){value.P=[];}var isParamDelayed=false;for(var i=0;i<value.P.length;i++){var p=value.P[i];if(p!==undefined&&p!==null&&p._isDelayed===true){isParamDelayed=true;break;}}var fixParam=D2L.LP.Web.Serialization.Json.FunctionReviver.FixParam;var retFunc=function(){var evt=new D2L.LP.Web.UI.Events.Event();evt._isDelayed=true;var isDelayed=value.D===true;var params=[];var args=arguments;var callFunction=function(){for(var i=0;i<args.length;i++){params.push(args[i]);}if(type.func.apply===undefined){evt.Release();throw'\''+value.N+'\' is not a function.';}return type.func.apply(type.obj,params);};if(!isDelayed&&!isParamDelayed){for(var i=0;i<value.P.length;i++){params.push(fixParam(value.P[i]));}return callFunction();}var finish=function(){if(isDelayed){var result=callFunction();if(result){result.AddListener(function(val){evt.Trigger(val);});result.AddReleaseListener(function(){evt.Release();});}else{evt.Release();}}else{evt.Trigger(callFunction());}};var buildParam=function(index){if(index==value.P.length){finish();return;}var p=value.P[index];if(p===undefined||p===null||p._isDelayed===undefined||p._isDelayed===false){params.push(fixParam(p));buildParam(++index);return;}if(p._isCall===true){p=p();}p.AddListener(function(val){params.push(fixParam(val));buildParam(++index);});p.AddReleaseListener(function(){evt.Release();});};setTimeout(function(){buildParam(0);},0);return evt;};if(value._type=='call'){retFunc._isDelayed=value.D===true||isParamDelayed;}return retFunc;};D2L.LP.Web.Serialization.Json.FunctionReviver.FixParam=function(p){if(p===undefined||p===null){return p;}if(typeof p=='object'){var origP=p;p=new p.constructor();for(var key in origP){p[key]=D2L.LP.Web.Serialization.Json.FunctionReviver.FixParam(origP[key]);}}if(p._isCall){p=p();}return p;};if(!this.JSON){this.JSON={};}(function(){function f(n){return n<10?'0'+n:n;}if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z':null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf();};}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key);}if(typeof rep==='function'){value=rep.call(holder,key,value);}switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null';}v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v;}if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==='string'){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v;}}if(typeof JSON.stringify!=='function'){JSON.stringify=function(value,replacer,space){var i;gap='';indent='';if(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' ';}}else if(typeof space==='string'){indent=space;}rep=replacer;if(replacer&&typeof replacer!=='function'&&(typeof replacer!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify');}return str('',{'':value});};}if(typeof JSON.parse!=='function'){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}return reviver.call(holder,key,value);}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);});}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j;}throw new SyntaxError('JSON.parse');};}})();D2L.LP.Web.Serialization.Url.Serialize=function(value){if(value===undefined||value===null){return'';}if(typeof value!=='object'){return value.toString();}var serializer=new D2L.LP.Web.Serialization.Url.Serializer();for(var key in value){serializer.AddMember(key,value[key]);}return serializer.Serialize();};D2L.LP.Web.Serialization.Url.Serializer=D2L.LP.Web.Serialization.Serializer.Extend({Construct:function(){arguments.callee.$.Construct.call(this);},Serialize:function(){var ret='';var delim='';var values=this.GetMembers();for(var i=0;i<values.length;i++){var kvp=values[i];ret+=delim+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(kvp[0])+'='+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(kvp[1]);delim='&';}return ret;}});D2L.LP.Globalization.Formatting.DateTime={};D2L.LP.Globalization.Formatting.DateTime.Exceptions={InvalidDateFormat:0,UnsupportedInputDateFormat:1};D2L.LP.Globalization.Formatting.DateTime.FormatPart=D2L.Class.extend({Construct:function(partType,partFormat){this.Type=partType;this.Format=partFormat;}});D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type={Day:0,Month:1,Year:2,Hour:3,Minute:4,Second:5};D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatTokenizer=D2L.Class.extend({Construct:function(dateFormat){this.m_dateFormatSeparator=null;this.m_dateFormatParts=null;this.m_dateFormat=dateFormat;},GetSeparator:function(){if(this.m_dateFormatSeparator==null){var re=new RegExp('\\W');var match=re.exec(this.m_dateFormat);if(match!=null){this.m_dateFormatSeparator=match[0];}}return this.m_dateFormatSeparator;},GetParts:function(){var result=[];var separator=this.GetSeparator();if(separator==null){return null;}var parts=this.m_dateFormat.split(separator);if(parts.length!=3){return null;}var isNotSupported=false;for(var i=0;i<parts.length;i++){part=parts[i].trim();if(part=='dd'||part=='d'){result.push(new D2L.LP.Globalization.Formatting.DateTime.FormatPart(D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Day,part));}else if(part=='MM'||part=='M'){result.push(new D2L.LP.Globalization.Formatting.DateTime.FormatPart(D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Month,part));}else if(part=='yyyy'){result.push(new D2L.LP.Globalization.Formatting.DateTime.FormatPart(D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Year,part));}else{isNotSupported=true;}}if(isNotSupported){return null;}else{return result;}}});D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatter=D2L.Class.extend({Construct:function(dateTimeFormatDescriptor,fuzzyDateTimeDescriptor){fuzzyDateTimeDescriptor.ClientNow=new Date();this.m_dateTimeFormatDescriptor=dateTimeFormatDescriptor;this.m_fuzzyDateTimeDescriptor=fuzzyDateTimeDescriptor;},FormatInputDate:function(date){var inputDateTimeFormatTokenizer=new D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatTokenizer(this.m_dateTimeFormatDescriptor.InputDateFormat);var separator=inputDateTimeFormatTokenizer.GetSeparator();var dateParts=inputDateTimeFormatTokenizer.GetParts();if(separator!=null&&dateParts!=null){var formattedDate='';for(var i=0;i<dateParts.length;i++){var datePart=dateParts[i];if(datePart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Day){formattedDate+=this.PrePadByZero(date.GetDay(),datePart.Format.length);}else if(datePart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Month){formattedDate+=this.PrePadByZero(date.GetMonth(),datePart.Format.length);}else if(datePart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Year){formattedDate+=date.GetYear().toString();}if(i<dateParts.length-1){formattedDate+=separator;}}return formattedDate;}},FormatDateTime:function(dateTime,format){var formats=D2L.LP.Globalization.Formatting.DateTime.Formats;if(format===undefined){format=formats.LongDateTime;}var dateTimeJs=D2L.LocalDateTime.ToJavaScriptDate(dateTime);switch(format){case formats.Time:var time=new D2L.LocalTime(dateTime.GetHour(),dateTime.GetMinute(),dateTime.GetSecond());return this.FormatTime(time);case formats.MonthAndDay:return this.FormatDateTime(dateTime,formats.ShortMonthName)+' '+dateTime.GetDay();case formats.LongMonthAndDay:return this.FormatDateTime(dateTime,formats.LongMonthName)+' '+dateTime.GetDay();case formats.ShortMonthName:return this.m_dateTimeFormatDescriptor.ShortMonthNames[dateTime.GetMonth()-1];case formats.LongMonthName:return this.m_dateTimeFormatDescriptor.LongMonthNames[dateTime.GetMonth()-1];case formats.ShortDayOfWeek:var dayOfWeekIndex=dateTimeJs.getDay();return this.m_dateTimeFormatDescriptor.ShortDayOfWeekNames[dayOfWeekIndex];default:throw'Unsupported DateTime format: \''+format+'\'.';}},FormatTime:function(time){var jsDate=new Date();jsDate.setHours(time.GetHour());jsDate.setMinutes(time.GetMinute());jsDate.setSeconds(time.GetSecond());return D2L.Intl.FormatTime(jsDate);},FormatFuzzyDateTime:function(inputDate,nowDate){var fuzzy=this.m_fuzzyDateTimeDescriptor;var formats=D2L.LP.Globalization.Formatting.DateTime.Formats;if(nowDate===undefined){nowDate=fuzzy.Now;}var thirtySec=30*1000;var oneMin=60*1000;var thirtyMin=30*oneMin;var fortyFiveMin=45*oneMin;var oneHour=60*oneMin;var sixHour=6*oneHour;var inputDateJs=D2L.LocalDateTime.ToJavaScriptDate(inputDate);var nowDateJs=D2L.LocalDateTime.ToJavaScriptDate(nowDate);var sameYear=inputDate.GetYear()===nowDate.GetYear();var sameDay=sameYear&&inputDate.GetMonth()===nowDate.GetMonth()&&inputDate.GetDay()===nowDate.GetDay();var midnight=new Date(nowDateJs.getFullYear(),nowDateJs.getMonth(),nowDateJs.getDate());var tomorrow=new Date(midnight.getTime()+24*oneHour);var yesterday=new Date(midnight.getTime()-24*oneHour);var threeDaysAgo=new Date(midnight.getTime()-3*24*oneHour);var timespan=nowDateJs.getTime()-inputDateJs.getTime();var text=this.FormatDateTime(inputDate,formats.MonthAndDay);if(!sameYear){text+=', '+inputDate.GetYear();}text+=' '+this.FormatDateTime(inputDate,formats.Time);var timeout=-1;if(timespan<0){timeout=timespan*-1;}else if(timespan<thirtySec){text=fuzzy.JustNow;timeout=thirtySec-timespan;}else if(timespan<oneMin+thirtySec){text=fuzzy.OneMinuteAgo;timeout=oneMin+thirtySec-timespan;}else if(timespan<2*oneMin+thirtySec){text=fuzzy.TwoMinutesAgo;timeout=2*oneMin+thirtySec-timespan;}else if(timespan<fortyFiveMin){var seconds=timespan%oneMin;var nextMin=seconds<thirtySec?thirtySec-seconds:oneMin-(seconds-thirtySec);var timeUntilFortyFiveMin=fortyFiveMin-timespan;var minutesRounded=Math.round(timespan%oneHour/oneMin);text=fuzzy.MinutesAgoMany.replace('[0]',minutesRounded);timeout=Math.min(nextMin,timeUntilFortyFiveMin);}else if(timespan<sixHour||sameDay){var minutes=timespan%oneHour;var nextHour=minutes<thirtyMin?thirtyMin-minutes:oneHour-(minutes-thirtyMin);var timeUntilSixHour=sixHour-timespan;if(timespan<oneHour+thirtyMin){text=fuzzy.OneHourAgo;}else if(timespan<oneHour*2+thirtyMin){text=fuzzy.TwoHoursAgo;}else{var hoursRounded=Math.round(timespan%(oneHour*24)/oneHour);text=fuzzy.ManyHoursAgo.replace('[0]',hoursRounded);}timeout=!sameDay&&timeUntilSixHour>0?timeUntilSixHour:nextHour;}else if(inputDateJs>threeDaysAgo){if(inputDateJs>yesterday){text=fuzzy.YesterdayTime.replace('[0]',this.FormatDateTime(inputDate,formats.Time));}else{text=fuzzy.DayOfWeekTime.replace('[0]',this.FormatDateTime(inputDate,formats.ShortDayOfWeek)).replace('[1]',this.FormatDateTime(inputDate,formats.Time));}timeout=tomorrow.getTime()-nowDateJs.getTime();}else if(sameYear){var endOfYear=new Date(nowDateJs.getFullYear()+1,0,1);var timeUntilEndOfYear=endOfYear.getTime()-nowDateJs.getTime();timeout=timeUntilEndOfYear;text=fuzzy.MonthDayTime.replace('[0]',this.FormatDateTime(inputDate,formats.LongMonthAndDay)).replace('[1]',this.FormatDateTime(inputDate,formats.Time));}if(timeout>0){timeout=Math.max(timeout,1000);}return{timeout:timeout,text:text};},PrePadByZero:function(input,maxNum){input=input.toString();var zero='0';while(zero.length>0&&input.length<maxNum){input=zero+input;}return input;}});D2L.LP.Globalization.Formatting.DateTime.DateTimeParser=D2L.Class.extend({Construct:function(dateTimeFormatDescriptor,numberParser){this.m_dateTimeFormatDescriptor=dateTimeFormatDescriptor;this.m_numberParser=numberParser;},TryParseInputDate:function(dateString){var inputDateTimeFormatTokenizer=new D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatTokenizer(this.m_dateTimeFormatDescriptor.InputDateFormat);var calendarSpecificYear=null;var calendarSpecificMonth=null;var calendarSpecificDay=null;dateString=dateString.toString().trim();var separator=inputDateTimeFormatTokenizer.GetSeparator();var dateFormatParts=inputDateTimeFormatTokenizer.GetParts();if(separator!=null&&dateFormatParts!=null){var dateParts=dateString.split(separator);if(dateParts.length!=dateFormatParts.length){throw D2L.LP.Globalization.Formatting.DateTime.Exceptions.InvalidDateFormat;}for(var i=0;i<dateFormatParts.length;i++){var dateFormatPart=dateFormatParts[i];try{var partValue=this.m_numberParser.ParseInteger(dateParts[i]);}catch(e){throw D2L.LP.Globalization.Formatting.DateTime.Exceptions.InvalidDateFormat;}if(dateFormatPart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Year){calendarSpecificYear=partValue;}else if(dateFormatPart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Month){calendarSpecificMonth=partValue;}else if(dateFormatPart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Day){calendarSpecificDay=partValue;}}if(!this.ValidateDate(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay)){return null;}return new D2L.LocalDateTime(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay,0,0,0);}else{throw D2L.LP.Globalization.Formatting.DateTime.Exceptions.UnsupportedInputDateFormat;}},TryParseTime:function(input){var dateTime=D2L.Intl.ParseTime(input);if(dateTime===undefined||dateTime===null){return null;}var time=new D2L.LocalTime(dateTime.getHours(),dateTime.getMinutes(),0);return time;},ValidateDate:function(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay){var year=calendarSpecificYear;var month=calendarSpecificMonth;var day=calendarSpecificDay;if(isNaN(year)||year<1753||year>9999){return false;}if(isNaN(month)||month<1||month>12){return false;}if(isNaN(day)||day<1||day>31){return false;}var allowedDays=31;if(month===2){if(year%4===0&&(!(year%100===0)||year%400===0)){allowedDays=29;}else{allowedDays=28;}}else if(month===4||month===6||month===9||month===11){allowedDays=30;}if(day>allowedDays){return false;}return true;}});D2L.LP.Globalization.Formatting.DateTime.Formats={LongDate:'LongDate',StandardDate:'StandardDate',ShortDate:'ShortDate',LongDateTime:'LongDateTime',StandardDateTime:'StandardDateTime',ShortDateTime:'ShortDateTime',Time:'Time',MonthAndYear:'MonthAndYear',MonthAndDay:'MonthAndDay',LongMonthAndDay:'LongMonthAndDay',LongMonthName:'LongMonthName',ShortMonthName:'ShortMonthName',LongDayOfWeek:'LongDayOfWeek',ShortDayOfWeek:'ShortDayOfWeek',InputDate:'InputDate'};D2L.LP.Globalization.Formatting.DateTime.FuzzyDate={initialize:function(node){this.MAX_TIMEOUT=1073741824;this.formatter=D2L.LP.Globalization.Locale.GetDateTimeFormatter();this.node=node;this.$node=$(node);var bypassAttr=this.$node.attr('data-bypass');if(bypassAttr!==undefined){return;}this.$node.attr('aria-live','off');this.dateTimeFromServer=D2L.LocalDateTime.FromJavaScriptDate(new Date(parseInt(this.$node.attr('data-date'))));this.pageLoadNowDateJs=new Date(parseInt(this.formatter.m_fuzzyDateTimeDescriptor.Now));this.initialNowDate=this.getNowDate();var format=this.formatter.FormatFuzzyDateTime(this.dateTimeFromServer,this.initialNowDate);if(format.timeout>0&&format.timeout<this.MAX_TIMEOUT){setTimeout(this.updateText.bind(this),format.timeout);}},getNowDate:function(){var nowDateJs=new Date(this.pageLoadNowDateJs.getTime()+this.getPageLoadOffSet());return D2L.LocalDateTime.FromJavaScriptDate(nowDateJs);},getPageLoadOffSet:function(){var pageLoadTime=this.formatter.m_fuzzyDateTimeDescriptor.ClientNow.getTime();var now=new Date().getTime();return now-pageLoadTime;},updateText:function(){var parent=this.node.parentNode;while(parent!==null&&parent!==this.node.ownerDocument){parent=parent.parentNode;}if(parent===null){return;}var newNowDate=this.getNowDate();var newFormat=this.formatter.FormatFuzzyDateTime(this.dateTimeFromServer,newNowDate);this.$node.text(newFormat.text);if(newFormat.timeout>0&&newFormat.timeout<this.MAX_TIMEOUT){setTimeout(this.updateText.bind(this),newFormat.timeout);}}};D2L.LP.Globalization.Formatting.Number={};D2L.LP.Globalization.Formatting.Number.NumberFormatDescriptor=D2L.Class.extend({Construct:function(decimalSeparator,groupSeparator,numberNegativePattern,percentPositivePattern,percentNegativePattern,percentSymbol,negativeSign,nativeDigits,useNativeDigits,groupSizes,integerRegex,decimalRegex){this.DecimalSeparator=decimalSeparator;this.GroupSeparator=groupSeparator;this.NumberNegativePattern=numberNegativePattern;this.PercentPositivePattern=percentPositivePattern;this.PercentNegativePattern=percentNegativePattern;this.PercentSymbol=percentSymbol;this.NegativeSign=negativeSign;this.NativeDigits=nativeDigits;this.UseNativeDigits=useNativeDigits;this.GroupSizes=groupSizes;this.IntegerRegex=integerRegex;this.DecimalRegex=decimalRegex;},_deserialize:function(deserializer){this.DecimalSeparator=deserializer.GetMember('DecimalSeparator');this.GroupSeparator=deserializer.GetMember('GroupSeparator');this.NumberNegativePattern=deserializer.GetMember('NumberNegativePattern');this.PercentPositivePattern=deserializer.GetMember('PercentPositivePattern');this.PercentNegativePattern=deserializer.GetMember('PercentNegativePattern');this.PercentSymbol=deserializer.GetMember('PercentSymbol');this.NegativeSign=deserializer.GetMember('NegativeSign');this.NativeDigits=deserializer.GetMember('NativeDigits');this.UseNativeDigits=deserializer.GetMember('UseNativeDigits');this.GroupSizes=deserializer.GetMember('GroupSizes');this.IntegerRegex=deserializer.GetMember('IntegerRegex');this.DecimalRegex=deserializer.GetMember('DecimalRegex');}});D2L.LP.Globalization.Formatting.Domain.Default.NumberFormatDescriptor=D2L.LP.Globalization.Formatting.Number.NumberFormatDescriptor;D2L.LP.Globalization.Formatting.Number.NumberFormatter=D2L.Class.extend({Construct:function(){},FormatInteger:function(value){return D2L.Intl.FormatNumber(value,{maximumFractionDigits:0});},FormatDecimal:function(value,numOfDecimalPoints,trailingZeroes){var options={};if(numOfDecimalPoints!==undefined&&numOfDecimalPoints!==null){options.maximumFractionDigits=numOfDecimalPoints;if(trailingZeroes){options.minimumFractionDigits=numOfDecimalPoints;}}else{options.maximumFractionDigits=15;}return D2L.Intl.FormatNumber(value,options);}});D2L.LP.Globalization.Formatting.Number.NumberParser=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor;},ParseInteger:function(value){if(value===undefined||value===null){return 0;}value=value.trim();if(value==''||value=='-'){return 0;}if(this.m_numberFormatDescriptor.GroupSeparator!=' '){value=value.replace(' ','');}else{value=value.replace(/^\s*|\s(?=\s)|\s*$/g,"");}var re=new RegExp(this.m_numberFormatDescriptor.IntegerRegex);if(!re.test(value)){throw'Invalid Integer';}value=value.replace(new RegExp('['+this.m_numberFormatDescriptor.GroupSeparator+']','g'),'');var num=D2L.Intl.ParseNumber(value);if(isNaN(num)){throw'Invalid Integer';}return num;},ParseDecimal:function(value){if(value===undefined||value===null){return 0;}value=value.trim();if(value==''){return 0;}if(this.m_numberFormatDescriptor.GroupSeparator!=' '){value=value.replace(' ','');}else{value=value.replace(/^\s*|\s(?=\s)|\s*$/g,"");}var re=new RegExp(this.m_numberFormatDescriptor.DecimalRegex);if(!re.test(value)){throw'Invalid Decimal';}value=value.replace(new RegExp('['+this.m_numberFormatDescriptor.GroupSeparator+']','g'),'');var num=D2L.Intl.ParseNumber(value);if(isNaN(num)){throw'Invalid Decimal';}return num;}});D2L.LP.Globalization.Formatting.Text={};D2L.LP.Globalization.Formatting.Text.TextDirection={LeftToRight:1,RightToLeft:2};D2L.LP.Globalization.Locale={};D2L.LP.Globalization.Locale.Init=function(numberFormatDescriptor,dateTimeFormatDescriptor,textFormatDescriptor,cultureCode,fuzzyDateTimeDescriptor){D2L.LP.Globalization.Locale=new D2L.LP.Globalization.LocaleObject(numberFormatDescriptor,dateTimeFormatDescriptor,textFormatDescriptor,cultureCode,fuzzyDateTimeDescriptor);};D2L.LP.Globalization.LocaleObject=D2L.Class.extend({Construct:function(numberFormatDescriptor,dateTimeFormatDescriptor,textFormatDescriptor,cultureCode,fuzzyDateTimeDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor;this.m_dateTimeFormatDescriptor=dateTimeFormatDescriptor;this.m_textFormatDescriptor=textFormatDescriptor;this.m_culture=cultureCode;this.m_fuzzyDateTimeDescriptor=fuzzyDateTimeDescriptor;this.m_numberParser=null;this.m_numberFormatter=null;this.m_dateTimeParser=null;this.m_dateTimeFormatter=null;},GetNumberFormatDescriptor:function(){return this.m_numberFormatDescriptor;},GetNumberParser:function(){if(this.m_numberParser===null){this.m_numberParser=new D2L.LP.Globalization.Formatting.Number.NumberParser(this.GetNumberFormatDescriptor());}return this.m_numberParser;},GetNumberFormatter:function(){if(this.m_numberFormatter===null){this.m_numberFormatter=new D2L.LP.Globalization.Formatting.Number.NumberFormatter();}return this.m_numberFormatter;},GetDateTimeFormatDescriptor:function(){return this.m_dateTimeFormatDescriptor;},GetFuzzyDateTimeDescriptor:function(){return this.m_fuzzyDateTimeDescriptor;},GetDateTimeParser:function(){if(this.m_dateTimeParser===null){this.m_dateTimeParser=new D2L.LP.Globalization.Formatting.DateTime.DateTimeParser(this.GetDateTimeFormatDescriptor(),this.GetNumberParser());}return this.m_dateTimeParser;},GetDateTimeFormatter:function(){if(this.m_dateTimeFormatter===null){this.m_dateTimeFormatter=new D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatter(this.GetDateTimeFormatDescriptor(),this.GetFuzzyDateTimeDescriptor());}return this.m_dateTimeFormatter;},GetTextFormatDescriptor:function(){return this.m_textFormatDescriptor;},GetCultureCode:function(){return this.m_culture;}});D2L.RemovePaddingElement=function(iframeEl){var paddingNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-page-main-padding',iframeEl);if(paddingNode){paddingNode.style.padding='0px';}};D2L.MakeIFrameFullscreen=function(id){var iframe=document.getElementById(id);if(!iframe){return;}document.body.style.overflow='hidden';D2L.RemovePaddingElement(iframe);var resize=function(){var viewportHeight=UI.GetWindowHeight(window);var iframeY=D2L.Util.Dom.FindPosY(iframe);var height=viewportHeight-iframeY;iframe.style.height=height+'px';};setTimeout(resize,1000);UI.OnPageLoad().RegisterMethod(resize);UI.GetWindowEventManager().Resize.RegisterMethod(function(){resize();});};window.addEventListener("message",function(event){if(event.data&&event.data==="d2l-sequence-launcher-hide-padding"){D2L.RemovePaddingElement(document.querySelector('iframe'));}});D2L.Util={};if(String.prototype.trim===undefined){String.prototype.trim=function(){return this.replace(/^\s+/,'').replace(/\s+$/,'');};}D2L.Util.Url={};D2L.Util.Url.Encode=function(str){var ret=encodeURIComponent(str);ret=ret.replace('\'','%27');ret=ret.replace('%2F','/');ret=ret.replace('%2C',',');return ret;};D2L.Util.Url.Decode=function(str){return decodeURIComponent(str);};D2L.Util.Dictionary=D2L.Class.extend({Construct:function(){this.m_keys=[];this.m_dict={};this.m_values=[];arguments.callee.$.Construct.call(this);},Add:function(key,value){var found=false;for(var i=0;i<this.m_keys.length;i++){if(this.m_keys[i]==key){this.m_values[i]=value;found=true;break;}}if(!found){this.m_keys.push(key);this.m_values.push(value);}this.m_dict[key]=value;},ContainsKey:function(key){for(var i=0;i<this.m_keys.length;i++){if(this.m_keys[i]==key){return true;}}return false;},GetCount:function(){return this.m_keys.length;},Get:function(key){if(this.m_dict[key]!==undefined){return this.m_dict[key];}return undefined;},Keys:function(){return this.m_keys;},Remove:function(key){for(var i=0;i<this.m_keys.length;i++){if(this.m_keys[i]==key){this.m_keys.splice(i,1);this.m_values.splice(i,1);this.m_dict[key]=undefined;return true;}}return false;},Values:function(){return this.m_values;},Serialize:function(serializer){for(var i=0;i<this.m_keys.length;i++){serializer.AddMember(this.m_keys[i],this.Get(this.m_keys[i]));}},Deserialize:function(deserializer){var keys=deserializer.Keys();for(var i=0;i<keys.length;i++){this.Add(keys[i],deserializer.GetMember(keys[i]));}}});D2L.Util.StringBuilder=D2L.Class.extend({Construct:function(initialValue){this.m_buffer=new Array("");if(initialValue!==undefined){this.Append(initialValue);}},Append:function(value){this.m_buffer.push(value);},ToString:function(){return this.m_buffer.join("");}});D2L.LP.Web.UI.Desktop={CompositeViews:{},Controls:{},MasterPages:{}};D2L.LP.Web.UI.Desktop.MasterPages.Immersive={MakeImmersive:function(node){var hideSiblings=function(currNode){if(!currNode){return;}if(!currNode.parentElement){return;}currNode.parentElement.classList.add('immersive-parent');if(currNode.parentElement.children){var siblings=currNode.parentElement.children;var index=0;for(index=0;index<siblings.length;index++){if(siblings[index]!==currNode){siblings[index].setAttribute("data-immersive-hidden","true");}}}hideSiblings(currNode.parentElement);};hideSiblings(node);node.classList.add('immersive');},RemoveImmersive:function(node){node.classList.remove('immersive');var allParents=document.querySelectorAll('.immersive-parent');var index=0;for(index=0;index<allParents.length;index++){allParents[index].classList.remove('immersive-parent');}var allHidden=document.querySelectorAll('[data-immersive-hidden]');index=0;for(index=0;index<allHidden.length;index++){allHidden[index].removeAttribute("data-immersive-hidden");}}};D2L.LP.Web.UI.Desktop.MasterPages.Dialog={NumOfDialogs:0,Offset:20,AdaptPageToDialog:function(handle){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var doc=handle.frame.contentWindow.document;var pageHeader=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-page-header',handle.container);if(pageHeader===null){return;}var close=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-dialog-close',handle.container);if(close!==null){return;}close=doc.createElement('a');close.className='d2l-dialog-close vui-outline';me.InitClose(close,handle.frame.contentWindow);pageHeader.insertBefore(close,pageHeader.childNodes[1]);},FreeRangeAppIFramePlugin:function(loadModulesFunction){return function(host){var getContextInfo=function(){var iframe=host.iframe;if(!iframe)return;var rect=iframe.getBoundingClientRect();var availableHeight=window.innerHeight;if(rect.top>0)availableHeight-=rect.top;if(availableHeight>rect.height)availableHeight=rect.height;return{availableHeight:availableHeight,top:rect.top};};var service={showBackdrop:function(){var iframe=host.iframe;if(!iframe)return;loadModulesFunction().AddListener(function(){if(!iframe.id)iframe.id=new D2L.LP.Web.UI.Html.UniqueHtmlId().GetValue();var backdrop=iframe.parentNode.querySelector('d2l-backdrop[for-target="'+iframe.id+'"]');if(!backdrop){backdrop=document.createElement('d2l-backdrop');backdrop.setAttribute('for-target',iframe.id);iframe.parentNode.appendChild(backdrop);}backdrop.setAttribute('shown','shown');iframe.setAttribute('data-d2l-backdrop-position',iframe.style.position);iframe.setAttribute('data-d2l-backdrop-z-index',iframe.style.zIndex);iframe.style.position='relative';iframe.style.zIndex='1000';});return getContextInfo();},hideBackdrop:function(){var iframe=host.iframe;if(!iframe)return;var backdrop=iframe.parentNode.querySelector('d2l-backdrop[for-target="'+iframe.id+'"]');if(!backdrop)return;backdrop.removeAttribute('shown');iframe.style.position=iframe.getAttribute('d2l-backdrop-position');iframe.style.zIndex=iframe.getAttribute('d2l-backdrop-z-index');iframe.removeAttribute('data-d2l-backdrop-position');iframe.removeAttribute('data-d2l-backdrop-z-index');}};host.registerService('dialogWC','0.1',service);};},InitClose:function(node,nodeWin){D2L.LP.Web.UI.Html.Aria.SetRole(node,'button');D2L.LP.Web.UI.Html.Dom.SetAttribute(node,'href','javascript:void(0);');if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(node,'onclick')){D2L.LP.Web.UI.Html.Dom.SetAttribute(node,'onclick','return false;');D2L.LP.Web.UI.Html.Dom.AddEventListener('click',node,function(){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Abort(nodeWin);});}},InitResize:function(node,nodeWin){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var handle=me.GetHandle(nodeWin);var settings={Handle:node,DisplayType:'none',GhostType:D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow};var evt=D2L.LP.Web.UI.Html.DragDrop.MakeResizeableNode(handle.dialog,settings,nodeWin,handle.rootWin);evt.AddListener(function(size){handle.isResized=true;var handlePositionOffset=8;var dialogPadding=me.computeDialogPadding(handle.dialog);if(dialogPadding){handlePositionOffset+=dialogPadding.bottom;handlePositionOffset+=document.dir==='rtl'?dialogPadding.left:dialogPadding.right;}me.SetSize(handle,size.width-handlePositionOffset,size.height-handlePositionOffset);});D2L.LP.Web.UI.Events.OnSizingFinished.AddListener(function(){if(!handle||!handle.container||!handle.body){return;}var rectBody=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.body);handle.bodyDiff=handle.height-rectBody.height;me.SetSize(handle,handle.width,handle.height);});D2L.LP.Web.UI.Events.OnViewRender.AddListener(function(partialNode){if(!handle||!handle.nodes.footer||!handle.container||!handle.body){return;}if(partialNode.nodeType!==1){return;}if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(handle.nodes.footer,partialNode)){return;}var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.container);var height=rect.height;if(handle.height>=height){return;}var footerRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.nodes.footer);height+=footerRect.height;if(handle.height===height){return;}handle.height=height;var rectBody=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.body);handle.bodyDiff=handle.height-rectBody.height;me.SetSize(handle,handle.width,handle.height);});},InitTitle:function(node,nodeWin){var closeNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-dialog-close',node)[0];var handle=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.GetHandle(nodeWin);D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitTitleHelper(handle,handle.dialog,node,closeNode,nodeWin,handle.rootWin);},InitTitleHelper:function(handle,dialogNode,titleNode,closeNode,nodeWin,win){var dragSettings=new D2L.LP.Web.UI.Html.DragDrop.DraggableSettings();dragSettings.SetHandle(titleNode);dragSettings.SetIsDelayed(false);dragSettings.SetDragDropEffect(D2L.LP.Web.UI.Html.DragDrop.DragDropEffect.Move);if(closeNode){dragSettings.AddHandleException(closeNode);}dragSettings.SetGhostType(D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow);dragSettings.GetDragStartEvent().AddListener(function(){handle.isDragged=true;});dragSettings.SetIsAutoScroll(false);D2L.LP.Web.UI.Html.DragDrop.MakeDraggableNode(dialogNode,dragSettings,nodeWin,win);},IsIos:function(){return /iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;},SetWidth:function(width){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var handle=me.GetHandle();width=Math.max(width,400);handle.width=width;handle.dialog.style.width=width+'px';handle.setWidthCalled=true;if(handle.container!==null){handle.container.style.width=width-2+'px';}if(handle.frame!==null){handle.frame.style.width=width-2+'px';}handle.onresize();handle.dialog.OnResize.Trigger();},SetHeight:function(height){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var handle=me.GetHandle();handle.height=height;handle.dialog.style.height=height+'px';if(handle.inner!==null){handle.inner.style.height=height-2+'px';}if(handle.frame!==null){handle.frame.style.height=height-2+'px';}if(handle.body!==null&&handle.nodes.footer!==null){var footerSize=handle.nodes.footer.offsetHeight;handle.body.style.height=height-3-handle.bodyDiff-footerSize+'px';}handle.onresize();handle.dialog.OnResize.Trigger();},SetHeading:function(title){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var handle=me.GetHandle();handle.nodes.heading.textContent=title;},SetSize:function(handle,width,height,ignoreDefaultMinSize){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog,dialogPaddingLeftRight=0,dialogPaddingTopBottom=0;var padding=me.computeDialogPadding(handle.dialog);if(padding){dialogPaddingLeftRight+=padding.left+padding.right;dialogPaddingTopBottom+=padding.top+padding.bottom;}if(ignoreDefaultMinSize!==true){width=me.GetMinWidth(handle,width);height=me.GetMinHeight(handle,height);}handle.width=width;handle.height=height;handle.dialog.style.width=width+dialogPaddingLeftRight*2+'px';handle.dialog.style.height=height+dialogPaddingTopBottom*2+'px';if(handle.container!==null){handle.container.style.width=width-2+'px';}if(handle.inner!==null){handle.inner.style.height=height-2+'px';}if(handle.frame!==null){handle.frame.style.width=width-2+'px';handle.frame.style.height=height-2+'px';}if(handle.body!==null&&handle.nodes.footer!==null){var footerSize=handle.nodes.footer.offsetHeight;handle.body.style.height=height-3-handle.bodyDiff-footerSize+'px';handle.dialog.OnResize.Trigger();}if(handle.setWidthCalled){return;}clearTimeout(handle.heightTimeout);handle.heightTimeout=setTimeout(function(){if(handle.body===null||handle.nodes.title===null||handle.nodes.footer===null){return;}var headerPlusFooterHeight=handle.nodes.title.offsetHeight+handle.nodes.footer.offsetHeight;var newBodyHeight=parseInt(height-headerPlusFooterHeight);handle.body.style.height=newBodyHeight+'px';handle.dialog.OnResize.Trigger();},0);},GetMinWidth:function(handle,width){var minWidth=400;if(handle.container){var dataMinWidth=D2L.LP.Web.UI.Html.Dom.GetAttribute(handle.container,'data-min-width');if(dataMinWidth!==null){minWidth=parseInt(dataMinWidth);}}return Math.max(width,minWidth);},GetMinHeight:function(handle,height){var minHeight=400;if(handle.container){var dataMinHeight=D2L.LP.Web.UI.Html.Dom.GetAttribute(handle.container,'data-min-height');if(dataMinHeight!==null){minHeight=parseInt(dataMinHeight);}}return Math.max(height,minHeight);},ComputeDialogWidthHeightFromPreferred:function(settings,viewportDimensions){var minTotalHorizontalMargin=2*settings.PreferredSize.MinHorizontalMargin;var minTotalVerticalMargin=2*settings.PreferredSize.MinVerticalMargin;settings.Width=settings.PreferredSize.PreferredWidth;settings.Height=settings.PreferredSize.PreferredHeight;if(settings.PreferredSize.PreferredWidth+minTotalHorizontalMargin>viewportDimensions.width){settings.Width=viewportDimensions.width-minTotalHorizontalMargin;}if(settings.PreferredSize.PreferredHeight+minTotalVerticalMargin>viewportDimensions.height){settings.Height=viewportDimensions.height-minTotalVerticalMargin;}},Build:function(handle,form,location,settings){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;if(settings.PreferredSize!=null){me.ComputeDialogWidthHeightFromPreferred(settings,D2L.LP.Web.UI.Html.Dom.GetViewportSize(handle.rootWin));}handle.width=settings.Width?settings.Width:400;handle.height=settings.Height?settings.Height:300;var dialogHeight=handle.height;var loadedOnce=false;var adjustSize=function(){var scroll=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(handle.rootWin);handle.dialog.style.top=scroll.top+50+handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.NumOfDialogs*handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Offset+'px';me.SetSize(handle,handle.width,handle.height);};handle.dialog=handle.rootWin.document.createElement('div');handle.dialog.OnResize=new D2L.LP.Web.UI.Events.Event();handle.dialog.className='d2l-dialog d2l-dialog-mvc d2l-dialog-loading';handle.dialog.d2l_handle=handle;handle.firstLoadEvent=new D2L.LP.Web.UI.Events.Event();handle.inner=handle.rootWin.document.createElement('div');handle.inner.className='d2l-dialog-inner';handle.dialog.appendChild(handle.inner);var frameId=new D2L.LP.Web.UI.Html.UniqueHtmlId().GetValue();handle.inner.innerHTML='<iframe src=\'/d2l/tools/blank.html\' name=\''+frameId+'\' allowfullscreen allow=\'microphone *; camera *\'></iframe>';handle.frame=handle.inner.firstChild;handle.frame.frameBorder='0';handle.frame.scrolling='no';handle.frame.className='d2l-dialog-frame d2l-dialog-frame-loading';handle.loadingSpinner=handle.rootWin.document.createElement('div');handle.loadingSpinner.className="d2l-dialog-loading-spinner";handle.inner.appendChild(handle.loadingSpinner);handle.rootWin.D2L.LP.Web.UI.Html.Bsi.LoadAssets(['node_modules/@brightspace-ui/core/components/loading-spinner/loading-spinner.js']).then(function(){var spinner=handle.rootWin.document.createElement('d2l-loading-spinner');spinner.setAttribute('size','120');handle.loadingSpinner.appendChild(spinner);});handle.onresize=function(){if(handle.isDragged){return;}var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(handle.rootWin);var left=Math.max(viewport.width/2-handle.width/2,0);handle.dialog.style.left=left+handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.NumOfDialogs*handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Offset+'px';if(handle.container){if(viewport.width<767){handle.container.classList.add('d2l-dialog-resizehandle-hide');var padding=me.computeDialogPadding(handle.dialog);var paddingTopBottom=0,paddingLeftRight=0;if(padding){paddingTopBottom+=padding.top+padding.bottom;paddingLeftRight+=padding.left+padding.right;}handle.frame.style.width=viewport.width-paddingLeftRight+'px';handle.frame.style.height=viewport.height-paddingTopBottom+'px';}else{D2L.LP.Web.UI.Desktop.MasterPages.Dialog.SetSize(handle,handle.width,handle.height);handle.container.classList.remove('d2l-dialog-resizehandle-hide');}}};D2L.LP.Web.UI.Events.OnResize.AddListener(handle.onresize);D2L.LP.Web.UI.Html.Dom.AddEventListener('load',handle.frame,function(){if(!loadedOnce){loadedOnce=true;handle.firstLoadEvent.Trigger();return;}if(handle.inner.contains(handle.loadingSpinner)){handle.inner.removeChild(handle.loadingSpinner);}handle.frame.contentDocument.body.classList.add('d2l-dialog-document-body');handle.frame.contentDocument.body.classList.add('d2l-dialog-mvc');handle.container=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-dialog-width',handle.frame.contentWindow.document);handle.body=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-dialog-body',handle.container);if(handle.body===null){handle.body=handle.container;}handle.nodes.title=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-dialog-title',handle.container);handle.nodes.heading=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-heading',handle.nodes.title);handle.nodes.footer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-dialog-footer-container',handle.container);if(settings.Onload!==undefined){settings.Onload.call(settings.Onload,handle);}if(handle.container!==null){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.container);dialogHeight=rect.height;if(!handle.setWidthCalled&&settings.PreferredSize==null){handle.width=rect.width;}handle.container.classList.add('d2l-dialog-flex');handle.frame.style.overflow='hidden';}else{handle.frame.style.overflow='scroll';handle.container=handle.frame.contentWindow.document.body;me.AdaptPageToDialog(handle);}if(handle.frame.contentWindow.D2L!==undefined){handle.frame.contentWindow.D2L.LP.Web.UI.Events.OnContentHeightChange.AddListener(function(newHeight){var desiredGrowth=newHeight+handle.bodyDiff-handle.height;if(handle.isResized||desiredGrowth<0){return;}var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.dialog);var scroll=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(handle.rootWin);var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(handle.rootWin);var top=Math.max(rect.top-scroll.top,0);var roomToGrow=viewport.height-top-rect.height;newHeight=handle.height+Math.min(desiredGrowth,roomToGrow);me.SetSize(handle,handle.width,newHeight);});if(settings.Height===undefined){var h=D2L.LP.Web.UI.Html.Dom.GetAttribute(handle.container,'data-height');if(h!==null){handle.height=parseInt(h);}else if(handle.nodes.footer!==null){var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(handle.rootWin);handle.height=Math.max(Math.min(dialogHeight+handle.nodes.footer.offsetHeight+10,viewport.height-100),200);}}if(handle.settings.AutoClose){handle.ondocumentclick=function(){handle.frame.contentWindow.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Close();};D2L.LP.Web.UI.Events.OnClick.AddListener(handle.ondocumentclick);}}setTimeout(function(){if(handle.body){var rectBody=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.body);handle.bodyDiff=dialogHeight-rectBody.height;adjustSize();handle.onresize();}},0);handle.frame.contentWindow.document.body.style.overflow='hidden';D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-dialog-loading',handle.dialog);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-dialog-frame-loading',handle.frame);me.Focus(handle.container,handle.frame.contentWindow);});adjustSize();handle.onresize();if(form===null){handle.firstLoadEvent.AddListener(function(){var frameLocation=location.GetUrl();try{handle.frame.contentWindow.location=frameLocation;}catch(e){handle.frame.src=frameLocation;}});}handle.inner.appendChild(handle.frame);},Abort:function(win){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelper(false,undefined,win);},AbortExternal:function(){parent.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelper(false,undefined);},Close:function(result){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelper(true,result);},CloseExternal:function(result){parent.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelper(true,result);},CloseHelper:function(doTrigger,result,win){var handle=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.GetHandle(win);if(handle===null){return result;}D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelperWithHandle(doTrigger,true,result,handle);},CloseHelperWithHandleAfterAnimation:function(doFocus,handle){var closingAnimation=function(){handle.dialog.removeEventListener('animationend',closingAnimation,false);handle.dialog.removeEventListener('webkitAnimationEnd',closingAnimation,false);handle.dialog.style.display='none';D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelperForFocusSwitch(handle,doFocus);};handle.dialog.addEventListener('animationend',closingAnimation,false);handle.dialog.addEventListener('webkitAnimationEnd',closingAnimation,false);handle.dialog.classList.add('d2l-dialog-closing');},CloseHelperWithHandle:function(doTrigger,doFocus,result,handle){if(handle.m_isClosed){return;}if(handle.onresize!==null){handle.win.D2L.LP.Web.UI.Events.OnResize.RemoveListener(handle.onresize);}if(handle.ondocumentclick!==null){handle.win.D2L.LP.Web.UI.Events.OnClick.RemoveListener(handle.ondocumentclick);}if(handle.shim!==null&&handle.settings.ShimType>0){D2L.LP.Web.UI.Desktop.Controls.Shim.Delete(handle.shim);}if(handle.settings.byPassOpenerFocus){doFocus=false;}if(doTrigger){handle.evt.Trigger(result);}else{if(handle.m_forceTriggerOnCancel){handle.evt.Trigger({});}else{handle.evt.Release();}}if(handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.NumOfDialogs<2){handle.rootWin.document.documentElement.classList.remove('d2l-dialog-open');handle.rootWin.document.documentElement.classList.remove('d2l-dialog-open-ios');}setTimeout(function(){handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelperWithHandleAfterAnimation(doFocus,handle);if(D2L&&D2L.LP){D2L.LP.Web.UI.Legacy.MasterPages.Dialog.DestroyAdapter();}},0);handle.m_isClosed=true;},CloseHelperForFocusSwitch:function(handle,doFocus){var removeDialog=function(){handle.dialog.d2l_handle=null;handle.dialog.parentNode.removeChild(handle.dialog);handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.NumOfDialogs--;};var assignFocusToOpener=function(){var promise=new Promise(function(resolve,reject){try{if(doFocus){var opener=handle.opener;setTimeout(function(){D2L.LP.Web.UI.Html.Dom.FocusNode(opener);resolve();},0);}else{resolve();}}catch(e){resolve();}});return promise;};assignFocusToOpener().then(removeDialog);},Focus:function(dialog,win){D2L.LP.Web.UI.Desktop.MasterPages.DialogCommon.Focus(dialog,win);var doc=win.document;var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var closeElem=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-dialog-close',dialog);me.MakeFocusTrap(dialog,win,closeElem);},MakeFocusTrap:function(dialog,win,closeElem){var doc=win.document;var first=doc.createElement('span');first.tabIndex=0;dialog.insertBefore(first,dialog.children[0]);var secondLast=doc.createElement('span');secondLast.tabIndex=0;dialog.appendChild(secondLast);var last=doc.createElement('span');last.tabIndex=0;dialog.appendChild(last);var delegated=false;D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',first,function(){delegated=true;secondLast.focus();});D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',secondLast,function(){if(delegated){delegated=false;return;}closeElem.focus();});D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',last,function(){closeElem.focus();});},GetHandle:function(win){win=win||window;var dialogs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-dialog-frame',win.parent.document);for(var i=0;i<dialogs.length;i++){if(dialogs[i].contentWindow==win){return dialogs[i].parentNode.parentNode.d2l_handle;}}return null;},FixSettings:function(settings){if(settings===undefined||settings===null){settings={};}if(settings.AutoClose===undefined){settings.AutoClose=false;}if(settings.ShimType===undefined){settings.ShimType=1;}if(settings.Window===undefined){if(window.parent!==window&&window.parent.frames&&window.parent.frames.length===3){if(window.parent.document.body.nodeName==="FRAMESET"){settings.Window=window;}else{settings.Window=window.parent;}}}return settings;},Open:function(opener,location,settings){return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmit(null,opener,location,settings);},OpenHelper:function(opener,location,settings){return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmitHelper(null,opener,location,settings);},OpenWithParam:function(openerId,location,params,settings){var evt=new D2L.LP.Web.UI.Events.Event();var form=D2L.LP.Web.UI.Desktop.MasterPages.DialogCommon.CreateForm(params);document.body.appendChild(form);var openSubmitEvent=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmit(form,openerId,location,settings);openSubmitEvent.AddListener(function(result){evt.Trigger(result);});openSubmitEvent.AddReleaseListener(function(){evt.Release();});return evt;},OpenSubmit:function(form,opener,location,settings){document.body.dispatchEvent(new CustomEvent('d2l-mvc-dialog-open',{bubbles:true,composed:true}));var openerElement;if(opener===undefined||opener===null){throw'Dialog opener is required. Cannot be '+opener;}else if(opener.GetValue!==undefined){var id=opener.GetValue();openerElement=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(openerElement===null||openerElement===undefined){throw'Dialog opener not found: '+id;}else if(openerElement.focus===undefined){throw'Invalid dialog opener: '+id;}}else if(opener.focus===undefined){throw'Invalid dialog opener: '+opener;}else{openerElement=opener;}return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmitHelper(form,openerElement,location,settings);},OpenSubmitHelper:function(form,opener,location,settings){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;settings=me.FixSettings(settings);var evt=new D2L.LP.Web.UI.Events.Event();var rootWin=D2L.LP.Web.UI.Desktop.MasterPages.DialogCommon.GetRootWindow();if(settings.Window){rootWin=settings.Window;}var handle={dialog:null,frame:null,body:null,bodyDiff:50,height:200,heightTimeout:null,inner:null,isResized:false,container:null,onresize:null,ondocumentclick:null,shim:null,win:window,rootWin:rootWin,opener:opener,evt:evt,isDragged:false,settings:settings,nodes:{title:null,heading:null,close:null,footer:null},width:300};handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.NumOfDialogs++;handle.rootWin.document.documentElement.classList.add('d2l-dialog-open');if(D2L.LP.Web.UI.Desktop.MasterPages.Dialog.IsIos()){handle.rootWin.document.documentElement.classList.add('d2l-dialog-open-ios');}me.Build(handle,form,location,settings,rootWin);var appendToDom=function(){rootWin.document.body.appendChild(handle.dialog);};var shim=function(){if(settings.ShimType>0){handle.shim=D2L.LP.Web.UI.Desktop.Controls.Shim.Create(handle.dialog,settings.ShimType==2);}};if(form!==null){handle.dialog.style.visibility='hidden';appendToDom();handle.firstLoadEvent.AddListener(function(){D2L.LP.Web.UI.Desktop.Controls.Form.SubmitToIFrameHelper(form,handle.frame,location).AddListener(function(result){if(result){shim();handle.dialog.style.visibility='visible';}else{me.CloseHelperWithHandle(false,false,undefined,handle);}});});}else{shim();appendToDom();}return evt;},computeDialogPadding:function(inDialog){if(!inDialog){return;}var innerDialog=inDialog.firstChild;if(!innerDialog){return;}var iframe=inDialog.frame;if(!iframe){return;}var boundsInner=innerDialog.getBoundingClientRect();var boundsIframe=iframe.getBoundingClientRect();var padding={top:Math.abs(boundsInner.top-boundsIframe.top),bottom:Math.abs(boundsInner.bottom-boundsIframe.bottom),left:Math.abs(boundsInner.left-boundsIframe.left),right:Math.abs(boundsInner.right-boundsIframe.right)};return padding;}};D2L.LP.Web.UI.Desktop.MasterPages.DialogCommon={CreateForm:function(params){var serializer=new D2L.LP.Web.Serialization.Serializer();var createHidden=function(name,value){var hidden=document.createElement('input');hidden.type='hidden';hidden.name=name;hidden.value=value;return hidden;};var form=document.createElement('form');D2L.LP.Web.UI.Html.Dom.SetAttribute(form,'data-method','POST');for(var key in params){serializer.AddMember(key,params[key]);}var members=serializer.GetMembers();for(var i=0;i<members.length;i++){form.appendChild(createHidden(members[i][0],members[i][1]));}return form;},Focus:function(container,win){var focusId=D2L.LP.Web.UI.Html.Dom.GetAttribute(container,'data-focusid');if(focusId!==null){var focusElem=win.D2L.LP.Web.UI.Html.Dom.GetElementById(focusId);if(D2L.LP.Web.UI.Html.Dom.IsFocusable(focusElem)){D2L.LP.Web.UI.Html.Dom.FocusNode(focusElem);return;}}var bodyNodes=win.document.getElementsByTagName('body');if(bodyNodes!==null&&bodyNodes.length>0){var skipFocus=bodyNodes[0].getAttribute('data-dialog-skipfocus');if(skipFocus){return;}}var doc=win.document;var closeElem=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-dialog-close',container);var elems=D2L.LP.Web.UI.Desktop.MasterPages.DialogCommon.GetFocusableElements(container);if(elems.length===0){return;}try{if(closeElem!==null){closeElem.focus();}win.focus();elems[0].focus();}catch(e){}if(closeElem===null){return;}},GetFocusableElements:function(container){var focusableElems={'a':true,'input':true,'select':true,'textarea':true,'button':true};var elems=[];var closeElem=null;var findElems=function(node){if(node.nodeType!==1){return;}var tagName=node.tagName.toLowerCase();if(focusableElems[tagName]===true){var focusable=true;if(tagName=='input'&&(node.type=='hidden'||node.disabled===true)){focusable=false;}else if(D2L.LP.Web.UI.Html.Css.GetStyle(node,'display')==='none'){focusable=false;}else if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-dialog-close',node)){closeElem=node;focusable=false;}if(focusable){elems.push(node);}}for(var i=0;i<node.childNodes.length;i++){findElems(node.childNodes[i]);}};findElems(container);if(elems.length===0&&closeElem!==null){elems.push(closeElem);}return elems;},GetRootWindow:function(){var rootWin=window;try{while(rootWin.parent!==rootWin&&rootWin.parent.D2L&&rootWin.parent.D2L.LP){var throwsIfXDomain=rootWin.parent.document;if(rootWin.parent.document.body.nodeName==='FRAMESET'){if(rootWin.parent===rootWin.parent.parent){break;}}rootWin=rootWin.parent;}}catch(xdomainErr){}return rootWin;}};D2L.LP.Web.UI.Desktop.MasterPages.DialogFullscreen={Abort:function(){D2L.LP.Web.UI.Desktop.MasterPages.DialogFullscreen.Close('abort');},Close:function(result){var placeholder=D2L.LP.Web.UI.Desktop.MasterPages.DialogFullscreen.GetTopDialog();if(!placeholder)return;var dialog=placeholder.querySelector('d2l-dialog-fullscreen');if(!dialog)return;var evt=new CustomEvent('d2l-dialog-close-mvc',{detail:{result:result}});dialog.dispatchEvent(evt);},GetTopDialog:function(){for(var i=document.body.childNodes.length-1;i>-1;i--){var node=document.body.childNodes[i];if(node.classList.contains('d2l-dialog-fullscreen-placeholder')){return node;}}return null;},Open:function(location,continueOnClose){var placeholderId=new D2L.LP.Web.UI.Html.UniqueHtmlId();var placeholder=document.createElement('div');placeholder.classList.add('d2l-placeholder-inner','d2l-dialog-fullscreen-placeholder');placeholder.setAttribute('id',placeholderId.GetValue());document.body.appendChild(placeholder);var evt=new D2L.LP.Web.UI.Events.Event();var closed=false;var onClose=function(e){placeholder.parentNode.removeChild(placeholder);if(!closed&&e&&e.detail&&e.detail.action==='abort'){if(continueOnClose){closed=true;evt.Trigger('abort');return;}closed=true;evt.Release();}};var onCloseMvc=function(e){if(e.detail.result==='abort'){e.target.opened=false;}else{closed=true;e.target.opened=false;evt.Trigger(e.detail.result);}};var onload=function(){var dialog=placeholder.querySelector('d2l-dialog-fullscreen');if(!dialog){evt.Release();return;}dialog.addEventListener('d2l-dialog-close',onClose);dialog.addEventListener('d2l-dialog-close-mvc',onCloseMvc);dialog.opened=true;};D2L.LP.Web.UI.Html.PartialRendering.PartialRender(placeholderId,function(){return D2L.LP.Web.UI.Rpc.ConnectPartial(placeholderId,'GET',location);}).AddListener(onload);return evt;}};D2L.LP.Web.UI.Desktop.MasterPages.Dialog.FileSelectorDialog={FileStore:{},GetFiles:function(id){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.FileSelectorDialog;var f=me.FileStore[id.GetValue()];if(f===undefined){return;}return f;},OpenDialog:function(openFunction,dialogId,callback){openFunction.call(openFunction).AddListener(function(files){if(files==null||files.length==0){return;}var fileParams=[];for(var i=0;i<files.length;i++){var file=files[i];var fileParam=new D2L.LP.Web.UI.Files.File(file.FileId,file.FileSystemType,file.FileName,file.Size,file.PreviewUrl);fileParams.push(fileParam);}var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.FileSelectorDialog;me.FileStore[dialogId.GetValue()]=fileParams;callback.call(callback);});}};D2L.LP.Web.UI.Html.JavaScript.Alert=function(titleText,primaryMessage,secondaryMessage,primaryButtonText,closeButtonText,openerId){var evt=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.Open(titleText,primaryMessage,secondaryMessage,primaryButtonText,null,closeButtonText,'d2l-dialog-inline-body-alert',function(){evt.Trigger(true);},null,function(){evt.Trigger(true);},openerId);return evt;};D2L.LP.Web.UI.Html.JavaScript.Info=function(titleText,primaryMessage,secondaryMessage,primaryButtonText,closeButtonText,openerId){var evt=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.Open(titleText,primaryMessage,secondaryMessage,primaryButtonText,null,closeButtonText,'d2l-dialog-inline-body-info',function(){evt.Trigger(true);},null,function(){evt.Trigger(true);},openerId);return evt;};D2L.LP.Web.UI.Html.JavaScript.Confirm=function(titleText,primaryMessage,secondaryMessage,primaryButtonText,secondaryButtonText,closeButtonText,openerId,testFunc){var evt=new D2L.LP.Web.UI.Events.Event();testFunc();D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.Open(titleText,primaryMessage,secondaryMessage,primaryButtonText,secondaryButtonText,closeButtonText,'d2l-dialog-inline-body-confirm',function(){evt.Trigger(true);},function(){evt.Trigger(false);},null,openerId);return evt;};D2L.LP.Web.UI.Desktop.MasterPages.Dialog.EquationEditor={CloseAndReturn:function(){var ret=new D2L.LP.Web.UI.Events.Event();var node=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-latexeditor");if(node!=null){D2L.LP.Web.UI.Desktop.Controls.EquationEditor.LatexEditor.GetAnnotatedMathML(node,function(mathml){window.setTimeout(function(){ret.Trigger(mathml);},500);});}else{node=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-equationeditor");D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.GetAnnotatedMathML(node,function(mathml){window.setTimeout(function(){ret.Trigger(mathml);},500);});}return ret;}};D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline={Open:function(titleText,primaryMessage,secondaryMessage,primaryButtonText,secondaryButtonText,closeButtonText,iconClass,primaryButtonCallback,secondaryButtonCallback,abortCallback,openerId,id,equalButtonWidths){var contentElement=document.createDocumentFragment();if(primaryMessage){var primaryMessageElement=contentElement.appendChild(document.createElement('p'));primaryMessageElement.classList.add('d2l-dialog-inline-primary-message');primaryMessageElement.innerHTML=primaryMessage;}if(secondaryMessage){var secondaryMessageElement=contentElement.appendChild(document.createElement('p'));secondaryMessageElement.classList.add('d2l-dialog-inline-secondary-message');secondaryMessageElement.innerHTML=secondaryMessage;}var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline;me.OpenWithElement(titleText,contentElement,false,primaryButtonText,secondaryButtonText,closeButtonText,iconClass,primaryButtonCallback,secondaryButtonCallback,abortCallback,openerId,id,equalButtonWidths,true);document.body.dispatchEvent(new CustomEvent('d2l-mvc-dialog-open',{bubbles:true,composed:true}));},OpenWithElement:function(titleText,contentElement,noPadding,primaryButtonText,secondaryButtonText,closeButtonText,iconClass,primaryButtonCallback,secondaryButtonCallback,abortCallback,openerId,id,equalButtonWidths,isAlert){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline;var rootWin=window;while(true){if(rootWin.parent===rootWin||rootWin.D2L===undefined||!D2L.LP.Web.UI.Html.Dom.HasSafeParent(rootWin)){break;}rootWin=rootWin.parent;}var handle={activeElement:document.activeElement,cont:null,shim:null,openerId:openerId,abortCallback:abortCallback,rootWin:rootWin};var nodes=me.Build(handle,titleText,closeButtonText,iconClass,contentElement,noPadding,primaryButtonText,primaryButtonCallback,secondaryButtonText,secondaryButtonCallback,id,equalButtonWidths,isAlert);handle.cont=nodes.container;handle.shim=D2L.LP.Web.UI.Desktop.Controls.Shim.Create(nodes.container,false);nodes.container.d2l_handle=handle;rootWin.document.body.appendChild(nodes.container);handle.resizeFunc=function(){var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(rootWin);var scroll=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(rootWin);var width;var contRect=nodes.container.getBoundingClientRect();width=contRect.width;var heightOther=60;if(nodes.titleCont){heightOther+=nodes.titleCont.getBoundingClientRect().height;}if(nodes.footerCont){heightOther+=nodes.footerCont.getBoundingClientRect().height;}nodes.bodyCont.style.maxHeight=contRect.height-heightOther+'px';nodes.container.style.left=(viewport.width-width)/2+'px';nodes.container.style.top=scroll.top+50+'px';};handle.resizeFunc();window.addEventListener('resize',handle.resizeFunc,false);nodes.anchorStart.focus();},Build:function(handle,titleText,closeButtonText,iconClass,contentElement,noPadding,primaryButtonText,primaryButtonCallback,secondaryButtonText,secondaryButtonCallback,id,equalButtonWidths,isAlert){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline;var titleNodes=me.BuildTitle(handle,titleText,closeButtonText);var footerNodes=me.BuildFooter(handle,primaryButtonText,primaryButtonCallback,secondaryButtonText,secondaryButtonCallback,equalButtonWidths);var anchorStart=handle.rootWin.document.createElement('a');anchorStart.onclick='return false;';D2L.LP.Web.UI.Html.Dom.SetAttribute(anchorStart,'href','javascript:void(0);');D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',anchorStart,function(){if(footerNodes.secondaryButton!==null){footerNodes.secondaryButton.focus();}else if(footerNodes.primaryButton!==null){footerNodes.primaryButton.focus();}else{var result=D2L.LP.Web.UI.Html.Dom.GetPreviousFocusableElement(anchorStart);if(result){result.focus();}else{titleNodes.close.focus();}}});var bodyCont=handle.rootWin.document.createElement('div');var bodyClass='d2l-dialog-inline-body';if(noPadding){bodyClass+=' d2l-dialog-inline-body-nopadding';}if(iconClass){bodyClass+=' d2l-dialog-inline-body-icon '+iconClass;}else{bodyClass+=' d2l-dialog-inline-body-noicon';}bodyCont.className=bodyClass;bodyCont.id=new D2L.LP.Web.UI.Html.UniqueHtmlId().GetValue();bodyCont.appendChild(contentElement);var anchorEnd=handle.rootWin.document.createElement('a');anchorEnd.onclick='return false;';D2L.LP.Web.UI.Html.Dom.SetAttribute(anchorEnd,'href','javascript:void(0);');D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',anchorEnd,function(){titleNodes.close.focus();});var inner=handle.rootWin.document.createElement('div');inner.className='d2l-dialog-inner';inner.appendChild(anchorStart);inner.appendChild(titleNodes.cont);inner.appendChild(bodyCont);if(footerNodes.cont!==null){inner.appendChild(footerNodes.cont);}inner.appendChild(anchorEnd);var cont=handle.rootWin.document.createElement('div');if(id){cont.id=id.GetValue();}cont.className='d2l-dialog d2l-dialog-mvc d2l-dialog-inline';var openingAnimation=function(){cont.removeEventListener('animationend',openingAnimation,false);cont.removeEventListener('webkitAnimationEnd',openingAnimation,false);cont.classList.remove('d2l-dialog-loading');};cont.addEventListener('animationend',openingAnimation,false);cont.addEventListener('webkitAnimationEnd',openingAnimation,false);cont.classList.add('d2l-dialog-loading');D2L.LP.Web.UI.Html.Aria.SetRole(cont,isAlert?'alertdialog':'dialog');D2L.LP.Web.UI.Html.Aria.SetAttribute(cont,'describedby',bodyCont.id);D2L.LP.Web.UI.Html.Aria.SetAttribute(cont,'labelledby',titleNodes.title.id);D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(cont,function(kpArgs){if(kpArgs.GetKey()===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape){me.AbortWithHandle(handle);}});cont.appendChild(inner);D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitTitleHelper({isDragged:false},cont,titleNodes.cont,titleNodes.close,handle.rootWin,handle.rootWin);return{container:cont,title:titleNodes.title,titleCont:titleNodes.cont,bodyCont:bodyCont,footerCont:footerNodes.cont,close:titleNodes.close,anchorStart:anchorStart};},BuildTitle:function(handle,titleText,closeButtonText){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline;var title=handle.rootWin.document.createElement('h2');title.className='d2l-heading vui-heading-3';title.innerHTML=titleText;title.id=new D2L.LP.Web.UI.Html.UniqueHtmlId().GetValue();var closeButtonSpan=handle.rootWin.document.createElement('span');closeButtonSpan.className='d2l-offscreen';closeButtonSpan.innerHTML=closeButtonText;var closeButton=handle.rootWin.document.createElement('a');closeButton.className='d2l-dialog-close';D2L.LP.Web.UI.Html.Aria.SetRole(closeButton,'button');D2L.LP.Web.UI.Html.Dom.SetAttribute(closeButton,'href','javascript:void(0);');D2L.LP.Web.UI.Html.Dom.SetAttribute(closeButton,'onclick','return false;');D2L.LP.Web.UI.Html.Dom.SetAttribute(closeButton,'title',closeButtonText);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',closeButton,function(){me.AbortWithHandle(handle);});var innerSpan=handle.rootWin.document.createElement('span');innerSpan.appendChild(closeButtonSpan);closeButton.appendChild(innerSpan);var cont=handle.rootWin.document.createElement('div');cont.className='d2l-dialog-title';cont.appendChild(title);cont.appendChild(closeButton);return{cont:cont,title:title,close:closeButton};},BuildFooter:function(handle,primaryButtonText,primaryButtonCallback,secondaryButtonText,secondaryButtonCallback,equalButtonWidths){if(!primaryButtonText&&!secondaryButtonText){return{cont:null,primaryButton:null,secondaryButton:null};}var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline;var buttonCont=handle.rootWin.document.createElement('div');buttonCont.className='d2l-dialog-buttons';var clear=handle.rootWin.document.createElement('div');clear.className='d2l-clear';var footerCont=handle.rootWin.document.createElement('div');footerCont.className='d2l-dialog-footer';footerCont.appendChild(buttonCont);footerCont.appendChild(clear);var primaryButton=primaryButtonText?buttonHelper(primaryButtonText,primaryButtonCallback,true):null;var secondaryButton=secondaryButtonText?buttonHelper(secondaryButtonText,secondaryButtonCallback,false):null;if(equalButtonWidths){setTimeout(function(){var maxWidthButton=Math.max(primaryButton.offsetWidth,secondaryButton.offsetWidth);secondaryButton.style.width=maxWidthButton+"px";primaryButton.style.width=maxWidthButton+"px";},1);}return{cont:footerCont,primaryButton:primaryButton,secondaryButton:secondaryButton};function buttonHelper(buttonText,cb,isPrimary){var button=D2L.LP.Web.UI.Desktop.Controls.Button.Build(handle.rootWin.document);buttonCont.appendChild(button);D2L.LP.Web.UI.Desktop.Controls.Button.Init(button);D2L.LP.Web.UI.Desktop.Controls.Button.SetTextNode(button,buttonText);D2L.LP.Web.UI.Desktop.Controls.Button.SetIsPrimaryNode(button,isPrimary);D2L.LP.Web.UI.Desktop.Controls.Button.SetOnClickNode(button,function(){me.Close(handle);if(cb!==null){cb();}});return button;}},Close:function(handle){window.removeEventListener('resize',handle.resizeFunc,false);var closed=false;var closingAnimation=function(){if(closed)return;closed=true;handle.cont.removeEventListener('animationend',closingAnimation,false);handle.cont.removeEventListener('webkitAnimationEnd',closingAnimation,false);D2L.LP.Web.UI.Html.Dom.RemoveElement(handle.cont);};handle.cont.addEventListener('animationend',closingAnimation,false);handle.cont.addEventListener('webkitAnimationEnd',closingAnimation,false);handle.cont.classList.add('d2l-dialog-closing');D2L.LP.Web.UI.Desktop.Controls.Shim.Delete(handle.shim);var opener=handle.activeElement;if(handle.openerId!==null){opener=D2L.LP.Web.UI.Html.Dom.GetElementById(handle.openerId);}setTimeout(function(){D2L.LP.Web.UI.Html.Dom.FocusNode(opener);},0);setTimeout(closingAnimation,400);},Abort:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(node===null||node.d2l_handle===undefined){return;}D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.AbortWithHandle(node.d2l_handle);},AbortWithHandle:function(handle){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.Close(handle);if(handle.abortCallback!==null){handle.abortCallback();}}};D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InlineDialog=function(openerId,id,titleText,primaryMessage,secondaryMessage,positiveButtonText,negativeButtonText,abortButtonText,iconImageClassName,positiveResult,negativeResult,abortResult){var evt=new D2L.LP.Web.UI.Events.Event();positiveResult=positiveResult==null?undefined:positiveResult;negativeResult=negativeResult==null?undefined:negativeResult;abortResult=abortResult==null?undefined:abortResult;D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.Open(titleText,primaryMessage,secondaryMessage,positiveButtonText,negativeButtonText,abortButtonText,iconImageClassName,function(){evt.Trigger(positiveResult);},function(){evt.Trigger(negativeResult);},function(){evt.Trigger(abortResult);},openerId,id);return evt;};D2L.LP.Web.UI.Html.JavaScript.Warning=function(titleText,primaryMessage,secondaryMessage,primaryButtonText,closeButtonText,openerId){var evt=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.Open(titleText,primaryMessage,secondaryMessage,primaryButtonText,null,closeButtonText,'d2l-dialog-inline-body-warning',function(){evt.Trigger(true);},null,function(){evt.Trigger(true);},openerId);return evt;};D2L.LP.Web.UI.Desktop.Controls.PageButtons={Init:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.PageButtons;var $node=$(node);var nodeHeight=$node.outerHeight();var $spacer=$('<div class="d2l-page-buttons-spacer"></div>').height(nodeHeight+'px').insertAfter(node);var handle={buttonHeight:$node.height(),extraWidth:$node.outerWidth(true)-$node.width(),$node:$node,$spacer:$spacer,$win:$(window),isFloating:false};var reposition=function(){me.Reposition(handle);};handle.$win.scroll(reposition).resize(reposition);$(document).ready(reposition);var prevDocumentHeight=document.body.offsetHeight;setInterval(function(){var documentHeight=document.body.offsetHeight;if(prevDocumentHeight!==documentHeight){reposition();}prevDocumentHeight=documentHeight;},100);},SetIsFloating:function(handle,isFloating){if(handle.isFloating!==isFloating){handle.$spacer.toggleClass('d2l-page-buttons-float',isFloating);handle.$node.toggleClass('d2l-page-buttons-float',isFloating);}if(isFloating){var floatParent=handle.$node.parent();if(handle.$node.offset().top-50<floatParent.offset().top){handle.$spacer.removeClass('d2l-page-buttons-float');handle.$node.removeClass('d2l-page-buttons-float');handle.isFloating=false;return;}var extras=handle.$node.outerWidth(true)-handle.$node.width();var width=floatParent.width()-extras;handle.$node.width(width);}else{handle.$node.width('auto');}handle.isFloating=isFloating;},Reposition:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.PageButtons;var docViewTop=handle.$win.scrollTop();var docViewBottom=docViewTop+handle.$win.height();var documentHeight=$(document).height();var buttonPosition=handle.isFloating?handle.$spacer.position().top:handle.$node.position().top;if(buttonPosition+handle.buttonHeight+10<=docViewBottom||docViewBottom==documentHeight){me.SetIsFloating(handle,false);}else{me.SetIsFloating(handle,true);}}};D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane={Blur:function(context){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-page-collapsepane-hover',context.sidebar);if(!context.isOpen){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-page-collapsepane-shadow-hover',context.shadow);}context.isOver=false;},Close:function(context,evt){if(!context.isOpen){return;}context.isOpen=false;context.ignoreClicks=false;D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-page-collapsepane-shadow-open',context.shadow);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-page-collapsepane-open',context.sidebar);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-page-collapsepane-opening',context.sidebar);context.shadow.title=context.expandText;context.handleLink.title=context.expandText;if(evt!==undefined&&evt.type==='click'){context.handleLink.blur();}if(!context.isOver){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-page-collapsepane-shadow-hover',context.shadow);}D2L.LP.Web.UI.Html.Dom.FocusCycle.SetIsEnabled(context.focusCycleHandle,false);var timeoutTime=D2L.LP.Web.UI.Html.Css.Capability.SupportsTransition()?400:0;clearTimeout(context.timeout);context.timeout=setTimeout(function(){if(!context.isOpen){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-page-collapsepane-visible',context.sidebar);var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(window);var minibarHeight=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane.GetMinibarHeight(context);var scrollPos=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(window);var pageRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-page-main',context.container));var navAdjustment=Math.max(minibarHeight,pageRect.top-scrollPos.top);context.container.style.width='20px';context.container.style.minHeight=viewport.height-navAdjustment+"px";}},timeoutTime);},Hover:function(context){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-page-collapsepane-hover',context.sidebar);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-page-collapsepane-shadow-hover',context.shadow);context.isOver=true;},Init:function(container){var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;var dom=D2L.LP.Web.UI.Html.Dom;var isRtl=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var sidebar=dom.GetFirstElementByClassName('d2l-page-collapsepane',container);var handleLink=dom.GetFirstElementByClassName('d2l-page-collapsepane-handle-link',sidebar);var handleExpand=dom.GetFirstElementByClassName('d2l-page-collapsepane-handle-expand',handleLink);var handleCollapse=dom.GetFirstElementByClassName('d2l-page-collapsepane-handle-collapse',handleLink);var end=dom.GetFirstElementByClassName('d2l-page-collapsepane-end',container);var context={collapseText:dom.GetTextContent(handleCollapse),container:container,expandText:dom.GetTextContent(handleExpand),focusCycleHandle:null,handle:dom.GetFirstElementByClassName('d2l-page-collapsepane-handle',sidebar),handleLink:handleLink,firstOpen:true,ignoreClicks:false,ignoreToggle:false,isOpen:false,isOver:false,isRtl:isRtl,minibar:dom.GetFirstElementByClassName('d2l-minibar-placeholder',document),openFirstFunction:$(sidebar).attr('data-openfirst'),shadow:dom.GetFirstElementByClassName('d2l-page-collapsepane-shadow',container),shadowEdge:0,sidebar:sidebar,sidebarContentInner:dom.GetFirstElementByClassName('d2l-page-collapsepane-content-inner',sidebar),timeout:null};var blur=function(){me.Blur(context);};var hover=function(){me.Hover(context);};var onClick=function(evt){me.OnClick(context,evt);};var onFocus=function(){me.OnFocus(context);};var onKeyPress=function(arg){me.OnKeyPress(context,arg);};var onScroll=function(){me.OnScroll(context);};var toggle=function(evt){me.Toggle(context,evt);};var swipe=function(evt){me.Swipe(context,evt);};context.handleLink.tabIndex=0;context.handleLink.title=context.expandText;D2L.LP.Web.UI.Html.Aria.SetRole(context.handleLink,'button');context.shadow.title=context.expandText;D2L.LP.Web.UI.Events.OnResize.AddListener(onScroll);D2L.LP.Web.UI.Events.OnScroll.AddListener(onScroll);D2L.LP.Web.UI.Events.OnClick.AddListener(onClick);D2L.LP.Web.UI.Events.OnKeyPress.AddListener(onKeyPress);dom.AddEventListener('click',context.shadow,toggle);dom.AddEventListener('click',context.handle,toggle);dom.AddEventListener('mouseover',context.shadow,hover);dom.AddEventListener('mouseout',context.shadow,blur);dom.AddEventListener('focus',context.handleLink,hover);dom.AddEventListener('blur',context.handleLink,blur);dom.AddEventListener('focus',document.body,onFocus,true);me.AddSwipeListener(document.body,swipe);context.focusCycleHandle=D2L.LP.Web.UI.Html.Dom.FocusCycle.Init(context.handle,end);var header=document.body.getElementsByTagName("header")[0];me.Observe(header,onScroll);container.d2l_context=context;},Observe:function(element,func){var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;var observer=new MutationObserver(function(){if(element.clientHeight){me.DisconnectRun(observer,func);}});var observerConfig={attributes:true,subtree:true};observer.observe(element,observerConfig);setTimeout(function(){me.DisconnectRun(observer,func);},10000);},DisconnectRun:function(observer,func){observer.disconnect();func();},GetContext:function(node){if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-page-collapsepane-container',node)){node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-page-collapsepane-container',node);if(node==null){return null;}}return node.d2l_context;},GetMinibarHeight:function(context){var minibarHeight=0;if(context.minibar!==null){var minibarRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(context.minibar);minibarHeight=minibarRect.height;}return minibarHeight;},AddSwipeListener:function(el,listener){var dom=D2L.LP.Web.UI.Html.Dom;var startX;var startY;var dx;var direction;var verticalThreshold=70;var horizontalThreshold=100;var cancelTouch=function(){dom.RemoveEventListener('touchmove',el,onTouchMove);dom.RemoveEventListener('touchend',el,onTouchEnd);startX=null;startY=null;direction=null;dx=null;};var onTouchMove=function(e){if(e.touches.length!==1){cancelTouch();return;}dx=e.touches[0].pageX-startX;var dy=e.touches[0].pageY-startY;if(direction==null){direction=dx;}else if(direction<0&&dx>0||direction>0&&dx<0||Math.abs(dy)>verticalThreshold){cancelTouch();}};var onTouchEnd=function(){var sX=startX;var distanceX=dx;cancelTouch();if(Math.abs(distanceX)>horizontalThreshold){listener({target:el,direction:distanceX>0?'right':'left',startX:sX});}};var onTouchStart=function(e){if(e.touches.length!==1){return;}dx=null;startX=e.touches[0].pageX;startY=e.touches[0].pageY;dom.AddEventListener('touchmove',el,onTouchMove,false);dom.AddEventListener('touchend',el,onTouchEnd,false);};dom.AddEventListener('touchstart',el,onTouchStart,false);},OnClick:function(context,evt){var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;if(!context.isOpen||context.ignoreClicks){return;}var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(evt);if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(context.sidebar,eventTarget)){me.Close(context,evt);}},OnFocus:function(context){var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;var activeNode=D2L.LP.Web.UI.Html.Dom.GetActiveElement();if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(context.sidebar,activeNode)){me.Close(context);}},OnKeyPress:function(context,arg){var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;var target=arg.GetTarget();if(target===undefined||target===null){return;}var evt=arg.GetEventObject();var key=arg.GetKey();if(target===context.handleLink&&key==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter){me.Toggle(context,evt);return;}if(context.isOpen&&arg.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape){me.Close(context,evt);return;}},OnScroll:function(context){var dom=D2L.LP.Web.UI.Html.Dom;var scrollPos=dom.GetScrollPosition();var windowInnerHeight=window.innerHeight;var parentRect=dom.GetBoundingRect(context.container);var pageRect=dom.GetBoundingRect(dom.GetParentElementByClassName('d2l-page-main',context.container));var visibleWindowHeight=windowInnerHeight||document.body.clientHeight;var minibarHeight=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane.GetMinibarHeight(context);var pageHeight=D2L.LP.Web.UI.Html.Dom.GetPageSize(window).height;var scrolledBeyond=scrollPos.top>0&&scrollPos.top+windowInnerHeight>pageHeight;if(scrolledBeyond){return;}var containerTop=Math.max(pageRect.top,scrollPos.top+minibarHeight);var shadowTop=Math.max(pageRect.top,parentRect.top-scrollPos.top);var maxHeight=Math.max(237,visibleWindowHeight-shadowTop-24);var navAdjustment=Math.max(minibarHeight,pageRect.top-scrollPos.top);context.sidebarContentInner.style.maxHeight=maxHeight+'px';context.container.style.minHeight=visibleWindowHeight-navAdjustment+'px';context.container.style.top=containerTop+'px';if(context.isRtl){context.shadowEdge=parentRect.right;}else{context.shadowEdge=parentRect.left;}},Open:function(context){if(context.isOpen){return;}var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;var dom=D2L.LP.Web.UI.Html.Dom;if(context.firstOpen){context.firstOpen=false;if(context.openFirstFunction!==undefined){eval(context.openFirstFunction);}}context.isOpen=true;context.ignoreClicks=true;dom.AddClassName('d2l-page-collapsepane-opening',context.sidebar);dom.AddClassName('d2l-page-collapsepane-visible',context.sidebar);var container=dom.GetBoundingRect(context.sidebar);context.container.style.width=container.width+20+"px";context.container.style.minHeight=container.height+"px";D2L.LP.Web.UI.Html.Dom.FocusCycle.SetIsEnabled(context.focusCycleHandle,true);me.OnScroll(context);context.shadow.title=context.collapseText;context.handleLink.title=context.collapseText;var timeoutTime=D2L.LP.Web.UI.Html.Css.Capability.SupportsTransition()?400:0;clearTimeout(context.timeout);context.timeout=setTimeout(function(){if(!context.isOpen){return;}context.ignoreClicks=false;dom.AddClassName('d2l-page-collapsepane-open',context.sidebar);dom.AddClassName('d2l-page-collapsepane-shadow-open',context.shadow);},timeoutTime);},Swipe:function(context,e){var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;var isRtl=context.isRtl;var edge=context.shadowEdge;if(e.direction=='left'&&!isRtl||e.direction=='right'&&isRtl){me.Close(context);return;}if(e.direction=='right'&&!isRtl&&e.startX<edge+40||e.direction=='left'&&isRtl&&e.startX>edge-40){context.ignoreToggle=true;me.Open(context);setTimeout(function(){context.ignoreToggle=false;},100);}},Toggle:function(context,evt){var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;if(context.ignoreToggle){return;}if(context.isOpen){me.Close(context,evt);}else{me.Open(context);}}};D2L.LP.Web.UI.Desktop.MasterPages.PageMessage={Close:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null){return;}node.style.opacity=0;setTimeout(function(){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,false);node.style.opacity=0;node.style.bottom='40px';},1500);},Open:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null){return;}node.style.zIndex=D2L.LP.Web.UI.Desktop.Controls.Shim.GetZIndex()+1000;D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,true);setTimeout(function(){node.style.opacity=1;node.style.bottom='50px';},100);},Shake:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null){return;}D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-page-message-shake',node);setTimeout(function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-page-message-shake',node);},1000);}};D2L.LP.Web.UI.Desktop.MasterPages.OptIn={m_storedResults:{},ReloadPage:function(){window.location.reload(true);},StoreResult:function(id,key,value){if(!this.m_storedResults[id]){this.m_storedResults[id]={};}this.m_storedResults[id][key]=value;},GetResult:function(id,key){if(!D2L.LP.Web.UI.Desktop.MasterPages.OptIn.m_storedResults[id]){return null;}return D2L.LP.Web.UI.Desktop.MasterPages.OptIn.m_storedResults[id][key];},OnVisibilityChange:function(id,isVisible){var eventHandler=D2L.LP.Web.UI.ObjectRepository.TryGet(id,"OnVisibilityChange");if(eventHandler){this.StoreResult(id,"IsVisible",isVisible);eventHandler.call(eventHandler);}},OnOptIn:function(id){var eventHandler=D2L.LP.Web.UI.ObjectRepository.TryGet(id,"OnOptIn");if(eventHandler){eventHandler.call(eventHandler);}},OnOptOut:function(id,event){var eventHandler=D2L.LP.Web.UI.ObjectRepository.TryGet(id,"OnOptOut");var details=event.detail||{};if(eventHandler){this.StoreResult(id,"Reason",details.reason||null);this.StoreResult(id,"Feedback",details.feedback||"");eventHandler.call(eventHandler);}}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-flyout-instance",function(flyout){var flyoutEvents=window.D2L.LP.Web.UI.Desktop.MasterPages.OptIn;flyout.addEventListener("flyout-opened",flyoutEvents.OnVisibilityChange.bind(flyoutEvents,flyout.id,true));flyout.addEventListener("flyout-closed",flyoutEvents.OnVisibilityChange.bind(flyoutEvents,flyout.id,false));flyout.addEventListener("opt-in",flyoutEvents.OnOptIn.bind(flyoutEvents,flyout.id));flyout.addEventListener("opt-out",flyoutEvents.OnOptOut.bind(flyoutEvents,flyout.id));});D2L.LP.Web.UI.Desktop.MasterPages.Title={SetTitle:function(title,orgName){if(document.title){document.title=title+' - '+orgName;}var titleBreadcrumbs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-page-breadcrumb-title');for(var i=0;i<titleBreadcrumbs.length;i++){D2L.LP.Web.UI.Desktop.Controls.Breadcrumbs.SetTextNode(titleBreadcrumbs[i],title);}var heading=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-page-title');if(heading===null){return;}if(heading.firstChild.nodeValue!==null){heading.firstChild.nodeValue=title;}else{heading.firstChild.innerHTML=title;}},RefreshDocumentTitle:function(orgName){var heading=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-page-title');if(!heading||!document.title){return;}document.title=heading.textContent+' - '+orgName;}};D2L.LP.Web.UI.Desktop.MasterPages.Popup={Close:function(){window.close();}};D2L.LP.Web.UI.Desktop.Controls.ActionContainer={GetSelectionInfo:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_selectionInfo;},TryGetSelectionUpdatedEventByNode:function(node){var dataControlId=node.getAttribute('data-d2l-dataControlId');if(dataControlId==null){return;}var dataControlNode=D2L.LP.Web.UI.Html.Dom.GetElementById(dataControlId);if(dataControlNode==null){return;}var dataControlNS=eval(dataControlNode.getAttribute('data-d2l-actionable-ns'));if(dataControlNS==null){return;}var dataControlUpdatedEvent=dataControlNS.TryGetSelectionUpdatedEvent(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(dataControlId));return dataControlUpdatedEvent;}};D2L.LP.Web.UI.Desktop.Controls.Alert={Close:function(id){var alert=document.getElementById(id.GetValue());if(alert){alert.close();}}};D2L.LP.Web.UI.Desktop.Controls.AutoComplete={CloseContainer:function(handle){if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',handle.containerNode)){return;}D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',handle.containerNode);D2L.LP.Web.UI.Html.Dom.RemoveEventListener('mouseup',document.body,handle.mouseUpHandler);var selectedNode=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetSelectedItemNode(handle);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-autocomplete-item-hover',selectedNode);D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',handle.sourceNode,handle.onSourceFocus);D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,'aria-expanded','false');D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.containerNode,'aria-hidden','true');},DisplayAndSetText:function(handle,itemNode){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;if(itemNode==null){itemNode=me.FindMatch(handle);}if(itemNode==null&&!handle.forceSelection){handle.sourceNode.value=D2L.LP.Web.UI.Html.JavaScript.TrimString(0,handle.sourceNode.value);handle.text=handle.sourceNode.value;handle.key='';}else{var item=me.GetSearchTextElement(itemNode);var text=D2L.LP.Web.UI.Html.Dom.GetAttribute(item,'data-d2l-displaytext');var key=D2L.LP.Web.UI.Html.Dom.GetAttribute(item,'data-d2l-key');handle.sourceNode.value=text;handle.text=text;handle.key=key;}handle.valueHidden.value=handle.text;handle.valueKey.value=handle.key;handle.lastSearch=null;D2L.LP.Web.UI.Html.Dom.RemoveAttribute(handle.sourceNode,'aria-activedescendant');me.FireChangeEvent(handle);},DisplayMessage:function(handle,isContainerVisible){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var messageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-autocomplete-message',handle.containerNode)[0];var message;var node;if(isContainerVisible){node=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.containerNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-autocomplete-invisible',node);if(handle.displayResultsMessage){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',messageNode);message=D2L.LP.Web.UI.Html.Dom.GetAttribute(messageNode,'data-d2l-resultsmessage');message=message.split('{0}').join(handle.numberMatches);messageNode.innerHTML=message.split('{1}').join(handle.totalResults);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',messageNode);}}else{if(handle.displayNoResultsMessage){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',messageNode);message=D2L.LP.Web.UI.Html.Dom.GetAttribute(messageNode,'data-d2l-noresultsmessage');messageNode.innerHTML=message.split('{0}').join(me.Encode(handle.text));node=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.containerNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-autocomplete-invisible',node);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',messageNode);me.CloseContainer(handle);}}},DisplayText:function(handle,itemNode){var item=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetSearchTextElement(itemNode);var text=D2L.LP.Web.UI.Html.Dom.GetAttribute(item,'data-d2l-displaytext');handle.sourceNode.value=text;D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,'aria-activedescendant',itemNode.id);},Encode:function(text){text=text.replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/'/g,'&#39;').replace(/</g,'&lt;').replace(/>/g,'&gt;');return text;},FindMatch:function(handle){var items=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetItems(handle);var text=handle.sourceNode.value.toLowerCase();for(var i=0;i<items.length;i++){var item=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetSearchTextElement(items[i]);var searchText=D2L.LP.Web.UI.Html.Dom.GetAttribute(item,'data-d2l-searchtext').toLowerCase();var displayText=D2L.LP.Web.UI.Html.Dom.GetAttribute(item,'data-d2l-displaytext').toLowerCase();if(text==searchText||text==displayText){return items[i];}}return null;},FireChangeEvent:function(handle){if("fireEvent"in handle.sourceNode)handle.sourceNode.fireEvent("onchange");else{var evt=document.createEvent("HTMLEvents");evt.initEvent("change",false,true);handle.sourceNode.dispatchEvent(evt);}},GetDataAttribute:function(node,attribute){if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(node,attribute)){return null;}var value=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,attribute);D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,attribute);if(value.toLowerCase()==='true'){value=true;}else if(value.toLowerCase()==='false'){value=false;}return value;},GetForceSelection:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetHandle(id);return handle.forceSelection;},GetHandle:function(nodeId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(nodeId.GetValue());return node.handle;},GetItems:function(handle){var items=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-autocomplete-item',handle.containerNode);return items;},GetSearchTextElement:function(itemNode){var item=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-autocomplete-searchtext',itemNode)[0];return item;},GetSelectedItem:function(containerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(containerId.GetValue());var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-autocomplete-hidden',node)[0];var valueNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(hiddenNode);var keyNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(valueNode);var param=new D2L.LP.Web.UI.Desktop.Controls.AutoComplete.SelectionInfo(valueNode.value,keyNode.value);return param;},GetSelectedItemNode:function(handle){var selectedNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-autocomplete-item-hover',handle.containerNode)[0];if(selectedNode){return selectedNode;}var items=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetItems(handle);for(var i=0;i<items.length;i++){var searchTextNode=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetSearchTextElement(items[i]);var searchText=D2L.LP.Web.UI.Html.Dom.GetAttribute(searchTextNode,'data-d2l-searchtext');if(searchText==handle.text){return items[i];}}},HandleKeyNavigation:function(handle,goUp){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var items=me.GetItems(handle);var GetSelectedIndex=function(){var selected=me.GetSelectedItemNode(handle);var index=-1;for(var i=0;i<items.length;i++){if(items[i]===selected){index=i;}}return index;};var selectedIndex=GetSelectedIndex(handle);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-autocomplete-item-hover',items[selectedIndex]);var nextItem=null;if(goUp){if(selectedIndex===-1){selectedIndex=items.length;}for(var i=--selectedIndex;i>=0;i--){if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',items[i])&&D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-autocomplete-item',items[i])){nextItem=items[i];break;}}}else{for(var i=++selectedIndex;i<items.length;i++){if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',items[i])&&D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-autocomplete-item',items[i])){nextItem=items[i];break;}}}var div=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.containerNode);if(nextItem!==null){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-autocomplete-item-hover',nextItem);me.DisplayText(handle,nextItem);var divBox=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(div);var itemBox=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(nextItem);if(itemBox.bottom>divBox.bottom){div.scrollTop+=itemBox.bottom-divBox.bottom;}if(itemBox.top<divBox.top){div.scrollTop-=divBox.top-itemBox.top;}}else{me.ResetText(handle);div.scrollTop=0;}},Highlight:function(text,start,length){if(length==0||length+start>text.length){return'';}var a=text.split("");var result="";var countdown=false;for(var i=0;i<a.length;i++){if(i==start){result+='<b>';countdown=true;}result+=a[i];if(countdown){length--;}if(length==0){result+='</b>';}}return result;},InitHandle:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var handle={containerNode:node,sourceNode:null,placeholderNode:null,valueHidden:null,keyHidden:null,text:'',key:'',activeDescendant:null,threshold:1,hasHeaders:false,displayResultsMessage:false,displayNoResultsMessage:false,forceSelection:false,onSourceFocus:null,queryDelay:150,keyPressTimeout:null,onItemSelected:null,matchWidthId:null,totalResults:0,numberMatches:0,removeMode:false};var sourceId=me.GetDataAttribute(handle.containerNode,'data-d2l-source');handle.sourceNode=D2L.LP.Web.UI.Html.Dom.GetElementById(sourceId);handle.text=handle.sourceNode.value;handle.placeholderNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.containerNode);var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-autocomplete-hidden',handle.containerNode)[0];handle.valueHidden=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(hiddenNode);handle.valueKey=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(handle.valueHidden);if(handle.text!=null){handle.valueHidden.value=handle.text;handle.valueKey.value=-1;}handle.displayResultsMessage=me.GetDataAttribute(handle.containerNode,'data-d2l-displayresultsmessage');handle.displayNoResultsMessage=me.GetDataAttribute(handle.containerNode,'data-d2l-displaynoresultsmessage');handle.forceSelection=me.GetDataAttribute(handle.containerNode,'data-d2l-forceselection');handle.hasHeaders=me.GetDataAttribute(node,'data-d2l-hasheaders');handle.threshold=me.GetDataAttribute(handle.containerNode,'data-d2l-threshold');handle.matchWidthId=me.GetDataAttribute(node,'data-d2l-width');handle.onItemSelected=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.containerNode.id,'itemSelected');handle.removeMode=me.GetDataAttribute(node,'data-d2l-removemode');var items=me.GetItems(handle);if(items.length!=0){handle.totalResults=items.length;handle.numberMatches=items.length;}node.handle=handle;return handle;},Initialize:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;me.InstallMouseSupport(handle);me.InstallItemMouseSupport(handle);me.InstallKeyboardSupport(handle);handle.mouseUpHandler=function(e){if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(handle.containerNode,e.target)){handle._clicked=false;}};D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',handle.sourceNode,function(e){var target=e.explicitOriginalTarget||document.activeElement;if(target==handle.placeholderNode){handle.sourceNode.focus();return;}if(!handle._clicked){me.CloseContainer(handle);}if(me.FindMatch(handle)||!handle.forceSelection){me.DisplayAndSetText(handle);if(handle.onItemSelected&&handle.text.length>0){if(handle.removeMode&&handle.forceSelection){var itemNode=me.GetSelectedItemNode(handle);D2L.LP.Web.UI.Html.Dom.SetAttribute(itemNode,'data-d2l-added',"");D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',itemNode);}handle.onItemSelected();}}else{me.ResetText(handle,true);}});D2L.LP.Web.UI.Html.Dom.AddEventListener('paste',handle.sourceNode,function(){setTimeout(function(){me.SetText(handle);handle.processFunction(handle);},0);});handle.onSourceFocus=function(){me.SetText(handle);handle.processFunction(handle);D2L.LP.Web.UI.Html.Dom.RemoveEventListener('focus',handle.sourceNode,handle.onSourceFocus);};D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',handle.sourceNode,handle.onSourceFocus);var items=me.GetItems(handle);for(var i=0;i<items.length;i++){var headers=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-autocomplete-headertextitem',items[i]);if(headers!=null&&headers[0]!=null){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-autocomplete-headeritem',items[i]);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-autocomplete-item',items[i]);D2L.LP.Web.UI.Html.Dom.SetAttribute(headers[0],'role','heading');handle.hasHeaders=true;}}if(handle.hasHeaders){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-autocomplete-headers',handle.containerNode);handle.totalResults=me.GetItems(handle).length;}D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,'autocomplete','off');D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,'role','autocomplete');D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,'aria-autocomplete','list');D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,'aria-expanded','false');D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,'aria-owns',handle.containerNode.id);D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,'tabindex',0);},InstallItemMouseSupport:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var items=me.GetItems(handle);var MouseOverItem=function(e){var item;if(e.currentTarget){item=e.currentTarget;}else{item=e.srcElement;if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-autocomplete-item',item)){item=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-autocomplete-item',item);}}if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-autocomplete-item',item)){return;}D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-autocomplete-item-hover',item);};for(var i=0;i<items.length;i++){D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseover',items[i],MouseOverItem);D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseout',items[i],function(){var item=me.GetSelectedItemNode(handle);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-autocomplete-item-hover',item);});}},ClearEntry:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetHandle(id);handle.text="";handle.key="";},InstallKeyboardSupport:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var commitChoice=function(){if(me.FindMatch(handle)||!handle.forceSelection){me.DisplayAndSetText(handle);if(handle.onItemSelected&&handle.text.length>0){if(handle.removeMode&&handle.forceSelection){var itemNode=me.GetSelectedItemNode(handle);D2L.LP.Web.UI.Html.Dom.SetAttribute(itemNode,'data-d2l-added',"");D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',itemNode);}handle.onItemSelected();}}else{me.ResetText(handle,true);}};var onSourceKeyUp=function(kpArgs){var keys=D2L.LP.Web.UI.Html.Dom.KeyUpEventArgs.Key;var key=kpArgs.GetKey();if(key===keys.ArrowDown){if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',handle.containerNode)){handle.processFunction(handle);}else{me.HandleKeyNavigation(handle,false);}me.SetText(handle);}else if(key===keys.ArrowUp){if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',handle.containerNode)){me.HandleKeyNavigation(handle,true);}}else if(key===keys.Enter){commitChoice();me.CloseContainer(handle);}else if(key===keys.Escape){me.CloseContainer(handle);me.ResetText(handle);}else if(key!=keys.Tab&&key!=keys.Shift&&key!=keys.Control&&key!=keys.ArrowLeft&&key!=keys.ArrowRight&&key!=keys.Home&&key!=keys.End){me.SetText(handle);if(handle.keyPressTimeout){clearTimeout(handle.keyPressTimeout);}handle.keyPressTimeout=setTimeout(function(){handle.processFunction(handle,true);},handle.queryDelay);}};D2L.LP.Web.UI.Html.Dom.AddKeyUpEventListener(handle.sourceNode,function(kpArgs){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(kpArgs.m_event);D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(kpArgs.m_event);onSourceKeyUp(kpArgs);});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(handle.sourceNode,function(kpArgs){if(kpArgs.GetKey()===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab){me.CloseContainer(handle);handle.sourceNode.focus();}});D2L.LP.Web.UI.Html.Dom.AddEventListener('keydown',handle.sourceNode,function(e){if(e.keyCode===38||e.keyCode===40){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(e);}});},InstallMouseSupport:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var MouseDownItem=function(e){var target=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(e);if(target!=handle.placeholderNode){var itemNode=me.GetSelectedItemNode(handle);if(itemNode==null){return;}handle._clicked=true;}};var MouseClickItem=function(e){handle._clicked=false;var target=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(e);if(target!=handle.placeholderNode){var itemNode=me.GetSelectedItemNode(handle);if(itemNode==null){return;}me.DisplayAndSetText(handle,itemNode);if(handle.onItemSelected&&handle.text.length>0){if(handle.removeMode&&handle.forceSelection){D2L.LP.Web.UI.Html.Dom.SetAttribute(itemNode,'data-d2l-added',"");D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',itemNode);}handle.onItemSelected();}me.CloseContainer(handle);}};D2L.LP.Web.UI.Html.Dom.AddEventListener('mousedown',handle.containerNode,MouseDownItem);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',handle.containerNode,MouseClickItem);},OpenContainer:function(handle){if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',handle.containerNode)){return;}D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseup',document.body,handle.mouseUpHandler);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',handle.containerNode);D2L.LP.Web.UI.Desktop.Controls.AutoComplete.ResizeContainer(handle);handle.sourceNode.focus();D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,'aria-expanded','true');D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.containerNode,'aria-hidden','false');},ResizeContainer:function(handle){var listContainerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.containerNode);var listNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listContainerNode);if(!listContainerNode.style.minWidth){var maxItemWidth=Math.max(listContainerNode.offsetWidth,listContainerNode.scrollWidth)+20;var sourceControlWidth=handle.sourceNode.offsetWidth-12;if(handle.matchWidthId){var matchWidthNode=D2L.LP.Web.UI.Html.Dom.GetElementById(handle.matchWidthId);sourceControlWidth=matchWidthNode.clientWidth-12;}var listWidth=sourceControlWidth>=maxItemWidth?sourceControlWidth:maxItemWidth+24;listContainerNode.style.minWidth=listWidth+"px";listNode.style.minWidth=listWidth-(listContainerNode.offsetWidth-listContainerNode.clientWidth+1)+"px";}},ResetText:function(handle,clear){if(clear){handle.text='';handle.key='';}handle.sourceNode.value=handle.text;D2L.LP.Web.UI.Html.Dom.RemoveAttribute(handle.sourceNode,'aria-activedescendant');D2L.LP.Web.UI.Desktop.Controls.AutoComplete.FireChangeEvent(handle);},SetText:function(handle){var changed=handle.text!==handle.sourceNode.value;handle.text=handle.sourceNode.value;D2L.LP.Web.UI.Html.Dom.RemoveAttribute(handle.sourceNode,'aria-activedescendant');if(changed){D2L.LP.Web.UI.Desktop.Controls.AutoComplete.FireChangeEvent(handle);}},ShowItemByKey:function(id,key){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var items=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-autocomplete-item',node);for(var i=0;i<items.length;i++){if(D2L.LP.Web.UI.Html.Dom.HasAttribute(items[i],'data-d2l-added')){var textNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-autocomplete-searchtext',items[i])[0];var itemKey=D2L.LP.Web.UI.Html.Dom.GetAttribute(textNode,'data-d2l-key');if(key==itemKey){D2L.LP.Web.UI.Html.Dom.RemoveAttribute(items[i],'data-d2l-added');break;}}}},HideItemByKey:function(id,key){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var items=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-autocomplete-item',node);for(var i=0;i<items.length;i++){if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(items[i],'data-d2l-added')){var textNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-autocomplete-searchtext',items[i])[0];var itemKey=D2L.LP.Web.UI.Html.Dom.GetAttribute(textNode,'data-d2l-key');if(key==itemKey){D2L.LP.Web.UI.Html.Dom.SetAttribute(items[i],'data-d2l-added');D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',items[i]);break;}}}}};D2L.LP.Web.UI.Desktop.Controls.AutoComplete.SelectionInfo=D2L.Class.Create({Construct:function(value,key){this.m_value=value;this.m_key=key;},_deserialize:function(deserializer){this.m_value=deserializer.GetMember('value');this.m_key=deserializer.GetMember('key');},_serialize:function(serializer){serializer.AddMember('value',this.m_value);serializer.AddMember('key',this.m_key);},GetValue:function(){return this.m_value;},GetKey:function(){return this.m_key;}});D2L.LP.Web.UI.Desktop.Controls.AutoComplete.Static={Filter:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;if(handle.sourceNode.value.length<handle.threshold){me.CloseContainer(handle);return;}me.OpenContainer(handle);var items=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-autocomplete-item',handle.containerNode);for(var i=0;i<items.length;i++){var item=me.GetSearchTextElement(items[i]);var displayText=me.Encode(D2L.LP.Web.UI.Html.Dom.GetAttribute(item,'data-d2l-searchtext'));var searchText=me.Encode(handle.text);if(displayText.toLowerCase().indexOf(searchText.toLowerCase())==-1){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',items[i]);}else{if(D2L.LP.Web.UI.Html.Dom.HasAttribute(items[i],'data-d2l-added')){continue;}D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',items[i]);if(handle.text.length>0){var start=displayText.toLowerCase().indexOf(searchText.toLowerCase());displayText=me.Highlight(displayText,start,searchText.length);}item.innerHTML=displayText;}}me.Static.RemoveHeaders(handle);var showContainer=me.Static.HasMatches(handle);if(handle.displayNoResultsMessage||handle.displayResultsMessage){me.DisplayMessage(handle,showContainer);}else if(!showContainer){me.CloseContainer(handle);}},HasMatches:function(handle){var items=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetItems(handle);handle.numberMatches=0;for(var i=0;i<items.length;i++){if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',items[i])){handle.numberMatches++;}}if(handle.numberMatches==0){return false;}return true;},RemoveHeaders:function(handle){if(handle.hasHeaders){var headers=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-autocomplete-headeritem',handle.containerNode);for(var i=0;i<headers.length;i++){var currentNode=headers[i];while(true){var sibling=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(currentNode);if(sibling==null||D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-autocomplete-headeritem',sibling)){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',headers[i]);break;}else if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-autocomplete-item',sibling)&&!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',sibling)){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',headers[i]);break;}currentNode=sibling;}}}}};D2L.LP.Web.UI.Desktop.Controls.AutoComplete.Dynamic={GetValue:function(sourceId){var sourceNode=D2L.LP.Web.UI.Html.Dom.GetElementById(sourceId.GetValue());var text=sourceNode.value;return text;},PartialFunction:function(handle,keyPressed){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;if(handle.lastSearch==handle.text&&!keyPressed){me.OpenContainer(handle);return;}if(handle.sourceNode.value.length>=handle.threshold){var reloadFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.containerNode.id,'reload');var result=reloadFunction();result.AddListener(function(){me.InstallItemMouseSupport(handle);var items=me.GetItems(handle);handle.lastSearch=handle.text;var listNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.placeholderNode);handle.totalResults=me.GetDataAttribute(listNode,'data-d2l-totalresults');me.Dynamic.GetMessages(handle);if(items.length!=0){handle.numberMatches=items.length;}if(items.length==0){me.DisplayMessage(handle,false);if(handle.displayNoResultsMessage){me.OpenContainer(handle);}}else{me.DisplayMessage(handle,true);me.Dynamic.IsResizeNeeded(handle);me.Dynamic.HighlightResults(handle,items);me.OpenContainer(handle);}});}else{me.CloseContainer(handle);}},HighlightResults:function(handle,items){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;if(handle.highlight&&handle.sourceNode.value.length>0){for(var i=0;i<items.length;i++){var item=me.GetSearchTextElement(items[i]);var displayText=me.Encode(D2L.LP.Web.UI.Html.Dom.GetAttribute(item,'data-d2l-searchtext'));var searchText=me.Encode(handle.text);var start=displayText.toLowerCase().indexOf(searchText.toLowerCase());displayText=me.Highlight(displayText,start,searchText.length);item.innerHTML=displayText;}}},IsResizeNeeded:function(handle){var listNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.containerNode);var width=Math.max(listNode.offsetWidth,listNode.scrollWidth);if(width>parseInt(listNode.style.minWidth,10)+2){listNode.style.minWidth="";D2L.LP.Web.UI.Desktop.Controls.AutoComplete.ResizeContainer(handle);}},GetMessages:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var placeholder=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.containerNode);var listNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(placeholder);var messageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-autocomplete-message',handle.containerNode)[0];var noResultsMessage=me.GetDataAttribute(listNode,'data-d2l-noresultsMessage');var resultsMessage=me.GetDataAttribute(listNode,'data-d2l-resultsMessage');if(noResultsMessage!=null){D2L.LP.Web.UI.Html.Dom.SetAttribute(messageNode,'data-d2l-noresultsmessage',noResultsMessage);}if(resultsMessage!=null){D2L.LP.Web.UI.Html.Dom.SetAttribute(messageNode,'data-d2l-resultsmessage',resultsMessage);}}};D2L.LP.Web.UI.Desktop.Controls.Breadcrumbs={SetTextNode:function(node,text){if(node.tagName==='D2L-BREADCRUMB'||node.tagName==='D2L-BREADCRUMB-CURRENT-PAGE'){node.setAttribute('text',text);return;}var textNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-breadcrumb-text',node);if(!textNode){return;}while(textNode.firstChild){textNode.removeChild(textNode.firstChild);}textNode.appendChild(document.createTextNode(text));}};D2L.LP.Web.UI.Desktop.Controls.Button={Build:function(doc){doc=doc||document;var node=doc.createElement('button');D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-button',node);D2L.LP.Web.UI.Html.Dom.SetAttribute(node,'data-onclick','var a=1;');return node;},ClickNode:function(node){D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',node);},GetTextNode:function(node){var text=$(node).text().trim();return text;},GetTitleNode:function(node){var dom=D2L.LP.Web.UI.Html.Dom;var hasTitle=dom.HasAttribute(node,'title');if(!hasTitle){return'';}var title=dom.GetAttribute(node,'title');return title;},Init:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.Button;var dom=D2L.LP.Web.UI.Html.Dom;var $node=$(node);me.InitPageButtons(node);var locationOnClick=null;if(dom.HasAttribute(node,'data-location')){var href=dom.GetAttribute(node,'data-location');if(node.classList.contains('d2l-newwindow')){locationOnClick=function(){window.open(href,'_blank');};}else{locationOnClick=function(){D2L.LP.Web.UI.Html.Dom.Navigate(D2L.LP.Web.Http.UrlLocation.Create(href));};}}var hasOnClick=dom.HasAttribute(node,'data-onclick');if(!hasOnClick&&locationOnClick===null){return;}var onClick=dom.GetAttribute(node,'data-onclick');dom.RemoveAttribute(node,'data-onclick');var processingText=dom.GetAttribute(node,'data-processing-text');var hasProcessingText=processingText!==undefined&&processingText!==null&&processingText.length>0;var clickTime=null;var isProcessing=false;var beginProcessing=function(){isProcessing=true;setTimeout(function(){if(isProcessing&&hasProcessingText){me.SetIsEnabledNode(node,false);$node.data('originalText',me.GetTextNode(node));me.SetTextNode(node,processingText);D2L.LP.Web.UI.Events.OnProcessingBegin.Trigger();}},200);};var finishProcessing=function(){if(hasProcessingText){var text=$node.data('originalText')||me.GetTextNode(node);me.SetTextNode(node,text);me.SetIsEnabledNode(node,true);D2L.LP.Web.UI.Events.OnProcessingEnd.Trigger();}isProcessing=false;};var execOnClick=function(){if(node.d2l_onClick!==undefined){return node.d2l_onClick();}if(hasOnClick){return eval(onClick);}};var clickFunction=function(){var bypassDoubleClickPrevention=dom.HasClassName('d2l-button-bypass',node);var currentTime=new Date().getTime();if(!bypassDoubleClickPrevention&&clickTime!==null&&currentTime-clickTime<=500){clickTime=currentTime;return;}if(!me.IsEnabledNode(node)||!bypassDoubleClickPrevention&&isProcessing){return;}clickTime=currentTime;var ret=execOnClick();if(locationOnClick!==null&&ret!==false){locationOnClick();}if(typeof ret==='undefined'||ret===null||ret.AddListener===undefined){return;}beginProcessing();ret.AddListener(finishProcessing);ret.AddReleaseListener(finishProcessing);};$node.click(clickFunction);node.addEventListener('d2l-button-ghost-click',clickFunction);},IsPageButton:function(node){var dom=D2L.LP.Web.UI.Html.Dom;var isPageButton=dom.GetParentElementByClassName('d2l-page-buttons',node)!==null;if(isPageButton){return true;}var isDialogButton=dom.GetParentElementByClassName('d2l-dialog-buttons',node)!==null;if(isDialogButton){var isDialogFooterButton=dom.GetParentElementByClassName('d2l-dialog-footer',node)!==null;if(!isDialogFooterButton){return true;}}return false;},InitPageButtons:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.Button;var isPageButton=me.IsPageButton(node);if(!isPageButton){return;}var enableOnEnd=true;D2L.LP.Web.UI.Events.OnProcessingBegin.AddListener(function(){enableOnEnd=me.IsEnabledNode(node);if(enableOnEnd){me.SetIsEnabledNode(node,false);}});D2L.LP.Web.UI.Events.OnProcessingEnd.AddListener(function(){if(enableOnEnd){me.SetIsEnabledNode(node,true);}enableOnEnd=true;});},IsEnabledNode:function(node){return!node.disabled;},IsPrimaryNode:function(node){return node.hasAttribute('primary');},IsVisibleNode:function(node){var isVisible=!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',node);return isVisible;},SetIsEnabled:function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node)return;D2L.LP.Web.UI.Desktop.Controls.Button.SetIsEnabledNode(node,isEnabled);},SetIsEnabledNode:function(node,isEnabled){var isEnabledCurrent=D2L.LP.Web.UI.Desktop.Controls.Button.IsEnabledNode(node);if(isEnabled==isEnabledCurrent){return;}node.disabled=!isEnabled;},SetIsPrimaryNode:function(node,isPrimary){if(isPrimary){node.setAttribute('primary','');}else{node.removeAttribute('primary');}},SetIsVisibleNode:function(node,isVisible){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,isVisible);},SetOnClickNode:function(node,onClick){node.d2l_onClick=onClick;},SetText:function(id,text){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null){return;}D2L.LP.Web.UI.Desktop.Controls.Button.SetTextNode(node,text);},SetTextNode:function(node,text){var $node=$(node);var offscreen=$node.children('.vui-offscreen');if(offscreen.length===1){$(offscreen[0]).text(text);return;}$node.contents().filter(function(){return this.nodeType===3;}).remove();$node.append(document.createTextNode(text));},SetTitleNode:function(node,title){if(title===undefined||title===null||title.length===0){D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,'title');}else{D2L.LP.Web.UI.Html.Dom.SetAttribute(node,'title',title);}},UnbindEvents:function(node){$(node).unbind('click');}};D2L.LP.Web.UI.Desktop.Controls.ButtonSubtle={SetText:function(id,text){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null){return;}node.setAttribute('text',text);}};D2L.LP.Web.UI.Desktop.Controls.ButtonCheckbox={AdjustAria:function(nodes){var me=D2L.LP.Web.UI.Desktop.Controls.ButtonCheckbox;var isSelected=me.GetIsSelectedNode(nodes.hidden);D2L.LP.Web.UI.Html.Aria.SetAttribute(nodes.node,'checked',isSelected);var textNode=nodes.text;if(isSelected&&nodes.textSelected!==undefined){textNode=nodes.textSelected;}D2L.LP.Web.UI.Html.Aria.SetAttribute(nodes.node,'labelledby',textNode.id);},GetNodes:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null){throw'ButtonCheckbox not found: \''+id.GetValue()+'\'.';}return D2L.LP.Web.UI.Desktop.Controls.ButtonCheckbox.GetNodesNode(node);},GetNodesNode:function(node){var hidden=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);var textNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-button-checkbox-text',node);var ret={node:node,hidden:hidden,text:textNodes[0],textSelected:undefined};if(textNodes.length===2){ret.textSelected=textNodes[1];}return ret;},GetIsSelected:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.ButtonCheckbox;var nodes=me.GetNodes(id);var isSelected=me.GetIsSelectedNode(nodes.hidden);return isSelected;},GetIsSelectedNode:function(hiddenNode){var isSelected=hiddenNode.value==='1';return isSelected;},SetIsSelected:function(id,isSelected){var me=D2L.LP.Web.UI.Desktop.Controls.ButtonCheckbox;var nodes=me.GetNodes(id);if(isSelected==me.GetIsSelectedNode(nodes.hidden)){return;}nodes.hidden.value=isSelected?'1':'0';me.AdjustAria(nodes);if(isSelected){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-button-checkbox-selected',nodes.node);if(nodes.textSelected!==undefined){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',nodes.textSelected);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',nodes.text);}}else{D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-button-checkbox-selected',nodes.node);if(nodes.textSelected!==undefined){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',nodes.text);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',nodes.textSelected);}}var buttonId=id.GetValue();if(D2L.LP.Web.UI.ObjectRepository.HasKey(buttonId)){var onClick=D2L.LP.Web.UI.ObjectRepository.Get(buttonId,0);if(onClick!==null){onClick.call(onClick);}}},GetSelectedValues:function(groupName){var values=[];var groupNameId=groupName.GetValue();var inputs=D2L.LP.Web.UI.Html.Dom.GetElementsByName(groupName.GetValue());for(var i=0;i<inputs.length;i++){var valueNode=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(inputs[i]);var isSelectedNode=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(valueNode);if(isSelectedNode.value=='1'){values.push(valueNode.value);}}return values;}};D2L.LP.Web.UI.Desktop.Controls.ButtonFilterGroup={SetSelectedItem:function(itemId,triggerOnClick){var anchorNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());if(anchorNode===null){throw'ButtonFilterGroup.SetSelectedItem error: item not found \''+itemId.GetValue()+'\'.';}var anchorNodes=anchorNode.parentNode.parentNode.getElementsByTagName('a');for(var i=0;i<anchorNodes.length;i++){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-button-filter-selected',anchorNodes[i]);}if(triggerOnClick){D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',anchorNode);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-button-filter-selected',anchorNode);}},SetIsEnabled:function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var anchorNodes=node.getElementsByTagName('a');for(var i=0;i<anchorNodes.length;i++){var idValue=anchorNodes[i].getAttribute('id');var anchorId=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(idValue);D2L.LP.Web.UI.Desktop.Controls.Button.SetIsEnabled(anchorId,isEnabled);}}};D2L.LP.Web.UI.Desktop.Controls.ButtonMenu=D2L.LP.Web.UI.Desktop.Controls.ButtonMenu||{};D2L.LP.Web.UI.Desktop.Controls.ButtonMenu.Init=function(node){var contextMenuId=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(node.getAttribute("data-contextMenuId"));var dataOpenerId=node.getAttribute("data-openerId");var opener=node.querySelector('#'+dataOpenerId);var loadFunction=function(e){if(!D2L.LP.Web.UI.Html.Dom.GetElementById(contextMenuId.GetValue()))return;if(D2L.LP.Web.UI.Desktop.Controls.ContextMenu.IsOpen(contextMenuId)){D2L.LP.Web.UI.Desktop.Controls.ContextMenu.Close(contextMenuId);return;}var keypress=e.type==='keypress'?true:false;if(keypress&&e.which!==13&&e.which!==32)return;var isEnabled=D2L.LP.Web.UI.Desktop.Controls.ButtonMenu.IsEnabledNode(node);if(isEnabled){D2L.LP.Web.UI.Desktop.Controls.ContextMenu.CreateDropdownMenu(node,contextMenuId,opener,null,keypress);}};opener.addEventListener('mouseup',loadFunction);opener.addEventListener('keypress',loadFunction);var closeFunction=function(){var dropdownMenuContent=node.querySelector('d2l-dropdown-menu');if(dropdownMenuContent){node.removeChild(dropdownMenuContent);}};node.addEventListener('d2l-dropdown-close',closeFunction);};D2L.LP.Web.UI.Desktop.Controls.ButtonMenu.IsEnabledNode=function(node){return!node.disabled;};D2L.LP.Web.UI.Desktop.Controls.ButtonMenu.SetItemIsEnabled=function(id,key,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var contextMenuId=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-contextMenuId');D2L.LP.Web.UI.Desktop.Controls.ContextMenu.SetItemIsEnabled(D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(contextMenuId),key,isEnabled);};D2L.LP.Web.UI.Desktop.Controls.ButtonMenu.SetIsEnabled=function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());node.disabled=!isEnabled;D2L.LP.Web.UI.Desktop.Controls.ContextMenu.SetIsEnabled(id,isEnabled);};D2L.LP.Web.UI.Desktop.Controls.CalendarMini={SetFocus:function(id,ariaMessage){var miniCalPlaceholder=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!miniCalPlaceholder){return;}var miniCal=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-calendar-mini',miniCalPlaceholder);if(D2L.LP.Web.UI.Html.Dom.HasAttribute(miniCalPlaceholder,'data-restoreColumn')){var startFromBottom=true;if(D2L.LP.Web.UI.Html.Dom.HasAttribute(miniCalPlaceholder,'data-startFromBottom')){startFromBottom=D2L.LP.Web.UI.Html.Dom.GetAttribute(miniCalPlaceholder,'data-startFromBottom');startFromBottom=startFromBottom=='true';D2L.LP.Web.UI.Html.Dom.RemoveAttribute(miniCalPlaceholder,'data-startFromBottom');}var restoreColumn=D2L.LP.Web.UI.Html.Dom.GetAttribute(miniCalPlaceholder,'data-restoreColumn')-0;D2L.LP.Web.UI.Html.Dom.RemoveAttribute(miniCalPlaceholder,'data-restoreColumn');miniCal.navRestoreColumnFocus(restoreColumn,startFromBottom);}else if(D2L.LP.Web.UI.Html.Dom.HasAttribute(miniCalPlaceholder,'data-restoreDate')){var restoreDay=D2L.LP.Web.UI.Html.Dom.GetAttribute(miniCalPlaceholder,'data-restoreDate');D2L.LP.Web.UI.Html.Dom.RemoveAttribute(miniCalPlaceholder,'data-restoreDate');miniCal.navFocusDay(restoreDay);}else{miniCal.navFocusDay(1);}if(ariaMessage!==undefined&&ariaMessage!==null){D2L.LP.Web.UI.Html.Aria.LogMessage(ariaMessage);}}};D2L.LP.Web.UI.Desktop.Controls.Checkbox={SetIsChecked:function(id,checked){var checkbox=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(checkbox===null){return;}var hidden=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(checkbox);if(hidden===null){return;}hidden.value=checked?'1':'0';checkbox.checked=checked;},GetIsChecked:function(id){var checkbox=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(checkbox===null){throw'Checkbox not found \''+id.GetValue()+'\'.';}return checkbox.checked;},SetIsEnabled:function(id,isEnabled){var checkbox=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(checkbox===null){throw'Checkbox not found \''+id.GetValue()+'\'.';}D2L.LP.Web.UI.Html.Dom.SetIsEnabled(id,isEnabled);var label=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-checkbox-container",checkbox);if(label){if(isEnabled){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-checkbox-disabled',label);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-checkbox-disabled',label);}}},GetFirstChildCheckboxInputNode:function(parent){var checkboxes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-checkbox',parent);if(checkboxes!=null&&checkboxes.length>0){return checkboxes[0];}else{return null;}},TryGetIsChecked:function(id,defaultValue){var checkbox=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(checkbox===null){return defaultValue;}return checkbox.checked;}};D2L.LP.Web.UI.Desktop.Controls.CheckboxList={CascadeOptions:{None:0,Both:1},CascadeSelection:function(node,cascadeOption){if(cascadeOption===undefined||cascadeOption===null||cascadeOption==this.CascadeOptions.None){return;}var checkBox=D2L.LP.Web.UI.Desktop.Controls.CheckboxList.GetCheckboxNode(node);var childList=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-checkboxlist',node);if(childList===undefined||childList===null){return;}if(cascadeOption==this.CascadeOptions.Both){this.SetIsAllSelectedByNode(childList,checkBox.checked);}},GetCheckboxNode:function(itemNode){var checkbox=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-checkbox',itemNode);if(checkbox===undefined||checkbox===null){return null;}return checkbox;},GetSelectedValues:function(id,includeNestedLists){var itemNodes=this.GetItemsNodes(id,includeNestedLists);var values=[];for(var i=0;i<itemNodes.length;i++){var checkboxNode=this.GetCheckboxNode(itemNodes[i]);if(checkboxNode!=null&&checkboxNode.checked){values.push(checkboxNode.value);}}return values;},GetItemsNodes:function(id,includeNestedLists){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return this.GetItemsNodesByNode(node,includeNestedLists);},GetItemsNodesByNode:function(node,includeNestedLists){var checkBoxes;if(includeNestedLists===undefined||includeNestedLists===null){includeNestedLists=false;}if(!includeNestedLists){checkBoxes=D2L.LP.Web.UI.Html.Dom.GetImmediateChildElementsByClassName('d2l-checkboxlist-item',node);}else{checkBoxes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-checkboxlist-item',node);}return checkBoxes;},SetIsAllSelected:function(id,isSelected){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return this.SetIsAllSelectedByNode(node,isSelected);},SetIsAllSelectedByNode:function(node,isSelected){var itemNodes=this.GetItemsNodesByNode(node,false);var excludeDisabled=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-excludeDisabled');excludeDisabled=excludeDisabled=='true';for(var i=0;i<itemNodes.length;i++){var checkboxNode=this.GetCheckboxNode(itemNodes[i]);if(checkboxNode!=null&&!(checkboxNode.disabled&&excludeDisabled)){D2L.LP.Web.UI.Desktop.Controls.Checkbox.SetIsChecked(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(checkboxNode.id),isSelected);D2L.LP.Web.UI.Html.Dom.DispatchEvent('change',checkboxNode);}}},SetIsSelected:function(id,value,isSelected){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var excludeDisabled=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-excludeDisabled');if(excludeDisabled===undefined||excludeDisabled===null){excludeDisabled=false;}var cascadeSelection=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-cascadeSelection');if(cascadeSelection===undefined||cascadeSelection===null){cascadeSelection=false;}var itemNodes=this.GetItemsNodes(id,false);for(var i=0;i<itemNodes.length;i++){var checkboxNode=this.GetCheckboxNode(itemNodes[i]);if(checkboxNode!=null&&checkboxNode.value==value&&!(node.disabled&&excludeDisabled)){D2L.LP.Web.UI.Desktop.Controls.Checkbox.SetIsChecked(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(checkboxNode.id),isSelected);if(cascadeSelection){this.CascadeSelection(node);}return;}}},SetIsAllEnabled:function(id,isEnabled){var itemNodes=this.GetItemsNodes(id,false);for(var i=0;i<itemNodes.length;i++){var checkboxNode=this.GetCheckboxNode(itemNodes[i]);D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode(checkboxNode,isEnabled);}},GetIsAnySelectedFunction:function(id){return D2L.LP.Web.UI.Desktop.Controls.CheckboxList.GetSelectedValues(id).length>0;}};D2L.LP.Web.UI.Desktop.Controls.ColourSelector={RegexpNumbersAndComma:/[^0-9\-,]/g,RegexpHexCode:/#([0-9a-fA-F]){6}/,RegexpRgb:/rgb\(([0-9]{1,3}\u002c?\s?){3}\)/,RecentColours:'',ColourLookupTable:[],DefaultBgColour:'#ffffff',DefaultFgColour:'#000000',SaveRcListSubkey:'saveRcListFunc',GetHandle:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);return D2L.LP.Web.UI.Desktop.Controls.ColourSelector.GetHandleByNode(node);},GetHandleByNode:function(node){var originalColourNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);var hiddenValueNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(originalColourNode);var handle={hiddenValueNode:hiddenValueNode,originalColourNode:originalColourNode};return handle;},Init:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.ColourSelector;var handle=me.GetHandleByNode(node);var cp_hidden_value=handle.hiddenValueNode;var cp_hidden_type=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-type",node);var cp_hidden_otherColour=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-othercolour",node);var cp_button=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-button",node);var cp_button_colourBox;var cp_floating_container;if(cp_button!=null){cp_button_colourBox=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-colourbox",cp_button);cp_floating_container=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(cp_button);}var cp_nav_matrix=new Array();var cp_recentColourNodes;var cp_titlebar_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-titlebar-cont",node);var cp_colourpalette=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette",node);var cp_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-cont",node);var cp_basic_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-basic-cont",node);var cp_linebreak=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-linebreak",cp_basic_cont);var cp_adv_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-adv-cont",node);var cp_okcancel_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-okcancel",node);var cp_more_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-more",node);var cp_noColourOption=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-nav-nocolour",node);var cp_more_button=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-nav-moreoptions",node);var cp_ok_button=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-nav-ok",node);var cp_cancel_button=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-nav-cancel",node);var cp_slider_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-slider-cont",node);var cp_slider_gradient=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-slider-gradient",node);var cp_slider_arrow=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-slider-arrow",node);var cp_slider_arrow_swatch=node.querySelector(".d2l-colourpalette-slider-arrow div");var cp_slider_label=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-slider-label",node);var cp_slider_input=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-slider-input",node);var cp_swatch=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-swatch",node);var cp_hex_input=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-hex-input",node);var cp_adv_preview_cont=node.querySelector('.d2l-colourpalette-preview-cont');var cp_adv_previews=node.querySelectorAll('.d2l-colourpalette-previewbox');var cp_adv_preview_smalltext=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-previewbox-smalltext",node);var cp_adv_preview_largetext=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-previewbox-largetext",node);var cp_wcag_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-wcag-cont",node);var cp_wcag_status_image=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-wcag-status-image",node);var cp_wcag_status_error;var cp_wcag_status_warning;var cp_wcag_status_pass;if(cp_wcag_status_image!=null){cp_wcag_status_error=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(cp_wcag_status_image);cp_wcag_status_warning=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(cp_wcag_status_error);cp_wcag_status_pass=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(cp_wcag_status_warning);}var cp_wcag_contrast_label=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-wcag-contrast-label",node);var cp_wcag_contrast_ratios=node.querySelectorAll('.d2l-colourpalette-wcag-contrast-ratio');var cp_wcag_contrast_ratio=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-wcag-contrast-ratio",node);var cp_getLcpValueSubkey="getLcpIdFunc";var getLinkedColourSelectorValueFunc=D2L.LP.Web.UI.ObjectRepository.Get(node.id,cp_getLcpValueSubkey);var linkedColourSelectorId=getLinkedColourSelectorValueFunc();var cp_lcpNode=D2L.LP.Web.UI.Html.Dom.GetElementById(linkedColourSelectorId);var cp_lcpButton;var cp_lcpHidden_defaultValue;var cp_lcpHidden_value;var cp_lcpHidden_type;if(cp_lcpNode!=null){cp_lcpButton=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-button",cp_lcpNode);cp_lcpHidden_defaultValue=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(cp_lcpNode);cp_lcpHidden_value=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(cp_lcpHidden_defaultValue);cp_lcpHidden_type=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-type",cp_lcpNode);}var isNewColourPalette=cp_colourpalette.classList.contains('d2l-colourpalette-new');if(isNewColourPalette){if(cp_adv_preview_cont&&cp_lcpNode==null&&cp_hidden_otherColour==null){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_adv_preview_cont);}}else{if(cp_wcag_cont&&cp_lcpNode==null&&cp_hidden_otherColour==null){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_wcag_cont);}}var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var cp_shiftDown=false;var cp_isPaletteOpen=false;var cp_numElementsPerRow=parseInt(cp_colourpalette.getAttribute('data-colors-per-row'));var cp_nav_currRow=0;var cp_nav_currCol=0;var cp_isAdvancedMode=cp_button==null;var cp_isForegroundMode=false;var cp_contrast_ratio_addspace=true;var cp_hexInput_label_addspace=true;var cp_basicModeWidth=isNewColourPalette?"350px":"21em";var cp_advModeWidth=isNewColourPalette?cp_basicModeWidth:"42em";var cp_colourboxClassName="d2l-colourpalette-colourbox-a";var cp_recentColourClassName="d2l-colourselector-nav-recentcolours";var cp_default_color=cp_hidden_type.value=='Background'?"#ffffff":"#000000";var cp_slider_rgb={r:255,g:255,b:255};var cp_slider_rgb_other={r:0,g:0,b:0};var cp_slider_hsl={h:0,s:0,l:0};var cp_slider_position={x:25,y:96};var cp_slider_posyclamp={min:-4,max:196};var cp_slider_posyrate=2;var cp_slider_max=100;var cp_nav_moreButtonRow=0;var cp_slider_mouseDown=false;var cp_slider_offsetY=0;var cp_regexp_numbers=/[^0-9\-]/g;var cp_wcag_failMarker=3;var cp_wcag_warningMarker=4.5;var cp_wcag_correctMarker=4.5;var cp_initializeColourSelectorDialog;var cp_setBasicMode;var cp_setAdvancedMode;var cp_openContainer;var cp_closeContainer;var cp_button_clickHandler;var cp_nav_matrixBoundaryCheck;var cp_nav_focusNode;var cp_nav_resetRowColumn;var cp_nav_checkButtonSkip;var cp_setPreviewBoxColour;var cp_setColourSelectorColour;var cp_getEventTarget;var cp_getElementClassName;var cp_hasClassName;var cp_setLcpRgb;var cp_trim;var cp_setHexInput;var cp_setLightnessValue;var cp_setContrastRatio;var cp_slider_getLValue;var cp_slider_updateHex;var cp_slider_updateRgb;var cp_slider_updateHsl;var cp_nav_arrowUpHandler;var cp_nav_arrowDownHandler;var cp_nav_arrowLeftHandler;var cp_nav_arrowRightHandler;var cp_nav_escapeHandler;var cp_nav_onKeyPress;var cp_onKeyPress;var cp_colourPaletteClick;var cp_cancelButtonHandler;var cp_moreButtonHandler;var cp_nav_onShiftPress;var cp_okButtonHandler;var cp_slider_updateWcagImage;var cp_handleHexChange;var cp_handleHslChange;var cp_handleHslSliderChange;var cp_slider_arrowUpHandler;var cp_slider_arrowDownHandler;var cp_slider_handleMouse;var cp_slider_onKeyPress;var cp_set_nohover;var cp_set_hover;var cp_reset_hover;var cp_addHover;var cp_removeHover;var index;cp_recentColourNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-colourselector-nav-recentcolours",node);cp_nav_matrix[cp_nav_currRow]=new Array(cp_numElementsPerRow);cp_nav_currRow=0;cp_nav_currCol=0;for(index=0;index<cp_recentColourNodes.length;index++){if(cp_nav_currCol>=cp_numElementsPerRow){cp_nav_currRow++;cp_nav_matrix[cp_nav_currRow]=new Array(cp_numElementsPerRow);cp_nav_currCol=0;}cp_nav_matrix[cp_nav_currRow][cp_nav_currCol]=cp_recentColourNodes[index];cp_nav_currCol++;}if(cp_noColourOption!==null){cp_nav_currRow++;cp_nav_currCol=0;cp_nav_matrix[cp_nav_currRow]=new Array(cp_numElementsPerRow);for(cp_nav_currCol=0;cp_nav_currCol<cp_numElementsPerRow;cp_nav_currCol++){cp_nav_matrix[cp_nav_currRow][cp_nav_currCol]=cp_noColourOption;}}var cp_colourOptionNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-colourselector-nav-colouroptions",node);cp_nav_currRow++;cp_nav_currCol=0;cp_nav_matrix[cp_nav_currRow]=new Array(cp_numElementsPerRow);for(index=0;index<cp_colourOptionNodes.length;index++){if(cp_nav_currCol>=cp_numElementsPerRow){cp_nav_currRow++;cp_nav_matrix[cp_nav_currRow]=new Array(cp_numElementsPerRow);cp_nav_currCol=0;}cp_nav_matrix[cp_nav_currRow][cp_nav_currCol]=cp_colourOptionNodes[index];cp_nav_currCol++;}if(cp_more_button!=null){cp_nav_currRow++;cp_nav_currCol=0;cp_nav_matrix[cp_nav_currRow]=new Array(cp_numElementsPerRow);cp_nav_moreButtonRow=cp_nav_currRow;for(cp_nav_currCol=0;cp_nav_currCol<cp_numElementsPerRow;cp_nav_currCol++){cp_nav_matrix[cp_nav_currRow][cp_nav_currCol]=cp_more_button;}}var cp_buildColourLangTermLookupTable=function(){for(var i=0;i<cp_colourOptionNodes.length;i++){var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.GetBackgroundHexColour(cp_colourOptionNodes[i]);_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(_hex);var _title=cp_colourOptionNodes[i].title;D2L.LP.Web.UI.Desktop.Controls.ColourSelector.AddColourToLookupTable(_hex,_title);}};var cp_initRecentColoursTitles=function(){for(var i=0;i<cp_recentColourNodes.length;i++){var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.GetBackgroundHexColour(cp_recentColourNodes[i]);_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(_hex);var _title=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.ColourLookupTable[_hex];if(_title===undefined||_title===null){cp_recentColourNodes[i].title=_hex;}else{cp_recentColourNodes[i].title=_title;}}};cp_buildColourLangTermLookupTable();cp_initRecentColoursTitles();var cp_initAriaRoles=function(){var _relatedElement;if(cp_button!=null){D2L.LP.Web.UI.Html.Aria.SetRole(cp_button,"button");D2L.LP.Web.UI.Html.Aria.SetRole(cp_floating_container,"application");}else{D2L.LP.Web.UI.Html.Aria.SetRole(node,"application");}var colourLists=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-colourpalette-colourboxes-list",node);for(var i=0;i<colourLists.length;i++){var _heading=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(colourLists[i]);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourpalette-title",_heading);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourpalette-rclabel",_heading);D2L.LP.Web.UI.Html.Aria.SetAttribute(colourLists[i],"labelledby",_heading.id);}if(cp_slider_arrow!=null){D2L.LP.Web.UI.Html.Aria.SetRole(cp_slider_arrow,"slider");_relatedElement=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(cp_slider_arrow);D2L.LP.Web.UI.Html.Aria.SetAttribute(cp_slider_arrow,"label",_relatedElement.firstChild.nodeValue);if(!isNewColourPalette){_relatedElement=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(cp_slider_input);D2L.LP.Web.UI.Html.Aria.SetAttribute(cp_slider_input,"label",_relatedElement.innerHTML);}D2L.LP.Web.UI.Html.Aria.SetAttribute(cp_slider_arrow,"valuemin","0");D2L.LP.Web.UI.Html.Aria.SetAttribute(cp_slider_arrow,"valuemax","100");D2L.LP.Web.UI.Html.Aria.SetAttribute(cp_slider_arrow,"valuenow","50");}};cp_initAriaRoles();cp_initializeColourSelectorDialog=function(){cp_setLcpRgb();cp_moreButtonHandler();};cp_setBasicMode=function(){cp_isAdvancedMode=false;cp_floating_container.style.width=cp_basicModeWidth;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_more_cont);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_titlebar_cont);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_okcancel_cont);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_adv_cont);if(cp_noColourOption!==null){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_noColourOption);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_linebreak);}};cp_setAdvancedMode=function(){cp_isAdvancedMode=true;if(!isNewColourPalette&&cp_floating_container!=null){cp_floating_container.style.width=cp_advModeWidth;}D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_more_cont);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_titlebar_cont);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_okcancel_cont);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_adv_cont);if(cp_noColourOption!==null){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_noColourOption);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_linebreak);}};cp_openContainer=function(){cp_reset_hover();cp_isPaletteOpen=D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpenNode(cp_floating_container)||D2L.LP.Web.UI.Desktop.Controls.ColourSelector.m_isOpening;if(cp_isPaletteOpen){cp_nav_resetRowColumn();cp_shiftDown=false;cp_setBasicMode();cp_setLcpRgb();}else{cp_closeContainer();}};cp_closeContainer=function(){D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.CloseNode(cp_floating_container,false);cp_setBasicMode();};cp_nav_matrixBoundaryCheck=function(){return cp_nav_currRow>=0&&cp_nav_currRow<cp_nav_matrix.length&&cp_nav_currCol>=0&&cp_nav_currCol<cp_numElementsPerRow;};cp_nav_resetRowColumn=function(ignoreFocus){cp_nav_currRow=0;cp_nav_currCol=0;if(!ignoreFocus){cp_nav_focusNode();}};cp_nav_focusNode=function(){if(cp_nav_matrixBoundaryCheck()){if(cp_nav_matrix[cp_nav_currRow][cp_nav_currCol]!==null){cp_nav_matrix[cp_nav_currRow][cp_nav_currCol].focus();}}};cp_nav_checkButtonSkip=function(skippedButtonNode){if(cp_nav_matrixBoundaryCheck()){if(cp_nav_matrix[cp_nav_currRow][cp_nav_currCol]===skippedButtonNode){return true;}}return false;};cp_setPreviewBoxColour=function(hex){if(cp_isForegroundMode===true){if(cp_adv_preview_smalltext!=null){cp_adv_preview_smalltext.style.color=hex;cp_adv_preview_largetext.style.color=hex;}}else{if(cp_adv_previews!=null){for(var i=0;i<cp_adv_previews.length;i++){cp_adv_previews[i].style.backgroundColor=hex;}}}};cp_setColourSelectorColour=function(isNone,updateRecentColours,selColour){if(isNone&&cp_isForegroundMode===false){D2L.LP.Web.UI.Desktop.Controls.Hidden.SetValueNode(cp_hidden_value,'');if(cp_button_colourBox!=null){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourselector-noneselected",cp_button_colourBox);}}else{var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(selColour);if(_hex===false){_hex=cp_default_color;}D2L.LP.Web.UI.Desktop.Controls.Hidden.SetValueNode(cp_hidden_value,_hex);if(cp_button_colourBox!=null){cp_button_colourBox.style.backgroundColor=_hex;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-colourselector-noneselected",cp_button_colourBox);}D2L.LP.Web.UI.Desktop.Controls.ColourSelector.UpdateRecentColourListFromNodes(_hex,cp_recentColourNodes,node.id);var saveRecentColourListFunc=D2L.LP.Web.UI.ObjectRepository.Get(node.id,D2L.LP.Web.UI.Desktop.Controls.ColourSelector.SaveRcListSubkey);saveRecentColourListFunc();}var onChange=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onchange');if(onChange!==null){onChange.call(onChange);}cp_closeContainer();return true;};cp_getEventTarget=function(event){return D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(event);};cp_getElementClassName=function(node){var _className=node.className;if(_className==null){_className=node.getAttribute("class");if(_className==null){return false;}}return _className;};cp_hasClassName=function(className,node){var _className=cp_getElementClassName(node);if(_className===false){return _className;}var _classes=_className.split(' ');for(var i=0;i<_classes.length;i++){if(_classes[i]==className){return true;}}return false;};cp_setLcpRgb=function(){var _rgb;if(cp_hidden_type!=null){if(cp_lcpHidden_value!=null&&cp_lcpHidden_type!=null){_rgb=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HexToRgb(cp_lcpHidden_value.value);if(_rgb!=null){cp_slider_rgb_other.r=_rgb.r;cp_slider_rgb_other.g=_rgb.g;cp_slider_rgb_other.b=_rgb.b;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_adv_preview_smalltext);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_adv_preview_largetext);}}else if(cp_hidden_otherColour!=null){_rgb=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HexToRgb(cp_hidden_otherColour.value);if(_rgb!=null){cp_slider_rgb_other.r=_rgb.r;cp_slider_rgb_other.g=_rgb.g;cp_slider_rgb_other.b=_rgb.b;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_adv_preview_smalltext);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_adv_preview_largetext);}}if(cp_hidden_type.value=="Foreground"){cp_isForegroundMode=true;if(_rgb==null||cp_lcpHidden_type!=null&&cp_lcpHidden_type.value==cp_hidden_type.value&&cp_hidden_otherColour==null){cp_slider_rgb_other.r=255;cp_slider_rgb_other.g=255;cp_slider_rgb_other.b=255;}}else{cp_isForegroundMode=false;if(_rgb==null||cp_lcpHidden_type!=null&&cp_lcpHidden_type.value==cp_hidden_type.value&&cp_hidden_otherColour==null){cp_slider_rgb_other.r=0;cp_slider_rgb_other.g=0;cp_slider_rgb_other.b=0;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_adv_preview_smalltext);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_adv_preview_largetext);}}var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RgbToHex(cp_slider_rgb_other);_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(_hex);if(cp_isForegroundMode!==true){if(cp_adv_preview_smalltext!=null){cp_adv_preview_smalltext.style.color=_hex;cp_adv_preview_largetext.style.color=_hex;}}else{if(cp_adv_previews!=null){for(var i=0;i<cp_adv_previews.length;i++){cp_adv_previews[i].style.backgroundColor=_hex;}}}}};cp_trim=function(str){return str.replace(/^\s+|\s+$/g,'');};cp_setHexInput=function(newHexValue){if(newHexValue.charAt(0)=="#"){newHexValue.substring(1);}cp_hex_input.value=newHexValue;cp_swatch.style.backgroundColor='#'+newHexValue;if(isNewColourPalette){cp_slider_arrow_swatch.style.backgroundColor='#'+newHexValue;}if(cp_hexInput_label_addspace===true){cp_hexInput_label_addspace=false;}else{cp_hexInput_label_addspace=true;}};cp_setLightnessValue=function(newLightnessValue){cp_slider_input.value=newLightnessValue;D2L.LP.Web.UI.Html.Aria.SetAttribute(cp_slider_arrow,"valuenow",newLightnessValue);if(!isNewColourPalette){D2L.LP.Web.UI.Html.Aria.SetAttribute(cp_slider_input,"valuetext",cp_slider_label.innerHTML+" "+newLightnessValue+"%");}};cp_setContrastRatio=function(newContrastRatio){cp_slider_updateWcagImage(newContrastRatio);if(isNewColourPalette){for(var i=0;i<cp_wcag_contrast_ratios.length;i++){cp_wcag_contrast_ratios[i].innerHTML=newContrastRatio+":1";}}else{if(cp_contrast_ratio_addspace===true){cp_wcag_contrast_label.innerHTML=cp_wcag_contrast_label.innerHTML+" ";cp_wcag_contrast_ratio.innerHTML=newContrastRatio+":1"+" ";cp_contrast_ratio_addspace=false;}else{cp_wcag_contrast_label.innerHTML=cp_trim(cp_wcag_contrast_label.innerHTML);cp_wcag_contrast_ratio.innerHTML=newContrastRatio+":1";cp_contrast_ratio_addspace=true;}}};cp_slider_getLValue=function(){var _lvalue=parseInt((cp_slider_position.y-cp_slider_posyclamp.min)/cp_slider_posyrate);_lvalue=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHslPercentage(_lvalue);return cp_slider_max-_lvalue;};cp_slider_updateWcagImage=function(contrastRatio){if(isNewColourPalette){var wcagStatus=node.querySelector('.d2l-colourpalette-wcag-status');if(contrastRatio<cp_wcag_failMarker){node.querySelector('.d2l-colourpalette-previewbox-small-wcag-icon > .d2l-colourpalette-previewbox-wcag-icon-pass').style.display='none';node.querySelector('.d2l-colourpalette-previewbox-small-wcag-icon > .d2l-colourpalette-previewbox-wcag-icon-fail').style.display='inline-block';node.querySelector('.d2l-colourpalette-previewbox-large-wcag-icon > .d2l-colourpalette-previewbox-wcag-icon-pass').style.display='none';node.querySelector('.d2l-colourpalette-previewbox-large-wcag-icon > .d2l-colourpalette-previewbox-wcag-icon-fail').style.display='inline-block';wcagStatus.textContent=wcagStatus.getAttribute('data-wcag-contrast-ratio')+' '+contrastRatio+'. '+wcagStatus.getAttribute('data-wcag-error-message')+' '+wcagStatus.getAttribute('data-wcag-accessible-ratio')+' 3.';}else if(contrastRatio<cp_wcag_warningMarker){node.querySelector('.d2l-colourpalette-previewbox-small-wcag-icon > .d2l-colourpalette-previewbox-wcag-icon-pass').style.display='none';node.querySelector('.d2l-colourpalette-previewbox-small-wcag-icon > .d2l-colourpalette-previewbox-wcag-icon-fail').style.display='inline-block';node.querySelector('.d2l-colourpalette-previewbox-large-wcag-icon > .d2l-colourpalette-previewbox-wcag-icon-fail').style.display='none';node.querySelector('.d2l-colourpalette-previewbox-large-wcag-icon > .d2l-colourpalette-previewbox-wcag-icon-pass').style.display='inline-block';wcagStatus.textContent=wcagStatus.getAttribute('data-wcag-contrast-ratio')+' '+contrastRatio+'. '+wcagStatus.getAttribute('data-wcag-warning-message')+' '+wcagStatus.getAttribute('data-wcag-accessible-ratio')+' 4.5';}else if(contrastRatio>=cp_wcag_correctMarker){node.querySelector('.d2l-colourpalette-previewbox-small-wcag-icon > .d2l-colourpalette-previewbox-wcag-icon-fail').style.display='none';node.querySelector('.d2l-colourpalette-previewbox-small-wcag-icon > .d2l-colourpalette-previewbox-wcag-icon-pass').style.display='inline-block';node.querySelector('.d2l-colourpalette-previewbox-large-wcag-icon > .d2l-colourpalette-previewbox-wcag-icon-fail').style.display='none';node.querySelector('.d2l-colourpalette-previewbox-large-wcag-icon > .d2l-colourpalette-previewbox-wcag-icon-pass').style.display='inline-block';wcagStatus.textContent=wcagStatus.getAttribute('data-wcag-contrast-ratio')+' '+contrastRatio+'. '+wcagStatus.getAttribute('data-wcag-pass-message')+' '+wcagStatus.getAttribute('data-wcag-accessible-ratio')+' 3.';}}else{if(contrastRatio<cp_wcag_failMarker){cp_wcag_status_image.style.backgroundImage="url(/d2l/img/lp/colourSelector/error.gif)";cp_wcag_status_image.title=cp_wcag_status_error.innerHTML;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_wcag_status_error);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_wcag_status_warning);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_wcag_status_pass);}else if(contrastRatio<cp_wcag_warningMarker){cp_wcag_status_image.style.backgroundImage="url(/d2l/img/lp/colourSelector/warning.gif)";cp_wcag_status_image.title=cp_wcag_status_warning.innerHTML;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_wcag_status_error);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_wcag_status_warning);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_wcag_status_pass);}else if(contrastRatio>=cp_wcag_correctMarker){cp_wcag_status_image.style.backgroundImage="url(/d2l/img/lp/colourSelector/correct.gif)";cp_wcag_status_image.title=cp_wcag_status_pass.innerHTML;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_wcag_status_error);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_wcag_status_warning);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_wcag_status_pass);}}};cp_slider_updateHex=function(updateGradient){var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RgbToHex(cp_slider_rgb);cp_setHexInput(_hex);_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(_hex);cp_setPreviewBoxColour(_hex);if(updateGradient===true){var _rgb=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HslToRgb(cp_slider_hsl.h,cp_slider_hsl.s,cp_slider_max*0.5);_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RgbToHex(_rgb);_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(_hex);cp_slider_gradient.style.backgroundColor=_hex;}var _contrastRatio=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.GetContrastRatio(cp_slider_rgb_other,cp_slider_rgb);_contrastRatio=Math.round(_contrastRatio*10)/10;cp_setContrastRatio(_contrastRatio);};cp_slider_updateRgb=function(updateGradient){cp_slider_hsl.l=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHslPercentage(cp_slider_input.value);cp_setLightnessValue(cp_slider_hsl.l);cp_slider_rgb=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HslToRgb(cp_slider_hsl.h,cp_slider_hsl.s,cp_slider_hsl.l);cp_slider_updateHex(updateGradient);};cp_slider_updateHsl=function(updateGradient){var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(cp_hex_input.value);if(_hex==="false"||_hex.length==0){_hex=cp_default_color;}cp_setHexInput(_hex);cp_slider_rgb=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HexToRgb(_hex);cp_slider_hsl=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RgbToHsl(cp_slider_rgb.r,cp_slider_rgb.g,cp_slider_rgb.b);cp_setLightnessValue(cp_slider_hsl.l);cp_slider_updateHex(updateGradient);};cp_handleHexChange=function(){cp_slider_updateHsl(true);cp_slider_position.y=(cp_slider_max-cp_slider_input.value)*cp_slider_posyrate+cp_slider_posyclamp.min;if(isNewColourPalette){if(isRTL){cp_slider_arrow.style.left=cp_slider_position.y*-1+"px";}else{cp_slider_arrow.style.left=cp_slider_position.y+"px";}}else{cp_slider_arrow.style.top=cp_slider_position.y+"px";}};cp_handleHslChange=function(){cp_slider_updateRgb(true);cp_slider_position.y=(cp_slider_max-cp_slider_input.value)*cp_slider_posyrate+cp_slider_posyclamp.min;if(isNewColourPalette){if(isRTL){cp_slider_arrow.style.left=cp_slider_position.y*-1+"px";}else{cp_slider_arrow.style.left=cp_slider_position.y+"px";}}else{cp_slider_arrow.style.top=cp_slider_position.y+"px";}};cp_handleHslSliderChange=function(){cp_slider_updateRgb(false);};cp_nav_arrowUpHandler=function(){cp_nav_currRow--;if(cp_nav_currRow<0){cp_nav_currRow=cp_nav_matrix.length-1;}if(cp_isAdvancedMode===true&&(cp_nav_checkButtonSkip(cp_more_button)||cp_nav_checkButtonSkip(cp_noColourOption))){cp_nav_arrowUpHandler();}else{cp_nav_focusNode();}};cp_nav_arrowDownHandler=function(){cp_nav_currRow++;if(cp_nav_currRow>=cp_nav_matrix.length){cp_nav_currRow=0;}if(cp_isAdvancedMode===true&&(cp_nav_checkButtonSkip(cp_more_button)||cp_nav_checkButtonSkip(cp_noColourOption))){cp_nav_arrowDownHandler();}else{cp_nav_focusNode();}};cp_nav_arrowLeftHandler=function(){cp_nav_currCol-=isRTL?-1:1;if(cp_nav_currCol<0){cp_nav_currCol=cp_numElementsPerRow-1;}else if(cp_nav_currCol>=cp_numElementsPerRow){cp_nav_currCol=0;}cp_nav_focusNode();};cp_nav_arrowRightHandler=function(){cp_nav_currCol+=isRTL?-1:1;if(cp_nav_currCol>=cp_numElementsPerRow){cp_nav_currCol=0;}else if(cp_nav_currCol<0){cp_nav_currCol=cp_numElementsPerRow-1;}cp_nav_focusNode();};cp_nav_escapeHandler=function(){cp_closeContainer();cp_button.focus();};cp_nav_onKeyPress=function(kpArgs){var result=false;if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowUp){cp_nav_arrowUpHandler();result=true;}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown){cp_nav_arrowDownHandler();result=true;}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowLeft){cp_nav_arrowLeftHandler();result=true;}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowRight){cp_nav_arrowRightHandler();result=true;}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter){result=cp_colourPaletteClick(kpArgs.GetEventObject());}return result;};cp_nav_onShiftPress=function(kpArgs){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab){var _lastCol=cp_nav_currCol;cp_nav_resetRowColumn();if(cp_isAdvancedMode===false){var _event=kpArgs.GetEventObject();if(!_event.shiftKey){cp_nav_currRow=cp_nav_moreButtonRow;cp_nav_currCol=_lastCol;}}}};cp_onKeyPress=function(kpArgs){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape){cp_nav_escapeHandler();}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab){var _event=kpArgs.GetEventObject();var _target=cp_getEventTarget(_event);if(_event.shiftKey){if(cp_noColourOption!=null&&_target==cp_noColourOption||cp_hasClassName(cp_colourboxClassName,_target)){cp_closeContainer();}else if(_target==cp_more_button){cp_nav_resetRowColumn(true);}}else{if(cp_isAdvancedMode===true){if(_target==cp_cancel_button){cp_closeContainer();}}else{if(cp_more_button!=null){if(_target==cp_more_button){cp_closeContainer();}}else{cp_closeContainer();}}}}};cp_button_clickHandler=function(){cp_openContainer();};cp_colourPaletteClick=function(event){var _target=null;var _isColourBoxSelected=false;_target=cp_getEventTarget(event);if(_target==cp_noColourOption){cp_setColourSelectorColour(true,false,"");return true;}else{if(cp_hasClassName(cp_colourboxClassName,_target)){for(var r=0;r<cp_nav_matrix.length&&_isColourBoxSelected===false;r++){for(var c=0;c<cp_numElementsPerRow&&_isColourBoxSelected===false;c++){if(_target==cp_nav_matrix[r][c]){cp_nav_currCol=c;cp_nav_currRow=r;cp_nav_focusNode();_isColourBoxSelected=true;}}}if(_isColourBoxSelected===true){var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.GetBackgroundHexColour(_target);if(cp_isAdvancedMode===true){if(_hex!==null){cp_setHexInput(_hex);cp_handleHexChange();}}else{if(_hex!==null){cp_setHexInput(_hex);}var isRecentColourBox=D2L.LP.Web.UI.Html.Dom.HasClassName(cp_recentColourClassName,_target);cp_setColourSelectorColour(false,!isRecentColourBox,_hex);return true;}}}}return false;};cp_moreButtonHandler=function(){var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(cp_hidden_value.value);cp_nav_resetRowColumn();cp_shiftDown=false;if(_hex===false){cp_setHexInput(cp_default_color);}else if(_hex.length==0){cp_setHexInput(cp_default_color);}else{cp_setHexInput(_hex);}cp_handleHexChange();cp_setAdvancedMode();};cp_cancelButtonHandler=function(){cp_closeContainer();};cp_okButtonHandler=function(){cp_setColourSelectorColour(false,true,cp_hex_input.value);};cp_slider_arrowUpHandler=function(){cp_slider_position.y-=cp_slider_posyrate;cp_setLightnessValue(cp_slider_getLValue());if(cp_slider_position.y<cp_slider_posyclamp.min){cp_slider_position.y=cp_slider_posyclamp.min;}if(isNewColourPalette){if(isRTL){cp_slider_arrow.style.left=cp_slider_position.y*-1+"px";}else{cp_slider_arrow.style.left=cp_slider_position.y+"px";}}else{cp_slider_arrow.style.top=cp_slider_position.y+"px";}cp_handleHslSliderChange();};cp_slider_arrowDownHandler=function(){cp_slider_position.y+=cp_slider_posyrate;cp_setLightnessValue(cp_slider_getLValue());if(cp_slider_position.y>cp_slider_posyclamp.max){cp_slider_position.y=cp_slider_posyclamp.max;}if(isNewColourPalette){if(isRTL){cp_slider_arrow.style.left=cp_slider_position.y*-1+"px";}else{cp_slider_arrow.style.left=cp_slider_position.y+"px";}}else{cp_slider_arrow.style.top=cp_slider_position.y+"px";}cp_handleHslSliderChange();};cp_slider_handleMouse=function(event){cp_regexp_numbers.lastIndex=0;var _posx=0;var _posy=0;var e=event;if(!isNewColourPalette){if(!e)e=window.event;if(e.pageX||e.pageY){if(isNewColourPalette){_posx=e.pageY;_posy=e.pageX;}else{_posx=e.pageX;_posy=e.pageY;}}}if(e.type=="mousedown"){var _top;if(!isNewColourPalette){_top=cp_slider_arrow.style.top;_top=_top.replace(cp_regexp_numbers,"");cp_slider_offsetY=_posy-parseInt(_top);}cp_slider_mouseDown=true;}else if(e.type=="mouseup"){cp_slider_mouseDown=false;}else if(e.type=="mouseout"){cp_slider_mouseDown=false;}if(cp_slider_mouseDown===true){if(!isNewColourPalette){cp_slider_position.y=_posy-cp_slider_offsetY;}else{if(e.movementX===0){return;}if(isRTL){cp_slider_position.y-=e.movementX;}else{cp_slider_position.y+=e.movementX;}}if(cp_slider_position.y<cp_slider_posyclamp.min){cp_slider_position.y=cp_slider_posyclamp.min;}else if(cp_slider_position.y>cp_slider_posyclamp.max){cp_slider_position.y=cp_slider_posyclamp.max;}cp_setLightnessValue(cp_slider_getLValue());if(isNewColourPalette){if(isRTL){cp_slider_arrow.style.left=cp_slider_position.y*-1+"px";}else{cp_slider_arrow.style.left=cp_slider_position.y+"px";}}else{cp_slider_arrow.style.top=cp_slider_position.y+"px";}cp_handleHslSliderChange();}};cp_slider_onKeyPress=function(kpArgs){var result=false;if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowUp){cp_slider_arrowUpHandler();result=true;}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown){cp_slider_arrowDownHandler();result=true;}else if(!isRTL){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowLeft){cp_slider_arrowUpHandler();result=true;}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowRight){cp_slider_arrowDownHandler();result=true;}}else if(isRTL){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowRight){cp_slider_arrowUpHandler();result=true;}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowLeft){cp_slider_arrowDownHandler();result=true;}}return result;};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(cp_cont,function(kpArgs){cp_nav_onShiftPress(kpArgs);});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(cp_basic_cont,function(kpArgs){var result=cp_nav_onKeyPress(kpArgs);if(result){var event=kpArgs.GetEventObject();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(event);}});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(cp_floating_container,function(kpArgs){var result=cp_onKeyPress(kpArgs);});D2L.LP.Web.UI.Html.Dom.AddEventListener("click",cp_basic_cont,cp_colourPaletteClick);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",cp_more_button,cp_moreButtonHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",cp_cancel_button,cp_cancelButtonHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",cp_ok_button,cp_okButtonHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",cp_button,cp_button_clickHandler);D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(cp_slider_arrow,function(kpArgs){var result=cp_slider_onKeyPress(kpArgs);if(result){var event=kpArgs.GetEventObject();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(event);}});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(cp_slider_input,function(kpArgs){var result=cp_slider_onKeyPress(kpArgs);if(result){var event=kpArgs.GetEventObject();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(event);}});D2L.LP.Web.UI.Html.Dom.AddEventListener("change",cp_hex_input,cp_handleHexChange);D2L.LP.Web.UI.Html.Dom.AddEventListener("change",cp_slider_input,cp_handleHslChange);D2L.LP.Web.UI.Html.Dom.AddEventListener("mousemove",cp_slider_cont,cp_slider_handleMouse);D2L.LP.Web.UI.Html.Dom.AddEventListener("mousedown",cp_slider_arrow,cp_slider_handleMouse);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",cp_slider_gradient,cp_slider_handleMouse);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseup",cp_slider_cont,cp_slider_handleMouse);cp_set_hover=function(event){var target;if(event.target){target=event.target;}if(event.srcElement){target=event.srcElement;}cp_addHover(target);};cp_set_nohover=function(event){var target;if(event.target){target=event.target;}if(event.srcElement){target=event.srcElement;}cp_removeHover(target);};cp_reset_hover=function(){for(var r=0;r<cp_nav_matrix.length;r++){for(var c=0;c<cp_numElementsPerRow;c++){cp_removeHover(cp_nav_matrix[r][c]);}}};cp_addHover=function(target){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-colourpalette-colourbox-a",target)){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourpalette-colourbox-hover",target);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-colourpalette-colourbox-nohover",target);}else if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-colourpalette-nocolouropt",target)){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourpalette-nocolouropt-hover",target);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-colourpalette-nocolouropt-nohover",target);}};cp_removeHover=function(target){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-colourpalette-colourbox-a",target)){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourpalette-colourbox-nohover",target);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-colourpalette-colourbox-hover",target);}else if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-colourpalette-nocolouropt",target)){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourpalette-nocolouropt-nohover",target);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-colourpalette-nocolouropt-hover",target);}};for(var r=0;r<cp_nav_matrix.length;r++){for(var c=0;c<cp_numElementsPerRow;c++){var target=cp_nav_matrix[r][c];cp_removeHover(target);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",target,cp_set_hover);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",target,cp_set_nohover);}}if(cp_button==null&&cp_colourpalette!=null){cp_initializeColourSelectorDialog();}},AddColourToLookupTable:function(colour,title){if(colour!=undefined&&colour!=null&&title!=undefined&&title!=null){if(D2L.LP.Web.UI.Desktop.Controls.ColourSelector.ColourLookupTable[colour]!=title){D2L.LP.Web.UI.Desktop.Controls.ColourSelector.ColourLookupTable[colour]=title;}}},OpenColourPalette:function(floatingContainerId,colourSelectorId,openerId,focus){D2L.LP.Web.UI.Desktop.Controls.ColourSelector.UpdateRecentColoursList(floatingContainerId);if(!D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpen(floatingContainerId)){var opener=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-colourselector-disabled',opener)){D2L.LP.Web.UI.Desktop.Controls.ColourSelector.m_isOpening=true;setTimeout(function(){D2L.LP.Web.UI.Desktop.Controls.ColourSelector.m_isOpening=false;D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Open(floatingContainerId,openerId,{Position:D2L.LP.Web.UI.Html.Style.OverlayPosition.Bottom,TargetId:colourSelectorId,FocusOnOpen:focus});});}}else{D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Close(floatingContainerId);}},GetLinkedColourSelectorId:function(linkedColourSelectorId){if(linkedColourSelectorId!=null){return linkedColourSelectorId.GetValue();}else{return false;}},SetRecentColours:function(csvColourList){D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RecentColours=csvColourList;},UpdateRecentColoursList:function(floatingContainerId){if(D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RecentColours.length==0){return false;}var node=D2L.LP.Web.UI.Html.Dom.GetElementById(floatingContainerId.GetValue());if(node!=null){var colourList=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RecentColours.split(',');var cp_recentColourNodes;var recentColourHexCode;cp_recentColourNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-colourselector-nav-recentcolours",node);for(var index=0;index<cp_recentColourNodes.length;index++){recentColourHexCode=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(colourList[index]);if(recentColourHexCode===false){recentColourHexCode="#ffffff";}cp_recentColourNodes[index].style.backgroundColor=recentColourHexCode;var colourTitle=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.ColourLookupTable[recentColourHexCode];if(colourTitle===undefined||colourTitle===null){colourTitle=recentColourHexCode;}cp_recentColourNodes[index].title=colourTitle;}}},UpdateRecentColourListFromDialog:function(colourSelectorId){var newRecentColour=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.GetValue(colourSelectorId);var node=D2L.LP.Web.UI.Html.Dom.GetElementById(colourSelectorId.GetValue());if(node===null){return;}var recentColourNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-colourselector-nav-recentcolours",node);D2L.LP.Web.UI.Desktop.Controls.ColourSelector.UpdateRecentColourList(newRecentColour,recentColourNodes);},UpdateRecentColourListFromNodes:function(newRecentColour,cp_recentColourNodes,colourSelectorId){var node=colourSelectorId.GetValue?D2L.LP.Web.UI.Html.Dom.GetElementById(colourSelectorId.GetValue()):D2L.LP.Web.UI.Html.Dom.GetElementById(colourSelectorId);if(cp_recentColourNodes==null||cp_recentColourNodes==undefined){if(node===null){return;}cp_recentColourNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-colourselector-nav-recentcolours",node);}newRecentColour=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(newRecentColour);if(newRecentColour!==false){D2L.LP.Web.UI.Desktop.Controls.ColourSelector.UpdateRecentColourList(newRecentColour,cp_recentColourNodes);}},UpdateRecentColourList:function(newRecentColour,cp_recentColourNodes){var _prevColour;var _tempColour;var _prevTitle;var _tempTitle;var _newRecentColourList="";var _newColourExists=false;for(var i=0;i<cp_recentColourNodes.length;i++){_tempColour=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.GetBackgroundHexColour(cp_recentColourNodes[i]);_tempColour=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(_tempColour);_tempTitle=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.ColourLookupTable[_tempColour];if(_tempTitle==undefined||_tempTitle==null){_tempTitle=_tempColour;}if(!_newColourExists){_newColourExists=_tempColour==newRecentColour;if(i==0){var _newRecentColourTitle=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.ColourLookupTable[newRecentColour];if(_newRecentColourTitle==undefined||_newRecentColourTitle==null){_newRecentColourTitle=newRecentColour;}cp_recentColourNodes[i].style.backgroundColor=newRecentColour;cp_recentColourNodes[i].title=_newRecentColourTitle;_newRecentColourList+=newRecentColour.substr(1,6)+",";}else{cp_recentColourNodes[i].style.backgroundColor=_prevColour;cp_recentColourNodes[i].title=_prevTitle;_newRecentColourList+=_prevColour.substr(1,6)+",";}_prevColour=_tempColour;_prevTitle=_tempTitle;}else{_newRecentColourList+=_tempColour.substr(1,6)+",";}}if(_newRecentColourList.charAt(_newRecentColourList.length-1)==","){_newRecentColourList=_newRecentColourList.substr(0,_newRecentColourList.length-1);}D2L.LP.Web.UI.Desktop.Controls.ColourSelector.SetRecentColours(_newRecentColourList);},SetIsEnabled:function(colourSelectorId,isEnabled){var colourSelector=D2L.LP.Web.UI.Html.Dom.GetElementById(colourSelectorId.GetValue());var opener=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-colourselector-button",colourSelector)[0];if(opener!=null&&isEnabled){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-colourselector-disabled',opener);D2L.LP.Web.UI.Html.Dom.SetAttribute(opener,'href','javascript:void(0);');}else if(opener!=null){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-colourselector-disabled',opener);opener.removeAttribute('href');}},GetValue:function(colourSelectorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(colourSelectorId.GetValue());var cp_hex_input=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-hex-input",node);var cp_hidden_type=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-type",node);var _hex=false;if(cp_hex_input!=null){_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(cp_hex_input.value);}if(_hex===false){_hex=cp_hidden_type!=null&&cp_hidden_type.value=="Foreground"?D2L.LP.Web.UI.Desktop.Controls.ColourSelector.DefaultFgColour:D2L.LP.Web.UI.Desktop.Controls.ColourSelector.DefaultBgColour;}return _hex;},GetSelectedValue:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.ColourSelector;var handle=me.GetHandle(id);var value=handle.hiddenValueNode.value;return value;},GetRecentColoursList:function(colourSelectorId){return D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RecentColours;},GetBackgroundHexColour:function(node){D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpNumbersAndComma.lastIndex=0;D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpHexCode.lastIndex=0;D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpRgb.lastIndex=0;var _rgb={r:0,g:0,b:0};var _str=node.style.backgroundColor;var _hex;if(D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpHexCode.test(_str)){_hex=_str.substr(1,6);}else if(D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpRgb.test(_str)){var _arr=_str.replace(D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpNumbersAndComma,"").split(",");_rgb.r=_arr[0];_rgb.g=_arr[1];_rgb.b=_arr[2];_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RgbToHex(_rgb);}else{}return _hex;},NormalizeHexCode:function(inputHexCode){var outputHexCode=inputHexCode;D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpHexCode.lastIndex=0;if(outputHexCode==null){return false;}if(outputHexCode.length!==0){if(outputHexCode.charAt(0)!=="#"){outputHexCode="#"+outputHexCode;}if(outputHexCode.length!=7){var outputHexCodeLength=outputHexCode.length;if(outputHexCodeLength>7){outputHexCode=outputHexCode.substr(0,7);}else if(outputHexCodeLength>=0&&outputHexCodeLength<7){for(var i=outputHexCodeLength;i<7&&outputHexCode.length<7;i++){outputHexCode=outputHexCode+"0";}}else{outputHexCode="#000000";}}if(!D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpHexCode.test(outputHexCode)){return"false";}}return outputHexCode;},NormalizeRgbValue:function(value){var normalizedVal=parseInt(value);if(isNaN(normalizedVal)){normalizedVal=0;}if(normalizedVal>255){normalizedVal=255;}else if(normalizedVal<0){normalizedVal=0;}return normalizedVal;},NormalizeHslPercentage:function(value){var normalizedVal=parseInt(value);if(isNaN(normalizedVal)){normalizedVal=50;}if(normalizedVal>100){normalizedVal=100;}else if(normalizedVal<0){normalizedVal=0;}return normalizedVal;},CalculateContrastRatio:function(rgb){var r_s=rgb.r/255;var g_s=rgb.g/255;var b_s=rgb.b/255;var r=r_s<=0.03928?r_s/12.92:Math.pow((r_s+0.055)/1.055,2.4);var g=g_s<=0.03928?g_s/12.92:Math.pow((g_s+0.055)/1.055,2.4);var b=b_s<=0.03928?b_s/12.92:Math.pow((b_s+0.055)/1.055,2.4);var L=0.2126*r+0.7152*g+0.0722*b;return L;},GetContrastRatio:function(rgb1,rgb2){var L1=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.CalculateContrastRatio(rgb1);var L2=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.CalculateContrastRatio(rgb2);var result=L1>=L2?(L1+0.05)/(L2+0.05):(L2+0.05)/(L1+0.05);return result;},RgbToHex:function(rgb){var hexCode=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.IntToHex(rgb.r)+D2L.LP.Web.UI.Desktop.Controls.ColourSelector.IntToHex(rgb.g)+D2L.LP.Web.UI.Desktop.Controls.ColourSelector.IntToHex(rgb.b);return hexCode;},IntToHex:function(intVal){var hexVal=parseInt(intVal).toString(16);if(hexVal.length==1){hexVal="0"+hexVal;}return hexVal;},HexToInt:function(hexVal){return parseInt(hexVal,16);},HexToRgb:function(hex){hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(hex);if(hex==false){return null;}hex=hex.substr(1,6);var r='00',g='00',b='00';if(hex.length==6){r=hex.substring(0,2);g=hex.substring(2,4);b=hex.substring(4,6);}else{if(hex.length>4){r=hex.substring(4,hex.length);hex=hex.substring(0,4);}if(hex.length>2){g=hex.substring(2,hex.length);hex=hex.substring(0,2);}if(hex.length>0){b=hex.substring(0,hex.length);}}var rgb={r:0,g:0,b:0};rgb.r=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HexToInt(r);rgb.g=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HexToInt(g);rgb.b=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HexToInt(b);return rgb;},RgbToHsl:function(r,g,b){r/=255,g/=255,b/=255;var max=Math.max(r,g,b),min=Math.min(r,g,b);var h,s,l=(max+min)/2;if(max==min){h=s=0;}else{var d=max-min;s=l>0.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;}h/=6;}var hsl={h:0,s:0,l:0};hsl.h=h;hsl.s=s;hsl.l=l;hsl.h=parseInt(hsl.h*60);if(hsl.h<0){hsl.h+=360;}hsl.s=parseInt(hsl.s*100);hsl.l=parseInt(hsl.l*100);return hsl;},HslToRgb:function(h,s,l){var r,g,b;if(h==360){h=0;}h/=60;s=s/100;l=l/100;if(s==0){r=g=b=l;}else{function hue2rgb(p,q,t){if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p;}var q=l<0.5?l*(1+s):l+s-l*s;var p=2*l-q;r=hue2rgb(p,q,h+1/3);g=hue2rgb(p,q,h);b=hue2rgb(p,q,h-1/3);}var rgb={r:0,g:0,b:0};rgb.r=r*255;rgb.g=g*255;rgb.b=b*255;rgb.r=Math.round(rgb.r);rgb.g=Math.round(rgb.g);rgb.b=Math.round(rgb.b);return rgb;},ValidateContrastRatio:function(resolvedId,requiredValue){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(resolvedId);var cp_wcag_contrast_ratio=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-wcag-contrast-ratio",node);if(cp_wcag_contrast_ratio==null){return true;}var contrastRatio=cp_wcag_contrast_ratio.innerHTML;var arr=contrastRatio.split(':');if(arr.length>0){var contrast=parseFloat(arr[0]);if(contrast==undefined||contrast==null||isNaN(contrast)){return true;}if(contrast>=requiredValue){return true;}}return false;},OnChangeEvents:{}};D2L.LP.Web.UI.Desktop.Controls.ColourSelector.m_isOpening=false;D2L.LP.Web.UI.Desktop.Controls.Container={SetWidth:function(id,value){var container=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());$(container).css('width',value);}};D2L.LP.Web.UI.Desktop.Controls.ContainerIcon={SetIsVisible:function(id,isVisible){D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(id,isVisible);}};D2L.LP.Web.UI.Desktop.Controls.ContainerLink={SetIsVisible:function(id,isVisible){D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(id,isVisible);}};D2L.LP.Web.UI.Desktop.Controls.ContextMenu={Close:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.ContextMenu;var d2lDropdownContent=me.GetDropdownContent(id);if(d2lDropdownContent){d2lDropdownContent.close();}else{var floatingContainerId=me.GetFloatingContainerHtmlId(id);D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Close(floatingContainerId,true);}},OnCloseHandler:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.ContextMenu;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.m_openerId!=null){var openerNode=D2L.LP.Web.UI.Html.Dom.GetElementById(node.m_openerId.GetValue());D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-contextmenu-opener-open',openerNode);openerNode.m_isClicked=false;D2L.LP.Web.UI.Html.Dom.DispatchEvent('blur',openerNode);}D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetOnCloseEvent(id).Trigger();},GetFloatingContainerHtmlId:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var floatingContainerId=node.getAttribute('data-floating-container-id');return D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(floatingContainerId);},GetDropdownContent:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var dropdownContentId=node.getAttribute('data-dropdown-content-id');return dropdownContentId?D2L.LP.Web.UI.Html.Dom.GetElementById(dropdownContentId):null;},GetOpenerKey:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.m_openerKey;},GetOnCloseEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.ContextMenu;if(me.OnCloseEvents[id.GetValue()]===undefined){me.OnCloseEvents[id.GetValue()]=new D2L.LP.Web.UI.Events.Event();}return me.OnCloseEvents[id.GetValue()];},CloneMenu:function(node,contextMenuId,opener,dropdownMenu){node=node||D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());dropdownMenu=dropdownMenu||node.querySelector('d2l-dropdown-content');if(!dropdownMenu){return;}var menuTemplate=D2L.LP.Web.UI.Html.Dom.GetElementById(contextMenuId.GetValue());var clone;if(menuTemplate.content){if(menuTemplate.content.firstElementChild){clone=document.importNode(menuTemplate.content,true).firstElementChild;}else{clone=menuTemplate.content.querySelector("*").cloneNode(true);}}else{clone=menuTemplate.querySelector("*").cloneNode(true);}if(!clone.hasAttribute("label")){clone.setAttribute("label",opener.getAttribute("text"));}dropdownMenu.appendChild(clone);D2L.LP.Web.UI.Events.OnViewRender.Trigger(clone);},CreateDropdownMenu:function(node,contextMenuId,opener,openerKey,keypress){var menuTemplate=D2L.LP.Web.UI.Html.Dom.GetElementById(contextMenuId.GetValue());if(!menuTemplate){return;}var me=this;D2L.LP.Web.UI.Html.Bsi.LoadAssets(['node_modules/@brightspace-ui/core/components/dropdown/dropdown-menu.js']).then(function(){var dropdownContentId=menuTemplate.getAttribute("data-dropdown-content-id");var dropdownMenu=document.createElement("d2l-dropdown-menu");dropdownMenu.setAttribute("no-pointer","");dropdownMenu.setAttribute("align","start");dropdownMenu.setAttribute("min-width","200");dropdownMenu.setAttribute("max-width","370");dropdownMenu.setAttribute("vertical-offset","12");dropdownMenu.setAttribute("id",dropdownContentId);dropdownMenu.setAttribute("class","d2l-dropdown-menu-contextmenu");dropdownMenu.addEventListener('d2l-dropdown-open',function(){menuTemplate.m_openerKey=openerKey;});D2L.LP.Web.UI.Desktop.Controls.ContextMenu.CloneMenu(node,contextMenuId,opener,dropdownMenu);node.appendChild(dropdownMenu);setTimeout(function(){keypress=keypress?keypress:false;dropdownMenu.open(keypress);me.SetLeft(dropdownMenu,node);},0);});},IsOpen:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.ContextMenu;var isOnDemand=D2L.LP.Web.UI.ObjectRepository.HasKeys(id.GetValue(),'LoadHandler');if(isOnDemand&&!D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.IsLoaded(id)){return false;}var d2lDropdownContent=me.GetDropdownContent(id);if(d2lDropdownContent){return d2lDropdownContent.opened;}else{var floatingContainerId=D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetFloatingContainerHtmlId(id);return D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpen(floatingContainerId);}},OnCloseEvents:{},OpenOnDemand:function(node,id,opener,openerKey,keypress){if(!D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.IsLoaded(id)){var loadRet=D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.Load(id,openerKey);loadRet.AddListener(function(){D2L.LP.Web.UI.Desktop.Controls.ContextMenu.CreateDropdownMenu(node,id,opener,openerKey,keypress);});}},GetAncestorBoundingClientRect:function(dropdownMenu){var offsetParent=dropdownMenu.offsetParent;if(offsetParent&&offsetParent.tagName!=='BODY'){return offsetParent.getBoundingClientRect();}var table=D2L.LP.Web.UI.Html.Dom.GetAncestorElementsByClassName('d2l-grid-wrapper',dropdownMenu);if(table&&table.length>0){return table[0].getBoundingClientRect();}else if(offsetParent){return offsetParent.getBoundingClientRect();}else{return null;}},SetLeft:function(dropdownMenu,opener){var self=this;requestAnimationFrame(function(){var tableBoundingRect=self.GetAncestorBoundingClientRect(dropdownMenu);if(!tableBoundingRect){return;}var openerBoundingRect=opener.getBoundingClientRect();var leftValue=getComputedStyle(document.body).direction==='rtl'?openerBoundingRect.right-tableBoundingRect.left:openerBoundingRect.left-tableBoundingRect.left;requestAnimationFrame(function(){dropdownMenu.style.left=leftValue+"px";});});},SetIsEnabled:function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node){node.disabled=!isEnabled;}},GetMenuItem:function(id,key){var itemId=id.GetValue()+'_'+key;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId);if(node){return node;}var template=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var content=template.content;var item=content.querySelector("#"+itemId);return item;},SetItemIsEnabled:function(id,key,isEnabled){var node=D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetMenuItem(id,key);if(!node){return;}if(isEnabled){node.removeAttribute('disabled');}else{node.setAttribute('disabled','disabled');}},SetItemIsVisible:function(id,key,isVisible){var node=D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetMenuItem(id,key);if(!node){return;}if(isVisible){node.removeAttribute('hidden');}else{node.setAttribute('hidden','hidden');}}};D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand={m_currentPlaceholderKey:null,m_currentId:null,m_loadedList:[],Load:function(id,placeholderKey){var ret=new D2L.LP.Web.UI.Events.Event();var me=D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand;me.m_currentId=id;me.m_currentPlaceholderKey=placeholderKey;var loadHandler=D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),'LoadHandler');var loadRet=eval(loadHandler);loadRet.AddListener(function(){ret.Trigger();});loadRet.AddReleaseListener(function(){ret.Release();});me.m_loadedList[id.GetValue()]=true;return ret;},IsLoaded:function(id){return D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.m_loadedList[id.GetValue()]||false;},GetCurrentPlaceholderKey:function(){return D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.m_currentPlaceholderKey;},GetCurrentPlaceholderId:function(){return D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.m_currentId.GetValue()+'_cmodph');},GetCurrentId:function(){return D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.m_currentId;}};D2L.LP.Web.UI.Desktop.Controls.DataListItem={};D2L.LP.Web.UI.Desktop.Controls.DataList={AdjustLastVisibleChild:function(node){var lastVisibleChild=null;var child=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);while(child!==null){var isHidden=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',child);if(!isHidden){lastVisibleChild=child;}D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-datalist-lastchild',child);child=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(child);}if(lastVisibleChild!==null){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-datalist-lastchild',lastVisibleChild);}},AddItems:function(dataListId,itemId,placeholderId,provider,createPlaceholder){var evt=new D2L.LP.Web.UI.Events.Event();if(dataListId===null||placeholderId===null||provider===null){evt.Release();return evt;}if(D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId.GetValue())===null){createPlaceholder.call(createPlaceholder);}var rc=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId.GetValue());if(rc===null){if(!D2L.LP.Web.UI.ObjectRepository.TryClone(dataListId.GetValue(),'0',placeholderId.GetValue(),'0')){evt.Release();return evt;}}var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var providerRet=provider.call(provider);providerRet.AddReleaseListener(function(){evt.Release();});providerRet.AddListener(function(){var listNode=me.GetListNode(dataListId);me.SetIsEmptyTextVisible(listNode,false);me.AdjustLastVisibleChild(listNode);var newItemNodes=me.GetNewItemNodesByNode(listNode);me.SetIsNewItems(newItemNodes,false);me.GetOnLoadMoreCompletedEvent(dataListId).Trigger(me.GetHasMoreItems(dataListId),newItemNodes);D2L.LP.Web.UI.ObjectRepository.Remove(placeholderId.GetValue(),'0');evt.Trigger();});return evt;},AddItemsAfter:function(dataListId,itemId,placeholderId,provider){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;if(dataListId===null){dataListId=me.GetDataListIdByItemId(itemId);}var listNode=me.GetListNode(dataListId);var evt=me.AddItems(dataListId,itemId,placeholderId,provider,function(){var itemNode;if(itemId!==null){itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());}else{itemNode=me.GetLastItemNode(dataListId);}var placeholderNode=document.createElement('li');placeholderNode.setAttribute('id',placeholderId.GetValue());placeholderNode.className='d2l-datalist-item-placeholder';if(itemNode!==null){D2L.LP.Web.UI.Html.Dom.InsertElementAfter(placeholderNode,itemNode);}else{var loadMorePlaceholderNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-item-placeholder-bottom',listNode);if(loadMorePlaceholderNode!==null){var parent=loadMorePlaceholderNode.parentNode;parent.insertBefore(placeholderNode,loadMorePlaceholderNode);}else{listNode.appendChild(placeholderNode);}}});return evt;},AddItemsBefore:function(dataListId,itemId,placeholderId,provider){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;if(dataListId===null){dataListId=me.GetDataListIdByItemId(itemId);}var listNode=me.GetListNode(dataListId);var evt=me.AddItems(dataListId,itemId,placeholderId,provider,function(){var itemNode;if(itemId!==null){itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());}else{itemNode=me.GetFirstItemNode(dataListId,true);}var placeholderNode=document.createElement('li');placeholderNode.setAttribute('id',placeholderId.GetValue());placeholderNode.className='d2l-datalist-item-placeholder';if(itemNode!==null){itemNode.parentNode.insertBefore(placeholderNode,itemNode);}else{var loadMorePlaceholderNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-item-placeholder-bottom',listNode);if(loadMorePlaceholderNode!==null){var parent=loadMorePlaceholderNode.parentNode;parent.insertBefore(placeholderNode,loadMorePlaceholderNode);}else{listNode.appendChild(placeholderNode);}}});return evt;},AddItemByNode:function(listNode,itemNode){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var loadMorePlaceholderNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-item-placeholder-bottom',listNode);var sourceList=itemNode.parentNode;if(loadMorePlaceholderNode!==null){var parent=loadMorePlaceholderNode.parentNode;parent.insertBefore(itemNode,loadMorePlaceholderNode);}else{listNode.appendChild(itemNode);}me.SetIsEmptyTextVisible(listNode,false);me.AdjustLastVisibleChild(listNode);if(sourceList!==listNode){var sourceListId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(sourceList.parentNode.getAttribute('id'));me.AdjustLastVisibleChild(sourceList);if(!me.GetHasVisibleItem(sourceListId)){me.SetIsEmptyTextVisible(sourceList,true);}}},AddItemClassNames:function(node,className){if(node!==undefined&&className.length>0&&node.className.indexOf(className,0)==-1){node.className+=' '+className;}},Get:function(){return D2L.LP.Web.UI.Desktop.Controls.DataList;},GetDataListIdByItemId:function(itemId){var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());return new D2L.LP.Web.UI.Html.AbsoluteHtmlId(itemNode.parentNode.parentNode.getAttribute('id'));},GetDataListPlaceholder:function(dataListRootNode){var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(dataListRootNode);while(itemNode!==null){if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-datalist-item-placeholder',itemNode)){return itemNode;}itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode);}return null;},GetEvent:function(id,events){var evt=events[id];if(evt===undefined){evt=new D2L.LP.Web.UI.Events.Event();events[id]=evt;}return evt;},GetFirstItemNode:function(id,includeHidden){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=me.GetListNode(id);var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-item',listNode);if(itemNode===null){return null;}if(includeHidden){return itemNode;}else if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',itemNode)){return itemNode;}return me.GetNextItemNode(itemNode,includeHidden);},GetHasMoreItems:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=me.GetListNode(id);var placeholderNode=me.GetDataListPlaceholder(listNode);if(placeholderNode===null){return false;}if(D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderNode.getAttribute('id'),2)){return true;}return false;},GetHasVisibleItem:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var itemNode=me.GetFirstItemNode(id,false);return itemNode!==null;},GetItemCount:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var count=0;var itemNode=me.GetFirstItemNode(id,false);while(itemNode!==null){count+=1;itemNode=me.GetNextItemNode(itemNode,false);}return count;},GetItemsNodes:function(id,className){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=me.GetListNode(id);return D2L.LP.Web.UI.Html.Dom.GetElementsByClassName(className,listNode);},GetLastItemNode:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=me.GetListNode(id);var itemNode=D2L.LP.Web.UI.Html.Dom.GetLastElementChild(listNode);while(itemNode!==null){if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-datalist-item',itemNode)){return itemNode;}itemNode=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(itemNode);}return null;},GetListNode:function(id){return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist',D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));},GetNewItemNodesByNode:function(listNode){var itemNodes=D2L.LP.Web.UI.Html.Dom.GetImmediateChildElementsByClassName('d2l-datalist-newitem',listNode);return itemNodes;},GetNextItemNode:function(itemNode,includeHidden){itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode);while(itemNode!==null){if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-datalist-item',itemNode)){if(includeHidden){return itemNode;}else if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',itemNode)){return itemNode;}}itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode);}return null;},GetPage:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var dataListId=id.GetValue();if(!D2L.LP.Web.UI.ObjectRepository.HasKey(dataListId)){return;}var onGetPage=D2L.LP.Web.UI.ObjectRepository.Get(dataListId,1);if(onGetPage===null){return;}var node=D2L.LP.Web.UI.Html.Dom.GetElementById(dataListId);var isReadOnly=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-readonly',node);me.GetOnPageEvent(id).Trigger();me.GetOnLoadEvent(id).Trigger();onGetPage.call(onGetPage).AddListener(function(){if(isReadOnly){var dlNode=D2L.LP.Web.UI.Html.Dom.GetElementById(dataListId);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-readonly',dlNode);}me.TryFocusFirstItem(id);me.GetOnPageCompletedEvent(id).Trigger(me.GetItemsNodes(id,'d2l-datalist-item'));});},GetOnLoadEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnLoadEvents);},GetOnLoadCompletedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnLoadCompletedEvents);},GetOnLoadMoreCompletedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnLoadMoreCompletedEvents);},GetOnPageEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnPageEvents);},GetOnPageCompletedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnPageCompletedEvents);},GetOnRemoveItemEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnRemoveItemEvents);},HighlightItem:function(itemId){var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());D2L.LP.Web.UI.Desktop.Controls.DataList.HighlightItemByNode(itemNode);},HighlightItemByNode:function(itemNode){if(!itemNode){return;}D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-datalist-item-highlight-transition-color',itemNode);setTimeout(function(){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-datalist-item-highlight-transition',itemNode);if(D2L.LP.Web.UI.Html.Css.Capability.SupportsTransition()){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-datalist-item-highlight-transition-color',itemNode);}setTimeout(function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-datalist-item-highlight-transition',itemNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-datalist-item-highlight-transition-color',itemNode);},1500);},0);},LoadMore:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=me.GetListNode(id);var placeholderNode=me.GetDataListPlaceholder(listNode);if(placeholderNode===null){return;}var placeholderId=placeholderNode.getAttribute('id');var onLoadMore;if(D2L.LP.Web.UI.ObjectRepository.HasKey(placeholderId)){onLoadMore=D2L.LP.Web.UI.ObjectRepository.Get(placeholderId,1);if(onLoadMore!==null){var nextItemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(placeholderNode);var previousItemNode=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(placeholderNode);me.GetOnLoadEvent(id).Trigger();onLoadMore.call(onLoadMore).AddListener(function(){var itemNode;var itemNodes=[];if(previousItemNode===null){itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listNode);}else{itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(previousItemNode);}while(itemNode!==null&&itemNode!=nextItemNode){if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-datalist-item-placeholder',itemNode)){itemNodes.push(itemNode);}itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode);}me.SetIsNewItems(itemNodes,false);if(itemNodes.length>0){var focusableElement=D2L.LP.Web.UI.Html.Dom.GetNextFocusableElement(itemNodes[0]);if(focusableElement&&focusableElement.focus){focusableElement.focus();}}me.SetIsEmptyTextVisible(listNode,false);me.AdjustLastVisibleChild(listNode);me.GetOnLoadMoreCompletedEvent(id).Trigger(me.GetHasMoreItems(id),itemNodes);});}}},MoveItemByNode:function(itemNode,moveToItemNode,isBefore){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var newList=moveToItemNode.parentNode;var sourceList=itemNode.parentNode;if(isBefore){newList.insertBefore(itemNode,moveToItemNode);}else{D2L.LP.Web.UI.Html.Dom.InsertElementAfter(itemNode,moveToItemNode);}me.AdjustLastVisibleChild(newList);if(sourceList!==newList){var sourceListId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(sourceList.parentNode.getAttribute('id'));me.AdjustLastVisibleChild(sourceList);if(!me.GetHasVisibleItem(sourceListId)){me.SetIsEmptyTextVisible(sourceList,true);}}},RemoveItem:function(itemId){if(itemId===null){return;}var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());me.RemoveItemByNode(itemNode);},RemoveItemByNode:function(itemNode){if(itemNode===null){return;}var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=itemNode.parentNode;var dataListId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(listNode.parentNode.getAttribute('id'));listNode.removeChild(itemNode);if(!me.GetHasVisibleItem(dataListId)){me.SetIsEmptyTextVisible(listNode,true);}me.AdjustLastVisibleChild(listNode);me.GetOnRemoveItemEvent(dataListId).Trigger(itemNode);},ReplaceItem:function(itemId,placeholderId,provider){if(placeholderId===null||provider===null){return;}var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());if(itemNode===null){return;}itemNode.setAttribute('id',placeholderId.GetValue());var dataListId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(itemNode.parentNode.parentNode.getAttribute('id'));var rc=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId.GetValue());if(rc===null){if(!D2L.LP.Web.UI.ObjectRepository.TryClone(dataListId.GetValue(),'0',placeholderId.GetValue(),'0')){return;}}var me=D2L.LP.Web.UI.Desktop.Controls.DataList;provider.call(provider).AddListener(function(){var listNode=me.GetListNode(dataListId);me.AdjustLastVisibleChild(listNode);me.GetOnLoadMoreCompletedEvent(dataListId).Trigger(me.GetHasMoreItems(dataListId));D2L.LP.Web.UI.ObjectRepository.Remove(placeholderId.GetValue(),'0');});},ReplaceItemContent:function(itemId,placeholderId,provider){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;if(placeholderId===null||provider===null){return;}var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());if(itemNode===null){return;}var contentNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-item-content',itemNode);contentNode.setAttribute('id',placeholderId.GetValue());D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-placeholder-inner',contentNode);var dataListId=me.GetDataListIdByItemId(itemId);var rc=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId.GetValue());if(rc===null){if(!D2L.LP.Web.UI.ObjectRepository.TryClone(dataListId.GetValue(),'0',placeholderId.GetValue(),'0')){return;}}provider.call(provider).AddListener(function(){D2L.LP.Web.UI.ObjectRepository.Remove(placeholderId.GetValue(),'0');});},RemoveItemClassNames:function(node,className){if(node!==undefined&&className.length>0){node.className=node.className.replace(' '+className,'');}},ScrollToFirstItem:function(dataListId){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var itemNode=me.GetFirstItemNode(dataListId,false);if(!itemNode){return;}var isVisible=D2L.LP.Web.UI.Html.Dom.IsVisibleInContainer(itemNode);if(isVisible){return;}return D2L.LP.Web.UI.Html.Dom.ScrollToElement(itemNode,0,false);},SetIsEmptyTextVisible:function(listNode,isVisible){var emptyTextNode=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(listNode);if(isVisible){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',listNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',emptyTextNode);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',emptyTextNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',listNode);}},SetItemIsVisible:function(id,isVisible){var item=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(item,isVisible);D2L.LP.Web.UI.Desktop.Controls.DataList.AdjustLastVisibleChild(item.parentNode);},SetIsNewItems:function(itemNodes,isNew){if(isNew){for(var i=0;i<itemNodes.length;i++){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-datalist-newitem',itemNodes[i]);}}else{for(var j=0;j<itemNodes.length;j++){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-datalist-newitem',itemNodes[j]);}}},TryFocusFirstItem:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var firstItemNode=me.GetFirstItemNode(id);if(!firstItemNode){return false;}var focusableElements=$(firstItemNode).find(':focusable');if(!focusableElements||focusableElements.length===0){return false;}focusableElements[0].focus();return true;},TryGetSelectionUpdatedEvent:function(id){var summaryNode=D2L.LP.Web.UI.Desktop.Controls.DataList.Summary.GetSummaryNode(id);if(summaryNode===null){return null;}var e=D2L.LP.Web.UI.Desktop.Controls.DataList.Summary.GetSelectionUpdatedEvent(id);return e;},OnLoadEvents:{},OnLoadCompletedEvents:{},OnLoadMoreCompletedEvents:{},OnPageEvents:{},OnPageCompletedEvents:{},OnRemoveItemEvents:{},CaptureOnClickRules:{'A':true,'BUTTON':true,'D2L-BUTTON':true,'D2L-BUTTON-ICON':true,'D2L-BUTTON-SUBTLE':true,'INPUT':true,'LABEL':true,'SELECT':true,'TEXTAREA':true}};D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop={AddAcceptableDragGroup:function(dragObject,acceptableGroup){if(dragObject.GetDragNode().d2l_DroppableSettings){dragObject.GetDragNode().d2l_DroppableSettings.AddAcceptableDragGroup(acceptableGroup);}},AddItem:function(dataListId,dragObject){var itemNode=dragObject.GetDragNode();var listNode=D2L.LP.Web.UI.Desktop.Controls.DataList.GetListNode(dataListId);if(itemNode==null||listNode==null){return;}D2L.LP.Web.UI.Desktop.Controls.DataList.AddItemByNode(listNode,itemNode);},GetDraggedKey:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_draggedNodeKey;},GetParentDataList:function(childNode){return D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-datalist',childNode).parentNode;},GetDragGroupFunction:function(dragObject){if(dragObject&&dragObject.GetDraggableSettings()){return dragObject.GetDraggableSettings().GetDragGroup();}else{return null;}},GetDragParam:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_dragObjectParam;},GetDragObject:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_dragObject;},GetDroppedOnKey:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_droppedOnNodeKey;},GetDroppedOnHtmlId:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_droppedOnNodeHtmlId;},GetDropPosition:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_itemDragPosition;},MoveItem:function(dragObject,moveToItemId,dropPositon){var moveToItemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(moveToItemId.GetValue());var itemNode=dragObject.GetDragNode();if(moveToItemNode==null||itemNode==null){return;}var isBefore=dropPositon==D2L.LP.Web.UI.Html.DragDrop.DropPosition.Before;D2L.LP.Web.UI.Desktop.Controls.DataList.MoveItemByNode(itemNode,moveToItemNode,isBefore);},RemoveItem:function(dragObject){var itemNode=dragObject.GetDragNode();D2L.LP.Web.UI.Desktop.Controls.DataList.RemoveItemByNode(itemNode);},SetAcceptableDragGroups:function(dragObject,acceptableGroups){if(dragObject.GetDragNode().d2l_DroppableSettings){dragObject.GetDragNode().d2l_DroppableSettings.SetAcceptableDragGroups(acceptableGroups);}}};D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.DropType={None:0,OnlyDropOn:1,OnlyDropBeforeAfter:2,All:3};D2L.LP.Web.UI.Desktop.Controls.DataList.FileDragDrop={m_droppedOnKey:null,m_droppedOnHtmlId:null,m_dropPosition:null,m_droppedFiles:null,GetDroppedOnKey:function(){return D2L.LP.Web.UI.Desktop.Controls.DataList.FileDragDrop.m_droppedOnKey;},GetDroppedOnHtmlId:function(){return D2L.LP.Web.UI.Desktop.Controls.DataList.FileDragDrop.m_droppedOnHtmlId;},GetDropPosition:function(){return D2L.LP.Web.UI.Desktop.Controls.DataList.FileDragDrop.m_dropPosition;},GetDroppedFiles:function(){return D2L.LP.Web.UI.Desktop.Controls.DataList.FileDragDrop.m_droppedFiles;},OnFilesDrop:function(key,htmlId,files){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.FileDragDrop;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(htmlId.GetValue());D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop.RemoveDragOverEffect(node);node.d2l_previousFileDropPosition=null;var dataListId=D2L.LP.Web.UI.Desktop.Controls.DataList.GetDataListIdByItemId(htmlId);me.m_droppedOnKey=key;me.m_droppedOnHtmlId=htmlId;me.m_dropPosition=node.d2l_fileDropPosition;me.m_droppedFiles=files;var dataListOnFilesDrop=D2L.LP.Web.UI.ObjectRepository.TryGet(dataListId.GetValue(),'OnFilesDrop');if(dataListOnFilesDrop){dataListOnFilesDrop.call(this);}},OnFileOver:function(htmlId,verticalDragPosition,supportsAllDropTypes){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(htmlId.GetValue());node.d2l_fileDropPosition=D2L.LP.Web.UI.Html.DragDrop.DropPosition.On;if(supportsAllDropTypes){if(verticalDragPosition<0.25){node.d2l_fileDropPosition=D2L.LP.Web.UI.Html.DragDrop.DropPosition.Before;}else if(verticalDragPosition>0.75){node.d2l_fileDropPosition=D2L.LP.Web.UI.Html.DragDrop.DropPosition.After;}}else{if(verticalDragPosition<0.5){node.d2l_fileDropPosition=D2L.LP.Web.UI.Html.DragDrop.DropPosition.Before;}else{node.d2l_fileDropPosition=D2L.LP.Web.UI.Html.DragDrop.DropPosition.After;}}if(node.d2l_previousFileDropPosition!==node.d2l_fileDropPosition){D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop.UpdateDragOverEffect(node,node.d2l_fileDropPosition);}node.d2l_previousFileDropPosition=node.d2l_fileDropPosition;},OnFileLeave:function(htmlId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(htmlId.GetValue());D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop.RemoveDragOverEffect(node);node.d2l_previousFileDropPosition=null;}};D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder={GetOrderedKeysNode:function(dataListNode){var result=[];var hiddens=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-datalist-item-dragdrop-reorder-hidden",dataListNode);for(var i=0;i<hiddens.length;i++){result.push(hiddens[i].value);}return result;},GetUpDownLinkIds:function(itemNode){var updownLinks=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-item-draghandle-reorder-updownlinks',itemNode);var upLinkId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(D2L.LP.Web.UI.Html.Dom.GetAttribute(updownLinks,'data-upLinkId'));var downLinkId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(D2L.LP.Web.UI.Html.Dom.GetAttribute(updownLinks,'data-downLinkId'));return{UpLinkId:upLinkId,DownLinkId:downLinkId};},InstallKeyboardEvents:function(itemNode){var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.GetParentDataList(itemNode);var upDownLinkIds=D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder.GetUpDownLinkIds(itemNode);var upLinkId=upDownLinkIds.UpLinkId;var downLinkId=upDownLinkIds.DownLinkId;var upLink=document.getElementById(upLinkId.GetValue());var downLink=document.getElementById(downLinkId.GetValue());var dragHandle=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-draghandle-handle',itemNode);var moveItemTo=function(item,isBefore){if(item&&D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-datalist-item-dragdrop-reorder',item)){D2L.LP.Web.UI.Desktop.Controls.DataList.MoveItemByNode(itemNode,item,isBefore);D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder.UpdateDataListReorderState(dataList);if(isBefore){if(!upLink.hasAttribute('disabled')){upLink.focus();}else{downLink.focus();}}else{if(!downLink.hasAttribute('disabled')){downLink.focus();}else{upLink.focus();}}}};var close=function(){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-offscreen',updownLinks);};var moveUp=function(){moveItemTo(D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(itemNode),true);};var moveDown=function(){moveItemTo(D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode),false);};var onFocus=function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-offscreen',updownLinks);};var onBlur=function(){var activeNode=D2L.LP.Web.UI.Html.Dom.GetActiveElement();if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(dragHandle,activeNode)){close();}};var onKeyPress=function(kpArgs){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowUp){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(kpArgs.GetEventObject());moveUp();}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(kpArgs.GetEventObject());moveDown();}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape){try{var activeNode=D2L.LP.Web.UI.Html.Dom.GetActiveElement();activeNode.blur();}catch(e){}}};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(dragHandle,function(kpArgs){onKeyPress(kpArgs);});var updownLinks=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName('d2l-datalist-item-draghandle-reorder-updownlinks',itemNode);var dragHandleIcon=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-draghandle-handle-icon',dragHandle);dragHandleIcon.appendChild(updownLinks);upLink.addEventListener('click',moveUp);downLink.addEventListener('click',moveDown);upLink.addEventListener('focus',onFocus);downLink.addEventListener('focus',onFocus);upLink.addEventListener('blur',onBlur);downLink.addEventListener('blur',onBlur);D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder.UpdateDataListReorderState(dataList);},UpdateDataListReorderState:function(dataList){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;me.AdjustLastVisibleChild(dataList);var initialChangeKey=$(dataList).data('initialChangeKey');var lastChangeKey=$(dataList).data('changeKey');var newChangeKey=me.Reorder.GetOrderedKeysNode(dataList).join();if(newChangeKey!==lastChangeKey){$(dataList).data('changeKey',newChangeKey);if(initialChangeKey!==newChangeKey){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.TriggerChange(dataList);}else{D2L.LP.Web.UI.Html.ChangeTracking.Trackable.TriggerRestore(dataList);}}var items=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-datalist-item-dragdrop-reorder",dataList);for(var i=0;i<items.length;i++){var item=items[i];var upDownLinkIds=me.Reorder.GetUpDownLinkIds(item);var upLink=document.getElementById(upDownLinkIds.UpLinkId.GetValue());var downLink=document.getElementById(upDownLinkIds.DownLinkId.GetValue());if(i==0){upLink.setAttribute('disabled','disabled');downLink.removeAttribute('disabled');}else if(i==items.length-1){downLink.setAttribute('disabled','disabled');upLink.removeAttribute('disabled');}else{upLink.removeAttribute('disabled');downLink.removeAttribute('disabled');}}}};D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop={InstallDragDropEvents:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop;var dragDropKey=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'DragDropKey');if(dragDropKey==null){return;}node.d2l_itemKey=dragDropKey;var dragSettings=new D2L.LP.Web.UI.Html.DragDrop.DraggableSettings();var dragHandleKey=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'DragDropHandle');if(dragHandleKey){var dragHandle=D2L.LP.Web.UI.Html.Dom.GetElementById(dragHandleKey);if(dragHandle){dragSettings.SetHandle(dragHandle);}}var dragGroup=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'DragGroup');if(dragGroup){dragSettings.SetDragGroup(dragGroup);}var param=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'DragParam');node.d2l_DraggableSettings=dragSettings;dragSettings.SetGhostType(D2L.LP.Web.UI.Html.DragDrop.GhostType.CloneShadow);dragSettings.SetKey(dragDropKey);dragSettings.SetParam(param);dragSettings.SetIsAutoScroll(true);D2L.LP.Web.UI.Html.DragDrop.MakeDraggableNode(node,dragSettings);var dropType=D2L.LP.Web.UI.ObjectRepository.Get(node.id,'DropType');if(dropType!=D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.DropType.None){var droppableSettings=new D2L.LP.Web.UI.Html.DragDrop.DroppableSettings();droppableSettings.SetDropEffect(D2L.LP.Web.UI.Html.DragDrop.DropEffect.None);var acceptableDragGroups=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'AcceptableDragGroups');if(acceptableDragGroups){for(var i=0;i<acceptableDragGroups.length;i++){droppableSettings.AddAcceptableDragGroup(acceptableDragGroups[i]);}}var unacceptableDragGroupsDropOn=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'UnacceptableDragGroupsDropOn');node.d2l_unacceptableDragGroupsDropOn=[];if(unacceptableDragGroupsDropOn){for(var i=0;i<unacceptableDragGroupsDropOn.length;i++){node.d2l_unacceptableDragGroupsDropOn[unacceptableDragGroupsDropOn[i]]=true;}}var unacceptableDragGroupsDropBeforeAfter=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'UnacceptableDragGroupsDropBeforeAfter');node.d2l_unacceptableDragGroupsDropBeforeAfter=[];if(unacceptableDragGroupsDropBeforeAfter){for(var i=0;i<unacceptableDragGroupsDropBeforeAfter.length;i++){node.d2l_unacceptableDragGroupsDropBeforeAfter[unacceptableDragGroupsDropBeforeAfter[i]]=true;}}droppableSettings.SetEventPropagation(false);droppableSettings.GetDropEvent().AddListener(function(dragObject){me.DragDropHandler(node,dragSettings,dragObject);});droppableSettings.GetDragOverEvent().AddListener(function(dragObject,mouseDeltas){me.DragOverHandler(node,mouseDeltas,dragObject,dropType);});droppableSettings.GetDragOutEvent().AddListener(function(dragObject){me.DragOutHandler(node,dragObject);});D2L.LP.Web.UI.Html.DragDrop.MakeDroppableNode(node,droppableSettings);node.d2l_DroppableSettings=droppableSettings;}},DragOverHandler:function(node,mouseDeltas,dragObject,dropType){var itemNode=dragObject.GetDragNode();var me=D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop;if(me.IsDescendantOf(node,itemNode)){return;}var position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.Invalid;var isInvalidDragForDropOn=false;var isInvalidDragForDropBeforeAfter=false;var dragGroup=dragObject.GetDraggableSettings().GetDragGroup();if(dragGroup){isInvalidDragForDropOn=node.d2l_unacceptableDragGroupsDropOn[dragGroup]||false;isInvalidDragForDropBeforeAfter=node.d2l_unacceptableDragGroupsDropBeforeAfter[dragGroup]||false;}if(dropType==D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.DropType.All){if(!isInvalidDragForDropOn&&!isInvalidDragForDropBeforeAfter){if(mouseDeltas.topDelta/mouseDeltas.nodeHeight<0.25){position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.Before;}else if(mouseDeltas.bottomDelta/mouseDeltas.nodeHeight<0.25){position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.After;}else{position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.On;}}else if(!isInvalidDragForDropBeforeAfter&&isInvalidDragForDropOn){if(mouseDeltas.topDelta<mouseDeltas.bottomDelta){position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.Before;}else{position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.After;}}else if(!isInvalidDragForDropOn&&isInvalidDragForDropBeforeAfter){position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.On;}}else if(dropType==D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.DropType.OnlyDropBeforeAfter&&!isInvalidDragForDropBeforeAfter){if(mouseDeltas.topDelta<mouseDeltas.bottomDelta){position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.Before;}else{position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.After;}}else if(dropType==D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.DropType.OnlyDropOn&&!isInvalidDragForDropOn){position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.On;}else{return;}itemNode.d2l_itemDropPosition=position;D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop.UpdateDragOverEffect(node,position);},DragOutHandler:function(node){D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop.RemoveDragOverEffect(node);},DragDropHandler:function(node,nodeDragSettings,dragObject){var me=D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop;me.DragOutHandler(node,dragObject);var itemNode=dragObject.GetDragNode();if(itemNode.d2l_itemDropPosition==D2L.LP.Web.UI.Html.DragDrop.DropPosition.Invalid){return;}if(me.IsDescendantOf(node,itemNode)){return;}var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.GetParentDataList(node);dataList.d2l_itemDragPosition=itemNode.d2l_itemDropPosition;var draggedNodeSettings=dragObject.GetDraggableSettings();dataList.d2l_draggedNodeKey=draggedNodeSettings.GetKey();dataList.d2l_droppedOnNodeKey=nodeDragSettings.GetKey();dataList.d2l_droppedOnNodeHtmlId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.id);dataList.d2l_dragObjectParam=draggedNodeSettings.GetParam();dataList.d2l_dragObject=dragObject;var dataListOnDrop=D2L.LP.Web.UI.ObjectRepository.TryGet(dataList.id,'OnItemDrop');if(dataListOnDrop){dataListOnDrop.call(this);}},IsDescendantOf:function(node,dragNode){var className='d2l-datalist-item';var parentItems=D2L.LP.Web.UI.Html.Dom.GetAncestorElementsByClassName(className,node);for(var i=0;i<parentItems.length;i++){var parentNode=parentItems[i];if(dragNode.id===parentNode.id){return true;}}return false;},RemoveDragOverEffect:function(node){var removeTargetIndicator=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-item-drop-target-visible');D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-datalist-item-drop-target-visible',removeTargetIndicator);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-datalist-item-drag-over',node);},UpdateDragOverEffect:function(node,position){var dropIndicator=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName('d2l-datalist-item-drop-target',node);var contentNode=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName('d2l-datalist-item-content',node);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-datalist-item-drop-target-top',dropIndicator);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-datalist-item-drop-target-bottom',dropIndicator);D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop.RemoveDragOverEffect(node);if(position==D2L.LP.Web.UI.Html.DragDrop.DropPosition.Before){dropIndicator.parentNode.insertBefore(dropIndicator,contentNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-datalist-item-drop-target-top',dropIndicator);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-datalist-item-drop-target-visible',dropIndicator);}else if(position==D2L.LP.Web.UI.Html.DragDrop.DropPosition.After){D2L.LP.Web.UI.Html.Dom.InsertElementAfter(dropIndicator,contentNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-datalist-item-drop-target-bottom',dropIndicator);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-datalist-item-drop-target-visible',dropIndicator);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-datalist-item-drag-over',node);}}};D2L.LP.Web.UI.Desktop.Controls.DataList.SimpleItems={SetIsSelected:function(itemId,isSelected){var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());if(itemNode==null){return;}if(isSelected){D2L.LP.Web.UI.Html.Dom.AddClassName('vui-selected',itemNode);}else{D2L.LP.Web.UI.Html.Dom.RemoveClassName('vui-selected',itemNode);}}};D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems={ClearSelection:function(clearSelectAll){if(clearSelectAll!=null){clearSelectAll.call(clearSelectAll);}},Get:function(){return D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems;},GetCheckboxNode:function(itemNode){return D2L.LP.Web.UI.Desktop.Controls.Checkbox.GetFirstChildCheckboxInputNode(D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode));},GetItemSelectedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems;var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList;return dataList.GetEvent(id.GetValue(),me.OnItemSelectedEvent);},GetOnLoadCompletedEvent:function(id){return D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnLoadCompletedEvent(id);},GetOnLoadMoreCompletedEvent:function(id){return D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnLoadMoreCompletedEvent(id);},GetOnPageEvent:function(id){return D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnPageEvent(id);},GetOnPageCompletedEvent:function(id){return D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnPageCompletedEvent(id);},GetParam:function(selectionProvider){if(selectionProvider==null){return null;}return new D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems.Param(selectionProvider.call(selectionProvider));},GetSelectedValues:function(id){return D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems.GetValues(id,true);},GetIsAnySelectedFunction:function(id){return D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems.GetSelectedValues(id).length>0;},GetValues:function(id,isSelected){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems;var itemNodes=D2L.LP.Web.UI.Desktop.Controls.DataList.GetItemsNodes(id,'d2l-datalist-checkboxitem');var values=[];for(var i=0;i<itemNodes.length;i++){var checkboxNode=me.GetCheckboxNode(itemNodes[i]);if(checkboxNode!=null){if(isSelected===undefined||checkboxNode.checked==isSelected){values.push(checkboxNode.value);}}}return values;},HighlightItemByNode:function(itemNode){D2L.LP.Web.UI.Desktop.Controls.DataList.HighlightItemByNode(itemNode);},InitializeCheckboxItem:function(itemNode,groupName){var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList;var me=D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems;var checkboxNode=me.GetCheckboxNode(itemNode);if(checkboxNode===null){return;}var setItemStyles=function(cbNode){if(!cbNode.disabled){if(cbNode.checked){D2L.LP.Web.UI.Html.Dom.AddClassName('vui-selected',itemNode);}else{D2L.LP.Web.UI.Html.Dom.RemoveClassName('vui-selected',itemNode);}}};setItemStyles(checkboxNode);if(groupName===undefined){var listNode=itemNode.parentNode;if(listNode!==null&&listNode.parentNode!==null){groupName=listNode.parentNode.getAttribute('id');}}var itemMarginNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode);var checkboxContainerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemMarginNode);var expandedClickHandler=function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);if(eventTarget===itemNode||eventTarget===itemMarginNode||eventTarget===checkboxContainerNode){D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',checkboxNode,{'cancelable':false});}};D2L.LP.Web.UI.Html.Dom.AddEventListener('click',itemNode,expandedClickHandler);var updateCheckboxHandler=function(){if(checkboxNode.d2l_checked!==undefined&&checkboxNode.d2l_checked!==null&&checkboxNode.d2l_checked!==checkboxNode.checked){D2L.LP.Web.UI.Desktop.Controls.Checkbox.SetIsChecked(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(checkboxNode.id),checkboxNode.d2l_checked);}checkboxNode.d2l_checked=null;if(!checkboxNode.disabled){setItemStyles(checkboxNode);var evt=me.GetItemSelectedEvent(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(groupName));evt.Trigger(checkboxNode.value,checkboxNode.checked);}};D2L.LP.Web.UI.Html.Dom.AddEventListener('click',checkboxNode,updateCheckboxHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener('d2l-datalist-checkboxitem-update',checkboxNode,updateCheckboxHandler);},OnItemSelectedEvent:{},SetIsSelectionReadOnly:function(id,isReadOnly){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(isReadOnly&&!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-readonly',node)){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-readonly',node);}else if(!isReadOnly&&D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-readonly',node)){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-readonly',node);}},SetSelection:function(id,type,values){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems;var itemNodes=D2L.LP.Web.UI.Desktop.Controls.DataList.GetItemsNodes(id,'d2l-datalist-checkboxitem');var getIsSelectionValue=function(value){for(var i=0;i<values.length;i++){if(values[i]==value){return true;}}return false;};var setSelection=function(isSelectedDelegate){for(var i=0;i<itemNodes.length;i++){var checkboxNode=me.GetCheckboxNode(itemNodes[i]);if(checkboxNode!=null&&!checkboxNode.disabled){var isSelected=isSelectedDelegate.call(isSelectedDelegate,checkboxNode);if(checkboxNode.checked!=isSelected){checkboxNode.d2l_checked=isSelected;D2L.LP.Web.UI.Html.Dom.DispatchEvent('d2l-datalist-checkboxitem-update',checkboxNode);}}}};if(type==D2L.LP.LayeredArch.SelectionFilterType.All){setSelection(function(){return true;});}else if(type==D2L.LP.LayeredArch.SelectionFilterType.None){setSelection(function(){return false;});}else if(type==D2L.LP.LayeredArch.SelectionFilterType.AllExcept){setSelection(function(checkboxNode){return!getIsSelectionValue(checkboxNode.value);});}else if(type==D2L.LP.LayeredArch.SelectionFilterType.Some){setSelection(function(checkboxNode){return getIsSelectionValue(checkboxNode.value);});}},SetIsSelected:function(id,value,isSelected){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems;var itemNodes=D2L.LP.Web.UI.Desktop.Controls.DataList.GetItemsNodes(id,'d2l-datalist-checkboxitem');for(var i=0;i<itemNodes.length;i++){var checkboxNode=me.GetCheckboxNode(itemNodes[i]);if(checkboxNode!=null&&checkboxNode.value==value&&!checkboxNode.disabled){if(checkboxNode.checked!=isSelected){checkboxNode.d2l_checked=isSelected;D2L.LP.Web.UI.Html.Dom.DispatchEvent('d2l-datalist-checkboxitem-update',checkboxNode);return;}}}},SetIsAllSelected:function(id,isSelected,itemNodes){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems;if(itemNodes===undefined){itemNodes=D2L.LP.Web.UI.Desktop.Controls.DataList.GetItemsNodes(id,'d2l-datalist-checkboxitem');}for(var i=0;i<itemNodes.length;i++){var checkboxNode=me.GetCheckboxNode(itemNodes[i]);if(checkboxNode!=null&&!checkboxNode.disabled){if(checkboxNode.checked!=isSelected){checkboxNode.d2l_checked=isSelected;D2L.LP.Web.UI.Html.Dom.DispatchEvent('d2l-datalist-checkboxitem-update',checkboxNode);}}}}};D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems.Param=D2L.Class.Create({Construct:function(selection){this.m_selection=selection;},_serialize:function(serializer){serializer.AddMember('selection',this.m_selection);},GetSelection:function(){return this.m_selection;}});D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems={GetRadioNode:function(itemNode){return D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode));},GetSelectedValue:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems;var itemNodes=D2L.LP.Web.UI.Desktop.Controls.DataList.GetItemsNodes(id,'d2l-datalist-radioitem');for(var i=0;i<itemNodes.length;i++){var radioNode=me.GetRadioNode(itemNodes[i]);if(radioNode!=null&&radioNode.checked){return radioNode.value;}}return null;},InitializeRadioItem:function(itemNode,groupName){var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList;var me=D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems;var radioNode=me.GetRadioNode(itemNode);if(radioNode==null){return;}if(groupName===undefined){var listNode=itemNode.parentNode;if(listNode!=null&&listNode.parentNode!=null){groupName=listNode.parentNode.getAttribute('id');}}if(groupName!==undefined){D2L.LP.Web.UI.Html.Dom.SetAttribute(radioNode,'name',groupName);}var itemMarginNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode);var expandedClickHandler=function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);if(eventTarget===itemNode||eventTarget===itemMarginNode){D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',radioNode);}};D2L.LP.Web.UI.Html.Dom.AddEventListener('click',itemNode,expandedClickHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',radioNode,function(){var itemNodes=D2L.LP.Web.UI.Html.Dom.GetImmediateChildElementsByClassName('vui-selected',itemNode.parentNode);for(var i=0;i<itemNodes.length;i++){D2L.LP.Web.UI.Html.Dom.RemoveClassName('vui-selected',itemNodes[i]);}if(!radioNode.disabled){if(radioNode.checked){D2L.LP.Web.UI.Html.Dom.AddClassName('vui-selected',itemNode);}}});},SetIsSelected:function(id,value,isSelected){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems;var itemNodes=D2L.LP.Web.UI.Desktop.Controls.DataList.GetItemsNodes(id,'d2l-datalist-radioitem');me.SetIsSelectedByItemNodes(itemNodes,value,isSelected);},SetIsSelectedByItemNodes:function(itemNodes,value,isSelected){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems;for(var i=0;i<itemNodes.length;i++){var radioNode=me.GetRadioNode(itemNodes[i]);if(radioNode!=null&&radioNode.value==value&&!radioNode.disabled){if(radioNode.checked!=isSelected){radioNode.checked=isSelected;D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',radioNode);return;}}}},SetIsSelectedByItemId:function(itemId,isSelected){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems;var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());if(itemNode==null){return;}var radioNode=me.GetRadioNode(itemNode);if(radioNode==null){return;}var listNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-datalist',itemNode);if(listNode==null){return;}var itemNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-datalist-radioitem',listNode);me.SetIsSelectedByItemNodes(itemNodes,radioNode.value,isSelected);}};D2L.LP.Web.UI.Desktop.Controls.DataList.Summary={GetSelectAllIdByDataListId:function(dataListId){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.Summary;var summaryNode=me.GetSummaryNode(dataListId);if(summaryNode==null){return null;}var selectAllNode=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName('d2l-selectall',summaryNode);if(selectAllNode==null){return null;}return new D2L.LP.Web.UI.Html.AbsoluteHtmlId(selectAllNode.getAttribute('id'));},GetSelectionInfo:function(provider){if(provider==null){return null;}return provider.call(provider);},GetSummaryNode:function(dataListId){var dataListNode=D2L.LP.Web.UI.Html.Dom.GetElementById(dataListId.GetValue());var summaryNode=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName('d2l-datalist-summary',dataListNode);return summaryNode;},GetEvent:function(id,events){var evt=events[id];if(evt===undefined){evt=new D2L.LP.Web.UI.Events.Event();events[id]=evt;}return evt;},OnSelectionUpdatedEvents:{},GetSelectionUpdatedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.Summary;return me.GetEvent(id.GetValue(),me.OnSelectionUpdatedEvents);}};D2L.LP.Web.UI.Desktop.Controls.DateTimeRange={GetLocalDateTimeFromString:function(dateTime){var re=/([0-9]{4})-([0-9]{2})-([0-9]{2})[T]?([0-9]{1,2})?[:]?([0-9]{1,2})?/;var match=dateTime.match(re);return new D2L.LocalDateTime(parseInt(match[1]),parseInt(match[2]),parseInt(match[3]),match[4]!==undefined?parseInt(match[4]):0,match[5]!==undefined?parseInt(match[5]):0,0);},GetNodes:function(id){var idVal=id.GetValue();var edit=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(edit===null){throw'DateTimeRange not found:\''+idVal+'\'.';}var container=edit.parentNode;var hiddens=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datetime-range-hiddens',container);var startDateTime=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(hiddens);var endDateTime=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(startDateTime);var isEnabled=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(endDateTime);return{edit:edit,startDateTime:startDateTime,endDateTime:endDateTime,isEnabled:isEnabled,isDateTimeRange:edit.tagName==='D2L-INPUT-DATE-TIME-RANGE'};},GetSelectedStartDateTime:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeRange;var nodes=me.GetNodes(id);return me.GetLocalDateTimeFromString(nodes.startDateTime.value);},GetSelectedEndDateTime:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeRange;var nodes=me.GetNodes(id);return me.GetLocalDateTimeFromString(nodes.endDateTime.value);},GetStringDateTimeFromLocal:function(localDateTime,isDateTimeRange){var year=localDateTime.GetYear();var month=localDateTime.GetMonth();var date=localDateTime.GetDay();if(month.toString().length<2)month='0'+month;if(date.toString().length<2)date='0'+date;if(isDateTimeRange){var hour=localDateTime.GetHour();var minute=localDateTime.GetMinute();if(hour.toString().length<2)hour='0'+hour;if(minute.toString().length<2)minute='0'+minute;return year+'-'+month+'-'+date+'T'+hour+':'+minute+':00.000';}else{return year+'-'+month+'-'+date;}},SetSelectedStartDateTime:function(id,selectedDateTime){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeRange;var nodes=me.GetNodes(id);var formatted=me.GetStringDateTimeFromLocal(selectedDateTime,nodes.isDateTimeRange);nodes.edit.startValue=formatted;me.SetNodeValues(nodes,formatted,null);},SetSelectedEndDateTime:function(id,selectedDateTime){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeRange;var nodes=me.GetNodes(id);var formatted=me.GetStringDateTimeFromLocal(selectedDateTime,nodes.isDateTimeRange);nodes.edit.endValue=formatted;me.SetNodeValues(nodes,null,formatted);},SetNodeValues:function(nodes,startDateTime,endDateTime){if(startDateTime)nodes.startDateTime.value=startDateTime;if(endDateTime)nodes.endDateTime.value=endDateTime;},ValidateMinMax:function(edit,attribute,ignoreTime,earliest,latest){var selectedDate=edit.getAttribute(attribute);var localDateTime=D2L.LP.Web.UI.Desktop.Controls.DateTimeRange.GetLocalDateTimeFromString(selectedDate);if(earliest!==null&&latest!==null){var isEarly=D2L.LocalDateTime.Compare(localDateTime,earliest,ignoreTime)<0;var isLate=D2L.LocalDateTime.Compare(localDateTime,latest,ignoreTime)>0;return!isEarly&&!isLate;}else if(earliest!==null){return D2L.LocalDateTime.Compare(localDateTime,earliest,ignoreTime)>=0;}else{return D2L.LocalDateTime.Compare(localDateTime,latest,ignoreTime)<=0;}},ValidateMinMaxRange:function(id,ignoreTime,earliest,latest){var edit=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeRange;return me.ValidateMinMax(edit,"start-value",ignoreTime,earliest,latest)&&me.ValidateMinMax(edit,"end-value",ignoreTime,earliest,latest);},ValidateRange:function(id,inclusive){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeRange;var edit=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(edit.hasAttribute('disabled'))return true;var startDate=edit.getAttribute('start-value');var localStartDateTime=me.GetLocalDateTimeFromString(startDate);var endDate=edit.getAttribute('end-value');var localEndDateTime=me.GetLocalDateTimeFromString(endDate);var jsStartDate=D2L.LocalDateTime.ToJavaScriptDate(localStartDateTime);var jsEndDate=D2L.LocalDateTime.ToJavaScriptDate(localEndDateTime);return inclusive?jsEndDate.getTime()-jsStartDate.getTime()>=0:jsEndDate.getTime()-jsStartDate.getTime()>0;}};D2L.LP.Web.UI.Desktop.Controls.DateRangeBinder={Init:function(startId,endId,autoShiftDates,inclusive){var dts=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var me=D2L.LP.Web.UI.Desktop.Controls.DateRangeBinder;var trb=D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder;var startNodes=dts.GetNodes(startId);var endNodes=dts.GetNodes(endId);var isSameDay=function(){var startDate=dts.GetSelectedDateTimeNodes(startNodes);var endDate=dts.GetSelectedDateTimeNodes(endNodes);return me.IsSameDay(startDate,endDate);};var validate=function(){if(me.GetUseLegacySelector()){validateLegacy();return;}var isVisible=D2L.LP.Web.UI.Html.Dom.IsVisible(endNodes.edit);var isValid=me.ValidateIds(startId,endId,inclusive);if(isValid){endNodes.edit.removeAttribute('invalid');startNodes.edit.removeAttribute('invalid');}else{endNodes.edit.setAttribute('invalid','invalid');if(!isVisible){startNodes.edit.setAttribute('invalid','invalid');}}};var validateLegacy=function(){var isVisible=D2L.LP.Web.UI.Html.Dom.IsVisible(endNodes.edit);var isValid=me.Validate(startNodes,endNodes);if(isValid){endNodes.edit.removeAttribute('aria-invalid');startNodes.edit.removeAttribute('aria-invalid');}else{endNodes.edit.setAttribute('aria-invalid','true');if(!isVisible){startNodes.edit.setAttribute('aria-invalid','true');}}};var startDateChange=function(evt){var date=evt.detail.date;var prevDate=evt.detail.prevDate;var endDate=dts.GetSelectedDateTimeNodes(endNodes);var jsDate=D2L.LocalDateTime.ToJavaScriptDate(date);var jsPrevDate=D2L.LocalDateTime.ToJavaScriptDate(prevDate);var jsEndDate=D2L.LocalDateTime.ToJavaScriptDate(endDate);var isValid=jsEndDate.getTime()-jsPrevDate.getTime()>=0;if(isValid&&autoShiftDates){var diff=jsDate.getTime()-jsPrevDate.getTime();var jsNewEndDate=new Date(jsEndDate.getTime()+diff);var newEndDate=D2L.LocalDateTime.FromJavaScriptDate(jsNewEndDate);dts.SetSelectedDateTimeByNode(endNodes,newEndDate);}validate();};var startTimeChange=function(evt){var time=evt.detail.time;var prevTime=evt.detail.prevTime;var hasTime=dts.GetHasTimeNodes(startNodes);if(!hasTime){return;}trb.OnStartChange(startNodes.timeNodes,endNodes.timeNodes,time,prevTime,isSameDay(),autoShiftDates,inclusive);};var endTimeChange=function(){var hasTime=dts.GetHasTimeNodes(endNodes);if(!hasTime){return;}trb.RenderValidation(startNodes.timeNodes,endNodes.timeNodes,isSameDay(),inclusive);};$(startNodes.container).on('d2l-datetime-selector-change',startDateChange);$(endNodes.container).on('d2l-datetime-selector-change',validate);if(me.GetUseLegacySelector()){$(startNodes.timeNodes.container).on('d2l-time-selector-change',startTimeChange);$(endNodes.timeNodes.container).on('d2l-time-selector-change',endTimeChange);}},IsSameDay:function(startDate,endDate){return startDate.GetYear()===endDate.GetYear()&&startDate.GetMonth()===endDate.GetMonth()&&startDate.GetDay()===endDate.GetDay();},ValidateIds:function(startId,endId,inclusive){var dts=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var me=D2L.LP.Web.UI.Desktop.Controls.DateRangeBinder;var startNodes=dts.GetNodes(startId);var endNodes=dts.GetNodes(endId);if(me.GetUseLegacySelector()){return me.ValidateIdsLegacy(startNodes,endNodes,inclusive);}else{return me.Validate(startNodes,endNodes,inclusive);}},ValidateIdsLegacy:function(startNodes,endNodes,inclusive){var dts=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var me=D2L.LP.Web.UI.Desktop.Controls.DateRangeBinder;var isDateValid=me.Validate(startNodes,endNodes);if(!isDateValid){return false;}var startDate=dts.GetSelectedDateTimeNodes(startNodes);var endDate=dts.GetSelectedDateTimeNodes(endNodes);var hasTime=dts.GetHasTimeNodes(endNodes);if(!hasTime){return true;}var isSameDay=me.IsSameDay(startDate,endDate);if(!isSameDay){return true;}var trb=D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder;var isTimeValid=trb.ValidateNodes(startNodes.timeNodes,endNodes.timeNodes,inclusive);return isTimeValid;},Validate:function(startNodes,endNodes,inclusive){var dts=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var me=D2L.LP.Web.UI.Desktop.Controls.DateRangeBinder;var startIsEnabled=dts.IsEnabledNodes(startNodes);var endIsEnabled=dts.IsEnabledNodes(endNodes);if(!startIsEnabled||!endIsEnabled){return true;}var startDate=dts.GetSelectedDateTimeNodes(startNodes);var endDate=dts.GetSelectedDateTimeNodes(endNodes);var hasTime=dts.GetHasTimeNodes(endNodes);if(me.GetUseLegacySelector()||!hasTime){return me.ValidateDates(startDate,endDate);}else{var jsStartDate=D2L.LocalDateTime.ToJavaScriptDate(startDate);var jsEndDate=D2L.LocalDateTime.ToJavaScriptDate(endDate);return inclusive?jsEndDate.getTime()-jsStartDate.getTime()>=0:jsEndDate.getTime()-jsStartDate.getTime()>0;}},ValidateDates:function(startDate,endDate){if(endDate.GetYear()!==startDate.GetYear()){return endDate.GetYear()>startDate.GetYear();}if(endDate.GetMonth()!==startDate.GetMonth()){return endDate.GetMonth()>startDate.GetMonth();}return endDate.GetDay()>=startDate.GetDay();},GetUseLegacySelector:function(){return!D2L.LP.Web.UI.Flags.Flag('US112810-date-time-components',true);}};D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector={IsEnabledNodes:function(nodes){return!nodes.edit.disabled;},SetIsEnabled:function(id,isEnabled){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);me.SetIsEnabledNodes(nodes,isEnabled);},GetIsEnabled:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);return me.IsEnabledNodes(nodes);},SetIsEnabledNodes:function(nodes,isEnabled){nodes.isEnabled.value=isEnabled?'1':'0';if(isEnabled)nodes.edit.removeAttribute('disabled');else nodes.edit.setAttribute('disabled','disabled');var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var useLegacy=me.GetUseLegacySelector();if(useLegacy){D2L.LP.Web.UI.Desktop.Controls.TimeSelector.SetIsEnabledNodes(nodes.timeNodes,isEnabled);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(nodes.calendarLink,isEnabled);if(nodes.nowButton!=null){D2L.LP.Web.UI.Desktop.Controls.Button.SetIsEnabledNode(nodes.nowButton,isEnabled);}}var dateTime=me.GetSelectedDateTimeNodes(nodes);var customEvent=new CustomEvent('d2l-datetime-selector-change',{detail:{date:dateTime,prevDate:dateTime},bubbles:true});nodes.container.dispatchEvent(customEvent);},SetSelectedDateTime:function(id,selectedDateTime){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);me.SetSelectedDateTimeByNode(nodes,selectedDateTime);},PageInitialLoadTimestamp:new Date().getTime(),SetDateTimeToNow:function(id,localDateTimeAtPageLoad){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var millisecondsSpentOnPage=new Date().getTime()-me.PageInitialLoadTimestamp;var now=new Date(localDateTimeAtPageLoad.GetTimestamp()+millisecondsSpentOnPage);me.SetSelectedDateTime(id,D2L.LocalDateTime.FromJavaScriptDate(now));},SetNodeValues:function(nodes,selectedDateTimeObject){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var prevDateTime=me.GetSelectedDateTimeNodes(nodes);nodes.year.value=selectedDateTimeObject.year;nodes.month.value=selectedDateTimeObject.month;nodes.day.value=selectedDateTimeObject.day;if(selectedDateTimeObject.hour!==undefined)nodes.hour.value=selectedDateTimeObject.hour;if(selectedDateTimeObject.minute!==undefined)nodes.minute.value=selectedDateTimeObject.minute;var currDateTime=me.GetSelectedDateTimeNodes(nodes);var customEvent=new CustomEvent('d2l-datetime-selector-change',{detail:{date:currDateTime,prevDate:prevDateTime},bubbles:true});nodes.container.dispatchEvent(customEvent);},SetSelectedDateTimeByNodeLegacy:function(nodes,selectedDateTime){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var prevDateTime=me.GetSelectedDateTimeNodes(nodes);var prevDateTimeStr=nodes.edit.value;var formatter=D2L.LP.Globalization.Locale.GetDateTimeFormatter();nodes.edit.value=formatter.FormatInputDate(selectedDateTime);nodes.edit.d2l_lastGoodDate=selectedDateTime;nodes.year.value=selectedDateTime.GetYear();nodes.month.value=selectedDateTime.GetMonth();nodes.day.value=selectedDateTime.GetDay();var time=new D2L.LocalTime(selectedDateTime.GetHour(),selectedDateTime.GetMinute());D2L.LP.Web.UI.Desktop.Controls.TimeSelector.SetTimeNodes(nodes.timeNodes,time);setTimeout(function(){var miniCalPartialRenderFunction=D2L.LP.Web.UI.ObjectRepository.Get(nodes.edit.id,'CalPartial');me.RefreshMiniCalendar(miniCalPartialRenderFunction);});var customEvent=new CustomEvent('d2l-datetime-selector-change',{detail:{date:selectedDateTime,prevDate:prevDateTime},bubbles:true});nodes.container.dispatchEvent(customEvent);if(prevDateTimeStr!=nodes.edit.value){nodes.edit.dispatchEvent(new CustomEvent('change',{bubbles:true}));}},SetSelectedDateTimeByNode:function(nodes,selectedDateTime){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;if(me.GetUseLegacySelector()){return me.SetSelectedDateTimeByNodeLegacy(nodes,selectedDateTime);}var month=selectedDateTime.GetMonth();var date=selectedDateTime.GetDay();var hour=selectedDateTime.GetHour();var minute=selectedDateTime.GetMinute();var obj={year:selectedDateTime.GetYear(),month:month,day:date,hour:hour,minute:minute};if(month.toString().length<2)month='0'+month;if(date.toString().length<2)date='0'+date;if(hour.toString().length<2)hour='0'+hour;if(minute.toString().length<2)minute='0'+minute;nodes.edit.value=selectedDateTime.GetYear()+'-'+month+'-'+date+'T'+hour+':'+minute+':00.000';me.SetNodeValues(nodes,obj);},SetSelectedDateByInputNodeId:function(id,selectedDateTime){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);var dateTime=me.GetSelectedDateTimeNodes(nodes);selectedDateTime=new D2L.LocalDateTime(selectedDateTime.GetYear(),selectedDateTime.GetMonth(),selectedDateTime.GetDay(),dateTime.GetHour(),dateTime.GetMinute(),0);me.SetSelectedDateTimeByNode(nodes,selectedDateTime);},GetSelectedDateTime:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);return me.GetSelectedDateTimeNodes(nodes);},GetSelectedDateTimeNodes:function(nodes){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var year=parseInt(nodes.year.value);var month=parseInt(nodes.month.value);var day=parseInt(nodes.day.value);var hour,minute,second;if(me.GetUseLegacySelector()){var time=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetTimeNodes(nodes.timeNodes);hour=time.GetHour();minute=time.GetMinute();second=time.GetSecond();}else{hour=parseInt(nodes.hour.value);minute=parseInt(nodes.minute.value);second=0;}return new D2L.LocalDateTime(year,month,day,hour,minute,second);},GetNodesLegacy:function(id,phid){var idVal=id.GetValue();var edit=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(edit===null){throw'DateTimeSelector not found:\''+idVal+'\'.';}var container=edit.parentNode.parentNode;var timeContainer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-time-selector',container);var timeEdit=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(timeContainer);var timeNodes=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetNodes(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(timeEdit.id));var hiddens=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datetime-selector-hiddens',container);var calendarLink=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datetime-selector-calendar-link',container);var floatingContainer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-floating-container',container);var placeholderContainer;if(phid==undefined||phid==null){placeholderContainer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-placeholder',floatingContainer);}else{placeholderContainer=D2L.LP.Web.UI.Html.Dom.GetElementById(phid);floatingContainer=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-floating-container',placeholderContainer);}var miniCalendar;if(placeholderContainer==null||placeholderContainer==undefined){miniCalendar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-calendar-mini',floatingContainer);}else{miniCalendar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-calendar-mini',placeholderContainer);}var year=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(hiddens);var month=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(year);var day=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(month);var hasTime=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(day);var isEnabled=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(hasTime);var nowButton=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datetime-selector-now-button',container);return{container:container,edit:edit,timeNodes:timeNodes,year:year,month:month,day:day,hasTime:hasTime,isEnabled:isEnabled,calendarLink:calendarLink,floatingContainer:floatingContainer,miniCalendar:miniCalendar,nowButton:nowButton};},GetNodes:function(id,phid){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;if(me.GetUseLegacySelector()){return me.GetNodesLegacy(id,phid);}var idVal=id.GetValue();var edit=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(edit===null){throw'DateTimeSelector not found:\''+idVal+'\'.';}var container=edit.parentNode;var hiddens=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datetime-selector-hiddens',container);var year=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(hiddens);var month=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(year);var day=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(month);var hour=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(day);var minute=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(hour);var hasTime=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(minute);var isEnabled=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(hasTime);return{container:container,edit:edit,year:year,month:month,day:day,hour:hour,minute:minute,hasTime:hasTime,isEnabled:isEnabled};},OpenMiniCalendar:function(floatingContainerId,dateInputId,openerId,focus,focusOnOpenTargetId){if(!D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpen(floatingContainerId)){var openerNode=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Open(floatingContainerId,openerId,{AttachToBody:false,AutoCloseExclusions:[openerNode],FocusOnOpen:focus,FocusOnOpenTargetControlId:focusOnOpenTargetId,Position:D2L.LP.Web.UI.Html.Style.OverlayPosition.Bottom,TargetId:dateInputId});}},RefreshMiniCalendar:function(partialRenderFunction){partialRenderFunction.call(partialRenderFunction);},GetHasTimeNodes:function(nodes){var hasTime=nodes.hasTime.value=='1';return hasTime;},ValidateRange:function(id,ignoreTime,earliest,latest){var selectedDate=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.GetSelectedDateTime(id);if(earliest!==null&&latest!==null){var isEarly=D2L.LocalDateTime.Compare(selectedDate,earliest,ignoreTime)<0;var isLate=D2L.LocalDateTime.Compare(selectedDate,latest,ignoreTime)>0;return!isEarly&&!isLate;}else if(earliest!==null){return D2L.LocalDateTime.Compare(selectedDate,earliest,ignoreTime)>=0;}else{return D2L.LocalDateTime.Compare(selectedDate,latest,ignoreTime)<=0;}},GetUseLegacySelector:function(){return!D2L.LP.Web.UI.Flags.Flag('US112810-date-time-components',true);}};D2L.LP.Web.UI.Desktop.Controls.Edit={ClearValue:function(id){D2L.LP.Web.UI.Desktop.Controls.Edit.SetValue(id,'');var inputNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());inputNode.focus();},ClearValueNode:function(node){D2L.LP.Web.UI.Desktop.Controls.Edit.SetValueNode(node,'');},GetValue:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Desktop.Controls.Edit.GetValueNode(input);},GetValueNode:function(node){if(node!==null){return node.value;}return'';},SetValue:function(id,value){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(input!==null){D2L.LP.Web.UI.Desktop.Controls.Edit.SetValueNode(input,value);}},SetValueNode:function(node,value){node.value=value;},IsEnabledNode:function(node){if(node.disabled!==undefined){return!node.disabled;}return true;},IsVisibleNode:function(node){return D2L.LP.Web.UI.Html.Dom.IsVisible(node);},IsVisible:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Desktop.Controls.Edit.IsVisibleNode(input);},ValidateEnabledVisibleNode:function(node){if(!node){return true;}var isEnabled=D2L.LP.Web.UI.Desktop.Controls.Edit.IsEnabledNode(node);var isVisible=D2L.LP.Web.UI.Desktop.Controls.Edit.IsVisibleNode(node);if(!isEnabled||!isVisible){return false;}return true;},ValidateMinLength:function(id,minLength){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var isEnabledVisible=D2L.LP.Web.UI.Desktop.Controls.Edit.ValidateEnabledVisibleNode(input);if(!isEnabledVisible){return true;}var length=input.value.trim().length;if(length===0||length>=minLength){return true;}return false;},ValidateRequired:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var isEnabledVisible=D2L.LP.Web.UI.Desktop.Controls.Edit.ValidateEnabledVisibleNode(input);if(!isEnabledVisible){return true;}return input.value.trim().length>0;}};D2L.LP.Web.UI.Desktop.Controls.EditEmail={ValidateEmail:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Desktop.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible){return true;}var emailPattern=/^[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$/;var emailValue=D2L.LP.Web.UI.Desktop.Controls.Edit.GetValue(id).trim();if(emailValue==''){return true;}return emailPattern.test(emailValue);}};D2L.LP.Web.UI.Desktop.Controls.EditInteger={TryGetInteger:function(id,isClientSideValidationEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(node&&node.tagName==='D2L-INPUT-NUMBER'){return D2L.LP.Web.UI.Desktop.Controls.InputNumber.GetValue(id);}if(isClientSideValidationEnabled===undefined){isClientSideValidationEnabled=false;}var editValue=D2L.LP.Web.UI.Desktop.Controls.Edit.GetValue(id).trim();if(editValue==''){return null;}else{try{return D2L.LP.Web.UI.Desktop.Controls.EditInteger.ParseNumber(editValue);}catch(e){var previousValue=D2L.LP.Web.UI.Desktop.Controls.EditInteger.GetHiddenValue(id);if(isClientSideValidationEnabled){var numberStr=D2L.LP.Web.UI.Desktop.Controls.EditInteger.FormatNumber(previousValue);D2L.LP.Web.UI.Desktop.Controls.Edit.SetValue(id,numberStr);}return previousValue;}}},GetHiddenValue:function(id){var hiddenId=D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),'HiddenId');var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetElementById(hiddenId.GetValue());if(hiddenNode.value==''){return null;}else{return hiddenNode.value;}},ParseNumber:function(numberStr){var number=D2L.LP.Globalization.Locale.GetNumberParser().ParseInteger(numberStr);return number;},FormatNumber:function(number){var numberStr=D2L.LP.Globalization.Locale.GetNumberFormatter().FormatInteger(number);return numberStr;},SetInteger:function(id,number,triggerOnChange){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.EditInteger.SetIntegerNode(node,number,triggerOnChange);},SetIntegerNode:function(node,number,triggerOnChange){if(node&&node.tagName==='D2L-INPUT-NUMBER'){D2L.LP.Web.UI.Desktop.Controls.InputNumber.SetNodeValue(node,number,triggerOnChange);return;}var numberStr=D2L.LP.Web.UI.Desktop.Controls.EditInteger.FormatNumber(number);D2L.LP.Web.UI.Desktop.Controls.Edit.SetValueNode(node,numberStr);if(triggerOnChange===undefined||triggerOnChange){D2L.LP.Web.UI.Html.Dom.DispatchEvent("change",node);}else{var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.id);D2L.LP.Web.UI.Desktop.Controls.EditInteger.UpdateHidden(id);}},UpdateHidden:function(id,isClientSideValidationEnabled){var hiddenId=D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),'HiddenId');var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetElementById(hiddenId.GetValue());var value=D2L.LP.Web.UI.Desktop.Controls.EditInteger.TryGetInteger(id,isClientSideValidationEnabled);if(value==null){D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode(hiddenNode,false);hiddenNode.value='';}else{D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode(hiddenNode,true);hiddenNode.value=value;}},ValidateInteger:function(resolvedId){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(resolvedId);var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Desktop.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible){return true;}var editValue=D2L.LP.Web.UI.Desktop.Controls.Edit.GetValueNode(node).trim();if(editValue==''){return true;}try{D2L.LP.Web.UI.Desktop.Controls.EditInteger.ParseNumber(editValue);return true;}catch(e){return false;}},ValidateIntegerRange:function(resolvedId,min,max){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(resolvedId);var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Desktop.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible){return true;}var value=D2L.LP.Web.UI.Desktop.Controls.EditInteger.TryGetInteger(id);if(value==null){return true;}if(min!==null&&max!==null){return min<=value&&value<=max;}else if(min!==null){return min<=value;}else if(max!==null){return value<=max;}else{return true;}}};D2L.LP.Web.UI.Desktop.Controls.EditDecimal={TryGetDecimal:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(node&&node.tagName==='D2L-INPUT-NUMBER'){return D2L.LP.Web.UI.Desktop.Controls.InputNumber.GetValue(id);}var editValue=D2L.LP.Web.UI.Desktop.Controls.Edit.GetValue(id).trim();if(editValue==''){return null;}else{try{return D2L.LP.Web.UI.Desktop.Controls.EditDecimal.ParseNumber(editValue);}catch(e){return D2L.LP.Web.UI.Desktop.Controls.EditDecimal.GetHiddenValue(id);}}},GetHiddenValue:function(id){var hiddenId=D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),'HiddenId');var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetElementById(hiddenId.GetValue());if(hiddenNode.value==''){return null;}else{return hiddenNode.value;}},ParseNumber:function(numberStr){var number=D2L.LP.Globalization.Locale.GetNumberParser().ParseDecimal(numberStr);return number;},FormatNumber:function(number){var numberStr=D2L.LP.Globalization.Locale.GetNumberFormatter().FormatDecimal(number);return numberStr;},SetDecimal:function(id,number,triggerOnChange){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(node&&node.tagName==='D2L-INPUT-NUMBER'){D2L.LP.Web.UI.Desktop.Controls.InputNumber.SetNodeValue(node,number,triggerOnChange);return;}var numberStr=D2L.LP.Web.UI.Desktop.Controls.EditDecimal.FormatNumber(number);D2L.LP.Web.UI.Desktop.Controls.Edit.SetValue(id,numberStr);if(triggerOnChange===undefined||triggerOnChange){var editNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.DispatchEvent("change",editNode);}else{D2L.LP.Web.UI.Desktop.Controls.EditDecimal.UpdateHidden(id);}},UpdateHidden:function(id){var hiddenId=D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),'HiddenId');var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetElementById(hiddenId.GetValue());var value=D2L.LP.Web.UI.Desktop.Controls.EditDecimal.TryGetDecimal(id);if(value==null){D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode(hiddenNode,false);hiddenNode.value='';}else{D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode(hiddenNode,true);hiddenNode.value=value;}},ValidateDecimal:function(resolvedId){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(resolvedId);var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Desktop.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible){return true;}var editValue=D2L.LP.Web.UI.Desktop.Controls.Edit.GetValue(id).trim();if(editValue==''){return true;}try{D2L.LP.Web.UI.Desktop.Controls.EditDecimal.ParseNumber(editValue);return true;}catch(e){return false;}},ValidateDecimalRange:function(resolvedId,min,max){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(resolvedId);var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Desktop.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible){return true;}var value=D2L.LP.Web.UI.Desktop.Controls.EditDecimal.TryGetDecimal(id);if(value==null){return true;}if(min!==null&&max!==null){return min<=value&&value<=max;}else if(min!==null){return min<=value;}else if(max!==null){return value<=max;}else{return true;}}};D2L.LP.Web.UI.Desktop.Controls.EditUrl={Validate:function(id,allowInternal){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Desktop.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible){return true;}var value=D2L.LP.Web.UI.Desktop.Controls.Edit.GetValueNode(node);if(value===undefined||value===null||value.trim().length===0){return true;}var regexpStr;if(allowInternal){regexpStr=D2L.LP.Web.UI.ObjectRepository.Get('UrlRegEx','AllowInternal');}else{regexpStr=D2L.LP.Web.UI.ObjectRepository.Get('UrlRegEx','NoInternal');}var regexp=new RegExp(regexpStr,'i');return regexp.test(value);},Required:function(id,allowInternal){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Desktop.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible){return true;}var hasProtocol=D2L.LP.Web.UI.Desktop.Controls.EditUrl.Validate(id,allowInternal);if(!hasProtocol){return true;}var value=D2L.LP.Web.UI.Desktop.Controls.Edit.GetValueNode(node);if(value===undefined||value===null||value.trim().length===0){return true;}var regexp=new RegExp('(:|/)[a-zA-Z0-9]','i');var hasContent=regexp.test(value);if(allowInternal&&hasContent){return true;}return hasContent;}};D2L.LP.Web.UI.Desktop.Controls.EditInPlace={Click:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.EditInPlace.ClickHelper(node,false);},ClickHelper:function(node,autoResize){var id=node.id;$(node).parent().attr("data-isOpen","true");var targetId=D2L.LP.Web.UI.ObjectRepository.TryGet(id);if(targetId==null){return;}var targetIdValue=targetId.GetValue();var target=D2L.LP.Web.UI.Html.Dom.GetElementById(targetIdValue);target.d2l_opener=node;if(autoResize){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);target.style.width=Math.max(rect.width,100)+'px';target.style.minHeight=rect.height+'px';}D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(target,true);if(D2L.LP.Web.UI.ObjectRepository.HasKeys(targetIdValue,'edit')){var onEdit=D2L.LP.Web.UI.ObjectRepository.Get(targetIdValue,'edit');onEdit();}var editor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor",target);if(editor!==null&&editor.d2l_isFullscreen===true){D2L.LP.Web.UI.Desktop.Controls.EditInPlace.SetBodyScrollBar(false);}},Finish:function(id){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(target);},FinishHelper:function(target,doTrigger,isEmpty){var targetIdVal=target.id;var opener=target.d2l_opener;var anchor=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(opener);target.d2l_opener=null;if(isEmpty!==undefined){D2L.LP.Web.UI.Desktop.Controls.EditInPlace.SetIsEmptyHelper(opener,isEmpty);}D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(opener,true);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(target,false);if(doTrigger){var hasFinish=D2L.LP.Web.UI.ObjectRepository.HasKeys(targetIdVal,'finish');if(hasFinish){var onFinish=D2L.LP.Web.UI.ObjectRepository.Get(targetIdVal,'finish');var ret=onFinish();ret.AddListener(function(){var editable=$(target).prev()[0];D2L.LP.Web.UI.Desktop.Controls.EditInPlace.ModifyAnchors(editable);});}D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-editable-changed',opener);}else{var hasAbort=D2L.LP.Web.UI.ObjectRepository.HasKeys(targetIdVal,'abort');if(hasAbort){var onAbort=D2L.LP.Web.UI.ObjectRepository.Get(targetIdVal,"abort");onAbort();}}setTimeout(function(){D2L.LP.Web.UI.Html.Dom.FocusNode(anchor);},0);setTimeout(function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-editable-changed',opener);},1500);},SetBodyScrollBar:function(isVisible){var bodyNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-body');if(isVisible){bodyNode.style.overflow='visible';}else{bodyNode.style.overflow='hidden';}},GetHtmlEditorContent:function(id){var htmlEditorId=$('#'+id.GetValue()).attr("data-d2l-htmleditorid");var htmlParam=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetHtml(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(htmlEditorId));return htmlParam;},IsEditorOpen:function(id){return $('#'+id.GetValue()).attr("data-isOpen");},ModifyAnchors:function(node){$(node).find('a').attr('target','_blank');},SetIsEmpty:function(id,isEmpty){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.EditInPlace.SetIsEmptyHelper(node,isEmpty);},SetIsEmptyHelper:function(node,isEmpty){var empty=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-editable-empty',node);if(empty!==null){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(empty,isEmpty);}var container=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-editable-content',node);if(container!==null){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(container,!isEmpty);}}};D2L.LP.Web.UI.Desktop.Controls.EditInPlace.Edit={Clear:function(id){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var edit=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-edit',target);D2L.LP.Web.UI.Desktop.Controls.Edit.ClearValueNode(edit);},OnEdit:function(id){var edit=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());edit.d2l_value=edit.value;edit.select();}};D2L.LP.Web.UI.Desktop.Controls.EditInPlace.EditUrl={OnEdit:function(id){var edit=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());edit.d2l_value=edit.value;if(edit.value==""){edit.value="http://";}edit.select();}};D2L.LP.Web.UI.Desktop.Controls.EditInPlace.LongEdit={Clear:function(id){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var edit=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-longedit',target);D2L.LP.Web.UI.Desktop.Controls.LongEdit.ClearValueNode(edit);}};D2L.LP.Web.UI.Desktop.Controls.EditInPlace.HtmlEditor={Cancel:function(editorId,targetId){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(targetId.GetValue());D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetHtml(editorId,target.d2l_html);D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(target);D2L.LP.Web.UI.Desktop.Controls.EditInPlace.SetBodyScrollBar(true);},GetHtml:function(id){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(target.d2l_html!==undefined){return target.d2l_html;}else{return'';}},OnEdit:function(id,editorId,html){var evt=new D2L.LP.Web.UI.Events.Event();var targetId=id.GetValue();var target=D2L.LP.Web.UI.Html.Dom.GetElementById(targetId);if(target.d2l_initialized==true){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.Focus(editorId);evt.Trigger();}else{if(target.d2l_html===undefined){target.d2l_html=html;}var initializeEditor=D2L.LP.Web.UI.ObjectRepository.TryGet(targetId,'initializeEditor');if(initializeEditor!=null){initializeEditor.call(initializeEditor).AddListener(function(){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.Focus(editorId);evt.Trigger();});target.d2l_initialized=true;}else{evt.Trigger();}}return evt;},Update:function(id,param){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var hasChanged=false;var newHtml=param.GetHtml();if(target.d2l_html!=newHtml){target.d2l_html=newHtml;hasChanged=true;}var isEmpty=newHtml==null||newHtml.length==0;D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(target,hasChanged,isEmpty);D2L.LP.Web.UI.Desktop.Controls.EditInPlace.SetBodyScrollBar(true);},GetOnInit:function(id){}};D2L.LP.Web.UI.Desktop.Controls.EditableEditUrl={SetUrl:function(id,url){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"href",url);},SetUrlDisplay:function(id,url,displayWithProtocol){if(!displayWithProtocol){url=D2L.LP.Web.UI.Desktop.Controls.EditableEditUrl.StripProtocol(url);}D2L.LP.Web.UI.Desktop.Controls.TextBlock.SetText(id,url);},StripProtocol:function(url){var seperator="://";if(url.indexOf(seperator)!=-1){url=url.substring(url.indexOf(seperator)+seperator.length);}return url;}};D2L.LP.Web.UI.Desktop.Controls.EditableEditInteger={IsValidInteger:function(value){try{D2L.LP.Web.UI.Desktop.Controls.EditInteger.ParseNumber(value);return true;}catch(e){return false;}},IsValidIntegerGreaterThanMin:function(value,minValue){if(D2L.LP.Web.UI.Desktop.Controls.EditableEditInteger.IsValidInteger(value)){return parseInt(value)>=minValue;}return false;},IsEmptyStringOrValidIntegerGreaterThanMin:function(value,minValue){return typeof value.trim==="function"&&value.trim()===""||this.IsValidIntegerGreaterThanMin(value,minValue);}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-emoticon-selector',function(node){D2L.LP.Web.UI.Desktop.Controls.EmoticonSelector.Init(node);});D2L.LP.Web.UI.Desktop.Controls.EmoticonSelector={Init:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.EmoticonSelector;var onSelectFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'OnSelectFunction');var emoticonNodes=me.GetEmoticonNodes(node);for(var e=0;e<emoticonNodes.length;e++){var target=emoticonNodes[e];D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseenter',target,function(event){me.SetActive(event,node);});D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseleave',target,me.SetInactive);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',target,function(){if(onSelectFunction===null){return;}onSelectFunction.call(onSelectFunction);});}var numEmoticonsPerRow=parseInt(node.getAttribute('data-d2l-emoticonrowsize'),10);D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,function(args){var result=me.HandleKeyPress(args,node,emoticonNodes,numEmoticonsPerRow,onSelectFunction);if(result){var event=args.GetEventObject();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(event);}});me.SetAriaRoles(node);me.ClearActiveNodes(node);me.SetNodeActive(emoticonNodes[0]);},SetAriaRoles:function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"application");var emoticonList=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-emoticon-selector-emoticon-list",node);var heading=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(emoticonList);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-emoticonselector-title",heading);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-emoticonselector-rclabel",heading);D2L.LP.Web.UI.Html.Aria.SetAttribute(emoticonList,"labelledby",heading.id);},SetActive:function(event,selector){var me=D2L.LP.Web.UI.Desktop.Controls.EmoticonSelector;var target;if(event.target){target=event.target;}if(event.srcElement){target=event.srcElement;}me.SetNodeActive(target,selector);},SetInactive:function(event){var me=D2L.LP.Web.UI.Desktop.Controls.EmoticonSelector;var target;if(event.target){target=event.target;}if(event.srcElement){target=event.srcElement;}me.SetNodeInactive(target);},SetNodeActive:function(node,selector){var me=D2L.LP.Web.UI.Desktop.Controls.EmoticonSelector;if(!me.IsActiveNode(node)){me.ClearActiveNodes(selector);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-emoticon-selector-emoticon-active',node);node.focus();}},SetNodeInactive:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.EmoticonSelector;if(me.IsActiveNode(node)){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-emoticon-selector-emoticon-active',node);}},GetActiveNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.EmoticonSelector;var emoticonNodes=me.GetEmoticonNodes(node);var activeNode=me.GetActiveNodeFromEmoticonNodes(emoticonNodes);return activeNode;},GetActiveNodeFromEmoticonNodes:function(emoticonNodes){var me=D2L.LP.Web.UI.Desktop.Controls.EmoticonSelector;for(var i=0;i<emoticonNodes.length;i++){var currentNode=emoticonNodes[i];if(me.IsActiveNode(currentNode)){return currentNode;}}return null;},GetEmoticonNodes:function(node){var emoticonNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-emoticon-selector-nav',node);return emoticonNodes;},IsActiveNode:function(node){var isActive=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-emoticon-selector-emoticon-active',node);return isActive;},HandleKeyPress:function(args,selector,emoticonNodes,emoticonsPerRow,onSelectFunction){var me=D2L.LP.Web.UI.Desktop.Controls.EmoticonSelector;var keyCode=args.GetKey();if(keyCode===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab){var event=args.GetEventObject();var target=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(event);if(!target||emoticonNodes.indexOf(target)<0||me.IsActiveNode(target)){return false;}me.SetNodeActive(target,selector);return true;}if(keyCode===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter){var event=args.GetEventObject();var target=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(event);if(!target||!me.IsActiveNode(target)){return false;}if(onSelectFunction===null){return false;}onSelectFunction.call(onSelectFunction);return true;}var result=me.HandleNav(selector,keyCode,emoticonNodes,emoticonsPerRow);return result;},HandleNav:function(selector,keyCode,emoticonNodes,emoticonsPerRow){var me=D2L.LP.Web.UI.Desktop.Controls.EmoticonSelector;var currentActiveNode=me.GetActiveNodeFromEmoticonNodes(emoticonNodes);var currentPosition=emoticonNodes.indexOf(currentActiveNode);var navFunction;var isRowPositionValidFunction;var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection===D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var leftMovePositionCheck=function(currentPos,newPos){var isNewPositionValid=newPos%emoticonsPerRow<currentPos%emoticonsPerRow;return isNewPositionValid;};var rightMovePositionCheck=function(currentPos,newPos){var isNewPositionValid=newPos%emoticonsPerRow>currentPos%emoticonsPerRow;return isNewPositionValid;};switch(keyCode){case D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowUp:navFunction=function(currentPos){newPos=currentPos-emoticonsPerRow;return newPos;};break;case D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown:navFunction=function(currentPos){newPos=currentPos+emoticonsPerRow;return newPos;};break;case D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowLeft:navFunction=function(currentPos){newPos=isRTL?currentPos+1:currentPos-1;return newPos;};isRowPositionValidFunction=isRTL?rightMovePositionCheck:leftMovePositionCheck;break;case D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowRight:navFunction=function(currentPos){newPos=newPos=isRTL?currentPos-1:currentPos+1;return newPos;};isRowPositionValidFunction=isRTL?leftMovePositionCheck:rightMovePositionCheck;break;default:break;}if(navFunction){me.ArrowNavHandler(navFunction,isRowPositionValidFunction,emoticonNodes,currentActiveNode,currentPosition);return true;}return false;},ArrowNavHandler:function(navFunction,isRowPositionValidFunction,emoticonNodes,currentActiveNode,currentPosition){var me=D2L.LP.Web.UI.Desktop.Controls.EmoticonSelector;var newPosition;if(currentActiveNode===null){newPosition=0;}else{newPosition=navFunction(currentPosition);}if(isRowPositionValidFunction&&!isRowPositionValidFunction(currentPosition,newPosition)){return;}if(!me.IsAbsolutePositionValid(emoticonNodes.length,newPosition)){return;}var newActiveNode=emoticonNodes[newPosition];me.SetNodeInactive(currentActiveNode);me.SetNodeActive(newActiveNode);},IsAbsolutePositionValid:function(numberOfEmoticons,position){var minPosition=0;var maxPosition=numberOfEmoticons-1;var isPositionValid=position>=minPosition&&position<=maxPosition;return isPositionValid;},ClearActiveNodes:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.EmoticonSelector;var emoticonNodes=me.GetEmoticonNodes(node);for(var e=0;e<emoticonNodes.length;e++){var currentNode=emoticonNodes[e];me.SetNodeInactive(currentNode);}},InsertEmoticon:function(selectorId,baseEmoticonLocation){var me=D2L.LP.Web.UI.Desktop.Controls.EmoticonSelector;var selector=D2L.LP.Web.UI.Html.Dom.GetElementById(selectorId);var activeNode=me.GetActiveNode(selector);if(activeNode===null){return;}var emoticonName=activeNode.getAttribute('data-d2l-emoji');var altText=activeNode.getAttribute('title').toLowerCase();var emoticonPath=baseEmoticonLocation+emoticonName+'.svg';var html='<img';html+=' src="'+emoticonPath+'"';html+=' alt="'+altText+'"';html+=' data-d2l-emoji="'+emoticonName+'"';html+='>';return html;}};D2L.LP.Web.UI.Desktop.Controls.EquationEditor={};D2L.LP.Web.UI.Desktop.Controls.EquationEditor.LatexEditor={SetMath:function(node,math){if(math){math=math.replace(/&#x9;/g,'\t');math=math.replace(/&#xA;/g,'\n');math=math.replace(/&#xD;/g,'\r');}var latexnode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-latexedit",node);latexnode.value=math;},GetMath:function(node,callback){var latexnode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-latexedit",node);callback.call(callback,latexnode.value);},AreLatexDelimitersSpecified:function(latex){if(/^\\\(/.test(latex)&&/\\\)$/.test(latex)){return true;}else if(/^\$\$/.test(latex)&&/\$\$$/.test(latex)){return true;}else if(/^\\\[/.test(latex)&&/\\\]$/.test(latex)){return true;}else{return false;}},GetMathML:function(node,callback){var latexnode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-latexedit",node);var hiddennode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-hiddenmath",node);var latex=latexnode.value;latex=latex.trim();if(!latex){callback.call(callback,'');return;}if(D2L.LP.Web.UI.Desktop.Controls.EquationEditor.LatexEditor.AreLatexDelimitersSpecified(latex)){hiddennode.innerHTML=latex;}else{hiddennode.innerHTML='$$'+latex+'$$';}D2L.LP.Web.UI.Html.Math.UpdateNode(hiddennode);D2L.LP.Web.UI.Html.Math.GetMath(hiddennode,function(mathList){if(Array.isArray(mathList)){if(mathList.length===1){callback.call(callback,mathList[0].mathML);}else{var decodeCharRef=function(match){return match.replace('&amp;','&');};var multiLineMathML='';mathList.forEach(function(math){multiLineMathML+='<mtr><mtd>';multiLineMathML+=math.mathML.replace(/&amp;[\S]*?;/g,decodeCharRef).replace(/<math[^>]*(.|\n|\r)*?>/gi,'').replace(/<\/math>/gi,'');multiLineMathML+='</mtd></mtr>';});multiLineMathML='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable>'+multiLineMathML+'</mtable></math>';callback.call(callback,multiLineMathML);}}else{callback.call(callback,'');}});},SetPreviewMathML:function(previewNode,mathml){previewNode.innerHTML=mathml;D2L.LP.Web.UI.Html.Math.UpdateNode(previewNode);},GetAnnotatedMathML:function(node,callback){var me=D2L.LP.Web.UI.Desktop.Controls.EquationEditor.LatexEditor;me.GetMathML(node,function(mathml){me.GetMath(node,function(math){var format='latex';if(math.indexOf('<math')===0){format='mathml';}var annotatedMathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML(format,'',math,mathml);callback.call(callback,annotatedMathML);});});}};D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor={FreeRangeAppIFramePlugin:function(){return function(host){var service={getAltText:function(mml,lang){mml=D2L.LP.Web.UI.Html.JavaScript.UrlEncode(mml);lang=D2L.LP.Web.UI.Html.JavaScript.UrlEncode(lang);var src='/wiris/editorservice.aspx/mathml2accessible?mml={0}&lang={1}'.replace('{0}',mml).replace('{1}',lang);return window.fetch(src).then(function(response){if(!response.ok)return'';return response.text();});}};host.registerService('equations','0.1',service);};},SetMath:function(node,math){if(math==null)return;if(math.indexOf('&lt;math')>-1){math=D2L.LP.Web.UI.Html.Math.DecodeMathML(math);}var graphicalEditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-graphicalequationeditor",node);if(graphicalEditor!=null&&!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",graphicalEditor)){D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.SetGraphicalMath(node,math);}var mathmleditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathmleditorarea",node);if(mathmleditor!=null&&!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",mathmleditor)){D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.SetMathMLMath(node,math);}},SetGraphicalMath:function(node,math){var graphicalEditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-graphicalequationeditor",node);var editor=com.wiris.jsEditor.JsEditor.getInstance(graphicalEditor);editor.setMathML(math);},SetMathMLMath:function(node,math){var mathmleditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathmleditorarea",node);mathmleditor.value=math;},ReplaceSelfClosingTags:function(text){var selfClosingRegex=/<\w+(\s+[^\\>]*)?\/>/gim;return text.replace(selfClosingRegex,function(match){var regexp=/<(\w+)(\s+([^\\>]*)?)?\/>/gim;var result=regexp.exec(match);if(result[3]==null){return"<"+result[1]+"></"+result[1]+">";}else{return"<"+result[1]+" "+result[3]+"></"+result[1]+">";}});},GetWirisMath:function(node,callback){var graphicalEditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-graphicalequationeditor",node);var editor=com.wiris.jsEditor.JsEditor.getInstance(graphicalEditor);var mathml=editor.getMathML();callback.call(callback,D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.ReplaceSelfClosingTags(mathml));},GetMath:function(node,callback){var graphicalEditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-graphicalequationeditor");var mathmleditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathmlequationeditor");if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",graphicalEditor)){D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.GetMathML(mathmleditor,function(mathml){callback.call(callback,mathml);});}else{D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.GetWirisMath(function(mathml){callback.call(callback,mathml);});}},GetMathML:function(node,callback){var mathmleditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathmleditorarea",node);var hidden=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-hiddenmath",node);hidden.innerHTML=mathmleditor.value;D2L.LP.Web.UI.Html.Math.UpdateNode(hidden);D2L.LP.Web.UI.Html.Math.GetMath(hidden,function(math){callback.call(callback,math);});},ToggleEditor:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor;var dom=D2L.LP.Web.UI.Html.Dom;var graphical=dom.GetFirstElementByClassName("d2l-graphicalequationeditor",node);var mathml=dom.GetFirstElementByClassName("d2l-mathmlequationeditor",node);if(dom.HasClassName("d2l-hidden",graphical)){me.GetMathML(node,function(math){if(math.length==1){me.SetGraphicalMath(node,me.ReplaceSelfClosingTags(math[0].mathML));}});dom.RemoveClassName("d2l-hidden",graphical);D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.HideMathML(node,true);}else{me.GetWirisMath(node,function(math){me.SetMathMLMath(node,math);});dom.AddClassName("d2l-hidden",graphical);D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.HideMathML(node,false);}},HideMathML:function(node,hide){var editor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathmleditorarea",node);var preview=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathpreview",node);var previewError=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathpreview-error",node);var generatePreview=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-showequationpreview",node);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(previewError,false);if(hide){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(preview,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(generatePreview,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(editor,true);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",editor);if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",preview)){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",preview);}preview.innerHTML="";D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.UpdateDialogSize(previewError,false);}else{D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(editor,true);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(generatePreview,true);}},GeneratePreview:function(node){var preview=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathpreview",node);var hidden=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-hiddenmath",node);var previewError=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathpreview-error",node);D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.GetMathML(node,function(mathml){if(mathml==null||mathml.length==0){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(previewError,true);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(preview,false);D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.UpdateDialogSize(previewError,true);}else{hidden.innerHTML=mathml[0].mathML;D2L.LP.Web.UI.Html.Math.UpdateNode(hidden,function(){preview.innerHTML=hidden.innerHTML;D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(previewError,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(preview,true);D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.UpdateDialogSize(preview,true);});}});},UpdateDialogSize:function(node,adjust){var heightAdjust=0;if(adjust){var nodeSize=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);heightAdjust=nodeSize.height;}var win=win||window;var dialogs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-dialog-frame',win.parent.document);var dialog=null;for(var i=0;i<dialogs.length;i++){if(dialogs[i].contentWindow==win){dialog=dialogs[i].parentNode.parentNode;}}if(dialog!=null&&dialog.d2l_handle!=null){var eqnEditor=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-equationeditor",node);var height=parseInt(D2L.LP.Web.UI.Html.Dom.GetAttribute(eqnEditor,"data-d2l-initialheight"));D2L.LP.Web.UI.Desktop.MasterPages.Dialog.SetSize(dialog.d2l_handle,dialog.d2l_handle.width,height+heightAdjust);}},HidePreview:function(node){var preview=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathpreview",node);preview.innerHTML="";D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",preview);D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.UpdateDialogSize(preview);},GetAnnotatedMathML:function(node,callback){var ret=new D2L.LP.Web.UI.Events.Event();var me=this;var editor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-graphicalequationeditor",node);if(editor==null||D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",editor)){me.GetMathML(node,function(mathml){var math=mathml[0].mathML;var annotatedMathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML("mathml",'',math,math);ret.Trigger(annotatedMathML);callback.call(callback,annotatedMathML);});}else{var toolbarType=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-wiristoolbartype");var encoding;if(toolbarType!=null&&toolbarType==="chemistry"){encoding="wiris-chemistry";}else{encoding="wiris";}me.GetWirisMath(node,function(mathml){var annotatedMathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML(encoding,'',mathml,mathml);ret.Trigger(annotatedMathML);callback.call(callback,annotatedMathML);});}return ret;}};D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse={m_changedKey:null,m_changedState:null,GetChangedKey:function(){return D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.m_changedKey;},GetChangedState:function(){return D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.m_changedState;},SetChangedKey:function(key,state){D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.m_changedKey=key;D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.m_changedState=state;},SuppressFocusChange:false,SuppressStateChangeEvent:false,Toggle:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null){throw'ExpandCollapse not found: \''+id.GetValue()+'\'.';}var links=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-imagelink',node);if(links.length!==2){return;}if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',links[0])){D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',links[1]);}else{D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',links[0]);}},CollapseAll:function(parentContainerId){D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.SuppressFocusChange=true;var node=document;if(parentContainerId!==undefined){node=D2L.LP.Web.UI.Html.Dom.GetElementById(parentContainerId.GetValue());}$(node).find('.d2l-collapsepane').each(function(index,elem){D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.CollapseNode(elem);});D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.SuppressFocusChange=false;},ExpandAll:function(parentContainerId){D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.SuppressFocusChange=true;var node=document;if(parentContainerId!==undefined){node=D2L.LP.Web.UI.Html.Dom.GetElementById(parentContainerId.GetValue());}$(node).find('.d2l-collapsepane').each(function(index,elem){D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.ExpandNode(elem);});D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.SuppressFocusChange=false;},CollapseNode:function(node){var links=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-imagelink',node);if(links.length!==2){return;}if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',links[0])){D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',links[1]);}},ExpandNode:function(node){var links=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-imagelink',node);if(links.length!==2){return;}if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',links[1])){D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',links[0]);}}};D2L.LP.Web.UI.Desktop.Controls.ExpandCollapseGroup={CollapseAll:function(groupName){D2L.LP.Web.UI.Desktop.Controls.ExpandCollapseGroup.ChangeAllState(groupName,false);},ExpandAll:function(groupName){D2L.LP.Web.UI.Desktop.Controls.ExpandCollapseGroup.ChangeAllState(groupName,true);},ChangeAllState:function(groupName,isExpanded){D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.SuppressFocusChange=true;D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.SuppressStateChangeEvent=true;$(document).find('.d2l-expandcollapse').each(function(index,elem){var elemGroupName=D2L.LP.Web.UI.Html.Dom.GetAttribute(elem,'data-group');if(elemGroupName==groupName){if(isExpanded){D2L.LP.Web.UI.Desktop.Controls.ExpandCollapseGroup.ExpandNode(elem);}else{D2L.LP.Web.UI.Desktop.Controls.ExpandCollapseGroup.CollapseNode(elem);}}});D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.SuppressFocusChange=false;D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.SuppressStateChangeEvent=false;},CollapseNode:function(node){var links=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-imagelink',node);if(links.length!==2){return;}if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',links[0])){D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',links[1]);}},ExpandNode:function(node){var links=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-imagelink',node);if(links.length!==2){return;}if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',links[1])){D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',links[0]);}}};D2L.LP.Web.UI.Desktop.Controls.FileInput={AddFiles:function(id,files){var evt=new D2L.LP.Web.UI.Events.Event();var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var placeholderNode=me.GetFilePlaceholder(node);var listNode=me.GetFileListNode(node);if(placeholderNode==null){evt.Release();return evt;}var placeholderId=placeholderNode.getAttribute('id');var onAddFile=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId,1);if(onAddFile==null){evt.Release();return evt;}node.d2l_addFiles=files;onAddFile.call(onAddFile).AddListener(function(){node.d2l_lastAddedFiles=node.d2l_addFiles;var onAddFilesComplete=D2L.LP.Web.UI.ObjectRepository.TryGet(node.getAttribute('id'),'OnAddFilesComplete');if(onAddFilesComplete!==null){onAddFilesComplete.call(onAddFilesComplete);}node.d2l_addFiles=undefined;me.SetAddFileVisibility(node);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',listNode);me.TriggerChangeEvent(node);evt.Trigger();});return evt;},AddLinks:function(id,links){var evt=new D2L.LP.Web.UI.Events.Event();var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var placeholderNode=me.GetFilePlaceholder(node);var listNode=me.GetFileListNode(node);if(placeholderNode==null){evt.Release();return evt;}var placeholderId=placeholderNode.getAttribute('id');var onAddLink=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId,2);if(onAddLink==null){evt.Release();return evt;}node.d2l_addLinks=links;onAddLink.call(onAddLink).AddListener(function(){node.d2l_lastAddedLinks=node.d2l_addLinks;var onAddLinksComplete=D2L.LP.Web.UI.ObjectRepository.TryGet(node.getAttribute('id'),'OnAddLinksComplete');if(onAddLinksComplete!==null){onAddLinksComplete.call(onAddLinksComplete);}node.d2l_addLinks=undefined;me.SetAddFileVisibility(node);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',listNode);me.TriggerChangeEvent(node);evt.Trigger();});return evt;},Clear:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var listNode=me.GetFileListNode(node);var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listNode);while(itemNode!=null){if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-fileinput-placeholder',itemNode)){me.RemoveFile(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(itemNode.getAttribute('id')));}itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode);}me.SetErrorMessageVisibility(node,'d2l-fileinput-filecount-error',false);me.SetErrorMessageVisibility(node,'d2l-fileinput-filetype-error',false);me.SetErrorMessageVisibility(node,'d2l-fileinput-filesize-error',false);me.SetErrorMessageVisibility(node,'d2l-fileinput-fileempty-error',false);me.SetErrorMessageVisibility(node,'d2l-fileinput-fileupload-error',false);},GetAbortLinkNodeByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var progressBarNode=me.GetProgressBarNodeByNode(node);var abortLinkNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(progressBarNode);return abortLinkNode;},GetAddButtonsNode:function(node){return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-fileinput-addbuttons',node);},GetAddFilesByPlaceholderId:function(placeholderId){var placeholderNode=D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId.GetValue());var node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-fileinput',placeholderNode);if(node.d2l_addFiles!==undefined){return node.d2l_addFiles;}else{return[];}},GetAddLinksByPlaceholderId:function(placeholderId){var placeholderNode=D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId.GetValue());var node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-fileinput',placeholderNode);if(node.d2l_addLinks!==undefined){return node.d2l_addLinks;}else{return[];}},GetChangeKey:function(node){var newKey='';var comma='';var files=D2L.LP.Web.UI.Desktop.Controls.FileInput.GetFilesByNode(node);var links=D2L.LP.Web.UI.Desktop.Controls.FileInput.GetLinksByNode(node);for(var i=0;i<files.length;i++){var actionType=files[i].GetActionType();if(actionType!='AddRemove'){newKey+=comma+(files[i].GetActionType()+files[i].GetPluginKey()+files[i].GetId());comma=',';}}for(var i=0;i<links.length;i++){var linkActionType=links[i].GetActionType();if(linkActionType!='AddRemove'){newKey+=comma+(links[i].GetActionType()+links[i].GetLinkName()+links[i].GetLocation());comma=',';}}return newKey;},GetFileCount:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var fileCount=0;var listNode=me.GetFileListNode(node);var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listNode);while(itemNode!=null){if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',itemNode)&&!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-fileinput-placeholder',itemNode)){fileCount++;}itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode);}return fileCount;},GetFileListNode:function(node){return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-fileinput-filelist',node);},GetFilePlaceholder:function(node){return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-fileinput-placeholder',node);},GetFiles:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var files=D2L.LP.Web.UI.Desktop.Controls.FileInput.GetFilesByNode(node);return files;},GetLinks:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var links=D2L.LP.Web.UI.Desktop.Controls.FileInput.GetLinksByNode(node);return links;},GetFilesByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var listNode=me.GetFileListNode(node);var files=[];var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listNode);while(itemNode!=null){if(itemNode.classList.contains('d2l-fileinput-link')){itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode);continue;}var fileName=itemNode.getAttribute('data-d2l-name');var actionTypeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode);var pluginKeyNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(actionTypeNode);var idNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(pluginKeyNode);var fileSizeNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(idNode);var previewHrefNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-link',itemNode);var previewUrl=previewHrefNode&&previewHrefNode.href;files.push(new D2L.LP.Web.UI.Desktop.Controls.FileInput.FileParam(fileName,actionTypeNode.value,pluginKeyNode.value,idNode.value,fileSizeNode.value,previewUrl));itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode);}return files;},GetLinksByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var listNode=me.GetFileListNode(node);var links=[];var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listNode);while(itemNode!=null){if(!itemNode.classList.contains('d2l-fileinput-link')){itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode);continue;}var linkName=itemNode.getAttribute('data-d2l-name');var actionTypeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode);var nameNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(actionTypeNode);var locationNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(nameNode);var urnNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(locationNode);links.push(new D2L.LP.Web.UI.Desktop.Controls.FileInput.LinkParam(linkName,actionTypeNode.value,locationNode.value,urnNode.value));itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode);}return links;},GetLastAddedFiles:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var files=node.d2l_lastAddedFiles;if(node.d2l_lastAddedFiles===undefined&&node.d2l_lastAddedFiles===null){files=[];}return new D2L.LP.Web.UI.Desktop.Controls.FileInput.Param(files);},GetParam:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var files=me.GetFiles(id);var links=me.GetLinks(id);return new D2L.LP.Web.UI.Desktop.Controls.FileInput.Param(files,links);},GetProgressBarNodeByNode:function(node){var progressBarNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-fileinput-upload-progress',node);return progressBarNode;},GetRemovedFile:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var removedFile=[];removedFile.push(node.d2l_removedFile);return new D2L.LP.Web.UI.Desktop.Controls.FileInput.Param(removedFile);},GetUploadButtonId:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var buttons=D2L.LP.Web.UI.Desktop.Controls.FileInput.GetAddButtonsNode(node);var uploadButton=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(buttons);return uploadButton.id;},HideErrorMessages:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;me.HideErrorMessagesByNode(D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));},HasChanged:function(node){var newChangeKey=D2L.LP.Web.UI.Desktop.Controls.FileInput.GetChangeKey(node);var oldChangeKey=$(node).data('changeKey');var hasChanged=newChangeKey!==oldChangeKey;return hasChanged;},HideErrorMessagesByNode:function(node){var errorsNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-fileinput-errors',node);var errorNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(errorsNode);while(errorNode!=null){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',errorNode);errorNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(errorNode);}},OnDropAbort:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.ResetUploadByNode(node);},OnDropError:function(id,errorNumber){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.ResetUploadByNode(node);if(errorNumber===1){me.SetErrorMessageVisibility(node,'d2l-fileinput-filecount-error',true);}else if(errorNumber===2){me.SetErrorMessageVisibility(node,'d2l-fileinput-filetype-error',true);}else if(errorNumber===3){me.SetErrorMessageVisibility(node,'d2l-fileinput-filesize-error',true);}else if(errorNumber===6){me.SetErrorMessageVisibility(node,'d2l-fileinput-fileempty-error',true);}else if(errorNumber===7){me.SetErrorMessageVisibility(node,'d2l-fileinput-filenamelength-error',true);}else{me.SetErrorMessageVisibility(node,'d2l-fileinput-fileupload-error',true);}},OnDropFilesComplete:function(id,files){var evt=null;var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(files!=null&&files.length>0){var fileInputFiles=[];for(var i=0;i<files.length;i++){fileInputFiles.push(new D2L.LP.Web.UI.Files.File(files[i].GetId(),files[i].GetFileSystemType(),files[i].GetName(),files[i].GetSize()));}evt=me.AddFiles(id,fileInputFiles);}me.UpdateProgressBarByNode(node.getAttribute('data-d2l-msg-uploadcomplete'),100,me.GetProgressBarNodeByNode(node));me.ResetUploadByNode(node);return evt;},OnDropProgress:function(id,progress){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var progressBarNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.UpdateProgressBarByNode(progress.GetFileName(),progress.GetTotalPercent(),progressBarNode);},OnDropStarted:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var progressBarNode=me.GetProgressBarNodeByNode(node);var abortLinkNode=me.GetAbortLinkNodeByNode(node);node.d2l_isUploading=true;me.HideErrorMessagesByNode(node);me.SetAddFileEnabled(node);me.UpdateProgressBarByNode('',0,progressBarNode);setTimeout(function(){if(node.d2l_isUploading){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',progressBarNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',abortLinkNode);}},500);},RemoveFile:function(itemId){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());var listNode=itemNode.parentNode;var actionTypeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode);if(actionTypeNode.value==='None'){actionTypeNode.value='Remove';}else if(actionTypeNode.value==='Add'){actionTypeNode.value='AddRemove';}D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',itemNode);var node=listNode.parentNode;me.SetAddFileVisibility(node);var count=me.GetFileCount(node);if(count===0){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',listNode);}var fileName=itemNode.getAttribute('data-d2l-name');var pluginKeyNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(actionTypeNode);var idNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(pluginKeyNode);var fileSizeNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(idNode);node.d2l_removedFile=new D2L.LP.Web.UI.Desktop.Controls.FileInput.FileParam(fileName,actionTypeNode.value,pluginKeyNode.value,idNode.value,fileSizeNode.value);var onRemoveFile=D2L.LP.Web.UI.ObjectRepository.TryGet(node.getAttribute('id'),'OnRemoveFile');if(onRemoveFile!==null){onRemoveFile.call(onRemoveFile);}me.TriggerChangeEvent(node);},ResetUploadByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var progressBarNode=me.GetProgressBarNodeByNode(node);var abortLinkNode=me.GetAbortLinkNodeByNode(node);node.d2l_isUploading=false;me.SetAddFileEnabled(node);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',abortLinkNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',progressBarNode);},SetAddFileEnabled:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var isEnabled=node.d2l_isAddFileAllowed&&!node.d2l_isUploading;var addButtonsContainer=me.GetAddButtonsNode(node);var addButtonNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('vui-button',addButtonsContainer);for(var i=0;i<addButtonNodes.length;i++){D2L.LP.Web.UI.Desktop.Controls.Button.SetIsEnabled(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(addButtonNodes[i].getAttribute('id')),isEnabled);}},SetAddFileVisibility:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;node.d2l_isAddFileAllowed=false;if(node.getAttribute('data-d2l-ismultiple')=='true'){node.d2l_isAddFileAllowed=true;}else{node.d2l_isAddFileAllowed=me.GetFileCount(node)==0;}var disableDisableDragDrop=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-fileinput-disabledragdrop',node);D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default.SetIsEnabledByNode(node,node.d2l_isAddFileAllowed);if(node.d2l_isAddFileAllowed){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-fileinput-add',node);if(disableDisableDragDrop===null){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-fileinput-add-border',node);}}else{D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-fileinput-add',node);if(disableDisableDragDrop===null){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-fileinput-add-border',node);}}},SetErrorMessageVisibility:function(node,className,isVisible){var errorNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName(className,node);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(errorNode,isVisible);},ShowHandlingMessage:function(id,fileExists){var fileControl=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(fileControl&&fileExists){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;setTimeout(function(){me.SetErrorMessageVisibility(fileControl,'d2l-fileinput-loading-message',true);},3000);}},UpdateProgressBarByNode:function(text,percent,node){var progressBarTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-fileinput-upload-progress-bar',node));var progressBarColourNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(progressBarTextNode);var isPercent=!isNaN(percent);if(isPercent){progressBarTextNode.innerHTML=text+' '+percent.toString()+'%';}else{progressBarTextNode.innerHTML=text+' - Uploading';}if(percent==0||!isPercent){progressBarColourNode.style.width='0px';progressBarColourNode.style.backgroundColor='transparent';}else{if(progressBarColourNode.parentNode.clientWidth==0){progressBarColourNode.style.width='100%';}else{progressBarColourNode.style.width=progressBarColourNode.parentNode.clientWidth*percent/100-8+'px';}if(progressBarColourNode.style.backgroundColor=='transparent'){progressBarColourNode.style.backgroundColor='';}}if(isPercent){D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'aria-valuenow',percent.toString());}},TriggerChangeEvent:function(node){var hasChanged=D2L.LP.Web.UI.Desktop.Controls.FileInput.HasChanged(node);if(hasChanged){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.TriggerChange(node);}else{D2L.LP.Web.UI.Html.ChangeTracking.Trackable.TriggerRestore(node);}},ValidateRequired:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return me.GetFileCount(node)>0;},ValidateUploadInProgress:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_isUploading===undefined||node.d2l_isUploading===false;}};D2L.LP.Web.UI.Desktop.Controls.FileInput.Param=D2L.Class.Create({Construct:function(files,links){if(files===undefined){files=[];}if(links===undefined){links=[];}this.m_files=files;this.m_links=links;},_serialize:function(serializer){serializer.AddMember('files',this.m_files);serializer.AddMember('links',this.m_links);},GetFiles:function(){return this.m_files;},GetLinks:function(){return this.m_links;}});D2L.LP.Web.UI.Desktop.Controls.FileInput.FileParam=D2L.Class.Create({Construct:function(fileName,actionType,pluginKey,id,fileSize,previewUrl){if(actionType===undefined){actionType='';}if(pluginKey===undefined){pluginKey='';}if(id===undefined){id='';}if(fileSize===undefined){fileSize='';}if(previewUrl===undefined){previewUrl='';}this.m_fileName=fileName;this.m_actionType=actionType;this.m_pluginKey=pluginKey;this.m_id=id;this.m_fileSize=fileSize;this.m_previewUrl=previewUrl;},_serialize:function(serializer){serializer.AddMember('actionType',this.m_actionType);serializer.AddMember('pluginKey',this.m_pluginKey);serializer.AddMember('id',this.m_id);},GetActionType:function(){return this.m_actionType;},GetPluginKey:function(){return this.m_pluginKey;},GetId:function(){return this.m_id;},GetFileName:function(){return this.m_fileName;},GetFileSize:function(){return this.m_fileSize;},GetPreviewUrl:function(){return this.m_previewUrl;}});D2L.LP.Web.UI.Desktop.Controls.FileInput.LinkParam=D2L.Class.Create({Construct:function(linkName,actionType,location,urn){if(actionType===undefined){actionType='';}this.m_linkName=linkName;this.m_actionType=actionType;this.m_location=location;this.m_urn=urn;},_serialize:function(serializer){serializer.AddMember('actionType',this.m_actionType);serializer.AddMember('name',this.m_linkName);serializer.AddMember('location',this.m_location);serializer.AddMember('urn',this.m_urn);},GetActionType:function(){return this.m_actionType;},GetLocation:function(){return this.m_location;},GetLinkName:function(){return this.m_linkName;},GetUrn:function(){return this.m_urn;}});D2L.LP.Web.UI.Desktop.Controls.FileInput.LegacyAddFile={AddAttachment:function(fileInputId,openFunction){openFunction.call(openFunction).AddListener(function(attachments){if(attachments==null||attachments.length==0){return;}var fileInputFiles=[];var fileInputLinks=[];for(var i=0;i<attachments.length;i++){if(attachments[i].Navigation){fileInputLinks.push(new D2L.LP.Web.UI.Links.Link(attachments[i].Navigation,attachments[i].Text,attachments[i].Navigation,attachments[i].Urn));}else{fileInputFiles.push(new D2L.LP.Web.UI.Files.File(attachments[i].FileId,attachments[i].FileSystemType,attachments[i].FileName,attachments[i].Size));}}if(fileInputLinks.length>0){D2L.LP.Web.UI.Desktop.Controls.FileInput.AddLinks(fileInputId,fileInputLinks);}if(fileInputFiles.length>0){D2L.LP.Web.UI.Desktop.Controls.FileInput.AddFiles(fileInputId,fileInputFiles);}});}};D2L.LP.Web.UI.Desktop.Controls.FileInput.RecordAudioFile={SaveAudio:function(id,openFunction,callback){openFunction.call(openFunction).AddListener(function(files){D2L.LP.Web.UI.Desktop.Controls.FileInput.AddFiles(id,files);if(callback){callback.call(callback,files);}});}};D2L.LP.Web.UI.Desktop.Controls.FileInput.RecordVideoFile={AddFile:function(fileInputId,openFunction,callback){openFunction.call(openFunction).AddListener(function(file){if(file==null||file.length==0){return;}if(file.FileSystemType){var fileInputFile=new D2L.LP.Web.UI.Files.File(file.FileId,file.FileSystemType,file.FileName,file.Size);D2L.LP.Web.UI.Desktop.Controls.FileInput.AddFiles(fileInputId,fileInputFile);if(callback){callback.call(callback,fileInputFile);}}else if(file.Navigation){var fileInputLink=new D2L.LP.Web.UI.Links.Link(file.LinkId,file.Text,file.Navigation,file.Urn);D2L.LP.Web.UI.Desktop.Controls.FileInput.AddLinks(fileInputId,fileInputLink);if(callback){callback.call(callback,fileInputLink);}}});}};D2L.LP.Web.UI.Desktop.Controls.FileLink={OnChangeEvents:{}};D2L.LP.Web.UI.Desktop.Controls.FileUpload={CallbackNumber:0,ErrCodeMaxFileSize:1000,ErrCodeTotalFileSize:1001,ErrCodeRestrictedFile:1002,CheckFileType:function(file){var _type=D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetFileType(file);if(_type===false){return false;}for(var i=0;i<D2L.LP.Web.UI.Desktop.Controls.FileUpload.FileTypeWhiteList.length;i++){if(_type===D2L.LP.Web.UI.Desktop.Controls.FileUpload.FileTypeWhiteList[i]){return true;}}return false;},ClearErrorMessages:function(id){if(typeof id==='object'){id=id.m_value;}var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(!node){var $iframes=$('iframe');try{var $contents=$iframes.contents();var $id=$contents.find('#'+id);if($id.length>0){var $errorNode=$contents.find('.d2l-filedrop-status-container');$errorNode.addClass('d2l-filedrop-status-container-hidden');}}catch(e){}}else{var parentBody=$(node).closest('body').get(0);var errorNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-filedrop-status-container',parentBody);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-filedrop-status-container-hidden',errorNode);}},GenerateIFrame:function(name,parentNode){var _hiddenIFrame;if(parentNode.insertAdjacentHTML){parentNode.insertAdjacentHTML('beforeEnd',"<iframe id='"+name+"' name='"+name+"' class='d2l-offscreen d2l-hidden "+name+"'></iframe>");_hiddenIFrame=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName(name,parentNode);}else{_hiddenIFrame=document.createElement("IFRAME");D2L.LP.Web.UI.Html.Dom.SetAttribute(_hiddenIFrame,"name",name);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-offscreen d2l-hidden",_hiddenIFrame);parentNode.appendChild(_hiddenIFrame);}return _hiddenIFrame;},GenerateInputNode:function(filelink,deleteicon,parentNode){var _inputNode;if(parentNode.insertAdjacentHTML){parentNode.insertAdjacentHTML('beforeEnd',"<input id='"+id+"' type='file' size='30' class='d2l-fileupload-input'>");_inputNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id);}else{_inputNode=document.createElement("input");D2L.LP.Web.UI.Html.Dom.SetAttribute(_inputNode,"size","30");D2L.LP.Web.UI.Html.Dom.SetAttribute(_inputNode,"type","file");D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-fileupload-input",_inputNode);parentNode.appendChild(_inputNode);}return _inputNode;},GetAction:function(fileName,callback,controlId,fileInputId,maxFileSize,maxTotalSize,totalSize){var _callbackId=D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetUniqueCallbackId(controlId,fileInputId);window[_callbackId]=callback;var _action="/d2l/common/upload/uploadFile.d2l"+"?cb="+_callbackId+"&fileName="+D2L.LP.Web.UI.Desktop.Controls.FileUpload.StripFilePath(fileName)+"&maxFileSize="+(maxFileSize==null||maxFileSize==undefined?0:maxFileSize)+"&maxTotalSize="+(maxTotalSize==null||maxTotalSize==undefined?0:maxTotalSize)+"&totalSize="+(totalSize==null||totalSize==undefined?0:totalSize);return _action;},GetCallbackNumber:function(){D2L.LP.Web.UI.Desktop.Controls.FileUpload.CallbackNumber+=1;return D2L.LP.Web.UI.Desktop.Controls.FileUpload.CallbackNumber;},GetUniqueCallbackId:function(controlId,fileInputId){var date=new Date();var _time=date.getTime();date=null;return"d2l_ctrl_"+controlId+"_"+fileInputId+"_"+_time+"_"+D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetCallbackNumber();},GetInvalidFileExtensionMessage:function(message){return message;},GetInvalidFileSizeMessage:function(message){return message;},GetInvalidTotalFileSizeMessage:function(message){return message;},GetInvalidRestrictedFileMessage:function(message){return message;},GetMaxFileSize:function(value){return value;},GetTotalFileSize:function(value){return value;},GetFileExt:function(fileName){if(!fileName||fileName===undefined){return false;}var _index=fileName.lastIndexOf(".");if(_index<0){return false;}var _ext=fileName.substring(_index+1);return _ext;},GetFileInfo:function(file){if(file===undefined){return false;}var _fileInfo={name:"",type:"",size:"0"};_fileInfo.name=D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetFileName(file);_fileInfo.type=D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetFileType(file);_fileInfo.size=D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetFileSize(file);return _fileInfo;},GetFileName:function(file){if(file.fileName===undefined){if(file.name===undefined){return false;}return file.name;}return file.fileName;},GetFileSize:function(file){if(file.fileSize===undefined){if(file.size===undefined){return false;}return file.size;}return file.fileSize;},GetFileType:function(file){if(file.type===undefined){return false;}return file.type;},GetTempFileId:function(hiddenInputId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(hiddenInputId);if(node!=null){return node.value;}return false;},StripFilePath:function(filePath){var _index=filePath.lastIndexOf("\\");var _fileName=filePath.substring(_index+1);return _fileName;},ValidateRequired:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(input!==null){return input.value.length>0;}else{return true;}},ValidateFileType:function(id,fileTypesList){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var ext=D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetFileExt(node.value);if(fileTypesList!==null&&fileTypesList!==undefined){var fileTypesArr=fileTypesList.split(',');for(var i=0;i<fileTypesArr.length;i++){var _ext=fileTypesArr[i];_ext=D2L.LP.Web.UI.Html.JavaScript.TrimString(0,_ext);if(_ext===ext||_ext==="*")return true;}}else{return true;}return false;},OnChangeEvents:{}};D2L.LP.Web.UI.Desktop.Controls.FilterInline={Clear:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null){throw'FilterInline not found: \''+idVal+'\'.';}var groups=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-filterinline-group',node);var setFocus=false;for(var i=0;i<groups.length;i++){var isSingle=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-filterinline-group-single',groups[i]);if(isSingle){continue;}var nodes=me.GetNodesNode(groups[i]);for(var j=0;j<nodes.anchors.length;j++){me.SetIsSelectedNodes(groups[i].id,nodes,nodes.anchors[j],false,i==groups.length-1&&j==nodes.anchors.length-1);}if(!setFocus&&nodes.anchors.length>0){nodes.anchors[0].focus();setFocus=true;}}},GetNodes:function(id,noThrow){var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null){if(noThrow){return null;}throw'FilterInlineGroupMultiple not found: \''+idVal+'\'.';}return D2L.LP.Web.UI.Desktop.Controls.FilterInline.GetNodesNode(node);},GetNodesNode:function(node){var anchors=node.getElementsByTagName('a');return{node:node,anchors:anchors};},GetSelectedKeys:function(id,defaultValue){var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;var noThrow=defaultValue!==undefined;var nodes=me.GetNodes(id,noThrow);if(nodes===null){return defaultValue;}var keys=D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),'keys');var selectedKeys=[];for(var i=0;i<nodes.anchors.length;i++){var isSelected=me.IsSelectedNode(nodes.anchors[i]);if(isSelected){selectedKeys.push(keys[i]);}}if(selectedKeys.length===0){return keys;}return selectedKeys;},GetSelectedKey:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null){throw'FilterInlineGroupSingle not found: \''+idVal+'\'.';}var keys=D2L.LP.Web.UI.ObjectRepository.Get(idVal,'keys');var anchors=node.getElementsByTagName('a');for(var i=0;i<anchors.length;i++){var isSelected=me.IsSelectedNode(anchors[i]);if(isSelected){return keys[i];}}throw'FilterInlineGroupSingle error: No items selected.';},IsNoneSelected:function(id,defaultValue){var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;var noThrow=defaultValue!==undefined;var nodes=me.GetNodes(id,noThrow);if(nodes===null){return defaultValue;}return me.IsNoneSelectedNodes(nodes);},IsNoneSelectedNodes:function(nodes){var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;for(var i=0;i<nodes.anchors.length;i++){var isSelected=me.IsSelectedNode(nodes.anchors[i]);if(isSelected){return false;}}return true;},IsSelectedNode:function(node){var isSelected=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-filterinline-item-selected',node);return isSelected;},RenderClear:function(node){var clear=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-filterinline-clear',node);if(clear===null){return;}var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;var clearSeparator=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(clear);var groups=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-filterinline-group',node);var isNoneSelected=true;for(var i=0;i<groups.length;i++){var groupNodes=me.GetNodesNode(groups[i]);isNoneSelected=isNoneSelected&&me.IsNoneSelectedNodes(groupNodes);}D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(clear,!isNoneSelected);if(clearSeparator&&$(clearSeparator).hasClass('d2l-filterinline-group-sep')){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(clearSeparator,!isNoneSelected);}},SetIsSelectedNodes:function(groupId,nodes,anchor,isSelected,triggerOnChange){var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;if(isSelected){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-filterinline-item-selected',anchor);}else{D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-filterinline-item-selected',anchor);}D2L.LP.Web.UI.Html.Aria.SetAttribute(anchor,'checked',isSelected?'true':'false');if(!triggerOnChange){return;}me.RenderClear($(nodes.node).closest('.d2l-filterinline').get(0));var onChange=D2L.LP.Web.UI.ObjectRepository.TryGet(groupId,'onchange');if(onChange!==null){onChange();}}};D2L.LP.Web.UI.Desktop.Controls.FilterInlineFlyout={Close:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var flyoutId=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-flyout-id'));D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.Close(flyoutId);},SetKey:function(id,key){var hidden=D2L.LP.Web.UI.Desktop.Controls.FilterInlineFlyout.GetKeyHidden(id);if(hidden.value!==key){hidden.value=key;}if(D2L.LP.Web.UI.ObjectRepository.HasKeys(id.GetValue(),'OnChange')){var onChangeFunc=D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),'OnChange');onChangeFunc.call(onChangeFunc);}},SetText:function(id,text){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var button=node.querySelector('d2l-dropdown-button-subtle');if(button){button.setAttribute('text',text);}},GetKey:function(id){return D2L.LP.Web.UI.Desktop.Controls.FilterInlineFlyout.GetKeyHidden(id).value;},GetKeyHidden:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var keyHidden=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-filterinline-group-flyout-key',node);return keyHidden;}};D2L.LP.Web.UI.Desktop.Controls.FileViewer={SetSize:function(node,contentHeight,resizeTarget){var content=$(node).parent().find(resizeTarget);var viewport=$(window).height();var offset=node.offset();var dialogFooterHeight=$('.d2l-dialog-footer').outerHeight(true)||0;var dialogPaddingHeight=($('.d2l-dialog-padding').innerHeight()||0)-($('.d2l-dialog-padding').height()||0);var totalDialogEffectHeight=dialogFooterHeight+dialogPaddingHeight;var adjustedHeight=viewport-offset.top-totalDialogEffectHeight;var smallestHeight=adjustedHeight;if(adjustedHeight>contentHeight){smallestHeight=contentHeight;}content.height(smallestHeight);},OnPluginLoad:function(resizeTarget,contentHeight){var me=D2L.LP.Web.UI.Desktop.Controls.FileViewer;var viewer=$(resizeTarget).closest('.d2l-fileviewer');var scaleWithViewport=false;if(viewer.attr('data-viewmode')==="ScaleWithViewport"){scaleWithViewport=true;}if(scaleWithViewport&&resizeTarget){me.SetSize(viewer,contentHeight,resizeTarget);var zoom=document.documentElement.clientWidth/window.innerWidth;$(window).resize(function(){var zoomNew=document.documentElement.clientWidth/window.innerWidth;if(zoom===zoomNew){me.SetSize(viewer,contentHeight,resizeTarget);}else{zoom=zoomNew;}});}},TryPrint:function(id){var $node;if(this.IsPrintable(id)){$node=$(D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));$(document.body).addClass('d2l-fileviewer-nonprintregion');$node.addClass('d2l-fileviewer-printregion');var topWindow=window.top;var topImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-fileviewer-image',topWindow.contentDocument);var topDocViewer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-fileviewer-rendered-pdf',topWindow.contentDocument);if(topDocViewer){var iFrame=$node.get(0).getElementsByClassName('d2l-fileviewer-rendered-pdf')[0].contentWindow;iFrame.focus();iFrame.print();}else if(!topImage){var iFrame=window.frames[$node.find("iframe").get(0).id];iFrame.focus();iFrame.print();}else{window.focus();window.print();}$(document.body).removeClass('d2l-fileviewer-nonprintregion');$node.find('.d2l-fileviewer').add($node).removeClass('d2l-fileviewer-printregion');}},IsPrintable:function(id){var $node=$(D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));return $node.find('.d2l-fileviewer').add($node).find("[data-isprintable=True]").size()>0;}};D2L.LP.Web.UI.Desktop.Controls.FloatingContainer={Open:function(id,openerId,openSettings){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.OpenNode(elem,openerId,openSettings);},OpenNode:function(elem,openerId,openSettings){var me=D2L.LP.Web.UI.Desktop.Controls.FloatingContainer;if(elem.onFocusHandler===undefined){elem.onFocusHandler=function(evt){var activeNode=D2L.LP.Web.UI.Html.Dom.GetActiveElement();var isFrameOrBody=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-dialog-frame',activeNode)||D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-body',activeNode);if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(elem,activeNode)&&!isFrameOrBody){me.CloseNode(elem,true);}};}D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',document.body,elem.onFocusHandler,true);openSettings=me.NormalizeOpenSettings(openSettings);var openerElem=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());if(openerElem===null){throw'FloatingContainer opener not found: \''+openerId.GetValue()+'\'.';}var targetElem=openerElem;if(openSettings.TargetId!=null){targetElem=D2L.LP.Web.UI.Html.Dom.GetElementById(openSettings.TargetId.GetValue());}elem.m_previousParent=elem.parentNode;D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(elem,true);D2L.LP.Web.UI.Html.Dom.OverlayElement(elem,targetElem,openerElem,openSettings.Position,openSettings.VerticalOffset,openSettings.HorizontalOffset,openSettings.IsAutoPosition,openSettings.IsAutoScroll,openSettings.AttachToBody);elem.style.zIndex=1000;elem.m_openerId=openerId.GetValue();elem.m_isOpen=true;elem.tabIndex=openSettings.TabIndex;elem.m_openSettings=openSettings;elem.m_ignoreAutoHide=true;elem.m_autoCloseExclusions=openSettings.AutoCloseExclusions;setTimeout(function(){elem.m_ignoreAutoHide=false;},0);if(openSettings.FocusOnOpen){if(openSettings.FocusOnOpenTargetControlId!==null){try{var focusTargetNode=D2L.LP.Web.UI.Html.Dom.GetElementById(openSettings.FocusOnOpenTargetControlId.GetValue());focusTargetNode.focus();}catch(e){}}else{me.Focus(elem);}}},NormalizeOpenSettings:function(settings){if(settings===undefined||settings===null){settings={};}settings.TargetId=settings.TargetId||null;settings.Position=settings.Position||D2L.LP.Web.UI.Html.Style.OverlayPosition.Right;settings.VerticalOffset=settings.VerticalOffset||0;settings.HorizontalOffset=settings.HorizontalOffset||0;settings.IsAutoScroll=settings.IsAutoScroll||false;settings.IsAutoPosition=settings.IsAutoPosition||true;settings.FocusOnOpen=settings.FocusOnOpen||true;settings.FocusOnOpenTargetControlId=settings.FocusOnOpenTargetControlId||null;settings.TabIndex=settings.TabIndex||0;settings.AttachToBody=settings.AttachToBody||false;settings.AutoCloseExclusions=settings.AutoCloseExclusions||[];return settings;},RefreshOpenNode:function(node){if(node.m_isOpen){var openSettings=node.m_openSettings;openSettings.FocusOnOpen=false;D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.OpenNode(node,new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.m_openerId),openSettings);}},Focus:function(node){var focusableElems={'a':true,'input':true,'select':true,'textarea':true,'button':true};var allNodes=node.all?node.all:node.getElementsByTagName('*');for(var i=0;i<allNodes.length;i++){var cNode=allNodes[i];if(focusableElems[cNode.tagName.toLowerCase()]&&D2L.LP.Web.UI.Html.Css.GetStyle(cNode,'display')!=='none'&&!(cNode.type=='hidden'||cNode.disabled===true)&&cNode.className.indexOf('d2l-floating-container-close')<0){try{cNode.focus();}catch(e){}break;}}},Close:function(id,ignoreFocus){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.CloseNode(elem,ignoreFocus);},CloseNode:function(elem,ignoreFocus){if(!elem.m_isOpen){return;}if(elem.d2l_onClose===undefined){elem.d2l_onClose=D2L.LP.Web.UI.ObjectRepository.TryGet(elem.getAttribute('id'),'onClose');}if(elem.d2l_onClose!==null){elem.d2l_onClose.call(elem.d2l_onClose);}if(elem.onFocusHandler!==undefined){D2L.LP.Web.UI.Html.Dom.RemoveEventListener('focus',document.body,elem.onFocusHandler,true);}if(ignoreFocus===undefined){ignoreFocus=false;}var openerId=elem.m_openerId;var openerElem=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(elem,false);if(openerElem&&openerElem.focus&&!ignoreFocus){try{openerElem.focus();}catch(e){}}elem.m_isOpen=false;D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.MoveToOriginalParent(elem);},MoveToOriginalParent:function(elem){if(elem.m_previousParent){elem.m_previousParent.appendChild(elem);}},IsOpen:function(id){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpenNode(elem);},IsOpenNode:function(elem){if(elem.m_isOpen===undefined){return false;}return elem.m_isOpen;},Toggle:function(id,openerId,openSettings){if(D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpen(id)){D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Close(id);}else{D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Open(id,openerId,openSettings);}},Init:function(){var me=D2L.LP.Web.UI.Desktop.Controls.FloatingContainer;var dom=D2L.LP.Web.UI.Html.Dom;if(me.m_initialized){return;}me.m_initialized=true;D2L.LP.Web.UI.Events.OnClick.AddListener(function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);var autoCloseContainers=dom.GetElementsByClassName('d2l-floating-container');for(var i=0;i<autoCloseContainers.length;i++){var container=autoCloseContainers[i];if(container.m_isOpen&&!container.m_ignoreAutoHide){var exclusions=container.m_autoCloseExclusions||[];var ancestor=dom.IsAncestor(container,eventTarget);if(!ancestor){for(var j=0;j<exclusions.length;j++){if(exclusions[j]==eventTarget||dom.IsAncestor(exclusions[j],eventTarget)){ancestor=true;break;}}}if(!ancestor){me.CloseNode(container,true);}}}});var floatingContainerNodesInsidePartial={};D2L.LP.Web.UI.Desktop.Controls.Form.OnBeforeSubmit.AddListener(function(form){var floatingContainerNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-floating-container',form);for(var i=0;i<floatingContainerNodes.length;i++){var fcNode=floatingContainerNodes[i];if(me.IsOpenNode(fcNode)){me.MoveToOriginalParent(fcNode);}}});D2L.LP.Web.UI.Html.PartialRendering.OnBefore.AddListener(function(placeholderId){var placeholder=dom.GetElementById(placeholderId.GetValue());floatingContainerNodesInsidePartial[placeholderId.GetValue()]=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-floating-container',placeholder);for(var i=0;i<floatingContainerNodesInsidePartial[placeholderId.GetValue()].length;i++){var fcNode=floatingContainerNodesInsidePartial[placeholderId.GetValue()][i];if(me.IsOpenNode(fcNode)){me.MoveToOriginalParent(fcNode);}}});D2L.LP.Web.UI.Html.PartialRendering.OnAfter.AddListener(function(placeholderId){for(var i=0;floatingContainerNodesInsidePartial[placeholderId.GetValue()]!==undefined&&i<floatingContainerNodesInsidePartial[placeholderId.GetValue()].length;i++){var fcNode=floatingContainerNodesInsidePartial[placeholderId.GetValue()][i];if(me.IsOpenNode(fcNode)){try{me.RefreshOpenNode(fcNode);}catch(e){}}}});}};D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.m_mouseEvent=null;D2L.LP.Web.UI.Desktop.Controls.Form={BuildParams:function(id,params){var form=D2L.LP.Web.UI.Desktop.Controls.Form.GetForm(id);return D2L.LP.Web.UI.Desktop.Controls.Form.BuildParamsNode(form,params);},BuildParamsNode:function(form,params){var elements=D2L.LP.Web.UI.Desktop.Controls.Form.GetFormElements(form);var scopeToIgnore=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,'data-scope');return D2L.LP.Web.UI.Desktop.Controls.Form.BuildParamsHelper(elements,params,scopeToIgnore);},GetFormElements:function(form){var elements;var isNested=D2L.LP.Web.UI.Desktop.Controls.Form.IsNestedForm(form);if(isNested){var pageForm=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form-primary",form);var pageFormElements=pageForm.elements;elements=[];for(var i=0;i<pageFormElements.length;i++){var pageFormElement=pageFormElements[i];if(D2L.LP.Web.UI.Html.Dom.IsAncestor(form,pageFormElement)){elements.push(pageFormElement);}}}else{elements=form.elements;}return elements;},BuildParamsHelper:function(elements,params,scopeToIgnore){if(params===undefined||params===null){params={};}for(var key in params){if(params[key]===null){delete params[key];}}for(var i=0;i<elements.length;i++){var element=elements[i];if(element.name!==undefined&&element.name!=''&&element.disabled==false&&!(element.tagName.toLowerCase()=='input'&&(element.type=='radio'||element.type=='checkbox')&&element.checked==false)){var elemName=element.name;if(scopeToIgnore&&scopeToIgnore!=''){elemName=elemName.replace(scopeToIgnore,'');}if(params[elemName]!==undefined){if(D2L.LP.Web.UI.Html.JavaScript.IsArray(params[elemName])){params[elemName].push(element.value);}else{params[elemName]=[params[elemName],element.value];}}else{params[elemName]=element.value;}}}return params;},ClearChanges:function(id){var form=D2L.LP.Web.UI.Desktop.Controls.Form.GetForm(id);D2L.LP.Web.UI.Html.ChangeTracking.Tracker.TriggerReset(form);},FinishSubmit:function(form){var params=D2L.LP.Web.UI.Desktop.Controls.Form.BuildParamsNode(form,null);var location=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,'data-location');var method=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,'data-method');var target=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,'data-target');var newForm=document.createElement('form');newForm.className='d2l-hidden';D2L.LP.Web.UI.Html.Dom.SetAttribute(newForm,'action',location);D2L.LP.Web.UI.Html.Dom.SetAttribute(newForm,'method',method);if(target){D2L.LP.Web.UI.Html.Dom.SetAttribute(newForm,'target',target);}D2L.LP.Web.UI.Html.Dom.SetAttribute(newForm,'enctype','application/x-www-form-urlencoded');newForm.onsubmit="return false;";var CreateAndAddHidden=function(name,val){var hidden=document.createElement('input');hidden.type='hidden';hidden.name=name;hidden.value=val;newForm.appendChild(hidden);};CreateAndAddHidden(D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName(),D2L.LP.Web.Authentication.Xsrf.GetXsrfToken());for(var key in params){var value=params[key];if(D2L.LP.Web.UI.Html.JavaScript.IsArray(value)){for(var i=0;i<value.length;i++){CreateAndAddHidden(key,value[i]);}}else{CreateAndAddHidden(key,value);}}document.body.appendChild(newForm);newForm.submit();newForm.parentNode.removeChild(newForm);},ClearValidation:function(id){var form=D2L.LP.Web.UI.Desktop.Controls.Form.GetForm(id);D2L.LP.Web.UI.Desktop.Controls.MessageArea.Reset(form);},DoSubmit:function(form,submitFunc){form.m_stopChangeTrackingPrompt=true;var parentForms=D2L.LP.Web.UI.Html.Dom.GetParentElementsByClassName('d2l-form',form);for(var i=0;i<parentForms.length;i++){parentForms[i].m_stopChangeTrackingPrompt=true;}D2L.LP.Web.UI.Desktop.Controls.Form.OnBeforeSubmit.Trigger(form);D2L.LP.Web.UI.Desktop.Controls.MessageArea.Reset(form);var evt=new D2L.LP.Web.UI.Events.Event();evt.AddListener(function(){form.m_stopChangeTrackingPrompt=false;form.m_skipValidation=false;for(var i=0;i<parentForms.length;i++){parentForms[i].m_stopChangeTrackingPrompt=false;}});if(submitFunc===undefined){submitFunc=function(evt2){var hasAction=D2L.LP.Web.UI.Html.Dom.HasAttribute(form,'data-location');var submit=D2L.LP.Web.UI.ObjectRepository.TryGet(form.id,'submit');var handleRet=function(retVal){if(retVal===true||retVal===false){evt2.Trigger(retVal);}else if(retVal!==undefined&&retVal.AddListener!==undefined){retVal.AddListener(handleRet);}else{evt2.Trigger(true);}};if(submit!==null){var ret=submit.call(submit);if(ret===undefined){ret=true;}handleRet(ret);}else if(hasAction){form.m_skipValidation=false;D2L.LP.Web.UI.Desktop.Controls.Form.FinishSubmit(form);setTimeout(function(){evt2.Trigger(true);});}};}var validators=D2L.LP.Web.UI.Desktop.Controls.Form.GetValidators(form);if(validators.length>0&&!form.m_skipValidation){D2L.LP.Web.UI.Desktop.Controls.Form.Validate(form,validators).AddListener(function(passed){if(passed){form.m_skipValidation=true;submitFunc(evt);}else{evt.Trigger(false);}});}else{form.m_skipValidation=false;submitFunc(evt);}return evt;},GetForm:function(id){var form=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(form===null){throw'Form not found: \''+id.GetValue()+'\'.';}return form;},GetLocation:function(id){var form=D2L.LP.Web.UI.Desktop.Controls.Form.GetForm(id);var loc=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-location");if(loc){return new D2L.LP.Web.Http.UrlLocation(loc);}else{return null;}},GetRpcVerb:function(form){var verb=D2L.LP.Web.UI.Rpc.Verbs.POST;var method=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,'data-method');if(method==='get'){verb=D2L.LP.Web.UI.Rpc.Verbs.GET;}return verb;},GetValidators:function(form){var allForms=[];allForms.push(form);allForms=allForms.concat(D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-form',form));var validators=[];for(var i=0;i<allForms.length;i++){var formNode=allForms[i];if(formNode.d2l_validators!==undefined){for(var j=0;j<formNode.d2l_validators.length;j++){validators.push(formNode.d2l_validators[j]());}}}return validators;},HasChanged:function(id){var form=D2L.LP.Web.UI.Desktop.Controls.Form.GetForm(id);return D2L.LP.Web.UI.Desktop.Controls.Form.HasChangedNode(form);},HasChangedNode:function(node){return D2L.LP.Web.UI.Html.ChangeTracking.Tracker.ContainsChanges(node);},IsNestedForm:function(formNode){return D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-form-nested',formNode);},RpcObjectSubmit:function(id,loc,skipValidation,params){var form=D2L.LP.Web.UI.Desktop.Controls.Form.GetForm(id);form.m_skipValidation=skipValidation;var evt=new D2L.LP.Web.UI.Events.Event();var submitFunc=function(evt2){params=D2L.LP.Web.UI.Desktop.Controls.Form.BuildParams(id,params);var rpcEvt=D2L.LP.Web.UI.Rpc.ConnectObject(D2L.LP.Web.UI.Desktop.Controls.Form.GetRpcVerb(form),loc,params);rpcEvt.AddListener(function(val){evt.Trigger(val);evt2.Trigger();});};var doSubmitEvt=D2L.LP.Web.UI.Desktop.Controls.Form.DoSubmit(form,submitFunc);doSubmitEvt.AddListener(function(pass){if(!pass){setTimeout(function(){evt.Release();},50);}});return evt;},RpcSubmit:function(id,location,skipValidation,params,options){if(skipValidation===undefined||skipValidation===null){skipValidation=false;}var submitFunc=function(evt){params=D2L.LP.Web.UI.Desktop.Controls.Form.BuildParams(id,params);var rpcEvt=D2L.LP.Web.UI.Rpc.Connect(D2L.LP.Web.UI.Desktop.Controls.Form.GetRpcVerb(form),location,params,options);rpcEvt.AddListener(function(pass){evt.Trigger(pass);});};var form=D2L.LP.Web.UI.Desktop.Controls.Form.GetForm(id);form.m_skipValidation=skipValidation;var submitRet=D2L.LP.Web.UI.Desktop.Controls.Form.DoSubmit(form,submitFunc);return submitRet;},RpcSubmitPartial:function(placeholderId,id,location,skipValidation,params,options){if(skipValidation===undefined||skipValidation===null){skipValidation=false;}if(options===undefined||options===null){options={};}if(params===undefined||params===null){params={};}var ret=new D2L.LP.Web.UI.Events.Event();params['_d2l_prc']=D2L.LP.Web.UI.Html.PartialRendering.GetPartialRenderContext(placeholderId.GetValue());var functions={success:function(result){ret.Trigger(result);if(result&&options.success){options.success.call(options.success);}if(!result&&options.failure!==undefined){options.failure.call(options.failure);}},failure:function(){ret.Trigger(false);if(options.failure!==undefined){options.failure.call(options.failure);}}};var evt;evt=D2L.LP.Web.UI.Desktop.Controls.Form.RpcSubmit(id,location,skipValidation,params,functions);evt.AddListener(function(success){if(!success){ret.Trigger(false);}});return ret;},SetLocation:function(id,location){var form=D2L.LP.Web.UI.Desktop.Controls.Form.GetForm(id);D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-location",location.GetUrl());},StopChangeTracking:function(id){var form=D2L.LP.Web.UI.Desktop.Controls.Form.GetForm(id);form.m_stopChangeTrackingPrompt=true;},Submit:function(id,skipValidation){if(skipValidation===undefined||skipValidation===null){skipValidation=false;}var form=D2L.LP.Web.UI.Desktop.Controls.Form.GetForm(id);form.m_skipValidation=skipValidation;return D2L.LP.Web.UI.Desktop.Controls.Form.DoSubmit(form);},SubmitByButton:function(buttonId){var submitButton=D2L.LP.Web.UI.Html.Dom.GetElementById(buttonId.GetValue());var form=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-form',submitButton);if(form){return D2L.LP.Web.UI.Desktop.Controls.Form.DoSubmit(form);}},SubmitToIFrame:function(id,iframeId,location){var form=D2L.LP.Web.UI.Desktop.Controls.Form.GetForm(id);var iframe=D2L.LP.Web.UI.Html.Dom.GetElementById(iframeId);return D2L.LP.Web.UI.Desktop.Controls.Form.SubmitToIFrameHelper(form,iframe,location);},SubmitToIFrameHelper:function(form,iframe,location){var oldAction=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-location");var oldTarget=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-target");D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-location",location.GetUrl());D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-target",iframe.name);var evt=D2L.LP.Web.UI.Desktop.Controls.Form.DoSubmit(form);evt.AddListener(function(){if(oldAction===null){D2L.LP.Web.UI.Html.Dom.RemoveAttribute(form,"data-location");}else{D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-location",oldAction);}if(oldTarget===null){D2L.LP.Web.UI.Html.Dom.RemoveAttribute(form,"data-target");}else{D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-target",oldTarget);}});return evt;},SubmitToDialog:function(id,dialogOpenerId,dialogLocation,dialogSettings){var form=D2L.LP.Web.UI.Desktop.Controls.Form.GetForm(id);return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmit(form,dialogOpenerId,dialogLocation,dialogSettings);},Validate:function(balloonContainer,validators,showErrors){if(showErrors===undefined){showErrors=true;}var ret=new D2L.LP.Web.UI.Events.Event();var errors=[];var handleResult=function(result,index,validator){var isError=result===undefined||result===null||result===false;if(isError){errors.push(validator);}if(result.AddListener!==undefined){result.AddListener(function(r){handleResult(r,index,validator);});}else{validate(++index);}};var validate=function(index){if(index==validators.length){if(errors.length>0&&showErrors){D2L.LP.Web.UI.Desktop.Controls.MessageArea.ShowErrors(errors);}ret.Trigger(errors.length===0);return;}var validator=validators[index];var result=validator.validation.apply(validator.validation);handleResult(result,index,validator);};D2L.LP.Web.UI.Desktop.Controls.MessageArea.Reset(balloonContainer);setTimeout(function(){validate(0);},0);return ret;},ValidateById:function(formId){var evt=new D2L.LP.Web.UI.Events.Event();var form=D2L.LP.Web.UI.Html.Dom.GetElementById(formId.GetValue());var validators=D2L.LP.Web.UI.Desktop.Controls.Form.GetValidators(form);D2L.LP.Web.UI.Desktop.Controls.Form.Validate(form,validators).AddListener(function(passed){if(passed){evt.Trigger(true);}else{evt.Trigger(false);}});return evt;}};D2L.LP.Web.UI.Desktop.Controls.Form.OnBeforeSubmit=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Desktop.Controls.FreeRangeApp={SetHeight:function(id,value){var container=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());container.style.height=value+'px';},SetIsVisible:function(id,value){var container=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(value){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',container);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',container);}}};D2L.LP.Web.UI.Desktop.Controls.Fragment={Build:function(name,doc){doc=doc||document;var me=D2L.LP.Web.UI.Desktop.Controls.Fragment;var node=doc.createElement('span');D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-fragment',node);var anchor=doc.createElement('a');D2L.LP.Web.UI.Html.Dom.SetAttribute(anchor,'name',name);node.appendChild(anchor);me.Init(node);return node;},Init:function(node){var minibar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-minibar-placeholder');if(minibar===null){return;}var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(minibar);node.firstChild.style.top='-'+(rect.height+10)+'px';}};D2L.LP.Web.UI.Desktop.Controls.Grid={m_sortFields:[],m_selectionState:[],m_currentReload:null,m_onLoadCompletedEvents:{},m_onLoadMoreCompletedEvents:{},AddOrUpdateSelectionStateAndStyle:function(id,node){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var key=node.value;var isSelected=node.checked;if(me.m_selectionState[id.GetValue()]===undefined){me.m_selectionState[id.GetValue()]=[];}me.m_selectionState[id.GetValue()][key]=isSelected;if(!isSelected){var gridNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-grid-wrapper',node);var selectAllInput=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-sel-page-input',gridNode);if(selectAllInput){selectAllInput.checked=false;}}me.UpdateSelectionStyle(node);},ApplyRememberedSelection:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var inputs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-grid-sel-input',node);if(inputs){for(var i=0;i<inputs.length;i++){var input=inputs[i];var key=input.value;if(me.m_selectionState[id.GetValue()]!==undefined&&me.m_selectionState[id.GetValue()][key]!==undefined){input.checked=me.m_selectionState[id.GetValue()][key];me.UpdateSelectionStyle(input);}}}},ClearSelection:function(id){D2L.LP.Web.UI.Desktop.Controls.Grid.ResetSelectionState(id);D2L.LP.Web.UI.Desktop.Controls.Grid.SetAllPageIsSelected(id,false);},IsEmpty:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-empty',node)!==null;},Get:function(){return D2L.LP.Web.UI.Desktop.Controls.Grid;},GetEvent:function(id,eventDictionary){if(eventDictionary[id.GetValue()]===undefined){eventDictionary[id.GetValue()]=new D2L.LP.Web.UI.Events.Event();}return eventDictionary[id.GetValue()];},GetGridIdByDescendantNode:function(node){var gridNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-grid-wrapper',node);return new D2L.LP.Web.UI.Html.AbsoluteHtmlId(gridNode.id);},GetHasMoreItems:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var context=me.GetLoadMoreContext(id);if(context){return context.HasMoreItems;}else{return null;}},GetIsLoadMore:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.m_isLoadMore||false;},GetNumericPagerId:function(id){return D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),'NumericPagerId');},GetLoadMoreContext:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var loadMoreWrapperNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-loadmore-wrapper',node);if(!loadMoreWrapperNode){return null;}var placeholderId=D2L.LP.Web.UI.Html.Dom.GetAttribute(loadMoreWrapperNode,'data-d2l-loadmore-placeholder-id');return D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId+'_LoadMoreContext');},GetLoadMoreExclusiveValue:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var context=me.GetLoadMoreContext(id);if(context){return context.ExclusiveValue;}else{return null;}},GetLoadMoreAddtionalExclusiveValues:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var context=me.GetLoadMoreContext(id);if(context){return context.AdditionalExclusiveValues;}else{return null;}},GetLoadMorePlaceholderId:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var loadMoreWrapperNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-loadmore-wrapper',node);if(!loadMoreWrapperNode){return null;}return D2L.LP.Web.UI.Html.Dom.GetAttribute(loadMoreWrapperNode,'data-d2l-loadmore-placeholder-id');},GetOnLoadCompletedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;return me.GetEvent(id,me.m_onLoadCompletedEvents);},GetOnLoadMoreCompletedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;return me.GetEvent(id,me.m_onLoadMoreCompletedEvents);},GetPageNumber:function(id){var numericPagerId=D2L.LP.Web.UI.Desktop.Controls.Grid.GetNumericPagerId(id);if(numericPagerId){return D2L.LP.Web.UI.Desktop.Controls.NumericPager.GetPageNumber(numericPagerId);}else{return null;}},GetPageSize:function(id){var numericPagerId=D2L.LP.Web.UI.Desktop.Controls.Grid.GetNumericPagerId(id);if(numericPagerId){return D2L.LP.Web.UI.Desktop.Controls.NumericPager.GetPageSize(numericPagerId);}else{return null;}},GetSelectionInfo:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var keys=[];var keysTracker=[];var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var inputs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-grid-sel-input',node);for(var i=0;i<inputs.length;i++){if(inputs[i].checked){keys.push(inputs[i].value);keysTracker[inputs[i].value]=true;}}var state=me.m_selectionState[id.GetValue()];if(state!==undefined){for(var key in state){if(state[key]===true&&!keysTracker[key]){keys.push(key);}}}var selectionFilterType=D2L.LP.LayeredArch.SelectionFilterType.Some;if(keys.length==0){selectionFilterType=D2L.LP.LayeredArch.SelectionFilterType.None;}var result=new D2L.LP.Web.UI.Desktop.Controls.Grid.SelectionInfo(selectionFilterType,keys);return result;},GetSelectionKeys:function(id){var selectionInfo=D2L.LP.Web.UI.Desktop.Controls.Grid.GetSelectionInfo(id);var keys=selectionInfo.GetKeys();return keys;},GetSingleSelectionSelectedKey:function(id){var selectionInfo=D2L.LP.Web.UI.Desktop.Controls.Grid.GetSelectionInfo(id);var keys=selectionInfo.GetKeys();if(keys.length===1){return keys[0];}return null;},GetSortField:function(id){if(D2L.LP.Web.UI.Desktop.Controls.Grid.m_sortFields[id.GetValue()]!==undefined){return D2L.LP.Web.UI.Desktop.Controls.Grid.m_sortFields[id.GetValue()].field;}else{return null;}},GetSortDirection:function(id){if(D2L.LP.Web.UI.Desktop.Controls.Grid.m_sortFields[id.GetValue()]!==undefined){return D2L.LP.Web.UI.Desktop.Controls.Grid.m_sortFields[id.GetValue()].direction;}else{return null;}},GetTableNodeByWrapperNode:function(wrapperNode){return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid',wrapperNode);},LoadMore:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var loadMoreWrapperNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-loadmore-wrapper',node);node.m_isLoadMore=true;var tableNode=me.GetTableNodeByWrapperNode(node);var placeholderRow=tableNode.insertRow(-1);placeholderRow.style.display='none';var placeholderCell=placeholderRow.insertCell(-1);var placeholder=document.createElement('div');placeholder.className='d2l-placeholder-inner';placeholderCell.appendChild(placeholder);var placeholderId=D2L.LP.Web.UI.Html.Dom.GetAttribute(loadMoreWrapperNode,'data-d2l-loadmore-placeholder-id');placeholder.id=placeholderId;var loadMoreFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),'LoadMoreHandler');var ret=loadMoreFunction.call(loadMoreFunction);me.m_currentReload=ret;ret.AddListener(function(){var newTable=placeholder.getElementsByTagName('table')[0];var newRows=[];if(newTable){for(var i=0;i<newTable.rows.length;i++){newRows.push(newTable.rows[i]);}var tBody=tableNode.getElementsByTagName('tbody')[0];for(var i=0;i<newRows.length;i++){tBody.appendChild(newRows[i]);}}var selectAllInput=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-sel-page-input',node);if(selectAllInput){selectAllInput.checked=false;}D2L.LP.Web.UI.Desktop.Controls.Grid.ApplyRememberedSelection(id);placeholderRow.parentNode.removeChild(placeholderRow);var hasMoreItems=me.GetHasMoreItems(id);me.GetOnLoadMoreCompletedEvent(id).Trigger(hasMoreItems);D2L.LP.Web.UI.Desktop.Controls.Grid.SetFooterIsVisible(id,hasMoreItems);node.m_isLoadMore=false;me.m_currentReload=null;});},Reload:function(id,keepSelection,pageNumber){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;if(me.m_currentReload!==null){me.m_currentReload.AddListener(function(){me.Reload(id,keepSelection,pageNumber);});return;}if(!keepSelection){me.ResetSelectionState(id);}var partialFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),'PartialHandler');if(partialFunction===null){throw'PartialHandler for Grid: '+id.GetValue()+' could not be found';}if(pageNumber){me.SetPageNumber(id,pageNumber);}var ret=partialFunction.call(partialFunction);me.m_currentReload=ret;ret.AddListener(function(){D2L.LP.Web.UI.Desktop.Controls.Grid.ApplyRememberedSelection(id);D2L.LP.Web.UI.Desktop.Controls.Grid.m_reloadTriggeredBySort=false;me.m_currentReload=null;});},RemoveRows:function(id,keys){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var keysMap={};for(var k=0;k<keys.length;k++){keysMap[keys[k]]=true;}var removedRows=false;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var inputs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-grid-sel-input',node);for(var i=0;i<inputs.length;i++){var input=inputs[i];if(keysMap[input.value]){if(input.checked){input.checked=false;D2L.LP.Web.UI.Desktop.Controls.Grid.AddOrUpdateSelectionStateAndStyle(id,input);}var row=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-grid-row',input);row.parentNode.removeChild(row);removedRows=true;}}if(removedRows){D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateCountText(id);D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateActionButtons(id);}},ResetSelectionState:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;me.m_selectionState[id.GetValue()]=[];},SetAllPageIsSelected:function(id,isSelected){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var inputs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-grid-sel-input',node);for(var i=0;i<inputs.length;i++){var input=inputs[i];input.checked=isSelected;D2L.LP.Web.UI.Desktop.Controls.Grid.AddOrUpdateSelectionStateAndStyle(id,input);}var pageInput=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-sel-page-input',node);if(pageInput){pageInput.checked=isSelected;}D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateCountText(id);D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateActionButtons(id);},SetFooterIsVisible:function(id,isVisible){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var loadMoreWrapperNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-footer-wrapper',node);if(loadMoreWrapperNode){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(loadMoreWrapperNode,isVisible);}},SetPageNumber:function(id,pageNumber){var numericPagerId=D2L.LP.Web.UI.Desktop.Controls.Grid.GetNumericPagerId(id);if(numericPagerId){D2L.LP.Web.UI.Desktop.Controls.NumericPager.SetPageNumber(numericPagerId,pageNumber);}},SetSortField:function(id,fieldName,direction){D2L.LP.Web.UI.Desktop.Controls.Grid.m_sortFields[id.GetValue()]={field:fieldName,direction:direction};if(D2L.LP.Web.UI.Desktop.Controls.Grid.m_reloadTriggeredBySort){D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.FocusOnOpener(id);}},SetSortFieldAndReload:function(id,fieldName,direction){D2L.LP.Web.UI.Desktop.Controls.Grid.m_reloadTriggeredBySort=true;D2L.LP.Web.UI.Desktop.Controls.Grid.SetSortField(id,fieldName,direction);D2L.LP.Web.UI.Desktop.Controls.Grid.Reload(id,true);},UpdateActionButtons:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var hasSelectedItems=me.GetSelectionInfo(id).GetType()!=D2L.LP.LayeredArch.SelectionFilterType.None;D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-grid-action-container-actions-action',node).forEach(function(actionWrapperNode){var isEnabled=!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-grid-action-disabled',actionWrapperNode);var isItemsAction=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-grid-action-container-actions-item-action',actionWrapperNode);var isActionEnabled=isEnabled&&!isItemsAction||isEnabled&&isItemsAction&&hasSelectedItems;D2L.LP.Web.UI.Desktop.Controls.Button.SetIsEnabledNode(actionWrapperNode,isActionEnabled);});},UpdateCountText:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var countNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-action-container-count',node);if(countNode){var searchTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-action-container-count-search',countNode);var noSearchTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-action-container-count-nosearch',countNode);var selectedTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-action-container-count-selected',countNode);var selectionInfo=me.GetSelectionInfo(id);if(selectionInfo.GetType()!=D2L.LP.LayeredArch.SelectionFilterType.None){if(selectedTextNode.innerHTML.indexOf('{count}')>0){selectedTextNode.innerHTML=selectedTextNode.innerHTML.replace('{count}','<span class="d2l-grid-action-container-count-selected-counter"></span>');}var numSelectedFormatted=D2L.LP.Globalization.Locale.GetNumberFormatter().FormatInteger(selectionInfo.GetKeys().length);var counterNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-action-container-count-selected-counter',selectedTextNode);if(counterNode.textContent!==undefined){counterNode.textContent=numSelectedFormatted;}else if(counterNode.innerText!==undefined){counterNode.innerText=numSelectedFormatted;}D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',selectedTextNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',noSearchTextNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',searchTextNode);}else{var isSearched=false;var searchControlId=D2L.LP.Web.UI.Html.Dom.GetAttribute(countNode,'data-searchControlId');if(searchControlId){isSearched=D2L.LP.Web.UI.Desktop.Controls.SearchSimple.IsSearched(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(searchControlId));}if(isSearched){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',selectedTextNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',noSearchTextNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',searchTextNode);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',selectedTextNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',noSearchTextNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',searchTextNode);}}}},UpdateSelectionStyle:function(node){var tr=node.parentNode.parentNode;if(node.checked){D2L.LP.Web.UI.Html.Dom.SetAttribute(tr,'selected','');}else{D2L.LP.Web.UI.Html.Dom.RemoveAttribute(tr,'selected');}},UpdateSelectionStyleForAllInputs:function(gridId){var gridNode=D2L.LP.Web.UI.Html.Dom.GetElementById(gridId.GetValue());var inputs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-grid-sel-input',gridNode);for(var i=0;i<inputs.length;i++){D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateSelectionStyle(inputs[i]);}}};D2L.LP.Web.UI.Desktop.Controls.Grid.SortDirection={Ascending:0,Descending:1};D2L.LP.Web.UI.Desktop.Controls.Grid.m_reloadTriggeredBySort=false;D2L.LP.Web.UI.Desktop.Controls.Grid.SelectionInfo=D2L.Class.Create({Construct:function(type,keys){if(type===undefined){type=D2L.LP.LayeredArch.SelectionFilterType.None;}if(keys===undefined){keys=[];}this.m_type=type;this.m_keys=keys;},_deserialize:function(deserializer){this.m_type=deserializer.GetMember('type');this.m_keys=deserializer.GetMember('keys');},_serialize:function(serializer){serializer.AddMember('type',this.m_type);serializer.AddMember('keys',this.m_keys);},GetType:function(){return this.m_type;},GetKeys:function(){return this.m_keys;}});D2L.LP.Web.UI.Desktop.Controls.GridLoadMorePagingInfo={};D2L.LP.Web.UI.Desktop.Controls.GridLoadMorePagingInfo.Args=D2L.Class.Create({Construct:function(){this.m_loadMoreExclusiveValue=null;this.m_isLoadMorePagerCall=null;this.m_loadMorePlaceholderId=null;this.m_loadMoreExclusiveValues=null;},_serialize:function(serializer){if(this.m_loadMorePlaceholderId!==null){serializer.AddMember('LoadMoreExclusiveValue',this.m_loadMoreExclusiveValue);serializer.AddMember('IsLoadMorePagerCall',this.m_isLoadMorePagerCall);serializer.AddMember('LoadMorePlaceholderId',this.m_loadMorePlaceholderId);serializer.AddMember('LoadMoreAdditionalExclusiveValues',this.m_loadMoreExclusiveValues);}},_deserialize:function(deserializer){this.m_loadMoreExclusiveValue=deserializer.GetMember('LoadMoreExclusiveValue');this.m_isLoadMorePagerCall=deserializer.GetMember('IsLoadMorePagerCall');this.m_loadMorePlaceholderId=deserializer.GetMember('LoadMorePlaceholderId');this.m_loadMoreExclusiveValues=deserializer.GetMember('LoadMoreAdditionalExclusiveValues');}});D2L.LP.Web.UI.Desktop.Controls.GridNumericPagingInfo={};D2L.LP.Web.UI.Desktop.Controls.GridNumericPagingInfo.Args=D2L.Class.Create({Construct:function(){this.m_pageNumber=null;this.m_pageSize=null;},_serialize:function(serializer){if(this.m_pageNumber!=null){serializer.AddMember('PageNumber',this.m_pageNumber);serializer.AddMember('PageSize',this.m_pageSize);}},_deserialize:function(deserializer){this.m_pageNumber=deserializer.GetMember('PageNumber');this.m_pageSize=deserializer.GetMember('PageSize');}});D2L.LP.Web.UI.Desktop.Controls.GridSearchingInfo={};D2L.LP.Web.UI.Desktop.Controls.GridSearchingInfo.Args=D2L.Class.Create({Construct:function(){this.m_searchKeyword=null;},_serialize:function(serializer){if(this.m_searchKeyword!=null){serializer.AddMember('SearchKeyword',this.m_searchKeyword);}},_deserialize:function(deserializer){this.m_searchKeyword=deserializer.GetMember('SearchKeyword');}});D2L.LP.Web.UI.Desktop.Controls.GridSortingInfo={};D2L.LP.Web.UI.Desktop.Controls.GridSortingInfo.Args=D2L.Class.Create({Construct:function(){this.m_sortField=null;this.m_sortDirection=null;},_serialize:function(serializer){if(this.m_sortField!=null){serializer.AddMember('SortField',this.m_sortField);serializer.AddMember('SortDirection',this.m_sortDirection);}},_deserialize:function(deserializer){this.m_sortField=deserializer.GetMember('SortField');this.m_sortDirection=deserializer.GetMember('SortDirection');}});D2L.LP.Web.UI.Desktop.Controls.Hidden={GetValue:function(id,defaultValue){var noThrow=defaultValue!==undefined;var node=D2L.LP.Web.UI.Desktop.Controls.Hidden.Get(id,noThrow);if(node===null){return defaultValue;}var value=node.value;return value;},Get:function(id,noThrow){var hidden=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(hidden===null){if(noThrow){return null;}throw'Hidden not found: \''+id.GetValue()+'\'.';}return hidden;},SetValue:function(id,value){D2L.LP.Web.UI.Desktop.Controls.Hidden.SetValueNode(D2L.LP.Web.UI.Desktop.Controls.Hidden.Get(id),value);},SetValueNode:function(node,value){var oldValue=node.value;node.value=value;if(node.classList.contains('d2l-hidden-track')&&oldValue!=value){node.dispatchEvent(new CustomEvent('change',{composed:true,bubbles:true}));}}};D2L.LP.Web.UI.Desktop.Controls.HourRangeBinder={ValidateIds:function(startId,endId){var startNode=D2L.LP.Web.UI.Html.Dom.GetElementById(startId.GetValue());var endNode=D2L.LP.Web.UI.Html.Dom.GetElementById(endId.GetValue());var startHour=parseInt(startNode.value);var endHour=parseInt(endNode.value);return endHour>=startHour;}};D2L.LP.Web.UI.Desktop.Controls.HtmlBlock={OnAfterRender:new D2L.LP.Web.UI.Events.Event(),RenderMentionsLinks:function(node){var mentions=node.querySelectorAll('[data-mentions-id]');if(mentions.length===0)return;var callback=function(response){if(!response)return;mentions.forEach(function(mention){var userId=mention.getAttribute('data-mentions-id');if(!userId)return;var anchor=document.createElement('a');anchor.href='/d2l/lp/profilecardsaccess/UserProfile?userId='+parseInt(userId);anchor.target='_blank';var name=mention.innerText;mention.innerText='';anchor.innerText=name;mention.appendChild(anchor);});};D2L.LP.Web.UI.Rpc.Connect(D2L.LP.Web.UI.Rpc.Verbs.GET,new D2L.LP.Web.Http.UrlLocation("/d2l/lp/profilecardsaccess/AccessCheck"),null,{success:callback});},GetHtml:function(id){var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null){throw'HtmlBlock not found \''+idVal+'\'.';}return node.innerHTML;},SetHtml:function(id,val){var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null){throw'HtmlBlock not found \''+idVal+'\'.';}node.innerHTML=val;}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditor={ActionIdMap:{},AllowSpellChecker:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;return me.AllowSpellCheckerByNode(D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));},AllowSpellCheckerByNode:function(node){return node.getAttribute('data-d2l-allow-spellchecker')==='true';},AppendHtml:function(editorId,html){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);var isInline=me.IsInlineByNode(node);if(me.IsNewEditorEnabled()){var current=node.html;if(isInline){node.html=current+html;}else{var loc=current.indexOf('</body>');node.html=current.substring(0,loc)+html+current.substring(loc,current.length);}}else{node.d2l_control.AppendHtml(editorId,html,isInline);}},CheckAccessibility:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);node.d2l_control.CheckAccessibility(editorId);},ExecuteCommand:function(editorId,name,value){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);node.d2l_control.ExecuteCommand(editorId,name,value);},Focus:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(id);if(me.IsNewEditorEnabled()){node.initializationComplete.then(function(){node.focus();});}else{node.d2l_control.FocusByNode(node);}},FreeRangeAppIFramePlugin:function(){return function(host){var service={getContext:function(){return document.documentElement.getAttribute('data-he-context');}};host.registerService('htmleditor','0.1',service);};},GetActionId:function(editorId,actionName){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var actionIdMap=me.GetActionIdMap(editorId);return actionIdMap[actionName];},GetActionIdMap:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var actionIdMap=me.ActionIdMap[editorId];if(actionIdMap===undefined){actionIdMap={};me.ActionIdMap[editorId]=actionIdMap;}return actionIdMap;},GetChangeKey:function(node){var value=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetHtml(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.getAttribute('id')));var serializer=new D2L.LP.Web.Serialization.Url.Serializer();value._serialize(serializer);return serializer.Serialize();},GetComputedStyle:function(editorId,styleAttribute){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetComputedStyle(editorId,styleAttribute);},GetEditor:function(editorId){return D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());},GetFileAdded:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());var files=node.d2l_files;if(files.length===0||files.length<node.d2l_files_queued){return;}var file=files[files.length-node.d2l_files_queued];node.d2l_files_queued-=1;return new D2L.LP.Web.UI.Files.File(file.GetId(),file.GetFileSystemType(),file.GetName(),file.GetSize());},GetHtml:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());if(me.IsNewEditorEnabled()){me.UpdateFilesNodeByNode(node);me.SetHiddenHtml(editorId.GetValue());return new D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.Param(editorId.GetValue(),node.html,node.getAttribute('data-d2l-htmlorgunitid'),node.files);}else{me.UpdateFilesNodeByNode(node);var files=node.d2l_files;return new D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.Param(editorId.GetValue(),node.d2l_control.GetHtml(editorId),node.getAttribute('data-d2l-htmlorgunitid'),files);}},GetSelectedNode:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetSelectedNode(editorId);},GetSelectionContent:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetSelectionContent(editorId);},GetSpellcheckText:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetSpellcheckText(editorId);},HasChanged:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetEditor(editorId);if(me.IsNewEditorEnabled()){return node.d2l_initialChangeKey!==node.d2l_changeKey;}else{return node.d2l_control.HasChanged(editorId);}},IsDirty:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());if(me.IsNewEditorEnabled()){return node.isDirty;}else{return node.d2l_control.IsDirty(editorId);}},IsEmpty:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());var html;if(me.IsNewEditorEnabled()){html=node.html;}else{html=node.d2l_control.GetHtml(editorId);}if(html==null){return true;}if(D2L.LP.Web.UI.Html.JavaScript.TrimString(0,html).length<1){return true;}return false;},InsertDelayed:function(editorId,delayedFunction,selectionProvider,resolve,reject){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;me.PasteDelayed(editorId,delayedFunction,selectionProvider,null,resolve,reject);},IsInline:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;return me.IsInlineByNode(D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));},IsInlineByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;if(me.IsNewEditorEnabled()){return!node.getAttribute('full-page');}else{return node.getAttribute('data-d2l-editor-isinline')==='true';}},IsNewEditorEnabled:function(){var context=JSON.parse(document.documentElement.getAttribute('data-he-context'));return context.alignmentSwitch;},MoveToStart:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());node.d2l_control.MoveToStart(editorId);},OnImageUploadStart:function(editorId){var onImageUploadStarted=D2L.LP.Web.UI.ObjectRepository.TryGet(editorId,'imageUploadStartedCallback');if(onImageUploadStarted){onImageUploadStarted();}},OnImageUploadComplete:function(editorId){var onImageUploadCompleted=D2L.LP.Web.UI.ObjectRepository.TryGet(editorId,'imageUploadCompletedCallback');if(onImageUploadCompleted){onImageUploadCompleted();}},PasteDelayed:function(editorId,delayedFunction,selectionProvider,htmlProvider,resolve,reject){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);node.d2l_control.PasteDelayed(editorId,delayedFunction,selectionProvider,htmlProvider,resolve,reject);},ResetChanged:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetEditor(editorId);D2L.LP.Web.UI.Html.ChangeTracking.Tracker.TriggerReset(node);},SetActionId:function(actionName,actionId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var editorId=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-htmleditor',document.getElementById(actionId.GetValue())).id;var actionIdMap=me.GetActionIdMap(editorId);actionIdMap[actionName]=actionId;},SetDirty:function(editorId,isDirty){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);if(!me.IsNewEditorEnabled())return;node.isDirty=isDirty;},SelectNode:function(editorId,nodeToSelect){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);node.d2l_control.SelectNode(editorId,nodeToSelect);},SetHiddenHtml:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var editorId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id);var node=me.GetEditor(editorId);var hiddenHtmlNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-html',node);hiddenHtmlNode.value=node.html;},SetHtml:function(editorId,html,baseRelativePath,keepFiles){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var evt=new D2L.LP.Web.UI.Events.Event();var node=me.GetEditor(editorId);var orgUnitId=node.getAttribute('data-d2l-htmlorgunitid');keepFiles=keepFiles||false;var filterMode;var convertResponseHandler;if(me.IsNewEditorEnabled()){if(node.getAttribute('no-filter')){filterMode='None';}else{filterMode='Strict';}if(keepFiles===false){node.files=[];}if(node.files===undefined||node.files===null){node.files=[];}convertResponseHandler=function(response){node.html=response;evt.Trigger();};}else{filterMode=node.getAttribute('data-d2l-filtermode');if(keepFiles===false){node.d2l_files=[];}if(node.d2l_files===undefined||node.d2l_files===null){node.d2l_files=[];}node.d2l_files_queued=0;convertResponseHandler=function(response){node.d2l_control.SetHtml(editorId,response);evt.Trigger();};}var params={filterMode:filterMode,html:html};if(baseRelativePath){params.baseRelativePath=baseRelativePath;}var options={success:convertResponseHandler,failure:function(){evt.Release();}};D2L.LP.Web.UI.Rpc.Connect(D2L.LP.Web.UI.Rpc.Verbs.POST,new D2L.LP.Web.Http.UrlLocation('/d2l/lp/htmleditor/converttoabsolute').WithQueryString('ou',orgUnitId),params,options);return evt;},SetIsResizeDisplayedByNode:function(node,isDisplayed){var resizeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-resize',node);if(isDisplayed){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',resizeNode);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',resizeNode);}},SetSize:function(editorId,height,width){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);node.d2l_control.SetSize(editorId,height,width);},SetSpellcheckText:function(editorId,response){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.SetSpellcheckText(editorId,response);},ToggleDisplayComponents:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-htmleditor-hide-components',node)){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-htmleditor-hide-components',node);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-htmleditor-hide-components',node);}me.UpdateComponentVisibilityByNode(node);D2L.LP.Web.UI.Events.OnResize.Trigger();},TriggerChangeEvent:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var initialChangeKey=node.d2l_initialChangeKey;var lastChangeKey=node.d2l_changeKey;var newChangeKey=me.GetChangeKey(node);if(newChangeKey===lastChangeKey)return;node.d2l_changeKey=newChangeKey;if(newChangeKey!==initialChangeKey){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.TriggerChange(node);}else{D2L.LP.Web.UI.Html.ChangeTracking.Trackable.TriggerRestore(node);}},TriggerFileAdded:function(editorId,file){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());node.d2l_files.push(file);node.d2l_files_queued+=1;var onFileAdded=D2L.LP.Web.UI.ObjectRepository.TryGet(editorId.GetValue(),'onFileAdded');if(onFileAdded!=null){onFileAdded.call(onFileAdded);}},UpdateComponentVisibilityByNode:function(node){var toolbarNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-header',node);var containerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-component-container',node);var visibilityToggleNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-component-toggle',toolbarNode);if(visibilityToggleNode==null){return;}D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(visibilityToggleNode,true);var toolbarWidth=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(toolbarNode).width-22;var toggleWidth=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(visibilityToggleNode).width+7;var boundingWidth=toolbarWidth-toggleWidth;if(boundingWidth<=0){return;}if(!containerNode.d2l_initialized){var componentNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-htmleditor-hide1',containerNode);for(var i=0;i<componentNodes.length;i++){var componentNode=componentNodes[i];componentNode.d2l_width=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(componentNode).width+8;D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-htmleditor-hide1-hidden',componentNode);}containerNode.d2l_initialized=true;}var containerHasHiddenComponent=false;if(containerNode.scrollWidth>boundingWidth){containerHasHiddenComponent=true;var componentNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-htmleditor-hide1',containerNode);var componentNumber=componentNodes.length;while(componentNumber--){var componentNode=componentNodes[componentNumber];if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-htmleditor-hide1-hidden',componentNode)){componentNode.d2l_width=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(componentNode).width+8;D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-htmleditor-hide1-hidden',componentNode);if(containerNode.scrollWidth<boundingWidth){break;}}}}else{var componentNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-htmleditor-hide1-hidden',containerNode);for(var i=0;i<componentNodes.length;i++){var componentNode=componentNodes[i];var componentWidth=componentNode.d2l_width;if(containerNode.scrollWidth+componentWidth<boundingWidth){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-htmleditor-hide1-hidden',componentNode);}else{containerHasHiddenComponent=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-htmleditor-hide-components',node);break;}}}D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(visibilityToggleNode,containerHasHiddenComponent);if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-htmleditor-hide-components',node)){var showTitle=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-d2l-toolbar-toggle-show');D2L.LP.Web.UI.Desktop.Controls.Button.SetTextNode(visibilityToggleNode,showTitle);D2L.LP.Web.UI.Desktop.Controls.Button.SetTitleNode(visibilityToggleNode,showTitle);}else{var hideTitle=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-d2l-toolbar-toggle-hide');D2L.LP.Web.UI.Desktop.Controls.Button.SetTextNode(visibilityToggleNode,hideTitle);D2L.LP.Web.UI.Desktop.Controls.Button.SetTitleNode(visibilityToggleNode,hideTitle);}},UpdateFilesNodeByNode:function(node){var filesNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-files',node);if(!filesNode){return;}D2L.LP.Web.UI.Html.Dom.RemoveChildElements(filesNode);var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var files;if(me.IsNewEditorEnabled()){if(!node.files||node.files.length===0){return;}files=node.files;var scope=filesNode.getAttribute('data-d2l-scope');for(var i=0;i<files.length;i++){var fileNumber=i+1;var idPrefix;if(fileNumber<2){idPrefix=scope+'$files$';}else{idPrefix=scope+'$files`'+fileNumber+'$';}var fsTypeNode=filesNode.appendChild(document.createElement('input'));fsTypeNode.setAttribute('id',idPrefix+'FileSystemType');fsTypeNode.setAttribute('name',idPrefix+'FileSystemType');fsTypeNode.setAttribute('value',files[i].FileSystemType);var idNode=filesNode.appendChild(document.createElement('input'));idNode.setAttribute('id',idPrefix+'Id');idNode.setAttribute('name',idPrefix+'Id');idNode.setAttribute('value',files[i].Id);var locationNode=filesNode.appendChild(document.createElement('input'));locationNode.setAttribute('id',idPrefix+'Location');locationNode.setAttribute('name',idPrefix+'Location');locationNode.setAttribute('value',files[i].Location);}}else{if(!node.d2l_files||node.d2l_files.length===0){return;}files=node.d2l_files;var scope=filesNode.getAttribute('data-d2l-scope');for(var i=0;i<files.length;i++){var fileNumber=i+1;var idPrefix;if(fileNumber<2){idPrefix=scope+'$files$';}else{idPrefix=scope+'$files`'+fileNumber+'$';}var fsTypeNode=filesNode.appendChild(document.createElement('input'));fsTypeNode.setAttribute('id',idPrefix+'FileSystemType');fsTypeNode.setAttribute('name',idPrefix+'FileSystemType');fsTypeNode.setAttribute('value',files[i].GetFileSystemType());var idNode=filesNode.appendChild(document.createElement('input'));idNode.setAttribute('id',idPrefix+'Id');idNode.setAttribute('name',idPrefix+'Id');idNode.setAttribute('value',files[i].GetId());var locationNode=filesNode.appendChild(document.createElement('input'));locationNode.setAttribute('id',idPrefix+'Location');locationNode.setAttribute('name',idPrefix+'Location');locationNode.setAttribute('value',files[i].GetLocation());}}},ValidateLengthDoesNotExceed:function(editorId,maxLength){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());var html;if(me.IsNewEditorEnabled()){html=node.html;}else{html=node.d2l_control.GetHtml(editorId);}if(html==null){return true;}if(D2L.LP.Web.UI.Html.JavaScript.TrimString(0,html).length<=maxLength){return true;}return false;},ValidateRequired:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;return!me.IsEmpty(editorId);},WordCount:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetText(editorId);},OnInput:function(editorId,delegate){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.OnInput(editorId,delegate);}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents={};D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor={AppendHtml:function(editorId,html,isInline){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var current=me.GetHtml(editorId);var result;if(isInline){result=current+html;}else{var loc=current.indexOf('</body>');result=current.substring(0,loc)+html+current.substring(loc,current.length);}me.SetHtml(editorId,result);},CheckAccessibility:function(editorId){var plugins=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin;plugins.CheckAccessibility(editorId);},ExecuteCommand:function(editorId,name,value){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core;var node=core.ContextNode('d2l_context');me.MoveToBookmarkByNode(node);core.ExecuteCommand({'name':name,'value':value});},FocusByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core;var textAreaId=me.GetTextAreaId(node);core.Focus(textAreaId);},GetChangeKey:function(node){var value=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetHtml(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.getAttribute('id')));var serializer=new D2L.LP.Web.Serialization.Url.Serializer();value._serialize(serializer);var changeKey=serializer.Serialize();return changeKey;},GetComputedStyle:function(editorId,styleAttribute){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var node=me.GetSelectedNode(editorId);return me.GetComputedStyleByNode(node,styleAttribute);},GetComputedStyleByNode:function(node,styleAttribute){if(!node){return;}if(node.nodeType===9){node=node.body;}var getStyleValue=function(node){var value=D2L.LP.Web.UI.Html.Css.GetStyle(node,styleAttribute);if(styleAttribute==='background-color'&&value==='transparent'&&node.parentNode){value=getStyleValue(node.parentNode);}return value;};return getStyleValue(node);},GetHtml:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core;var textAreaId=me.GetTextAreaId(editorId);return core.GetContent(textAreaId);},GetSelectedNode:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor,me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core;var htmlEditorNode=htmlEditor.GetEditor(editorId);var node=null;if(core.isIE()){node=htmlEditorNode.d2l_selectedNode;if(node){return node;}}var textAreaId=me.GetTextAreaId(editorId);node=core.GetSelectedNode(textAreaId);return node;},GetSelectionContent:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core;var textAreaId=me.GetTextAreaId(editorId);var content=core.GetSelectionContent(textAreaId);return content;},GetSpellcheckText:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor,me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core;var htmlEditorNode=htmlEditor.GetEditor(editorId);var textAreaId=me.GetTextAreaId(editorId);var walk=function(n,f){var d=core.GetDocument(textAreaId);var w;if(d.createTreeWalker){w=d.createTreeWalker(n,NodeFilter.SHOW_TEXT,null,false);while((n=w.nextNode())!==null){f.call(f,n);}}else{core.Walk({'tree':n,'delegate':f,'name':'childNodes'});}};var tx='';var nodeDic=new D2L.Util.Dictionary();var nodeIden=0;walk(core.GetBody(textAreaId),function(n){if(n.nodeType===3&&n.nodeValue.trim()){nodeDic.Add(nodeIden,n);tx+=n.nodeValue+'['+nodeIden+':d2lsciden]';nodeIden++;}});htmlEditorNode.d2l_nodeDic=nodeDic;return tx;},GetTextAreaId:function(nodeOrId){if(nodeOrId.GetValue){nodeOrId=D2L.LP.Web.UI.Html.Dom.GetElementById(nodeOrId.GetValue());}var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-textarea',nodeOrId);return textAreaNode.getAttribute('id');},GetText:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core;var textAreaId=me.GetTextAreaId(editorId);return core.GetText(textAreaId);},OnInput:function(editorId,delegate){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core;var textAreaId=me.GetTextAreaId(editorId);var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetElementById(textAreaId);var node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-htmleditor',textAreaNode);node.inputHandlers.push(delegate);},TriggerInputChanged:function(node){for(var i=0;i<node.inputHandlers.length;i++){delegate=node.inputHandlers[i];delegate.call(this);}},HasChanged:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetEditor(editorId);var hasChanged=$(node).data('initialChangeKey')!==$(node).data('changeKey');return hasChanged;},InitializeCallback:function(textAreaId,body,doc){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core,htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetElementById(textAreaId);var node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-htmleditor',textAreaNode);if(!node){return;}var iFrameNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(core.GetContentAreaContainer(textAreaId));var title=node.getAttribute('data-d2l-editor-title');if(title||title===''){iFrameNode.title=title;}var labelledById=node.getAttribute('data-d2l-editor-labelledbyid');if(labelledById){D2L.LP.Web.UI.Html.Aria.SetAttribute(iFrameNode,'labelledby',labelledById);}D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',iFrameNode.contentWindow,function(e){node.d2l_onContentFocus.Trigger();node.d2l_hasFocus=true;D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-htmleditor-frosted',node);});D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',iFrameNode.contentWindow,function(e){node.d2l_hasFocus=false;setTimeout(function(){if(!node.d2l_hasFocus){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-htmleditor-frosted',node);}},0);me.TriggerChangeEvent(node);});core.OnInput(textAreaId,function(){me.TriggerInputChanged(node);});me.TriggerInputChanged(node);core.OnObjectResize(textAreaId,function(e){if(e.target.hasAttribute('data-d2l-editor-default-img-style')&&core.GetStyle(textAreaId,e.target,'max-width')==='100%'){core.SetStyle(textAreaId,e.target,"max-width","");e.target.removeAttribute('data-d2l-editor-default-img-style');}});if(core.isIE()){var getBookmark=function(evt){node.d2l_selectedNode=core.GetSelectedNode();node.d2l_bookmark=core.GetBookMark(textAreaId,1);};var editorBody=core.GetBody(textAreaId);D2L.LP.Web.UI.Html.Dom.AddEventListener('select',editorBody,getBookmark,true);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',editorBody,getBookmark,true);D2L.LP.Web.UI.Html.Dom.AddEventListener('keyup',editorBody,getBookmark);core.OnMouseUp(textAreaId,function(){getBookmark();});if(core.isIE()){var parentPlaceholders=D2L.LP.Web.UI.Html.Dom.GetParentElementsByClassName('d2l-placeholder-live',iFrameNode);if(parentPlaceholders){for(var i=0;i<parentPlaceholders.length;i++){D2L.LP.Web.UI.Html.Dom.RemoveAttribute(parentPlaceholders[i],'aria-live');}}}}var $node=$(node);var initialChangeKey=me.GetChangeKey(node);$node.data('initialChangeKey',initialChangeKey).data('changeKey',initialChangeKey);$(document).on('vui-reset',function(evt){var changeKey=$node.data('changeKey');var hasChanged=changeKey!==$node.data('initialChangeKey');var isParentTracker=D2L.LP.Web.UI.Html.Dom.IsAncestor(evt.target,node);if(!isParentTracker||!hasChanged){return;}$node.data('initialChangeKey',changeKey);D2L.LP.Web.UI.Html.ChangeTracking.Trackable.TriggerRestore(node);});me.SetSizeByNode(node,node.getAttribute('data-d2l-height'),node.getAttribute('data-d2l-width'));node.style.visibility='visible';setTimeout(function(){htmlEditor.UpdateComponentVisibilityByNode(node);},0);},InitializeLayout:function(editorId){var editorNode=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId);if(!editorNode){return;}var resizeHandle=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-resize',editorNode);var resizeSettings={Handle:resizeHandle,DisplayType:'hidden',GhostType:D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow};var onResize=D2L.LP.Web.UI.Html.DragDrop.MakeResizeableNode(editorNode,resizeSettings,window,window);var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;if(onResize){onResize.AddListener(function(size){htmlEditor.SetSize(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(editorNode.getAttribute('id')),size.height+'px',size.width+'px');});}D2L.LP.Web.UI.Events.OnResize.AddListener(function(){htmlEditor.UpdateComponentVisibilityByNode(editorNode);});},IsDirty:function(editorId){var core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core,me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var textAreaId=me.GetTextAreaId(editorId);return core.IsDirty(textAreaId);},MoveToBookmarkByNode:function(node){var core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core,me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var textAreaId=me.GetTextAreaId(node);if(!core.isIE()){return;}core.MoveToBookmark(textAreaId,node.d2l_bookmark);},MoveToStart:function(editorId){var core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core;var textAreaId=me.GetTextAreaId(editorId);setTimeout(function(){core.ExecuteCommand({'name':'selectall','value':null},textAreaId);core.Collapse(textAreaId,true);},0);},Paste:function(editorId,html){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core,htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=htmlEditor.GetEditor(editorId);var textAreaId=me.GetTextAreaId(node);me.MoveToBookmarkByNode(node);if(html){core.ExecuteCommand({'name':core.AttributeMap.InsertContent,'value':html},textAreaId);}},PasteDelayed:function(editorId,delayedFunction,selectionProvider,htmlProvider){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core,htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=htmlEditor.GetEditor(editorId);var textAreaId=me.GetTextAreaId(node);delayedFunction.call(delayedFunction).AddListener(function(obj){var doInsert=function(html){if(selectionProvider){selectionProvider.call(selectionProvider);}me.MoveToBookmarkByNode(node);if(html){core.ExecuteCommand({'name':core.AttributeMap.InsertContent,'value':html},textAreaId);}};if(htmlProvider){var htmlResult=htmlProvider.call(htmlProvider,obj);if(typeof htmlResult==='string'){doInsert(htmlResult);}else if(typeof htmlResult==='object'&&htmlResult.AddListener){htmlResult.AddListener(function(html){doInsert(html);});}}else{doInsert(obj);}});},SelectNode:function(editorId,nodeToSelect){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core;var textAreaId=me.GetTextAreaId(editorId);core.SelectNode(textAreaId,nodeToSelect);},SetHeightByNode:function(node,height){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core;if(height.substr(height.length-2,2)==='px'){var pixelHeight=parseInt(height.substr(0,height.length));var toolbarHeight=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-header',node)).height;var footerHeight=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-footer',node)).height;pixelHeight-=toolbarHeight+footerHeight;if(pixelHeight<120){pixelHeight='120';}height=pixelHeight+'px';}core.SetHeight(me.GetTextAreaId(node),height);D2L.LP.Web.UI.Events.OnSizingFinished.Trigger();},SetHtml:function(editorId,html){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core;var textAreaId=me.GetTextAreaId(editorId);core.SetContent(textAreaId,html);},SetSize:function(editorId,height,width){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;me.SetSizeByNode(D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue()),height,width);},SetSizeByNode:function(node,height,width){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;me.SetWidthByNode(node,width);setTimeout(function(){me.SetHeightByNode(node,height);},0);},SetSpellcheckText:function(editorId,response){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor,htmlEditorNode=htmlEditor.GetEditor(editorId),i,text,iden,phrase,node,nodeDic=htmlEditorNode.d2l_nodeDic;if(!nodeDic){return;}var phrases=response.split(':d2lsciden]');var dic=new D2L.Util.Dictionary();for(i=0;i<phrases.length;i++){phrase=phrases[i];iden=phrase.substring(phrase.lastIndexOf('[')+1);text=phrase.substring(0,phrase.lastIndexOf('['));dic.Add(iden,text);}for(i=0;i<nodeDic.Keys().length;i++){node=nodeDic.Get(nodeDic.Keys()[i]);text=dic.Get(nodeDic.Keys()[i]);if(text||text===''){node.data=text;}}htmlEditorNode.d2l_nodeDic=undefined;},SetWidthByNode:function(node,width){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor,core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core,htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;if(width.substr(width.length-2,2)==='px'){if(parseInt(width.substr(0,width.length))<200){width='200px';}}node.style.width=width;core.SetWidth(me.GetTextAreaId(node),width);htmlEditor.UpdateComponentVisibilityByNode(node);return width;},TriggerChangeEvent:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var initialChangeKey=$(node).data('initialChangeKey');var lastChangeKey=$(node).data('changeKey');var newChangeKey=me.GetChangeKey(node);if(newChangeKey===lastChangeKey){return;}$(node).data('changeKey',newChangeKey);if(newChangeKey!==initialChangeKey){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.TriggerChange(node);}else{D2L.LP.Web.UI.Html.ChangeTracking.Trackable.TriggerRestore(node);}},UpdateTextArea:function(textAreaId){var core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core,textAreaNode=D2L.LP.Web.UI.Html.Dom.GetElementById(textAreaId);if(textAreaNode){textAreaNode.value=core.GetContent(textAreaId);}}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.TextEditor={AppendHtml:function(editorId,html){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.TextEditor;me.SetHtml(editorId,me.GetHtml(editorId)+html);},ExecuteCommand:function(editorId,name,value){},FocusByNode:function(node){var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-textarea',node);textAreaNode.focus();},GetComputedStyle:function(editorId,styleAttribute){},GetHtml:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-textarea',node);return textAreaNode.value;},GetSelectedNode:function(editorId){},GetSelectionContent:function(editorId){return'';},GetSpellcheckText:function(editorId){return this.GetHtml(editorId);},GetTextAreaId:function(node){var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-textarea',node);return textAreaNode.getAttribute('id');},HasChanged:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetEditor(editorId);var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-textarea',node);return textAreaNode._changeTracking.hasChanged;},IsDirty:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());return node.d2l_isDirty;},MoveToStart:function(editorId){},PasteDelayed:function(editorId,delayedFunction,selectionProvider,htmlProvider){},SelectNode:function(editorId,nodeToSelect){},SetHtml:function(editorId,html){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=htmlEditor.GetEditor(editorId);var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-textarea',node);textAreaNode.value=html;$(textAreaNode).trigger('change');node.d2l_isDirty=true;},SetSize:function(editorId,height,width){},SetSpellcheckText:function(editorId,response){var editNode=this.SetHtml(editorId,response);}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.NoEditor={AppendHtml:function(editorId,html){},ExecuteCommand:function(editorId,name,value){},FocusByNode:function(node){},GetComputedStyle:function(editorId,styleAttribute){},GetHtml:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);return hiddenNode.value;},GetSelectedNode:function(editorId){},GetSelectionContent:function(editorId){return'';},HasChanged:function(editorId){return false;},IsDirty:function(editorId){},MoveToStart:function(editorId){},PasteDelayed:function(editorId,delayedFunction,selectionProvider,htmlProvider){},SelectNode:function(editorId,nodeToSelect){},SetHtml:function(editorId,html){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=htmlEditor.GetEditor(editorId);var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);hiddenNode.value=html;},SetSize:function(editorId,height,width){}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.FraEditor={AppendHtml:function(editorId,html){},ExecuteCommand:function(editorId,name,value){},FocusByNode:function(node){},GetComputedStyle:function(editorId,styleAttribute){},GetHtml:function(editorId){},GetSelectedNode:function(editorId){},GetSelectionContent:function(editorId){return'';},HasChanged:function(editorId){return false;},IsDirty:function(editorId){},MoveToStart:function(editorId){},PasteDelayed:function(editorId,delayedFunction,unused,htmlProvider,resolve,reject){var fn=delayedFunction.call(delayedFunction);fn.AddListener(function(obj){var doInsert=function(html){if(html){resolve(html);}};if(htmlProvider){var htmlResult=htmlProvider.call(htmlProvider,obj);if(typeof htmlResult==='string'){doInsert(htmlResult);}else if(typeof htmlResult==='object'&&htmlResult.AddListener){htmlResult.AddListener(function(html){doInsert(html);});}}else{doInsert(obj);}});fn.AddReleaseListener(function(){reject('Cancelled');});},SelectNode:function(editorId,nodeToSelect){},SetHtml:function(editorId,html){},SetSize:function(editorId,height,width){}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.FileData=D2L.Class.Create({Construct:function(fileSystemType,id,name,size,location){if(fileSystemType===undefined){fileSystemType='';}this.m_fileSystemType=fileSystemType;if(id===undefined){id='';}this.m_id=id;if(name===undefined){name='';}this.m_name=name;if(size===undefined){size=0;}this.m_size=size;if(location===undefined){location='';}this.m_location=location;},_serialize:function(serializer){serializer.AddMember('fileSystemType',this.m_fileSystemType);serializer.AddMember('id',this.m_id);serializer.AddMember('location',this.m_location);},GetFileSystemType:function(){return this.m_fileSystemType;},GetId:function(){return this.m_id;},GetName:function(){return this.m_name;},GetLocation:function(){return this.m_location;},GetSize:function(){return this.m_size;}});D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.Param=D2L.Class.Create({Construct:function(id,html,htmlOrgUnitId,files){if(id===undefined){id='';}this.m_id=id;if(html===undefined){html='';}this.m_html=html;if(htmlOrgUnitId===undefined){htmlOrgUnitId=0;}this.m_htmlOrgUnitId=htmlOrgUnitId;if(files===undefined){files=[];}this.m_files=files;},_serialize:function(serializer){serializer.AddMember('id',this.m_id);serializer.AddMember('html',this.m_html);serializer.AddMember('htmlOrgUnitId',this.m_htmlOrgUnitId);serializer.AddMember('files',this.m_files);},GetFiles:function(){return this.m_files;},GetHtml:function(){return this.m_html;}});D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button={GetOnActiveChangeByNode:function(node){if(node.d2l_onActiveChange===undefined){node.d2l_onActiveChange=new D2L.LP.Web.UI.Events.Event();}return node.d2l_onActiveChange;},GetOnEnabledChangeByNode:function(node){if(node.d2l_onEnabledChange===undefined){node.d2l_onEnabledChange=new D2L.LP.Web.UI.Events.Event();}return node.d2l_onEnabledChange;},Initialize:function(name,commandName,buttonId,mixins){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin;var node;var onClick=null;if(mixins&&mixins['onClick']){onClick=mixins['onClick'];}return plugin.InitializeControl('Button',{'action':D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button,'name':name,'commandName':commandName,'controlId':buttonId,'onClick':onClick,'nodeChange':function(args){if(!node){node=D2L.LP.Web.UI.Html.Dom.GetElementById(buttonId.GetValue());}if(mixins&&mixins['activatedDelegate']){me.SetIsActiveByNode(node,mixins['activatedDelegate'](args));}else{if(!mixins||mixins['activatedDelegate']!==null){me.SetIsActiveByNode(node,args.getCommandState(commandName));}}if(mixins&&mixins['enabledDelegate']){me.SetIsEnabledByNode(node,mixins['enabledDelegate'](args));}}});},InitializeByNode:function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,'button');var title=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'title');if(title!=null&&title.length>0){D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'label',title);}D2L.LP.Web.UI.Desktop.Controls.Link.InstallClickable(node);var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-htmleditor-button-disabled',node);if(isDisabled){D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'disabled','true');}var hasOnClick=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,'data-onclick');if(!hasOnClick){return;}var onClick=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-onclick');D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,'data-onclick');D2L.LP.Web.UI.Html.Dom.AddEventListener('click',node,function(){var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-htmleditor-button-disabled',node);if(!isDisabled){eval(onClick);}});},SetIsActive:function(id,isActive){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;var buttonId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(buttonId);me.SetIsActiveByNode(node,isActive);},SetIsActiveByNode:function(node,isActive){if(isActive==D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-htmleditor-button-active',node)){return;}if(isActive){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-htmleditor-button-active',node);}else{D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-htmleditor-button-active',node);}if(node.d2l_onActiveChange!==undefined){node.d2l_onActiveChange.Trigger(isActive);}},SetIsEnabled:function(id,isEnabled){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.SetIsEnabledByNode(node,isEnabled);},SetIsEnabledByNode:function(node,isEnabled){var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-htmleditor-button-disabled',node);if(!isEnabled==isDisabled){return;}D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'disabled',!isEnabled);if(isEnabled){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-htmleditor-button-disabled',node);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-htmleditor-button-disabled',node);}if(node.d2l_onEnabledChange!==undefined){node.d2l_onEnabledChange.Trigger(isEnabled);}}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.ColorButton={SetColorSample:function(id,value){var sampleNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-color-sample',D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));sampleNode.style.background=value;},UpdateClassName:function(id,className,addClassName){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(addClassName==D2L.LP.Web.UI.Html.Dom.HasClassName(className,node)){return;}if(addClassName){D2L.LP.Web.UI.Html.Dom.AddClassName(className,node);}else{D2L.LP.Web.UI.Html.Dom.RemoveClassName(className,node);}}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Menu={Register:function(menuId,editorNode){editorNode.d2l_onContentFocus.AddListener(function(){D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.Close(menuId);});}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SelectList={Initialize:function(name,commandName,listId){var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin;var selectList=D2L.LP.Web.UI.Desktop.Controls.SelectList;var values;return plugin.InitializeControl('SelectList',{'selectList':D2L.LP.Web.UI.Desktop.Controls.SelectList,'name':name,'commandName':commandName,'controlId':listId,'nodeChange':function(args){if(!values){values=selectList.GetValues(listId);}var newValue=args.getCommandValue(commandName);if(newValue===0){newValue='';}var currentValue=selectList.GetSelectedValue(listId);if(newValue==currentValue){return;}for(var i=0;i<values.length;i++){if(values[i]===newValue){selectList.SetSelectedValue(listId,newValue);return;}}selectList.SetSelectedValue(listId,'');}});}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton={DoAction:function(splitButtonId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(splitButtonId.GetValue());var menuContainer=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);var activeItem=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-split-item-active',menuContainer);D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',activeItem);},SetIsActiveByNode:function(node,isActive){if(isActive){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-htmleditor-split-button-active',node);}else{D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-htmleditor-split-button-active',node);}},SetIsEnabledByNode:function(node,isEnabled){if(isEnabled){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-htmleditor-split-button-disabled',node);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-htmleditor-split-button-disabled',node);}},SetSelectedItemByNode:function(menuItem){var node=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-htmleditor-toolbar-item',menuItem));D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.UpdateByNode(node,menuItem.getAttribute('data-d2l-key'));},Update:function(splitButtonId,itemKey){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.UpdateByNode(D2L.LP.Web.UI.Html.Dom.GetElementById(splitButtonId.GetValue()),itemKey);},UpdateByNode:function(node,itemKey){if(node.getAttribute('data-d2l-key')===itemKey){return;}var itemData=node.d2l_itemsData[itemKey];if(itemData===undefined){return;}var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton;node.setAttribute('title',itemData.title);D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'label',itemData.title);node.setAttribute('data-d2l-key',itemData.key);var iconNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-split-button-icon',node);iconNode.src=itemData.src;iconNode.className='d2l-htmleditor-split-button-icon '+itemData.className;var menuContainer=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);var menuItems=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-htmleditor-buttonmenuitem',menuContainer);for(var i=0;i<menuItems.length;i++){var menuItem=menuItems[i];var key=menuItem.getAttribute('data-d2l-key');if(key!==itemKey){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-htmleditor-split-item-active',menuItem);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-htmleditor-split-item-active',menuItem);me.SetIsActiveByNode(node,D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-htmleditor-button-active',menuItem));me.SetIsEnabledByNode(node,!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-htmleditor-button-disabled',menuItem));}}}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Text={SetText:function(id,text){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Text;var buttonId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(buttonId);me.SetTextByNode(node,text);},SetTextByNode:function(node,text){node.innerHTML=text;}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.AutosaveAction={TriggerSave:function(){if(typeof tinymce==='undefined'){return;}if(!tinymce){return;}if(typeof tinymce.triggerSave==="function"){tinymce.triggerSave();}}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.AccessibilityCheckAction={CheckAccessibility:function(editorId){return D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.CheckAccessibility(editorId);}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.AttributesAction={Plugin:function(action,isEnabled,host){host.registerService('fra-html-editor-attributes','0.1',{click:function(attributes){if(!isEnabled){return Promise.reject('disabled');}var promise=new Promise(function(resolve,reject){action(attributes,resolve,reject);});return promise;},config:function(){return{isEnabled:isEnabled};}});},GetAttributesData:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node==null||node.nodeName=='BODY'||node.nodeType==9||node.getAttribute===undefined){return null;}var title='';if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,'title')){title=node.getAttribute('title');}var idValue='';if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,'id')){idValue=node.getAttribute('id');}var className=node.className;var style='';if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,'style')){style=node.getAttribute('style');}var textDirection='';if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,'dir')){textDirection=node.getAttribute('dir');}return{title:title,id:idValue,className:className,style:style,textDirection:textDirection};},Initialize:function(buttonId){var button=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;var plugin=button.Initialize('d2l_attributes','attributes',buttonId,{activatedDelegate:null,enabledDelegate:function(args){var isDisabled=args.element!=null&&(args.element.nodeName==='BODY'||args.element.nodeName==='BR'||args.element.nodeType===9);return!isDisabled;}});return plugin;},SetAttributes:function(editorId,location,attributes,resolve,reject){if(attributes){location.RemoveQueryString("attributes");location=location.WithQueryString("attributes",attributes);}var event=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Open(editorId,location);event.AddListener(function(obj){if(resolve){resolve(obj);return;}var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node==null){return;}var setAttr=function(name,value){if(value==''){node.removeAttribute(name);}else{node.setAttribute(name,value);}};node.className=obj.className;setAttr('title',obj.title);setAttr('id',obj.id);setAttr('style',obj.style);setAttr('dir',obj.textDirection);});if(reject){event.AddReleaseListener(function(){reject('Cancelled');});}}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.AttributesAction.View={GetAttributes:function(id){var nodeId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(nodeId);var getTitle=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getTitle');var title=getTitle.call(getTitle);var getId=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getId');var idValue=getId.call(getId);var getClassName=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getClassName');var className=getClassName.call(getClassName);className=className.replace(/,[\s]*|;[\s]*/g,' ');var getStyle=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getStyle');var style=getStyle.call(getStyle);var getTextDirection=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getTextDirection');var textDirection=getTextDirection.call(getTextDirection);return{title:D2L.LP.Web.UI.Html.JavaScript.TrimString(0,title),id:D2L.LP.Web.UI.Html.JavaScript.TrimString(0,idValue),className:D2L.LP.Web.UI.Html.JavaScript.TrimString(0,className),style:D2L.LP.Web.UI.Html.JavaScript.TrimString(0,style),textDirection:textDirection};}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.CodeAction={Plugin:function(action,isEnabled,host){host.registerService('fra-html-editor-code','0.1',{config:function(){return{isEnabled:isEnabled};}});}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmleditor-code',function(node){var dialogBody=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-dialog-body',node);var textArea=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-dialog-textarea',node);var wordWrap=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node));var wordWrapRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(wordWrap);var resizeTextArea=function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(dialogBody);textArea.style.height=rect.height-wordWrapRect.height-35+'px';};D2L.LP.Web.UI.Events.OnResize.AddListener(function(){setTimeout(resizeTextArea,0);});});D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.CodeAction.View={GetCode:function(id){var textArea=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return textArea.value;},SetWrap:function(id,isWrap){var textArea=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var wrapType="off";if(isWrap){wrapType="soft";}textArea.setAttribute("wrap",wrapType);}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.DirectionalityAction={InitializeLtr:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.DirectionalityAction;var plugin=me.Initialize(id,'ltr');return plugin;},InitializeRtl:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.DirectionalityAction;var plugin=me.Initialize(id,'rtl');return plugin;},Initialize:function(id,dir){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.DirectionalityAction;var button=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;return button.Initialize('d2l_'+dir,dir,id,{activatedDelegate:function(args){return me.IsDirection(args.getParentBlockElement(args.element),dir);},enabledDelegate:function(args){return args.getParentBlockElement(args.element)!=null;}});},IsDirection:function(element,dir){if(element){return element.getAttribute('dir')===dir;}return false;},SetDirection:function(editorId,direction){var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin;var parent=plugin.GetParentNodeOfSelected(editorId);if(parent){if(plugin.GetAttribute(editorId,parent,'dir')!==direction){plugin.SetAttribute(editorId,parent,'dir',direction);}else{plugin.SetAttribute(editorId,parent,'dir','');}}plugin.Focus(editorId);}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.EquationActions={GetSelectedMathML:function(editorId){var mathML='';var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node&&node.nodeName=='IMG'&&node.className.indexOf('equation')>-1){if(node.attributes.getNamedItem('data-d2l-mathml')!==null){mathML=node.attributes.getNamedItem('data-d2l-mathml').value;var mathML=decodeURIComponent(mathML);}else if(node.attributes.getNamedItem('hack')!==null){var applet=node.attributes.getNamedItem('hack').value;var appletDecoded=decodeURIComponent(applet);var tempDiv=document.createElement("div");tempDiv.innerHTML=appletDecoded;var math='';if(tempDiv!==null&&tempDiv.firstChild!==null&&tempDiv.firstChild.childNodes.length>0){var params=tempDiv.firstChild.childNodes;for(var i=0;i<params.length;i++){if(params[i].attributes!==null){var paramNameAtt=params[i].attributes.getNamedItem('name');if(paramNameAtt!==null&&paramNameAtt.value==='eq'){var paramValueAtt=params[i].attributes.getNamedItem('value');math=paramValueAtt.value;mathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML('webeq','',math,math);break;}}}}}}return mathML;}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.ChemistryEquationAction={Plugin:function(action,isEnabled,host){host.registerService('fra-html-editor-chemistry-equation','0.1',{click:function(mathML){if(!isEnabled){return Promise.reject('disabled');}var promise=new Promise(function(resolve,reject){action(mathML,resolve,reject);});return promise;},config:function(){return{isEnabled:isEnabled};}});},GetSelectedMathML:function(editorId){var parent=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.GraphicalEquationAction;return parent.GetSelectedMathML(editorId);},Insert:function(editorId,location,parameters,fraMathML,resolve,reject){var parent=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.GraphicalEquationAction;return parent.Insert(editorId,location,parameters,fraMathML,resolve,reject);},Initialize:function(buttonId){var parent=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.GraphicalEquationAction;D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId('chemistry_graphical_editor',buttonId);var onNodeChange=function(element){var buttonNode=D2L.LP.Web.UI.Html.Dom.GetElementById(buttonId.GetValue());var htmlEditComp=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents,isEnabled=true,isActive=false;if(!element.node&&element.element){element.node=element.element;}if(!element.isCollapsed&&element.node.nodeName==='IMG'&&element.node.className.indexOf('equation')>-1){var mathMLAttribute=element.node.getAttribute('data-d2l-mathml');isEnabled=mathMLAttribute.indexOf('wiris')>-1;isActive=mathMLAttribute.indexOf('wiris-chemistry')>-1;if(isActive){htmlEditComp.SplitButton.SetSelectedItemByNode(buttonNode);}}htmlEditComp.Button.SetIsEnabledByNode(buttonNode,isEnabled);htmlEditComp.Button.SetIsActiveByNode(buttonNode,isActive);};var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.InitializeScript('Script',{'name':'d2l_chemistryequation','nodeChange':function(element){onNodeChange(element);},'onSetContent':function(obj){parent.OnBeforeSetContent(obj);},'onGetContent':function(obj){parent.OnPostProcess(obj);}});return plugin;}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.LatexEquationAction={Plugin:function(action,isEnabled,host){host.registerService('fra-html-editor-latex-equation','0.1',{click:function(mathML){if(!isEnabled){return Promise.reject('disabled');}var promise=new Promise(function(resolve,reject){action(mathML,resolve,reject);});return promise;},config:function(){return{isEnabled:isEnabled};}});},GetSelectedMathML:function(editorId){var mathML='';var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node&&node.nodeName==='IMG'&&node.className==='equation'){if(node.attributes.getNamedItem('data-d2l-mathml')!=null){mathML=node.attributes.getNamedItem('data-d2l-mathml').value;var mathML=decodeURIComponent(mathML);}}return mathML;},Insert:function(editorId,location,parameters,fraMathML,resolve,reject){if(fraMathML){parameters.mathml=fraMathML;}function opener(){return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenWithParam(editorId,location,parameters,null);}D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.InsertDelayed(editorId,opener,null,resolve,reject);},Initialize:function(buttonId){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId('latex_editor',buttonId);var buttonNode=D2L.LP.Web.UI.Html.Dom.GetElementById(buttonId.GetValue());var events={onNodeChange:function(e){var htmlEditComp=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents,isEnabled=true,isActive=false;if(!e.node&&e.element)e.node=e.element;if(!e.isCollapsed&&e.node.nodeName==='IMG'&&e.node.className.indexOf('equation')>-1){isEnabled=e.node.getAttribute('data-d2l-mathml').indexOf('latex')>-1;isActive=isEnabled;if(isEnabled){htmlEditComp.SplitButton.SetSelectedItemByNode(buttonNode);}}htmlEditComp.Button.SetIsEnabledByNode(buttonNode,isEnabled);htmlEditComp.Button.SetIsActiveByNode(buttonNode,isActive);}};var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.InitializeScript('Script',{'name':'d2l_latexequation','actionId':'latex_editor','nodeChange':function(e){events.onNodeChange(e);}});return plugin;}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.GraphicalEquationAction={Plugin:function(action,isEnabled,host){host.registerService('fra-html-editor-graphical-equation','0.1',{click:function(mathML){if(!isEnabled){return Promise.reject('disabled');}var promise=new Promise(function(resolve,reject){action(mathML,resolve,reject);});return promise;},config:function(){return{isEnabled:isEnabled};}});},GetSelectedMathML:function(editorId){var mathML='';var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node&&node.nodeName=='IMG'&&node.className=='equation'){if(node.attributes.getNamedItem('data-d2l-mathml')!=null){mathML=node.attributes.getNamedItem('data-d2l-mathml').value;var mathML=decodeURIComponent(mathML);}else if(node.attributes.getNamedItem('hack')!=null){var applet=node.attributes.getNamedItem('hack').value;var appletDecoded=decodeURIComponent(applet);var tempDiv=document.createElement("div");tempDiv.innerHTML=appletDecoded;var math='';if(tempDiv!==null&&tempDiv.firstChild!==null&&tempDiv.firstChild.childNodes.length>0){var params=tempDiv.firstChild.childNodes;for(var i=0;i<params.length;i++){if(params[i].attributes!==null){var paramNameAtt=params[i].attributes.getNamedItem('name');if(paramNameAtt!==null&&paramNameAtt.value==='eq'){var paramValueAtt=params[i].attributes.getNamedItem('value');math=paramValueAtt.value;mathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML('webeq','',math,math);break;}}}}}}return mathML;},Insert:function(editorId,location,parameters,fraMathML,resolve,reject){if(fraMathML){parameters.mathml=fraMathML;}function opener(){return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenWithParam(editorId,location,parameters,null);}D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.InsertDelayed(editorId,opener,null,resolve,reject);},Initialize:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.GraphicalEquationAction;D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId('graphical_editor',buttonId);var onNodeChange=function(element){var buttonNode=D2L.LP.Web.UI.Html.Dom.GetElementById(buttonId.GetValue());var htmlEditComp=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents,isEnabled=true,isActive=false;if(!element.node&&element.element){element.node=element.element;}if(!element.isCollapsed&&element.node.nodeName==='IMG'&&element.node.className.indexOf('equation')>-1){var mathMLAttribute=element.node.getAttribute('data-d2l-mathml');isEnabled=mathMLAttribute.indexOf('wiris')>-1;isActive=mathMLAttribute.indexOf('wiris-chemistry')===-1;if(isActive){htmlEditComp.SplitButton.SetSelectedItemByNode(buttonNode);}}htmlEditComp.Button.SetIsEnabledByNode(buttonNode,isEnabled);htmlEditComp.Button.SetIsActiveByNode(buttonNode,isActive);};var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.InitializeScript('Script',{'name':'d2l_graphicalequation','nodeChange':function(element){onNodeChange(element);},'onSetContent':function(obj){me.OnBeforeSetContent(obj);},'onGetContent':function(obj){me.OnPostProcess(obj);}});return plugin;},OnPostProcess:function(obj){var convertToMath=function(obj){var func=function(match,sub1,sub2){var hackRegEx=/^<img[^>]*\s+data-d2l-mathml=\"([^\"]*)\"(.|\n|\r)*/i;var hackResult=hackRegEx.exec(match);var hack=decodeURIComponent(hackResult[1]);return hack;};obj.content=obj.content.replace(/<img[^>]*\s+data-d2l-mathml=\"[^\"]*\"[^>]*>/gi,func);};if(obj.get){convertToMath(obj);}},OnBeforeSetContent:function(obj){var convertToImages=function(obj){var func=function(match){var title=match.match(/title=(\"|\')([^\"]*)(\"|\')/i);if(title!=null&&title.length==4&&title[2]!=null){title=title[2];}else{title="";}var annotationRegex=/<annotation encoding="([^"]*)">/gi;var annotationMatch=annotationRegex.exec(match);var removeAnnotation=false;var classString="equation";if(annotationMatch==null){classString+=" mathmlequation";removeAnnotation=true;}else{if(annotationMatch[1].indexOf("wiris")>-1){classString+=" graphicalequation";}else if(annotationMatch[1]=="latex"){classString+=" latexequation";}else{classString+=" mathmlequation";removeAnnotation=true;}}var trimmedMml=match.replace(/>\s+</g,"><");if(removeAnnotation){trimmedMml=trimmedMml.replace(/<annotation[\s\S]*<\/annotation>/g,"");}else{trimmedMml=trimmedMml.replace(/;\s+&/g,";&");}var encodedMml=encodeURIComponent(trimmedMml);var previewImageSrc="/wiris/editorservice.aspx/render.png?mml="+encodedMml;var placeholderImageSrc="'/d2l/img/LP/htmlEditor/equation_unavailable.png'";var placeholderImageTitle="'Preview image not available for this equation'";var imageHtml='<img class="'+classString+'" title="'+title+'" alt="'+title+'" src="'+previewImageSrc+'" style="vertical-align:middle;" hspace="5" vspace="5" onerror="if (this.src != '+placeholderImageSrc+") this.src = "+placeholderImageSrc+"; this.alt = "+placeholderImageTitle+"; this.title = "+placeholderImageTitle+'" data-d2l-mathml="'+encodedMml+'" \/>';return imageHtml;};var appletFunc=function(match){var math=match.match(/<math[^>]*>(.|\n|\r)*<\/math>/gi);if(math!=null&&math.length>0){math=math[0];}return func(D2L.LP.Web.UI.Html.Math.AnnotateMathML('wiris','',math,math));};obj.content=obj.content.replace(/<applet[^>]*>(.|\n|\r)*?(<math[^>]*>(.|\n|\r)*?<\/math>)(.|\n|\r)*?<\/applet>/gi,appletFunc);obj.content=obj.content.replace(/<math[^>]*>(.|\n|\r)*?<\/math>/gi,func);};convertToImages(obj);}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.MathMLEquationAction={Plugin:function(action,isEnabled,host){host.registerService('fra-html-editor-mml-equation','0.1',{click:function(mathML){if(!isEnabled){return Promise.reject('disabled');}var promise=new Promise(function(resolve,reject){action(mathML,resolve,reject);});return promise;},config:function(){return{isEnabled:isEnabled};}});},GetSelectedMathML:function(editorId){var mathML='';var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node&&node.nodeName==='IMG'&&node.className==='equation'){if(node.attributes.getNamedItem('data-d2l-mathml')!==null){mathML=node.attributes.getNamedItem('data-d2l-mathml').value;var mathML=decodeURIComponent(mathML);}else if(node.attributes.getNamedItem('hack')!==null){var applet=node.attributes.getNamedItem('hack').value;var appletDecoded=decodeURIComponent(applet);var tempDiv=document.createElement("div");tempDiv.innerHTML=appletDecoded;var math='';if(tempDiv!==null&&tempDiv.firstChild!==null&&tempDiv.firstChild.childNodes.length>0){var params=tempDiv.firstChild.childNodes;for(var i=0;i<params.length;i++){if(params[i].attributes!==null){var paramNameAtt=params[i].attributes.getNamedItem('name');if(paramNameAtt!==null&&paramNameAtt.value==='eq'){var paramValueAtt=params[i].attributes.getNamedItem('value');math=paramValueAtt.value;mathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML('webeq','',math,math);break;}}}}}}return mathML;},Insert:function(editorId,location,parameters,fraMathML,resolve,reject){if(fraMathML){parameters.mathml=fraMathML;}function opener(){return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenWithParam(editorId,location,parameters,null);}D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.InsertDelayed(editorId,opener,null,resolve,reject);},Initialize:function(buttonId){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId('mathml_editor',buttonId);var buttonNode=D2L.LP.Web.UI.Html.Dom.GetElementById(buttonId.GetValue());var events={convertToMath:function(obj){var func=function(match,sub1,sub2){var hackRegEx=/^<img[^>]*\s+data-d2l-mathml=\"([^\"]*)\"(.|\n|\r)*/i;var hackResult=hackRegEx.exec(match);var hack=decodeURIComponent(hackResult[1]);return hack;};obj.content=obj.content.replace(/<img[^>]*\s+data-d2l-mathml=\"[^\"]*\"[^>]*>/gi,func);},onNodeChange:function(e){var htmlEditComp=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents,isEnabled=true,isActive=false;if(!e.node&&e.element)e.node=e.element;if(!e.isCollapsed&&e.node.nodeName==='IMG'&&e.node.className.indexOf('equation')>-1){var mathml=e.node.getAttribute('data-d2l-mathml');isEnabled=mathml.indexOf('latex')===-1&&mathml.indexOf('wiris')===-1;isActive=isEnabled;if(isEnabled){htmlEditComp.SplitButton.SetSelectedItemByNode(buttonNode);}}htmlEditComp.Button.SetIsEnabledByNode(buttonNode,isEnabled);htmlEditComp.Button.SetIsActiveByNode(buttonNode,isActive);}};var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.InitializeScript('Script',{'name':'d2l_mathmlequation','actionId':'mathml_editor','nodeChange':function(e){events.onNodeChange(e);}});return plugin;}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.FormatAction={Initialize:function(name,commandName,listId){var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin;var selectList=D2L.LP.Web.UI.Desktop.Controls.SelectList;var values;return plugin.InitializeControl('SelectList',{'selectList':D2L.LP.Web.UI.Desktop.Controls.SelectList,'name':name,'commandName':commandName,'controlId':listId,'nodeChange':function(args){if(!values){values=selectList.GetValues(listId);}var newValue='';for(var i=0;i<values.length;i++){if(args.hasFormat(values[i])){newValue=values[i];break;}}var currentValue=selectList.GetSelectedValue(listId);if(newValue==currentValue){return;}selectList.SetSelectedValue(listId,newValue);}});}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.FullscreenAction={IsFullscreen:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());return node.d2l_isFullscreen===true;},SetIsFullscreen:function(editorId,buttonId,isFullscreen){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.FullscreenAction;if(me.IsFullscreen(editorId)==isFullscreen){return;}var button=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());var bodyNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-body');if(bodyNode==null){bodyNode=document.getElementById('d2l_body');}if(node.d2l_fullscreenResize===undefined){node.d2l_fullscreenResize=function(){var tempViewPort=D2L.LP.Web.UI.Html.Dom.GetViewportSize();D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetSize(editorId,tempViewPort.height+'px',tempViewPort.width+'px');};}if(isFullscreen){var boundingRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);node.d2l_nomralSize={height:boundingRect.height,width:boundingRect.width};var viewPort=D2L.LP.Web.UI.Html.Dom.GetViewportSize();bodyNode.style.overflow='hidden';D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-htmleditor-fullscreen',node);D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetSize(editorId,viewPort.height+'px',viewPort.width+'px');D2L.LP.Web.UI.Events.OnResize.AddListener(node.d2l_fullscreenResize);}else{D2L.LP.Web.UI.Events.OnResize.RemoveListener(node.d2l_fullscreenResize);D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetSize(editorId,node.d2l_nomralSize.height+'px',node.d2l_nomralSize.width+'px');D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-htmleditor-fullscreen',node);bodyNode.style.overflow='visible';}D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetIsResizeDisplayedByNode(node,!isFullscreen);button.SetIsActive(buttonId,isFullscreen);node.d2l_isFullscreen=isFullscreen;},ToggleFullscreen:function(editorId,buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.FullscreenAction;me.SetIsFullscreen(editorId,buttonId,!me.IsFullscreen(editorId));}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.HorizontalRuleAction={GetHorizontalRuleData:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node===null||node.nodeName!=='HR'){return null;}var width=node.style.width;var widthType;if(width.indexOf('%')!==-1){width=width.replace('%','');widthType='%';}else if(width.indexOf('px')!==-1){width=width.replace('px','');widthType='px';}else{return null;}var height=node.style.height;if(height==='auto'||height.indexOf('px')===-1){height=0;}else{height=height.replace('px','');}var borderType='inset';if(node.style.borderStyle!=='inset'){borderType='solid';}return{width:width,widthType:widthType,height:height,borderType:borderType};},Initialize:function(buttonId){var button=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;var plugin=button.Initialize('d2l_hr','hr',buttonId,{activatedDelegate:function(args){return args&&args.element.nodeName==='HR';},enabledDelegate:null,onClick:function(args){if(args.element.nodeName==='HR'){args.selectNode(args.element);}}});return plugin;}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.HorizontalRuleAction.View={GetHorizontalRule:function(id){var nodeId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(nodeId);var getWidthType=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getWidthType');var widthType=getWidthType.call(getWidthType);if(widthType!='px'){widthType='%';}var getWidthValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getWidthValue');var widthValue=getWidthValue.call(getWidthValue);if(widthValue==null){widthValue=100;widthType='%';}var getHeightValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getHeightValue');var heightValue=getHeightValue.call(getHeightValue);if(heightValue==null){heightValue='auto';}else{heightValue=heightValue+'px';}var getShadow=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getShadow');var shadow=getShadow.call(getShadow);var borderStyle='solid';if(shadow){borderStyle='inset';}var hr='<hr style="width: '+widthValue+widthType+'; '+'height: '+heightValue+'; '+'color: #ffffff; '+'border-style: '+borderStyle+'; '+'border-width: 1px; '+'border-color: #cccccc;" />';return hr;}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.ImageAction={Plugin:function(action,isEnabled,host){host.registerService('fra-html-editor-image','0.1',{click:function(){if(!isEnabled){return Promise.reject('disabled');}var promise=new Promise(function(resolve,reject){action(resolve,reject);});return promise;},config:function(){return{isEnabled:isEnabled};}});},Insert:function(editorId,openFunction,orgUnitPath,tempFilePath,resolve,reject){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.PasteDelayed(editorId,openFunction,null,function(responseValues){var files=responseValues[0],isDecorative=responseValues[1],altText=responseValues[2];if(isDecorative){altText='';}else{altText=D2L.LP.Web.UI.Html.JavaScript.HtmlEncode(altText);}var src;if(files[0].FileSystemType.toLowerCase()==='content'){src=files[0].FileId;if(src.substr(0,1)!='/'){src=orgUnitPath+src;}src=D2L.LP.Web.UI.Html.JavaScript.UrlEncodePath(src);src=src.replace("%2E",".");}else if(files[0].FileSystemType.toLowerCase()==='temp'){src=tempFilePath.replace('%7b0%7d',files[0].FileId);}else if(files[0].FileSystemType.toLowerCase()==='external'){src=files[0].GetFileId();}D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.TriggerFileAdded(editorId,new D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.FileData(files[0].FileSystemType,files[0].FileId,files[0].FileName,files[0].Size,src));var html='<img src="'+D2L.LP.Web.UI.Html.JavaScript.HtmlEncode(src)+'"'+' alt="'+altText+'" title="'+altText+'" style="max-width:100%;" data-d2l-editor-default-img-style="true" />';return html;},resolve,reject);}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.IndentOutdent={InitializeIndent:function(buttonId){var button=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;return button.Initialize('d2l_indent','indent',buttonId,{activatedDelegate:null,enabledDelegate:null});},InitializeOutdent:function(buttonId){var button=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;return button.Initialize('d2l_outdent','outdent',buttonId,{activatedDelegate:null,enabledDelegate:function(args){return args.getCommandState('outdent');}});}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.IsfAction={Plugin:function(action,isEnabled,isWindowModeOpaque,host){host.registerService('fra-html-editor-isf','0.1',{click:function(){if(!isEnabled){return Promise.reject('disabled');}var promise=new Promise(function(resolve,reject){action(resolve,reject);});return promise;},config:function(){return{isEnabled:isEnabled,isWindowModeOpaque:isWindowModeOpaque};}});},Initialize:function(isWindowModeOpaque){var events={onBeforeSetContent:function(o){this._convertToImages(o);},onPostProcess:function(o){if(o.get){this._convertToElements(o);return;}},_convertToImages:function(context){var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin;if(context.content!=null&&context.content.length>0&&context.content.search(/(<object|<embed|<iframe)/i)!=-1){var html=context.content;var sb=new D2L.Util.StringBuilder();var embedStartRe=new RegExp('(<embed)','i');var objectStartRe=new RegExp('(<object)','i');var iFrameStartRe=new RegExp('(<iframe)','i');var scriptStartRe=new RegExp('(<script|'+plugin.RegExp.OpenScript+')','i');var searchRe=new RegExp('(<object|<embed|<iframe|<script|'+plugin.RegExp.OpenScript+')','i');var toIndex=0;while(html.length>0){toIndex=html.search(searchRe);if(toIndex==0){embedStartRe.lastIndex=0;scriptStartRe.lastIndex=0;objectStartRe.lastIndex=0;iFrameStartRe.lastIndex=0;searchRe.lastIndex=toIndex;var match=searchRe.exec(html)[0];if(scriptStartRe.test(match)){var scriptEndIndex=html.indexOf('>',toIndex);if(html.substr(scriptEndIndex-1,1)=='/'){toIndex=scriptEndIndex+1;}else{var scriptEndRe=new RegExp('(</script>|'+plugin.RegExp.CloseScript+')','i');scriptEndIndex=html.search(scriptEndRe);if(scriptEndIndex!=-1){toIndex=html.indexOf('>',scriptEndIndex)+1;}else{toIndex=html.indexOf('>',toIndex)+1;}}sb.Append(html.substring(0,toIndex));html=html.substring(toIndex);}else if(objectStartRe.test(match)){var isValidObject=true;var objectHtml=html.substring(0).toLowerCase();var objectCount=1;var objectFromIndex=7;var objectStartIndex=0;var objectEndIndex=0;while(objectCount>0){objectStartIndex=objectHtml.indexOf('<object',objectFromIndex);objectEndIndex=objectHtml.indexOf('</object>',objectFromIndex);if(objectStartIndex!=-1&&objectStartIndex<objectEndIndex){objectCount+=1;objectFromIndex=objectStartIndex+7;}else{if(objectEndIndex!=-1){objectCount-=1;objectFromIndex=objectEndIndex+9;}}if(objectEndIndex===-1){isValidObject=false;break;}}if(isValidObject){sb.Append(events._createImage(html.substring(0,objectFromIndex)));html=html.substring(objectFromIndex);}else{sb.Append(html);html='';}}else if(embedStartRe.test(match)){var embedEndIndex=html.indexOf('>');if(html.substr(embedEndIndex-1,1)==='/'){embedEndIndex=embedEndIndex+1;}else{var embedEndRe=new RegExp('</embed>','i');embedEndIndex=html.search(embedEndRe);if(embedEndIndex!=-1){embedEndIndex=embedEndIndex+8;}else{embedEndIndex=html.indexOf('>')+1;}}sb.Append(events._createImage(html.substring(0,embedEndIndex)));html=html.substring(embedEndIndex);}else if(iFrameStartRe.test(match)){var iFrameEndIndex=html.indexOf('>');var iFrameHtml=html.substring(0,iFrameEndIndex+1);var iFrameSrcRe=new RegExp('src=(\'|")[^>]*youtube[^\'">]*(\'|")','i');iFrameHtml=iFrameHtml.replace(iFrameSrcRe,function(srcHtml){if(isWindowModeOpaque){if(srcHtml.indexOf('wmode')===-1){if(srcHtml.indexOf('?')===-1){return srcHtml.substring(0,srcHtml.length-1)+'?wmode=opaque'+srcHtml.substring(srcHtml.length-1);}else{return srcHtml.substring(0,srcHtml.length-1)+'&amp;wmode=opaque'+srcHtml.substring(srcHtml.length-1);}}else{return srcHtml.replace(/wmode=([^&#\'\"]*)/,'wmode=opaque');}}else{if(srcHtml.indexOf('wmode')!==-1){return srcHtml=srcHtml.replace(/wmode=([^&#\'\"]*)/,'wmode=');}else{return srcHtml;}}});sb.Append(iFrameHtml);html=html.substring(iFrameEndIndex+1);}}else{if(toIndex===-1){sb.Append(html);break;}else{sb.Append(html.substring(0,toIndex));html=html.substring(toIndex);}}}context.content=sb.ToString();}this._setDefaultImageStyle(context);},_createImage:function(html){var me=this;var width=me._getAttributeValue('width',html);if(width==null){width='100px';}var height=me._getAttributeValue('height',html);if(height==null){height='100px';}var classId=me._getAttributeValue('classid',html);if(classId==null){classId=me._getAttributeValue('type',html);}return'<img src="/d2l/img/LP/htmlEditor/eq_trans.gif" '+'width="'+width+'" '+'height="'+height+'" '+'class="'+me._getImageClassName(classId)+'" '+'data-isf-content="'+encodeURIComponent(html)+'" />';},_setDefaultImageStyle:function(context){if(context.content===null||context.content.length<=0){return;}var node=new DOMParser().parseFromString(context.content,'text/html');if(!node||!node.body||!node.body.firstElementChild){return;}var img=node.body.firstElementChild;if(!img||img.nodeName.toUpperCase()!=='IMG'||img.hasAttribute('width')||img.hasAttribute('height')||img.style.width||img.style.height){return;}img.style.maxWidth='100%';img.setAttribute('data-d2l-editor-default-img-style','true');context.content=img.outerHTML;},_createElement:function(html,height,width){var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin;if(width===null){width='100px';}if(height===null){height='100px';}html=decodeURIComponent(html);html=html.replace(new RegExp(plugin.RegExp.HrefString,'g'),'');html=html.replace(new RegExp(plugin.RegExp.SrcString,'g'),'');html=html.replace(new RegExp('width=[\"\']{1}[0-9px]+[\'\"]','gi'),'width="'+width+'"');html=html.replace(new RegExp('height=[\"\']{1}[0-9px]+[\'\"]','gi'),'height="'+height+'"');html=html.replace(new RegExp('width=[0-9px]+','gi'),'width='+width);html=html.replace(new RegExp('height=[0-9px]+','gi'),'height='+height);return html;},_getImageClassName:function(classId){if(classId!=null){classId=classId.toLowerCase();var guidIndex=classId.indexOf(':');if(guidIndex!=-1&&classId.length>guidIndex+1){classId=classId.substring(guidIndex+1);}}else{classId='';}switch(classId){case'd27cdb6e-ae6d-11cf-96b8-444553540000':case'application/x-shockwave-flash':case'd2l_flash':return'disf_flash';case'166b1bca-3f9c-11cf-8075-444553540000':return'disf_shockwave';case'6bf52a52-394a-11d3-b153-00c04f79faa6':case'22d6f312-b0f6-11d0-94ab-0080c74c7e95':case'05589fa1-c356-11ce-bf01-00aa0055595a':return'disf_windowsmedia';case'02bf25d5-8c17-4b23-bc80-d3488abddc6b':case'd2l_qt':return'disf_quicktime';case'cfcdaa03-8be4-11cf-b84b-0020afbbccfa':return'disf_realmedia';default:return'disf_default';}},_getAttribute:function(attributeName,html){var attRe=new RegExp(attributeName+'=(\"[^<>"]*\"|\'[^<>\']*\'|\w+)','i');var attMatch=attRe.exec(html);if(attMatch!=null&&attMatch.length>0){return attMatch[0];}else{return null;}},_getAttributeValue:function(attributeName,html){var attValue=null;var attRe=new RegExp(attributeName+'=(\"[^<>"]*\"|\'[^<>\']*\'|\w+)','i');var attMatch=attRe.exec(html);if(attMatch!=null&&attMatch.length>1){if(attMatch[1].length>1&&(attMatch[1].substr(0,1)=='\''||attMatch[1].substr(0,1)=='\"')){attValue=attMatch[1].substring(1,attMatch[1].length-1);}else{attValue=attMatch[1];}}return attValue;},_convertToElements:function(context){if(context.content!=null&&context.content.length>0&&context.content.search(/data-isf-content/i)!=-1){var html=context.content;var sb=new D2L.Util.StringBuilder();var toIndex=0;var imgStartRe=new RegExp('(<img)','i');while(html.length>0){imgStartRe.lastIndex=0;toIndex=html.search(imgStartRe);if(toIndex==0){var imgEndIndex=html.indexOf('>');if(html.substr(imgEndIndex-1,1)==='/'){imgEndIndex=imgEndIndex+1;}else{var imgEndRe=new RegExp('</img>','i');imgEndIndex=html.search(imgEndRe);if(imgEndIndex!=-1){imgEndIndex=imgEndIndex+6;}else{imgEndIndex=html.indexOf('>')+1;}}var imgHtml=html.substring(0,imgEndIndex);if(imgHtml.indexOf('data-isf-content')!==-1){sb.Append(this._createElement(this._getAttributeValue('data-isf-content',imgHtml),this._getAttributeValue('height',imgHtml),this._getAttributeValue('width',imgHtml)));}else{sb.Append(imgHtml);}html=html.substring(imgEndIndex);}else{if(toIndex==-1){sb.Append(html);break;}else{sb.Append(html.substring(0,toIndex));html=html.substring(toIndex);}}}context.content=sb.ToString();}}};var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.InitializeScript('Script',{'name':'d2l_isf','onSetContent':function(obj){events.onBeforeSetContent(obj);},'onGetContent':function(obj){events.onPostProcess(obj);}});return plugin;}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.FontFamilyAction={Plugin:function(isEnabled,fontFamilies,host){host.registerService('fra-html-editor-font-family','0.1',{get:function(){if(!isEnabled){return Promise.reject('disabled');}var promise=new Promise(function(resolve){resolve(fontFamilies);});return promise;},config:function(){return{isEnabled:isEnabled};}});}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.LinkAction={GetLinkData:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node==null||node.nodeName!='A'){return null;}var href=node.getAttribute('href');var title=D2L.LP.Web.UI.Html.Dom.GetTextContent(node);var target=node.getAttribute('target');if(target==='_top'){target=1;}else if(target==='_blank'){target=2;}else{target=0;}return{href:href,target:target,title:title};},GetLinkSelectedText:function(editorId){var text;var selectedNode=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(selectedNode&&selectedNode.nodeName==='A'){text=D2L.LP.Web.UI.Html.Dom.GetTextContent(selectedNode);}else{text=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectionContent(editorId);}if(text===undefined||text===null){text='';}return text;},Initialize:function(buttonId){var button=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;var plugin=button.Initialize('d2l_link','link',buttonId,{activatedDelegate:function(args){return args&&args.element.nodeName==='A';},enabledDelegate:null,onClick:function(args){if(args.element.nodeName==='A'){args.selectNode(args.element);}}});return plugin;},SelectLink:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var selectedNode=htmlEditor.GetSelectedNode(editorId);if(selectedNode==null){return;}if(selectedNode.nodeName==='A'){htmlEditor.SelectNode(editorId,selectedNode);}}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.PreviewAction={Plugin:function(action,isEnabled,host){host.registerService('fra-html-editor-preview','0.1',{click:function(html){if(!isEnabled){return Promise.reject('disabled');}var promise=new Promise(function(resolve,reject){action(html,resolve,reject);});return promise;},config:function(){return{isEnabled:isEnabled};}});},Preview:function(editorId,location,parameters,html,resolve,reject){if(html){parameters.editor.m_html=html;}var event=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenWithParam(editorId,location,parameters,null);if(resolve){event.AddListener(function(){resolve('closed');});}if(reject){event.AddReleaseListener(function(){reject('cancelled');});}}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmleditor-preview',function(node){var dialogBody=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-dialog-body',node);var resizeFrame=function(){setTimeout(function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(dialogBody);node.style.width='100%';node.style.height=rect.height-8+'px';},50);};D2L.LP.Web.UI.Events.OnResize.AddListener(resizeFrame);});D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SpellcheckAction={Apply:function(editorId,openFunction){openFunction.call(openFunction).AddListener(function(responseValue){return D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetSpellcheckText(editorId,responseValue);});},GetText:function(editorId){return D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSpellcheckText(editorId);}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction={};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View={GetEntityFromString:function(charValue){var entityExp=/&#[^;]*;/g;var result=entityExp.exec(charValue);if(result==null||result[0].length<4){return'';}return result[0];},GetSelectedSymbol:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var editId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.getAttribute('data-d2l-editId'));var charValue=D2L.LP.Web.UI.Desktop.Controls.Edit.GetValue(editId);return me.GetEntityFromString(charValue);},SetSelectedSymbol:function(id,charValue){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.SetSelectedSymbolByNode(node,charValue);},SetSelectedSymbolByNode:function(node,charValue){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View;if(node.d2l_selectedCharacter==charValue){return;}charValue=me.GetEntityFromString(charValue);if(node.d2l_charNodes===undefined){node.d2l_charNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-htmleditor-symbol-char',node);}var htmlCodeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-symbol-htmlcode',node));htmlCodeNode.innerHTML='&nbsp;';for(var i=0;i<node.d2l_charNodes.length;i++){var charNode=node.d2l_charNodes[i];if(charNode.d2l_isSelected){charNode.d2l_isSelected=false;D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-htmleditor-symbol-char-selected',charNode);}if(charNode.getAttribute('data-d2l-numcode')==charValue){charNode.d2l_isSelected=true;D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-htmleditor-symbol-char-selected',charNode);htmlCodeNode.innerHTML=charNode.getAttribute('data-d2l-htmlcode').replace('&','&amp;');}}node.d2l_selectedCharacter=charValue;var symbolNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-symbol-symbol',node);if(charValue.length==0){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-htmleditor-symbol-symbol-invalid',symbolNode);}else{D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-htmleditor-symbol-symbol-invalid',symbolNode);}D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(symbolNode).innerHTML=node.d2l_selectedCharacter;}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction={Initialize:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_edittable','edittable',buttonId);},InitializeCellProperties:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_cellproperties','cellproperties',buttonId);},InitializeRowProperties:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_rowproperties','rowproperties',buttonId);},InitializeDelete:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_delete','delete',buttonId);},InitializeDeleteColumn:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_deletecolumn','deletecolumn',buttonId);},InitializeDeleteRow:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_deleterow','deleterow',buttonId);},InitializeInsertColumnAfter:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_insertcolumnafter','insertcolumnafter',buttonId);},InitializeInsertColumnBefore:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_insertcolumnbefore','insertcolumnbefore',buttonId);},InitializeCopyRow:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_copyrow','copyrow',buttonId);},InitializeCutRow:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_cutrow','cutrow',buttonId);},InitializeInsertRowAfter:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_insertrowafter','insertrowafter',buttonId);},InitializeInsertRowBefore:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_insertrowbefore','insertrowbefore',buttonId);},InitializeMergeCells:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_mergecells','mergecells',buttonId);},InitializePasteRowAfter:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_pasterowafter','pasterowafter',buttonId);},InitializePasteRowBefore:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_pasterowbefore','pasterowbefore',buttonId);},InitializeSplitCells:function(buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction;return me.InitializeEditAction('d2l_splitcells','splitcells',buttonId);},InitializeEditAction:function(name,commandName,buttonId){var button=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;var plugin=button.Initialize(name,commandName,buttonId,{enabledDelegate:function(args){if(!args||!args.element){return false;}return $(args.element).closest("td,th").length>0;}});return plugin;},GetSelectedRowCount:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;return table.GetSelectedRows(wysiwyg.GetTextAreaId(id)).length;},GetSelectedColumnCount:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;return Object.keys(table.GetSelectedColumns(wysiwyg.GetTextAreaId(id))).length;},GetRowBackgroundColor:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var color=table.GetRowBackgroundColor(wysiwyg.GetTextAreaId(id));if(!color){return'';}return color;},GetRowHeight:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var height=table.GetRowHeight(wysiwyg.GetTextAreaId(id));if(height===undefined){return'';}return height;},GetRowType:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var rowType=table.GetRowType(wysiwyg.GetTextAreaId(id));if(rowType===undefined){return'body';}return rowType;},GetRowHorizontalAlign:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var alignment=table.GetRowHorizontalAlign(wysiwyg.GetTextAreaId(id));if(alignment===undefined){return'none';}return alignment;},GetRowVerticalAlign:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var alignment=table.GetRowVerticalAlign(wysiwyg.GetTextAreaId(id));if(alignment===undefined){return'none';}return alignment;},GetHeight:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var height=table.GetTableProperties(wysiwyg.GetTextAreaId(id)).height;if(height===undefined){return'';}return height;},GetWidth:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var width=table.GetTableProperties(wysiwyg.GetTextAreaId(id)).width;if(width===undefined){return'';}return width;},GetAlignment:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var alignment=table.GetTableProperties(wysiwyg.GetTextAreaId(id)).alignment;if(alignment===undefined){return'';}return alignment;},GetCellHeight:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var height=table.GetCellHeight(wysiwyg.GetTextAreaId(id));if(height===undefined){return'';}return height;},GetCellWidth:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var width=table.GetCellWidth(wysiwyg.GetTextAreaId(id));if(width===undefined){return'';}return width;},GetCellHorizontalAlign:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var alignment=table.GetCellHorizontalAlign(wysiwyg.GetTextAreaId(id));if(alignment===undefined){return'';}return alignment;},GetCellVerticalAlign:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var alignment=table.GetCellVerticalAlign(wysiwyg.GetTextAreaId(id));if(alignment===undefined){return'';}return alignment;},GetCellBackgroundColor:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var color=table.GetCellBackgroundColor(wysiwyg.GetTextAreaId(id));if(!color){return'';}return color;},GetCellBorderColor:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var color=table.GetCellBorderColor(wysiwyg.GetTextAreaId(id));if(!color){return'';}return color;},GetCellBorderWidth:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var width=table.GetCellBorderWidth(wysiwyg.GetTextAreaId(id));if(width===undefined){return'';}return width;},GetCellType:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var cellType=table.GetCellType(wysiwyg.GetTextAreaId(id));if(cellType===undefined){return'';}return cellType;},GetCellPadding:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var cellPadding=table.GetTableProperties(wysiwyg.GetTextAreaId(id)).cellPadding;if(cellPadding===undefined){return'';}return cellPadding;},GetCellSpacing:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var cellSpacing=table.GetTableProperties(wysiwyg.GetTextAreaId(id)).cellSpacing;if(cellSpacing===undefined){return'';}return cellSpacing;},GetIncludeCaption:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;return table.GetTableProperties(wysiwyg.GetTextAreaId(id)).includeCaption;},GetBackgroundColor:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var color=table.GetTableProperties(wysiwyg.GetTextAreaId(id)).backgroundColor;if(!color){return'';}return color;},GetBorderColor:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var color=table.GetTableProperties(wysiwyg.GetTextAreaId(id)).borderColor;if(!color){return'';}return color;},GetBorderWidth:function(id){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var width=table.GetTableProperties(wysiwyg.GetTextAreaId(id)).borderWidth;if(width===undefined){return'';}return width;},HandleBorderColorChange:function(color,width,widthInitializer){if(color&&color.length>0&&(!width||width===0)){widthInitializer.call(widthInitializer);}},UpdateRowProperties:function(id,rowPropertiesProvider){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var textAreaId=wysiwyg.GetTextAreaId(id);rowPropertiesProvider.call(rowPropertiesProvider).AddListener(function(rowProperties){table.UpdateRowProperties(textAreaId,rowProperties);});},UpdateCellProperties:function(id,cellPropertiesProvider){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var textAreaId=wysiwyg.GetTextAreaId(id);cellPropertiesProvider.call(cellPropertiesProvider).AddListener(function(cellProperties){table.UpdateCellProperties(textAreaId,cellProperties);});},UpdateTableProperties:function(id,tablePropertiesProvider){var wysiwyg=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var table=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.TableGrid;var textAreaId=wysiwyg.GetTextAreaId(id);tablePropertiesProvider.call(tablePropertiesProvider).AddListener(function(tableProperties){table.UpdateTableProperties(textAreaId,tableProperties);});}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction.CellPropertiesView={GetCellData:function(id){var nodeId=id.GetValue();var getWidthValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getWidthValue');var widthValue=getWidthValue.call(getWidthValue);if(widthValue&&/^[0-9]+$/.test(widthValue)){widthValue+='px';}var getHeightValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getHeightValue');var heightValue=getHeightValue.call(getHeightValue);if(heightValue&&/^[0-9]+$/.test(heightValue)){heightValue+='px';}var getHorizontalAlignValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getHorizontalAlignValue');var horizontalAlignValue=getHorizontalAlignValue.call(getHorizontalAlignValue);var getVerticalAlignValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getVerticalAlignValue');var verticalAlignValue=getVerticalAlignValue.call(getVerticalAlignValue);var getCellTypeValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getCellTypeValue');var cellTypeValue=getCellTypeValue.call(getCellTypeValue);var getBackgroundColorValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getBackgroundColorValue');var backgroundColorValue=getBackgroundColorValue.call(getBackgroundColorValue);var getBorderColorValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getBorderColorValue');var borderColorValue=getBorderColorValue.call(getBorderColorValue);var getBorderWidthValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getBorderWidthValue');var borderWidthValue=getBorderWidthValue.call(getBorderWidthValue);if(borderWidthValue&&/^[0-9]+$/.test(borderWidthValue)){borderWidthValue+='px';}return{width:widthValue,height:heightValue,horizontalAlign:horizontalAlignValue,verticalAlign:verticalAlignValue,cellType:cellTypeValue,backgroundColor:backgroundColorValue,borderColor:borderColorValue,borderWidth:borderWidthValue};}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction.RowPropertiesView={GetRowData:function(id){var nodeId=id.GetValue();var getHeightValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getHeightValue');var heightValue=getHeightValue.call(getHeightValue);if(heightValue&&/^[0-9]+$/.test(heightValue)){heightValue+='px';}var getRowTypeValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getRowTypeValue');var rowTypeValue=getRowTypeValue.call(getRowTypeValue);var getBackgroundColorValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getBackgroundColorValue');var backgroundColorValue=getBackgroundColorValue.call(getBackgroundColorValue);var getHorizontalAlignValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getHorizontalAlignValue');var horizontalAlignValue=getHorizontalAlignValue.call(getHorizontalAlignValue);var getVerticalAlignValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getVerticalAlignValue');var verticalAlignValue=getVerticalAlignValue.call(getVerticalAlignValue);return{horizontalAlign:horizontalAlignValue,verticalAlign:verticalAlignValue,height:heightValue,rowType:rowTypeValue,backgroundColor:backgroundColorValue};}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction.TablePropertiesView={GetTableData:function(id){var nodeId=id.GetValue();var getWidthValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getWidthValue');var widthValue=getWidthValue.call(getWidthValue);if(widthValue&&/^[0-9]+$/.test(widthValue)){widthValue+='px';}var getHeightValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getHeightValue');var heightValue=getHeightValue.call(getHeightValue);if(heightValue&&/^[0-9]+$/.test(heightValue)){heightValue+='px';}var getCellSpacingValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getCellSpacingValue');var cellSpacingValue=getCellSpacingValue.call(getCellSpacingValue);if(cellSpacingValue&&/^[0-9]+$/.test(cellSpacingValue)){cellSpacingValue+='px';}var getCellPaddingValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getCellPaddingValue');var cellPaddingValue=getCellPaddingValue.call(getCellPaddingValue);if(cellPaddingValue&&/^[0-9]+$/.test(cellPaddingValue)){cellPaddingValue+='px';}var getIncludeCaptionValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getIncludeCaptionValue');var includeCaptionValue=getIncludeCaptionValue.call(getIncludeCaptionValue);var getAlignmentValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getAlignmentValue');var alignmentValue=getAlignmentValue.call(getAlignmentValue);var getBackgroundColorValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getBackgroundColorValue');var backgroundColorValue=getBackgroundColorValue.call(getBackgroundColorValue);var getBorderColorValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getBorderColorValue');var borderColorValue=getBorderColorValue.call(getBorderColorValue);var getBorderWidthValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,'getBorderWidthValue');var borderWidthValue=getBorderWidthValue.call(getBorderWidthValue);if(borderWidthValue&&/^[0-9]+$/.test(borderWidthValue)){borderWidthValue+='px';}return{backgroundColor:backgroundColorValue,borderColor:borderColorValue,borderWidth:borderWidthValue,includeCaption:includeCaptionValue,cellSpacing:cellSpacingValue,cellPadding:cellPaddingValue,width:widthValue,height:heightValue,alignment:alignmentValue};}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-table-builder',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableSizeSelector;var $node=$(node);var $tableSizes=$node.find('.d2l-table-builder-size');me.SetActiveDataNode($tableSizes.get(0),true);var onSelectSizeFunction=D2L.LP.Web.UI.ObjectRepository.TryGet($node.attr('id'),'OnSelectSizeFunction');$tableSizes.on('mouseenter',function(e){me.SetActiveDataNode(e.target);}).on('click',function(e){if(onSelectSizeFunction===null){return;}onSelectSizeFunction.call(onSelectSizeFunction);});});D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableSizeSelector={FormatColsRowsText:function(text,rows,cols){return text.replace('{cols}',cols).replace('{rows}',rows);},HandleKeyPress:function(id,keyCode){if(keyCode<37||keyCode>40){return;}var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableSizeSelector;var $builder=$(D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));var $activeColumn=$builder.find('.d2l-table-builder-size-active');var $activeRow=$activeColumn.parent();var $rows=$builder.children('.d2l-table-builder-row');if(keyCode===40){if($activeRow.index()+1===$rows.length){return;}me.SetActiveDataNode($($rows.get($activeRow.index()+1)).children().get($activeColumn.index()));}else if(keyCode===39){if($activeColumn.index()+1===$activeRow.children().length){return;}me.SetActiveDataNode($activeRow.children().get($activeColumn.index()+1));}else if(keyCode===37){if($activeColumn.index()===0){return;}me.SetActiveDataNode($activeRow.children().get($activeColumn.index()-1));}else if(keyCode===38){if($activeRow.index()===0){return;}me.SetActiveDataNode($($rows.get($activeRow.index()-1)).children().get($activeColumn.index()));}},OnShow:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableSizeSelector;var $builder=$(D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));var $colsByRows=$builder.find('.d2l-table-builder-cols-by-rows');D2L.LP.Web.UI.Html.Aria.LogMessage(me.FormatColsRowsText($colsByRows.attr('data-cols-by-rows-text'),1,1));me.SetActiveData(id,1,1);},SetActiveData:function(id,row,column){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableSizeSelector;var $builder=$(D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));me.SetActiveDataNode($($builder.find('.d2l-table-builder-row').get(row-1)).children().get(column-1));},SetActiveDataNode:function(node,skipAriaMsg){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableSizeSelector;var $node=$(node);var $builder=$node.closest('.d2l-table-builder');$builder.find('.d2l-table-builder-size-active').removeClass('d2l-table-builder-size-active');$node.addClass('d2l-table-builder-size-included d2l-table-builder-size-active');if($node.data('row')===undefined){$node.data('row',$(node.parentNode).index());}if($node.data('column')===undefined){$node.data('column',$(node).index());}var $rows=$builder.children('.d2l-table-builder-row');$rows.each(function(rowIndex){var $row=$(this);$row.children().each(function(columnIndex){var $column=$(this);if($column!==$node&&$column.hasClass('d2l-table-builder-size-included')){$column.removeClass('d2l-table-builder-size-included');}if(rowIndex>$node.data('row')||columnIndex>$node.data('column')){$column.removeClass('d2l-table-builder-size-included');}else{$column.addClass('d2l-table-builder-size-included');}});});var $colsByRows=$builder.find('.d2l-table-builder-cols-by-rows');var colsRowsText=me.FormatColsRowsText($colsByRows.attr('data-cols-by-rows-text'),$node.data('row')+1,$node.data('column')+1);$colsByRows.text(colsRowsText);if(!skipAriaMsg){D2L.LP.Web.UI.Html.Aria.LogMessage($colsByRows.text());}},InsertTable:function(editorId,builderId){var $builder=$(D2L.LP.Web.UI.Html.Dom.GetElementById(builderId.GetValue()));var $activeData=$builder.find('.d2l-table-builder-size-active');var cols=$activeData.data('column')+1;var rows=$activeData.data('row')+1;if(cols===null||cols===undefined||rows===null||rows===undefined||cols<=0||rows<=0){return;}var y,x,html;html='<table><tbody>';for(y=0;y<rows;y++){html+='<tr>';for(x=0;x<cols;x++){html+='<td><br></td>';}html+='</tr>';}html+='</tbody></table>';D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Paste(editorId,html);}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.UndoRedo={InitializeUndo:function(buttonId){var button=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;return button.Initialize('d2l_undo','undo',buttonId,{activatedDelegate:null,enabledDelegate:function(args){return args.hasUndo();}});},InitializeRedo:function(buttonId){var button=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;return button.Initialize('d2l_redo','redo',buttonId,{activatedDelegate:null,enabledDelegate:function(args){return args.hasRedo();}});}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.WordCountAction={ChangeMode:function(editorId,textControlId,wordCountRegex){var WCA=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.WordCountAction;if(WCA.WordCountMode[editorId.GetValue()]==='word'){WCA.WordCountMode[editorId.GetValue()]='char';}else{WCA.WordCountMode[editorId.GetValue()]='word';}WCA.WordCount(editorId,textControlId,wordCountRegex);},WordCount:function(editorId,textControlId,wordCountRegex){var regexWordDefault=/[\S]+/g;var regexChar=/[^\s]/g;var WCA=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.WordCountAction;var editorBody=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WordCount(editorId);var regex;var countLangTerm;if(WCA.WordCountMode[editorId.GetValue()]==='word'){var regexWord;try{regexWord=new RegExp(wordCountRegex,'g');}catch(err){regexWord=regexWordDefault;}regex=regexWord;countLangTerm=D2L.LP.Web.UI.ObjectRepository.Get("TextRenderer","WordCount");}else{regex=regexChar;countLangTerm=D2L.LP.Web.UI.ObjectRepository.Get("TextRenderer","CharCount");}var count=0;try{count=((editorBody||'').match(regex)||[]).length;}catch(err){if(WCA.WordCountMode[editorId.GetValue()]==='word'){regex=regexWordDefault;count=((editorBody||'').match(regex)||[]).length;}}if(editorBody.trim().length>1&&count===0&&WCA.WordCountMode[editorId.GetValue()]==='word'){regex=regexWordDefault;count=((editorBody||'').match(regex)||[]).length;}var outputString=countLangTerm.replace("{0}",count.toString());D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Text.SetText(textControlId,outputString);return;},Register:function(editorId,textControlId,wordCountRegex){var WCA=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.WordCountAction;D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.OnInput(editorId,function(){WCA.WordCount(editorId,textControlId,wordCountRegex);});if(WCA.WordCountMode===null||typeof WCA.WordCountMode==='undefined'){WCA.WordCountMode={};}D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.WordCountAction.WordCountMode[editorId.GetValue()]='word';return null;}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.FullPageScript={Initialize:function(){return'd2l_fullpage';}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.ReplaceStringScript={Initialize:function(replace){var events={decodeReplaceStrings:function(obj){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.ReplaceStringScript.DecodeReplaceStrings(obj);},encodeReplaceStrings:function(obj){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.ReplaceStringScript.EncodeReplaceStrings(obj,replace);},onBeforeSetContent:function(obj){this.encodeReplaceStrings(obj);},onPostProcess:function(obj){if(obj.get){this.decodeReplaceStrings(obj);return;}}};var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.InitializeScript('Script',{'name':'d2l_replacestring','onSetContent':function(obj){events.encodeReplaceStrings(obj);},'onGetContent':function(obj){events.decodeReplaceStrings(obj);}});return plugin;},EncodeReplaceStrings:function(obj,replace){var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin;var html=obj.content;if(html!=null&&html.length>0){var func=function(match){var tempNode=document.createElement('div');tempNode.innerHTML=match;var img=tempNode.firstChild;if(!img){return match;}var src=img.getAttribute(plugin.Attributes.Data);if(!src){src=img.getAttribute('src');}if(!src){return match;}var originalSrc=src;for(var key in replace){var regEx=new RegExp('{'+key+'}','i');src=src.replace(regEx,replace[key]);}if(src!==originalSrc){img.setAttribute('src',src);img.setAttribute('data-d2l-src',encodeURIComponent(originalSrc));if(img.getAttribute(plugin.Attributes.Data)!==null){img.setAttribute(plugin.Attributes.Src,src);}var temp=tempNode.innerHTML;temp=temp.replace(/<\/iframe>/gi,'');return temp;}else{return match;}};html=html.replace(/<(img|iframe)[^>]*\ssrc[\s]*=[\s]*(\'([^\']*)\'|\"([^\"]*)\"|([^>^\s^\/]*))[^>]*>/gi,func);obj.content=html;}},DecodeReplaceStrings:function(obj){var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin;var html=obj.content;if(html!=null&&html.length>0){var func=function(match){var tempNode=document.createElement('div');tempNode.innerHTML=match;var img=tempNode.firstChild;var d2l_src=img.getAttribute('data-d2l-src');if(d2l_src!=''){img.setAttribute('src',decodeURIComponent(d2l_src));img.removeAttribute('data-d2l-src');if(img.getAttribute(plugin.Attributes.Data)!=null){img.setAttribute(plugin.Attributes.Data,decodeURIComponent(d2l_src));}var temp=tempNode.innerHTML;temp=temp.replace(/<\/iframe>/gi,'');return temp;}else{return match;}};html=html.replace(/<(img|iframe)[^>]*\sdata-d2l-src[\s]*=[\s]*(\'([^\']*)\'|\"([^\"]*)\"|([^>^\s^\/]*))[^>]*>/gi,func);obj.content=html.replace(/(%7B(orgId|orgName|orgUnitId|OrgUnitName|OrgUnitCode|OrgUnitPath|UserId|UserName|OrgDefinedId|FirstName|LastName|ExternalEmail|InternalEmail|RoleId)%7D)/gi,'{$2}');}}};D2L.LP.Web.UI.Desktop.Controls.IFrame={AddOnLoadHandler:function(iframe,handler){if(iframe.m_loaded){handler();}else{D2L.LP.Web.UI.Html.Dom.AddEventListener('load',iframe,handler);}},SetLocation:function(id,location){var $frame=id.$();var loadingIcon=$frame.prev('.d2l-iframe-loading-container');loadingIcon.show();$frame.hide().load(function(){loadingIcon.hide();$frame.show();}).attr('src',location.GetUrl());},GetNextGeneratedId:function(){var id=10;return function(){return id++;};}()};D2L.LP.Web.UI.Desktop.Controls.Image={SetAlt:function(id,alt){var img=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(img!==null){img.alt=alt;img.title=alt;}},SetIsVisible:function(id,isVisible){D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(id,isVisible);}};D2L.LP.Web.UI.Desktop.Controls.ImageLink={AddOnClick:function(id,onclick){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null){return;}D2L.LP.Web.UI.Html.Aria.SetRole(node,'button');D2L.LP.Web.UI.Html.Dom.SetAttribute(node,'onclick','return false;');D2L.LP.Web.UI.Html.Dom.AddEventListener('click',node,function(){if(D2L.LP.Web.UI.Desktop.Controls.ImageLink.IsEnabledNode(node)){onclick();}});},IsEnabledNode:function(node){return!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-imagelink-disabled',node);},SetIsEnabled:function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.ImageLink.SetIsEnabledNode(node,isEnabled);},SetIsEnabledNode:function(node,isEnabled){var isDisabled=!D2L.LP.Web.UI.Desktop.Controls.ImageLink.IsEnabledNode(node);if(!isEnabled==isDisabled){return;}D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'disabled',!isEnabled);if(isEnabled){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-imagelink-disabled',node);D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'disabled','false');}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-imagelink-disabled',node);D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'disabled','true');}var hasHref=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,isEnabled?'data-href':'href');if(!hasHref){return;}var href=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,isEnabled?'data-href':'href');D2L.LP.Web.UI.Html.Dom.SetAttribute(node,isEnabled?'href':'data-href',href);D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,isEnabled?'data-href':'href');}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-navigation-immersive',function(node){var iterator=node.querySelector('d2l-navigation-iterator');if(iterator===null){return;}if(iterator.hasAttribute('data-on-previous-click')){iterator.addEventListener('previous-click',function(){var onPreviousClick=iterator.getAttribute('data-on-previous-click');eval(onPreviousClick);});}if(iterator.hasAttribute('data-on-next-click')){iterator.addEventListener('next-click',function(){var onNextClick=iterator.getAttribute('data-on-next-click');eval(onNextClick);});}});D2L.LP.Web.UI.Desktop.Controls.ImmersiveNav={SetHref:function(id,href){var node=document.getElementById(id.GetValue());if(!node){return;}node.setAttribute('href',href.GetUrl());},SetText:function(id,text){var node=document.getElementById(id.GetValue());if(!node){return;}node.setAttribute('text',text);},SetIsVisible:function(id,isVisible){var node=document.getElementById(id.GetValue());if(!node){return;}var immersiveNavElem=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-navigation-immersive',node);if(immersiveNavElem){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(immersiveNavElem,isVisible);}}};D2L.LP.Web.UI.Desktop.Controls.InlineHelp={m_popupLocation:null,Init:function(popupLocation){var me=D2L.LP.Web.UI.Desktop.Controls.InlineHelp;me.m_popupLocation=popupLocation;},SetText:function(id,text){var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null){throw'InlineHelp not found: \''+idVal+'\'.';}node.innerHTML=text;},PopupHelp:function(titleTerm,descriptionTerm){var me=D2L.LP.Web.UI.Desktop.Controls.InlineHelp;var loc=me.m_popupLocation;loc=loc.WithQueryString('titleTerm',titleTerm);loc=loc.WithQueryString('descriptionTerm',descriptionTerm);var name=titleTerm.toLowerCase().replace('.','_').replace('\\','_');D2L.LP.Web.UI.Html.Dom.OpenWindow('popupHelp_'+name,loc,600,400,false,false);}};D2L.LP.Web.UI.Desktop.Controls.InputNumber={GetValue:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);return node.value===undefined?null:node.value;},SetNodeValue:function(node,number,triggerOnChange){node.value=number;if(triggerOnChange===undefined||triggerOnChange){node.dispatchEvent(new CustomEvent('change',{bubbles:true,composed:false}));}else{D2L.LP.Web.UI.Desktop.Controls.InputNumber.UpdateHidden(node.id);}},UpdateHidden:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var hiddenId=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-hidden-id');var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetElementById(hiddenId);if(node.trailingZeroes){hiddenNode.value=node.valueTrailingZeroes;}else{hiddenNode.value=node.value===undefined?'':node.value;}},ValidateEnabledVisibleNode:function(node){if(!node){return true;}var isEnabled=node.disabled!==undefined?!node.disabled:true;var isVisible=D2L.LP.Web.UI.Html.Dom.IsVisible(node);return isEnabled&&isVisible;},ValidateRange:function(id,min,max,minExclusive,maxExclusive){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var isEnabledVisible=D2L.LP.Web.UI.Desktop.Controls.InputNumber.ValidateEnabledVisibleNode(node);if(!isEnabledVisible){return true;}node.validate();var value=node.value;if(value===undefined){return true;}if(min!==null&&max!==null){if(minExclusive&&maxExclusive){return min<value&&value<max;}else if(minExclusive){return min<value&&value<=max;}else if(maxExclusive){return min<=value&&value<max;}else{return min<=value&&value<=max;}}else if(min!==null){return minExclusive?min<value:min<=value;}else if(max!==null){return maxExclusive?value<max:value<=max;}return true;},ValidateRequired:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var isEnabledVisible=D2L.LP.Web.UI.Desktop.Controls.InputNumber.ValidateEnabledVisibleNode(node);if(!isEnabledVisible){return true;}node.validate();return node.value!==undefined;}};D2L.LP.Web.UI.Desktop.Controls.IntegerSelector={Increment:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.IntegerSelector;var context=me.GetContext(id);var currentValue=me.TryGetCurrentValue(id);var maxValue=context.MaxValue;var delta=context.Delta;if(currentValue==null){return;}if(maxValue==null||currentValue+delta<=maxValue){me.SetEditIntegerValue(id,currentValue+delta);}me.UpdateButtons(id);},Decrement:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.IntegerSelector;var context=me.GetContext(id);var currentValue=me.TryGetCurrentValue(id);var minValue=context.MinValue;var delta=context.Delta;if(currentValue==null){return;}if(minValue==null||currentValue-delta>=minValue){me.SetEditIntegerValue(id,currentValue-delta);}me.UpdateButtons(id);},UpdateButtons:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.IntegerSelector;var context=me.GetContext(id);var currentValue=me.TryGetCurrentValue(id);var minValue=context.MinValue;var maxValue=context.MaxValue;var moreButtonId=context.MoreButtonId;var lessButtonId=context.LessButtonId;var delta=context.Delta;if(currentValue==null){return;}D2L.LP.Web.UI.Desktop.Controls.Button.SetIsEnabled(moreButtonId,true);D2L.LP.Web.UI.Desktop.Controls.Button.SetIsEnabled(lessButtonId,true);if(maxValue!=null&&currentValue+delta>maxValue){D2L.LP.Web.UI.Desktop.Controls.Button.SetIsEnabled(moreButtonId,false);}if(minValue!=null&&currentValue-delta<minValue){D2L.LP.Web.UI.Desktop.Controls.Button.SetIsEnabled(lessButtonId,false);}},GetContext:function(id){return D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue()+'_c');},SetEditIntegerValue:function(id,val){D2L.LP.Web.UI.Desktop.Controls.EditInteger.SetInteger(id,val);var context=D2L.LP.Web.UI.Desktop.Controls.IntegerSelector.GetContext(id);if(context.TextBlockId!=null){D2L.LP.Web.UI.Desktop.Controls.TextBlock.SetText(context.TextBlockId,D2L.LP.Globalization.Locale.GetNumberFormatter().FormatInteger(val));}},TryGetCurrentValue:function(id){return D2L.LP.Web.UI.Desktop.Controls.EditInteger.TryGetInteger(id);}};D2L.LP.Web.UI.Desktop.Controls.Iterator={SetIsEnabled:function(iteratorId,isEnabled){var elementId=iteratorId;if(iteratorId.GetValue){elementId=iteratorId.GetValue();}var node=D2L.LP.Web.UI.Html.Dom.GetElementById(elementId);var anchorNodes=node.getElementsByTagName('a');var stateFunction=isEnabled?D2L.LP.Web.UI.Desktop.Controls.Iterator.SetEnabled:D2L.LP.Web.UI.Desktop.Controls.Iterator.SetDisabled;for(var i=0;i<anchorNodes.length;i++){stateFunction(anchorNodes[i]);}},SetEnabled:function(node){D2L.LP.Web.UI.Desktop.Controls.Iterator.OnClickAttributeHelper(node,false);$(node).removeClass('vui-disabled d2l-iterator-button-disabled');},SetDisabled:function(node){D2L.LP.Web.UI.Desktop.Controls.Iterator.OnClickAttributeHelper(node,true);$(node).addClass('vui-disabled d2l-iterator-button-disabled');},OnClickAttributeHelper:function(node,isEnabled){var hasOnClick=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,isEnabled?'onclick':'data-onclick');if(!hasOnClick){return;}var onclick=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,isEnabled?'onclick':'data-onclick');D2L.LP.Web.UI.Html.Dom.SetAttribute(node,isEnabled?'data-onclick':'onclick',onclick);D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,isEnabled?'onclick':'data-onclick');}};D2L.LP.Web.UI.Desktop.Controls.Link={InstallClickable:function(node){node.tabIndex=0;var handleEnter=function(){D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',node);};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,function(key){if(key.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter){handleEnter();}});},SetText:function(id,text){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node){return;}while(node.firstChild){node.removeChild(node.firstChild);}node.appendChild(document.createTextNode(text));}};D2L.LP.Web.UI.Desktop.Controls.LinkHeading={SetText:function(id,text){var headingNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var node=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(headingNode);if(!node){return;}while(node.firstChild){node.removeChild(node.firstChild);}node.appendChild(document.createTextNode(text));}};D2L.LP.Web.UI.Desktop.Controls.ListIcon={SetIcon:function(id,icon){var idVal=id.GetValue();var item=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(item===null){throw'ListIconItem not found: \''+idVal+'\'.';}item.style.backgroundImage='url('+icon+')';}};D2L.LP.Web.UI.Desktop.Controls.LoadMorePager={Pagers:[],Init:function(id,controlProvider,pageableControlId,showFunction,hideFunction,setLoadingTextFunction,setNormalTextFunction){var pager=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(pager===null){return;}var me=D2L.LP.Web.UI.Desktop.Controls.LoadMorePager;var pageableControl=controlProvider.call(controlProvider);var info={ControlProvider:controlProvider,IsLoading:false,SetLoadingFunction:setLoadingTextFunction,PageableControl:pageableControl,PageableControlId:pageableControlId};me.Pagers[id]=info;var setIsVisible=function(isVisible){if(isVisible){showFunction();}else{hideFunction();}};var onLoadCompleteFunction=function(hasMoreItems){setIsVisible(hasMoreItems);};pageableControl.GetOnLoadCompletedEvent(pageableControlId).AddListener(onLoadCompleteFunction);var onLoadMoreCompleteFunction=function(hasMoreItems){me.Pagers[id].IsLoading=false;setNormalTextFunction();setIsVisible(hasMoreItems);};pageableControl.GetOnLoadMoreCompletedEvent(pageableControlId).AddListener(onLoadMoreCompleteFunction);pager.d2l_onLoadCompleteHandle=onLoadCompleteFunction;pager.d2l_onLoadMoreHandle=onLoadMoreCompleteFunction;pager.d2l_pageableControl=pageableControl;pager.d2l_pageableControlId=pageableControlId;setIsVisible(pageableControl.GetHasMoreItems(pageableControlId));},LoadMore:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.LoadMorePager;var info=me.Pagers[id];if(info===undefined||info.IsLoading){return;}info.IsLoading=true;setTimeout(function(){if(info.IsLoading){info.SetLoadingFunction();}},1000);info.PageableControl.LoadMore(info.PageableControlId);}};D2L.LP.Web.UI.Desktop.Controls.LongEdit={ClearValue:function(id){D2L.LP.Web.UI.Desktop.Controls.LongEdit.SetValue(id,'');},ClearValueNode:function(node){D2L.LP.Web.UI.Desktop.Controls.LongEdit.SetValueNode(node,'');},IsEmpty:function(id){var input=D2L.LP.Web.UI.Desktop.Controls.LongEdit.GetInput(id);var value=D2L.LP.Web.UI.Html.JavaScript.TrimString(0,input.value);var isEmpty=value.length===0;return isEmpty;},GetInput:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(input===null){throw'LongEdit not found \''+id.GetValue()+'\'.';}return input;},SetHeight:function(id,height){var input=D2L.LP.Web.UI.Desktop.Controls.LongEdit.GetInput(id);D2L.LP.Web.UI.Desktop.Controls.LongEdit.SetHeightNode(input,height);},SetHeightNode:function(node,height){if(height===undefined||height===null){height=50;}D2L.LP.Web.UI.Html.Dom.SetAttribute(node,'data-height',height);var isResized=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-longedit-resized',node);if(isResized){return;}node.style.height=height+'px';},SetValue:function(id,value){var input=D2L.LP.Web.UI.Desktop.Controls.LongEdit.GetInput(id);D2L.LP.Web.UI.Desktop.Controls.LongEdit.SetValueNode(input,value);},SetValueNode:function(node,value){node.value=value;if(node.d2l_onChange!==undefined){node.d2l_onChange();}},AddOffScreenClass:function(node){var wasHidden=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',node.parentNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',node.parentNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-longedit-offscreen',node.parentNode);return wasHidden;},RemoveOffScreenClass:function(node,wasHidden){if(wasHidden){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',node.parentNode);}D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-longedit-offscreen',node.parentNode);}};D2L.LP.Web.UI.Desktop.Controls.MediaPlayer={PlayerInitializer:function(node){var mp=D2L.LP.Web.UI.Desktop.Controls.MediaPlayer;if(!VideoPlayer||typeof VideoPlayer!=='object'){return;}mp.InitializeMediaPlayerControls(node.getAttribute('data-mediaplayer-controlslang'));if(mejs&&!VideoPlayer._hasInit){var player;if(node.getAttribute('data-mediaplayer-use-d2l-labs-media-player')==='true'){player=new MediaPlayerGenerator();}else{player=new MediaElementGenerator();}VideoPlayer.initVideoPlayer(player);VideoPlayer._hasInit=true;}mp.InitializeWarningsAndErrors(node.getAttribute('data-mediaplayer-warningsanderrorslang'));mp.InitializeCCLanguages(node.getAttribute('data-mediaplayer-cclanguages'));},AddCssUrl:function(inCssUrl){$link=$(document).find('head').find('link');var NotAddCssflag=true;for(var i=0;$link[i];i++){if($($link[i]).attr('href')===inCssUrl){NotAddCssflag=false;break;}}if(NotAddCssflag){var $css=$('<link rel="stylesheet" type="text/css" href="'+inCssUrl+'">');$(document).find('head').append($css);}},InitializeMediaPlayerControls:function(langTerms){langTerms=JSON.parse(langTerms);if(mejs&&mejs.i18n&&mejs.i18n.locale){var locales=mejs.i18n.locale.strings;if(!locales){locales={};locales.en={};}for(var locale in locales){for(var term in langTerms){if(langTerms.hasOwnProperty(term)){locales[locale][term]=langTerms[term];}}}}},InitializeWarningsAndErrors:function(langTerms){langTerms=JSON.parse(langTerms);if(ParserWarnings){ParserWarnings.InitializeLangTerms(langTerms);}},InitializeCCLanguages:function(languages){languages=JSON.parse(languages);if(mejs){for(var locale in languages){if(languages.hasOwnProperty(locale)){mejs.language.codes[locale]=languages[locale];}}}},GetWarningsAndErrors:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var warnings=[];if(node){var messages=node.getAttribute('data-mediaplayer-warnings');if(messages){var msgObj=JSON.parse(messages);for(var i=0;msgObj[i];i++){if(msgObj[i].text){warnings.push(msgObj[i].text.msg);}}}}return warnings;},HasErrors:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var errors=false;if(node){var messages=node.getAttribute('data-mediaplayer-warnings');if(messages){var msgObj=JSON.parse(messages);for(var i=0;msgObj[i];i++){if(msgObj[i].type==="error"){errors=true;break;}}}}return errors;},GetTitle:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node){var data=node.getAttribute('data-mediaplayer-video-data');var title='';if(data){var dataObj=JSON.parse(data);if(dataObj.title){title=dataObj.title;}}return title;}return'';},GetAuthor:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node){var data=node.getAttribute('data-mediaplayer-video-data');var author='';if(data){var dataObj=JSON.parse(data);if(dataObj.author){author=dataObj.author;}}return author;}return'';},GetSourceProvider:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node){var data=node.getAttribute('data-mediaplayer-video-data');var sourceProvider='';if(data){var dataObj=JSON.parse(data);if(dataObj.sourceProvider){sourceProvider=dataObj.sourceProvider;}}return sourceProvider;}return'';},GetSourceName:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node){var data=node.getAttribute('data-mediaplayer-video-data');var sourceName='';if(data){var dataObj=JSON.parse(data);if(dataObj.sourceName){sourceName=dataObj.sourceName;}}return sourceName;}return'';},GetMediaPlayerSrc:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node){var src=node.getAttribute('data-mediaplayer-src');if(!src){return'';}return src;}return'';},GetPageUrl:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node){var pageUrl=node.getAttribute('data-mediaplayer-pageurl');if(!pageUrl){return'';}return pageUrl;}return'';},GetSupportedMediaExtensions:function(){if(VideoParser){return VideoParser.SupportedFileExtensions();}else{return['mp4'];}},IsSupportedMediaFile:function(inUrl){if(VideoParser){return VideoParser.isSupportedFile(inUrl);}else{return false;}},IsEmpty:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node){return node.hasChildNodes()>0?true:false;}},SetSource:function(id,source){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node){$(node).attr('data-mediaplayer-src',source);$(node).empty();setTimeout(function(){VideoPlayer.create(id.GetValue(),source,{allowDownload:$(node).attr('data-mediaplayer-show-download-button')==='true',pluginPath:'https://s.brightspace.com/lib/vui-mediaplayer/0.2.1/'});$('.mejs-container .mejs-controls').css('visibility','hidden');},0);}},TriggerUpdate:function(id){return D2L.LP.Web.UI.Desktop.Controls.MediaPlayer.Trigger(id,'vui.mediaplayer.resize');},Trigger:function(id,value){var node=$('#'+id.GetValue());if(node.length>0){node.trigger(value);return true;}return false;},VideoError:function(error){var $errorContainer=$('<div class="mediaplayer-cannotplay-container"></div>');var $tcContainer=$('<div class="mediaplayer-cannotplay-table-cell"></div>');var $messageContainer=$('<div></div>');$tcContainer.append($messageContainer);$errorContainer.append($tcContainer);var $parent=$(error).parent();var $mediaplayer=$(error).parents('.vui-mediaplayer');var h;var w;$mediaplayer.attr('data-mediaplayer-warnings',null);if($mediaplayer.height()===0){h=225;w=400;var p=$(error).parents();for(var i=0;p[i];i++){if($(p[i]).height()===0){$(p[i]).height(h);}else{break;}}}else{h=$mediaplayer.height()<=524?$mediaplayer.height():524;w=$mediaplayer.width()<=940?$mediaplayer.width():940;}$parent.height(h).width(w);$mediaplayer.find('video').height(h).width(w);$mediaplayer.find('.mejs-container').height(h).width(w);var $message=$('<div class="mediaplayer-cannotplay-message" role="alert"></div>');if(h!==90&&w!==160){$messageContainer.append('<div class="mediaplayer-cannotplay-icon"></div>');$message.append('<h3 class="mediaplayer-cannotplay-message-h3">'+mejs.i18n.t('txtBrowserCannotPlayVideo')!=="undefined"?mejs.i18n.t('txtBrowserCannotPlayVideo'):'Your browser cannot play that video.'+'</h3>');var tmp="";if($mediaplayer.attr('data-mediaplayer-video-data')&&$mediaplayer.attr('data-mediaplayer-size')){var info=JSON.parse($mediaplayer.attr('data-mediaplayer-video-data'));tmp=info.title+' - '+$mediaplayer.attr('data-mediaplayer-size');$message.append('<br>');}$message.append('<i>'+tmp+'</i>');$message.append('<br>');}else{$message.append('<h3 class="mediaplayer-cannotplay-message-h3">'+mejs.i18n.t('txtCannotPlayVideo')!=="undefined"?mejs.i18n.t('txtCannotPlayVideo'):'Cannot play video.'+'</h3>');}$message.append('<a href="'+$(error).attr('src')+'" tabindex="0"><span>'+mejs.i18n.t("Download File")+'</span></a>');$messageContainer.append($message);var mec=$parent.find('.me-cannotplay');mec.empty();$parent.parents('.mejs-container').css('background','#ffffff');$parent.append($errorContainer);}};D2L.LP.Web.UI.Desktop.Controls.Menu={GetItemIsSelected:function(itemId){var item=document.getElementById(itemId.GetValue());if(!item)return false;return item.hasAttribute('selected');},SetItemIsSelected:function(itemId,selected){var item=document.getElementById(itemId.GetValue());if(!item){return;}if(selected){item.selected=selected;}else{item.removeAttribute("selected");}}};D2L.LP.Web.UI.Desktop.Controls.MenuFlyout=D2L.LP.Web.UI.Desktop.Controls.MenuFlyout||{};D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.GetContentsKeyPressed=function(contentsId){var contentsNode=D2L.LP.Web.UI.Html.Dom.GetElementById(contentsId.GetValue());return contentsNode.d2l_lastKeyPressed;};D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.Init=function(menuNode,contentsNode,openFunction,openFirstFunction,closeFunction){var contentsNodeId=contentsNode.getAttribute('id');if(contentsNodeId!==undefined){D2L.LP.Web.UI.Html.Dom.AddKeyDownEventListener(contentsNode,function(e){var keyCode=e.GetKey();if(keyCode>36&&keyCode<41){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(e.GetEventObject());}});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(contentsNode,function(e){var keyCode=e.GetKey();if(keyCode===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter){var contentEnterFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(contentsNodeId,'Flyout.OnEnterFunction');if(contentEnterFunction!==null){contentEnterFunction.call(contentEnterFunction);}}var contentKeyPressFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(contentsNodeId,'Flyout.OnKeyPressFunction');if(contentKeyPressFunction!==null){contentsNode.d2l_lastKeyPressed=e.GetKey();contentKeyPressFunction.call(contentKeyPressFunction);}});}if(closeFunction){contentsNode.addEventListener('d2l-dropdown-close',function(){closeFunction.call(closeFunction);});}var loadFunction=function(){if(!contentsNode.opened){return;}D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.UpdatePosition(contentsNode,menuNode);if(openFunction){openFunction.call(openFunction);}};var opener=menuNode.classList.contains('d2l-menuflyout-opener')?menuNode:D2L.LP.Web.UI.Html.Dom.GetElementById(menuNode.getAttribute("data-opener-id"));opener.addEventListener('click',loadFunction);var loadFirstFunction=function(e){var keypress=e.type==='keypress'?true:false;if(keypress&&e.which!==13&&e.which!==32)return;opener.removeEventListener('mouseup',loadFirstFunction);opener.removeEventListener('keypress',loadFirstFunction);if(D2L.LP.Web.UI.Html.Dom.HasAttribute(menuNode,'data-has-upper-boundary')){contentsNode.setAttribute("boundary",JSON.stringify({"above":0}));}var hasLoading=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-loading',contentsNode).length>0;var timeout=hasLoading?501:0;setTimeout(function(){contentsNode.close();contentsNode.open(keypress);},timeout);if(openFirstFunction){openFirstFunction.call(openFirstFunction);}};opener.addEventListener('mouseup',loadFirstFunction);opener.addEventListener('keypress',loadFirstFunction);};D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.InitContextMenu=function(menuNode,openFunction,openFirstFunction,closeFunction){var loadFunction=function(){if(openFunction){openFunction.call(openFunction);}};var opener=menuNode.classList.contains('d2l-menuflyout-opener')?menuNode:D2L.LP.Web.UI.Html.Dom.GetElementById(menuNode.getAttribute("data-opener-id"));var loadFirstFunction=function(e){var keypress=e.type==='keypress'?true:false;if(keypress&&e.which!==13&&e.which!==32)return;opener.removeEventListener('mouseup',loadFirstFunction);opener.removeEventListener('keypress',loadFirstFunction);var contextMenuId=menuNode.getAttribute('data-contextMenuId');if(openFirstFunction){openFirstFunction.call(openFirstFunction);}var contextMenuIdAbs=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(contextMenuId);D2L.LP.Web.UI.Desktop.Controls.ContextMenu.CreateDropdownMenu(menuNode,contextMenuIdAbs,menuNode,null,keypress);setTimeout(function(){var templateContent=D2L.LP.Web.UI.Html.Dom.GetElementById(contextMenuId);var contentId=templateContent.getAttribute('data-dropdown-content-id');contentsNode=D2L.LP.Web.UI.Html.Dom.GetElementById(contentId);if(closeFunction){contentsNode.addEventListener('d2l-dropdown-close',function(){closeFunction.call(closeFunction);});}opener.addEventListener('click',loadFunction);loadFunction();});};opener.addEventListener('mouseup',loadFirstFunction);opener.addEventListener('keypress',loadFirstFunction);};D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.UpdatePosition=function(contentsNode,menuNode){var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var parent=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-max-width',contentsNode)||document.body;var parentRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(parent);var flyoutRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(menuNode);var contentId=contentsNode.getAttribute("data-contentId");var content=D2L.LP.Web.UI.Html.Dom.GetElementById(contentId);if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(contentsNode,'data-has-min-width')){content.style.minWidth=flyoutRect.width+'px';}var contentsRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(content);var left=Math.max(flyoutRect.right-parentRect.left,0);var right=Math.max(parentRect.right-flyoutRect.left,0);var rightOverflow;if(isRTL){rightOverflow=left-contentsRect.width;}else{rightOverflow=right-contentsRect.width;}var currentAlign=contentsNode.getAttribute("align");if(rightOverflow>0){if(currentAlign!=="start"){contentsNode.setAttribute("align","start");contentsNode.close();contentsNode.open();}}else if((isRTL?right:left)-contentsRect.width>0){if(currentAlign!=="end"){contentsNode.setAttribute("align","end");contentsNode.close();contentsNode.open();}}};D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.Close=function(id){var flyout=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!flyout){return;}var content=flyout.getElementsByTagName('d2l-dropdown-content')[0];content.close();};D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.FocusOnOpener=function(id){setTimeout(function(){var flyout=id.$();if(flyout.length===0){return;}var openerAnchor=$('.d2l-menuflyout-opener',flyout);D2L.LP.Web.UI.Html.Dom.FocusNode(openerAnchor);},250);};D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.SetText=function(id,val){var flyout=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var opener=flyout.classList.contains('d2l-menuflyout-opener')?flyout:D2L.LP.Web.UI.Html.Dom.GetElementById(flyout.getAttribute("data-opener-id"));opener.setAttribute('text',val);};D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.SetIcon=function(id,val){var flyout=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var opener=flyout.classList.contains('d2l-menuflyout-opener')?flyout:D2L.LP.Web.UI.Html.Dom.GetElementById(flyout.getAttribute("data-opener-id"));opener.setAttribute('icon',val);};D2L.LP.Web.UI.Desktop.Controls.MessageArea={IsVisible:false,PlaceholderId:null,ErrorLocation:null,Apply:function(delegate){var ma=D2L.LP.Web.UI.Html.Dom.GetElementById(D2L.LP.Web.UI.Desktop.Controls.MessageArea.PlaceholderId);if(ma!==null){delegate.call(delegate,ma);}},CreateBalloon:function(inputId,message){var balloon=document.createElement('div');balloon.id='balloon_'+inputId;balloon.className='d2l-form-balloon vui-validation-bubble vui-validation-bubble-show';var balloonChildren=document.createElement('div');balloonChildren.className='d2l-form-balloon-children vui-validation-bubble-content';var balloonTextSpan=document.createElement('span');balloonTextSpan.className='d2l-form-balloon-text';balloonTextSpan.appendChild(document.createTextNode(message));balloonChildren.appendChild(balloonTextSpan);balloon.appendChild(balloonChildren);return balloon;},Init:function(placeholderId,errorLocation){var me=D2L.LP.Web.UI.Desktop.Controls.MessageArea;me.PlaceholderId=placeholderId;me.ErrorLocation=errorLocation;},Reset:function(balloonContainer){D2L.LP.Web.UI.Desktop.Controls.MessageArea.SetIsVisible(false);var balloons=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-form-balloon',balloonContainer);for(var i=0;i<balloons.length;i++){if(balloons[i].d2l_input!==undefined){D2L.LP.Web.UI.Html.Aria.SetAttribute(balloons[i].d2l_input,'labelledby','');D2L.LP.Web.UI.Html.Aria.RemoveAttribute(balloons[i].d2l_input,'invalid');balloons[i].d2l_input.style.marginBottom=balloons[i].d2l_input_original_bottom_margin;balloons[i].d2l_input=null;}balloons[i].parentNode.removeChild(balloons[i]);}},RpcReceivePayloadProvider:function(data){var me=D2L.LP.Web.UI.Desktop.Controls.MessageArea;var count=0;var updateVisibility=function(){count++;if(data.Items.length===0||count===data.Items.length){me.Apply(function(node){node.innerHTML=data.Html;D2L.LP.Web.UI.Events.OnViewRender.Trigger(node);me.SetIsVisible(true);D2L.LP.Web.UI.Html.Dom.FocusNode(node);});}};if(data.Items.length===0){updateVisibility();}for(var i=0;i<data.Items.length;i++){(function(index){var inputId=data.Items[index].Key;var input=D2L.LP.Web.UI.Html.Dom.GetElementById(inputId);if(input===null||input.tagName==='D2L-INPUT-NUMBER'||input.tagName==='D2L-HTMLEDITOR'){updateVisibility();return;}var balloon=me.CreateBalloon(inputId,data.Items[i].Message);balloon.d2l_input=input;D2L.LP.Web.UI.Html.Aria.SetAttribute(input,'invalid','true');var balloonChildrenNode=balloon.firstChild;D2L.LP.Web.UI.Html.Dom.InsertElementAfter(balloon,input);D2L.LP.Web.UI.Html.Aria.SetAttribute(input,'labelledby',balloon.id);setTimeout(function(){var bottomMargin=D2L.LP.Web.UI.Html.Css.GetStyle(input,'margin-bottom');if(bottomMargin===undefined){bottomMargin=D2L.LP.Web.UI.Html.Css.GetStyle(input,'marginBottom');if(bottomMargin===undefined){bottomMargin='0px';}}balloon.d2l_input_original_bottom_margin=bottomMargin;input.style.marginBottom=balloonChildrenNode.offsetHeight+10+'px';balloon.style.marginTop=-balloonChildrenNode.offsetHeight+'px';balloon.style.height=balloonChildrenNode.offsetHeight+'px';updateVisibility();},0);})(i);}},SetIsVisible:function(isVisible){D2L.LP.Web.UI.Desktop.Controls.MessageArea.Apply(function(ma){var me=D2L.LP.Web.UI.Desktop.Controls.MessageArea;if(me.IsVisible==isVisible){return;}ma.style.display=isVisible?'block':'none';me.IsVisible=isVisible;D2L.LP.Web.UI.Events.OnContentHeightChange.Trigger();});},ShowErrors:function(errors){D2L.LP.Web.UI.Rpc.Connect(D2L.LP.Web.UI.Rpc.Verbs.POST,D2L.LP.Web.UI.Desktop.Controls.MessageArea.ErrorLocation,{errors:errors});}};D2L.LP.Web.UI.Desktop.Controls.MoreLess={IsExpanded:function(moreLessId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(moreLessId.GetValue());return $(window).vui_moreless('isExpanded',node);},ChangeBlurColor:function(moreLessId,newColor){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(moreLessId.GetValue());return $(window).vui_moreless('BlurColor',node,newColor);},Refresh:function(moreLessId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(moreLessId.GetValue());return $(window).vui_moreless('Refresh',node);}};D2L.LP.Web.UI.Desktop.Controls.MultiSelect={AddItems:function(id,data){for(var i=0;i<data.length;i++){D2L.LP.Web.UI.Desktop.Controls.MultiSelect.OnItemAdded(id,data[i].GetValue(),data[i].GetKey(),true);}},Clear:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.MultiSelect;var handle=me.GetHandle(id);var items=me.GetAllItems(handle);for(var i=0;i<items.length;i++){me.RemoveItem(handle,items[i]);}},Focus:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHandle(id);handle.inputNode.focus();},GetAddedItem:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.MultiSelect;var handle=me.GetHandle(id);var newItem=me.GetLastItem(handle);var hiddens=me.GetHiddenNodes(newItem);var itemParam=new me.ItemParam(hiddens.valueNode.value,hiddens.keyNode.value,hiddens.actionNode.value);return itemParam;},GetAllItems:function(handle){var items=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-multiselect-choice',handle.node);for(var i=items.length;i>=0;i--){if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',items[i])){items.splice(i,1);}}return items;},GetDataAttribute:function(node,attribute){if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(node,attribute)){return null;}var value=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,attribute);D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,attribute);if(value==='true'||value==='True'){value=true;}else if(value==='false'||value=='False'){value=false;}return value;},GetHandle:function(nodeId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(nodeId.GetValue());if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-multiselect',node)){node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-multiselect',node);}return node.handle;},GetHiddenNodes:function(itemNode){var actionHidden=D2L.LP.Web.UI.Html.Dom.GetLastElementChild(itemNode);var keyHidden=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(actionHidden);var valueHidden=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(keyHidden);return{actionNode:actionHidden,keyNode:keyHidden,valueNode:valueHidden};},GetItems:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.MultiSelect;var handle=me.GetHandle(id);var itemNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-multiselect-choice',handle.node);var items=[];for(var i=0;i<itemNodes.length;i++){var hiddens=me.GetHiddenNodes(itemNodes[i]);items.push(new me.ItemParam(hiddens.valueNode.value,hiddens.keyNode.value,hiddens.actionNode.value));}var param=new me.Param(items);return param;},GetLastItem:function(handle){var items=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetAllItems(handle);var lastItem=items[items.length-1];return lastItem;},GetRemovedItem:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHandle(id);return handle.removedItem;},GetValue:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHandle(id);return handle.inputNode.value;},InitHandle:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.MultiSelect;var handle={node:node,inputNode:null,placeholderNode:null,autoCompleteId:null,removedOriginals:[],width:0,onItemAdded:null,onItemRemoved:null,removedItem:null,customParseMode:false};var inputId=me.GetDataAttribute(handle.node,'data-d2l-input');handle.width=handle.node.scrollWidth-20;handle.inputNode=D2L.LP.Web.UI.Html.Dom.GetElementById(inputId);handle.placeholderNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-multiselect-placeholder',node)[0];handle.autoCompleteId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(D2L.LP.Web.UI.Html.Dom.GetAttribute(handle.inputNode,'aria-owns'));handle.onItemAdded=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.node.id,'itemAdded');handle.onItemRemoved=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.node.id,'itemRemoved');handle.customParseMode=me.GetDataAttribute(handle.node,'data-d2l-customparsemode');D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.inputNode,'data-d2l-validatefocus',handle.inputNode.id);D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.inputNode,'data-d2l-validateinput',handle.node.id);node.handle=handle;return handle;},Initialize:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.MultiSelect;handle.inputNode.style.width="2em";var hiddens=me.GetHiddenNodes(handle.placeholderNode);var hiddenIdParts=hiddens.actionNode.id.split('$');hiddenIdParts.pop();var hiddenItemId=hiddenIdParts.pop();D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.placeholderNode,'data-d2l-idprefix',hiddenIdParts.join('$'));D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.placeholderNode,'data-d2l-iditem',hiddenItemId);D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(handle.inputNode,function(kpArgs){if(kpArgs.GetKey()===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Backspace){var newWidth=me.MeasureInput(handle);if(newWidth<=handle.width){handle.inputNode.style.width=newWidth+"px";}if(handle.inputNode.value.length==0){var lastItem=me.GetLastItem(handle);if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-multiselect-choice-selected',lastItem)){me.RemoveItem(handle,lastItem);}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-multiselect-choice-selected',lastItem);}}}});D2L.LP.Web.UI.Html.Dom.AddKeyUpEventListener(handle.inputNode,function(kpArgs){if(kpArgs.GetKey()!=D2L.LP.Web.UI.Html.Dom.KeyUpEventArgs.Key.Backspace){var lastItem=me.GetLastItem(handle);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-multiselect-choice-selected',lastItem);if(handle.inputNode.clientWidth<=handle.width){handle.inputNode.style.width=me.MeasureInput(handle)+"px";}}});D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',handle.inputNode,function(){var lastItem=me.GetLastItem(handle);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-multiselect-choice-selected',lastItem);});var items=me.GetAllItems(handle);if(items.length>0){for(var i=0;i<items.length;i++){hiddens=me.GetHiddenNodes(items[i]);D2L.LP.Web.UI.Desktop.Controls.AutoComplete.HideItemByKey(handle.autoCompleteId,hiddens.keyNode.value);}}handle.inputNode.style.width=me.MeasureInput(handle)+"px";},IsEmpty:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHandle(id);var items=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-multiselect-choice',handle.node);for(var i=0;i<items.length;i++){if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',items[i])){return false;}}return true;},MeasureInput:function(handle){var span=document.createElement('span');var value=handle.inputNode.value;if(value==''){value=handle.inputNode.placeholder;}var content=document.createTextNode(value);span.appendChild(content);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-multiselect-offscreen',span);document.body.appendChild(span);var width=span.offsetWidth;document.body.removeChild(span);return width+25;},OnClickClearIcon:function(itemId){var handle=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHandle(itemId);var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());D2L.LP.Web.UI.Desktop.Controls.MultiSelect.RemoveItem(handle,itemNode);handle.inputNode.focus();},OnItemAdded:function(id,text,key,isParsed){var me=D2L.LP.Web.UI.Desktop.Controls.MultiSelect;var handle=me.GetHandle(id);if(isParsed===undefined){isParsed=false;}if(!isParsed&&handle.customParseMode&&!key){var customParse=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.node.id,'customParse');customParse();return;}var lastTag=me.GetLastItem(handle);if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-multiselect-choice-selected',lastTag)){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-multiselect-choice-selected',lastTag);}var newNode=handle.placeholderNode.cloneNode(true);var itemId=new D2L.LP.Web.UI.Html.UniqueHtmlId();var closeIconId=new D2L.LP.Web.UI.Html.UniqueHtmlId();newNode.id=itemId.GetValue();D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-multiselect-placeholder',newNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',newNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-multiselect-choice',newNode);D2L.LP.Web.UI.Html.Dom.RemoveAttribute(newNode,'aria-hidden');var textNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(newNode);var textContent=document.createTextNode(text);textNode.appendChild(textContent);var closeIcon=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-multiselect-clearicon',newNode)[0];closeIcon.id=closeIconId.GetValue();D2L.LP.Web.UI.Html.Dom.AddEventListener('click',closeIcon,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);D2L.LP.Web.UI.Desktop.Controls.MultiSelect.OnClickClearIcon(itemId);});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(closeIcon,function(kpArgs){if(kpArgs.GetKey()===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter){D2L.LP.Web.UI.Desktop.Controls.MultiSelect.OnClickClearIcon(itemId);}});D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseover',closeIcon,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);});var title=D2L.LP.Web.UI.Html.Dom.GetAttribute(closeIcon,'title');title=title.split('{0}').join(text);D2L.LP.Web.UI.Html.Dom.SetAttribute(closeIcon,'title',title);var hiddenIdPrefix=D2L.LP.Web.UI.Html.Dom.GetAttribute(handle.placeholderNode,'data-d2l-idprefix');var hiddenItemId=D2L.LP.Web.UI.Html.Dom.GetAttribute(handle.placeholderNode,'data-d2l-iditem');var hiddenId=hiddenIdPrefix+"$"+hiddenItemId+"$";var actionType='Add';for(var i=0;i<handle.removedOriginals.length;i++){if(key==handle.removedOriginals[i].key){actionType='None';var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(handle.removedOriginals[i].id);D2L.LP.Web.UI.Html.Dom.RemoveElement(itemNode);handle.removedOriginals.splice(i,1);break;}}me.UpdateHiddenNodes(newNode,hiddenId,text,key,actionType);if(hiddenItemId.indexOf('`')!=-1){var hiddenItemIdParts=hiddenItemId.split('`');hiddenItemIdParts[1]=parseInt(hiddenItemIdParts[1])+1;hiddenItemId=hiddenItemIdParts.join('`');}else{hiddenItemId+="`1";}hiddenId=hiddenIdPrefix+"$"+hiddenItemId+"$";me.UpdateHiddenNodes(handle.placeholderNode,hiddenId);D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.placeholderNode,'data-d2l-iditem',hiddenItemId);handle.node.insertBefore(newNode,handle.placeholderNode);handle.inputNode.value='';if(handle.onItemAdded){handle.onItemAdded();}var newWidth=me.MeasureInput(handle);if(newWidth<=handle.width){handle.inputNode.style.width=newWidth+"px";}},RemoveItem:function(handle,item){var hiddens=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHiddenNodes(item);if(hiddens.actionNode.value==='None'){hiddens.actionNode.value='Remove';D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',item);handle.removedOriginals.push({key:hiddens.keyNode.value,id:item.id});}else if(hiddens.actionNode.value==='Add'){D2L.LP.Web.UI.Html.Dom.RemoveElement(item);}D2L.LP.Web.UI.Desktop.Controls.AutoComplete.ShowItemByKey(handle.autoCompleteId,hiddens.keyNode.value);if(handle.onItemRemoved){handle.removedItem=new D2L.LP.Web.UI.Desktop.Controls.MultiSelect.ItemParam(hiddens.valueNode.value,hiddens.keyNode.value,hiddens.actionNode.value);handle.onItemRemoved();}},SetIsVisible:function(id,isVisible){var handle=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHandle(id);if(isVisible){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',handle.node);handle.width=handle.node.scrollWidth-20;}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',handle.node);}},UpdateHiddenNodes:function(listNode,newId,value,key,action){if(value===undefined){value="";key="";action="";}var hiddens=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHiddenNodes(listNode);hiddens.valueNode.id=newId+"Value";hiddens.valueNode.name=newId+"Value";hiddens.keyNode.id=newId+"Key";hiddens.keyNode.name=newId+"Key";hiddens.actionNode.id=newId+"ActionType";hiddens.actionNode.name=newId+"ActionType";hiddens.valueNode.value=value;hiddens.keyNode.value=key;hiddens.actionNode.value=action;},ValidateRequired:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHandle(id);var items=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetAllItems(handle);return items.length!=0;}};D2L.LP.Web.UI.Desktop.Controls.MultiSelectSerializableItem=D2L.Class.Create({Construct:function(value,key,title){if(value===undefined){value='';key='';title='';}this.m_value=value;this.m_key=key;this.m_title=title;},_serialize:function(serializer){serializer.AddMember('value',this.m_value);serializer.AddMember('key',this.m_key);serializer.AddMember('title',this.title);},_deserialize:function(deserializer){this.m_value=deserializer.GetMember('Value');this.m_key=deserializer.GetMember('Key');this.m_title=deserializer.GetMember('Title');},GetValue:function(){return this.m_value;},GetKey:function(){return this.m_key;},GetTitle:function(){return this.m_title;}});D2L.LP.Web.UI.Desktop.Controls.MultiSelect.ItemParam=D2L.Class.Create({Construct:function(value,key,actionType){if(value===undefined){value='';key='';actionType='';}this.m_value=value;this.m_key=key;this.m_actionType=actionType;},_serialize:function(serializer){serializer.AddMember('value',this.m_value);serializer.AddMember('key',this.m_key);serializer.AddMember('actionType',this.m_actionType);},GetValue:function(){return this.m_value;},GetKey:function(){return this.m_key;},GetActionType:function(){return this.m_actionType;}});D2L.LP.Web.UI.Desktop.Controls.MultiSelect.Param=D2L.Class.Create({Construct:function(items){if(items===undefined){items=[];}this.m_items=items;},_serialize:function(serializer){serializer.AddMember('items',this.m_items);},GetItems:function(){return this.m_items;}});D2L.LP.Web.UI.Desktop.Controls.NumericPager={GetPage:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;var handle=me.GetHandle(id);if(handle.controlProvider==null){return;}var pageableControlId=D2L.LP.Web.UI.ObjectRepository.Get(handle.id.GetValue(),'pageableControlId');var pageableControl=handle.controlProvider.call(handle.controlProvider);pageableControl.GetPage(pageableControlId);},GetHandle:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null){return null;}var handle=D2L.LP.Web.UI.Desktop.Controls.NumericPager.GetHandleByNode(node);return handle;},GetHandleByNode:function(node){var id=node.getAttribute('id');var inputNumber=node.querySelector('d2l-input-number');var edit=inputNumber!==null?inputNumber:D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-edit',node);var buttons=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-numericpager-iterator',node);var pageCountNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-numericpager-pagecount',node);var pageNumberNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);var pageSizeNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(pageNumberNode);var controlProvider=D2L.LP.Web.UI.ObjectRepository.TryGet(id,'controlProvider');var handle={controlProvider:controlProvider,editNode:edit,id:new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id),nextNode:buttons[1],node:node,pageCountNode:pageCountNode,pageNumberNode:pageNumberNode,pageNumber:parseInt(pageNumberNode.value,10),pageSizeNode:pageSizeNode,previousNode:buttons[0]};return handle;},GetPageCount:function(node){return node.d2l_pageCount;},GetPageNumber:function(id,defaultValue){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;var handle=me.GetHandle(id);if(handle===null||handle.node===null){if(defaultValue!==undefined){return defaultValue;}throw'NumericPager not found: \''+id.GetValue()+'\'.';}var pageNumber=parseInt(handle.pageNumberNode.value,10);return pageNumber;},GetPageSize:function(id,defaultValue){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;var handle=me.GetHandle(id);if(handle===null||handle.node===null){if(defaultValue!==undefined){return defaultValue;}throw'NumericPager not found: \''+id.GetValue()+'\'.';}var pageSize=parseInt(handle.pageSizeNode.value,10);return pageSize;},NextPage:function(id,editId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(node.d2l_isBusy){return;}var pageNumber=D2L.LP.Web.UI.Desktop.Controls.EditInteger.TryGetInteger(editId);D2L.LP.Web.UI.Desktop.Controls.EditInteger.SetInteger(editId,pageNumber+1);},OnPageNumberChange:function(id,pageNumber,triggerOnPageRequest){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;var handle=me.GetHandle(id);var pageNumberNode=handle.pageNumberNode;var previousPageNumber=parseInt(pageNumberNode.value,10);var pageCount=handle.node.d2l_pageCount;if(handle.node.d2l_isBusy||pageNumber==null||pageNumber<1||pageNumber>pageCount){D2L.LP.Web.UI.Desktop.Controls.EditInteger.SetIntegerNode(handle.editNode,previousPageNumber);return;}if(pageNumber!==previousPageNumber){pageNumberNode.value=pageNumber;if(triggerOnPageRequest===undefined||triggerOnPageRequest){me.PageRequest(id);}me.UpdateNextPrevious(handle,pageNumber);}},OnPageSizeChange:function(id,newPageSize){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;var handle=me.GetHandle(id);handle.pageSizeNode.value=newPageSize;me.SetPageNumber(id,1,false);me.PageRequest(id);},PageRequest:function(id){var pagerId=id.GetValue();if(!D2L.LP.Web.UI.ObjectRepository.HasKeys(pagerId,'onPageRequest')){return;}var onPageRequest=D2L.LP.Web.UI.ObjectRepository.Get(pagerId,'onPageRequest');if(onPageRequest==null){return;}var node=D2L.LP.Web.UI.Html.Dom.GetElementById(pagerId);node.d2l_isBusy=true;var onCompleted=onPageRequest.call(onPageRequest);if(onCompleted!==undefined&&typeof onCompleted['AddListener']==='function'){onCompleted.AddListener(function(){node.d2l_isBusy=false;});}else{node.d2l_isBusy=false;}},PreviousPage:function(id,editId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(node.d2l_isBusy){return;}var pageNumber=D2L.LP.Web.UI.Desktop.Controls.EditInteger.TryGetInteger(editId);D2L.LP.Web.UI.Desktop.Controls.EditInteger.SetInteger(editId,pageNumber-1);},SetPageCount:function(id,pageCount){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;var handle=me.GetHandle(id);me.SetPageCountHandle(handle,pageCount);},SetPageCountHandle:function(handle,pageCount){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;if(handle.node.d2l_pageCount!=pageCount){handle.node.d2l_pageCount=pageCount;me.UpdateNextPrevious(handle);handle.pageCountNode.innerHTML=D2L.LP.Globalization.Locale.GetNumberFormatter().FormatInteger(pageCount);}},SetPageNumber:function(id,pageNumber,triggerOnPageRequest){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;var handle=me.GetHandle(id);me.SetPageNumberHandle(handle,pageNumber,triggerOnPageRequest);},SetPageNumberHandle:function(handle,pageNumber,triggerOnPageRequest){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;if(handle.pageNumber==parseInt(pageNumber,10)){return;}D2L.LP.Web.UI.Desktop.Controls.EditInteger.SetIntegerNode(handle.editNode,pageNumber,triggerOnPageRequest);if(!triggerOnPageRequest){me.OnPageNumberChange(handle.id,pageNumber,triggerOnPageRequest);}},UpdateNextPrevious:function(handle,pageNumber){if(pageNumber===undefined){pageNumber=handle.pageNumber;}var pageCount=parseInt(handle.node.d2l_pageCount,10);var enablePrevious=pageNumber>1;var enableNext=pageNumber<pageCount;var activeElement=D2L.LP.Web.UI.Html.Dom.GetActiveElement();if(!enablePrevious&&activeElement===handle.previousNode||!enableNext&&activeElement===handle.nextNode){D2L.LP.Web.UI.Html.Dom.FocusNode(handle.editNode);}D2L.LP.Web.UI.Desktop.Controls.ImageLink.SetIsEnabledNode(handle.previousNode,enablePrevious);D2L.LP.Web.UI.Desktop.Controls.ImageLink.SetIsEnabledNode(handle.nextNode,enableNext);}};D2L.LP.Web.UI.Desktop.Controls.OnOff={Initialize:function(node){var switchElem=node.querySelector('d2l-switch');var labelId=node.getAttribute('data-labelId');if(labelId){switchElem.text=document.querySelector('#'+labelId).textContent;}var id=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(node.id);var onChange=node.getAttribute('data-onchange');if(onChange){var isProcessing=false;var beginProcessing=function(){isProcessing=true;setTimeout(function(){if(isProcessing){D2L.LP.Web.UI.Desktop.Controls.OnOff.SetIsEnabled(id,false);}},200);};var finishProcessing=function(){if(isProcessing){isProcessing=false;D2L.LP.Web.UI.Desktop.Controls.OnOff.SetIsEnabled(id,true);}};switchElem.addEventListener('change',function(e){node.querySelector('input[type="hidden"]').value=e.target.on?'on':'off';var ret=eval(onChange);if(ret===undefined||ret===null||ret.AddListener===undefined){return;}var alertMessage=node.getAttribute('data-alert-message');D2L.LP.Web.UI.Html.Aria.LogMessage(alertMessage);ret.AddListener(finishProcessing);ret.AddReleaseListener(finishProcessing);beginProcessing();});}},SetIsEnabled:function(id,isEnabled){var switchElem=document.getElementById(id.GetValue()).querySelector('d2l-switch');switchElem.disabled=!isEnabled;},GetStatus:function(id){var switchElem=document.getElementById(id.GetValue()).querySelector('d2l-switch');return switchElem.on;},SetStatus:function(id,isOn){var switchElem=document.getElementById(id.GetValue()).querySelector('d2l-switch');switchElem.on=isOn;}};D2L.LP.Web.UI.Desktop.Controls.OrgUnitSelector={ValidateRequired:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(input!==null&&D2L.LP.Web.UI.Html.Dom.IsVisible(input)){return input.value.length>0;}else{return true;}},GetSelectedOrgUnitId:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node){var inputId=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-hiddenId");var input=D2L.LP.Web.UI.Html.Dom.GetElementById(inputId);if(input&&input.value!==''){return input.value;}}return null;}};D2L.LP.Web.UI.Desktop.Controls.Placeholder={Clear:function(id){var ph=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(ph===null){return;}D2L.LP.Web.UI.Html.Dom.ApplyClassFunctions(D2L.LP.Web.UI.Html.Dom.ClassDestructors,ph);D2L.LP.Web.UI.Html.Dom.RemoveChildElements(ph);}};D2L.LP.Web.UI.Desktop.Controls.QuickEntryLong={Values:{},Cancel:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.QuickEntryLong;var handle=me.GetHandle(id);me.CancelHandle(handle,id,true);},CancelHandle:function(handle,id,clearValue){handle.LongEdit.value='';if(clearValue){D2L.LP.Web.UI.Desktop.Controls.QuickEntryLong.Values[id]='';}D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-offscreen',handle.SaveButton);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-offscreen',handle.CancelButton);D2L.LP.Web.UI.Desktop.Controls.LongEdit.SetHeightNode(handle.LongEdit,null);},FocusHandle:function(handle){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-offscreen',handle.SaveButton);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-offscreen',handle.CancelButton);D2L.LP.Web.UI.Desktop.Controls.LongEdit.SetHeightNode(handle.LongEdit,handle.OnFocusHeight);},GetValue:function(id){var values=D2L.LP.Web.UI.Desktop.Controls.QuickEntryLong.Values;if(values[id]===undefined){return'';}return values[id];},GetHandle:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);return D2L.LP.Web.UI.Desktop.Controls.QuickEntryLong.GetHandleNode(node.parentNode);},GetHandleNode:function(node){var longEditNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-longedit',node);var saveButton=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-quickentry-long-save',node);var cancelButton=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-quickentry-long-cancel',node);var onFocusHeight=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-heightfocus');return{CancelButton:cancelButton,LongEdit:longEditNode,Node:node,OnFocusHeight:onFocusHeight,SaveButton:saveButton};},Save:function(id,onSave){var me=D2L.LP.Web.UI.Desktop.Controls.QuickEntryLong;var handle=me.GetHandle(id);var value=handle.LongEdit.value;if(value.trim().length===0){me.CancelHandle(handle,id,true);return;}me.Values[id]=value;if(onSave!==null){onSave();}D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-quickentry-long-animate',handle.Node);me.CancelHandle(handle,id,false);setTimeout(function(){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-quickentry-long-animate',handle.Node);},0);}};D2L.LP.Web.UI.Desktop.Controls.RadioButton={GetChecked:function(id){return D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()).checked;},GetSelectedValue:function(groupName){var radios=document.getElementsByName(groupName.GetValue());for(var i=0;i<radios.length;i++){if(radios[i].checked==true){return radios[i].value;}}return null;},SetIsEnabled:function(groupName,isEnabled){var radios=document.getElementsByName(groupName.GetValue());for(var i=0;i<radios.length;i++){radios[i].disabled=!isEnabled;var label=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-radio-inline",radios[i]);if(label){if(isEnabled){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-radio-disabled',label);$(label).removeAttr('onclick');}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-radio-disabled',label);$(label).attr('onclick','return false;');}}}},SetSelected:function(groupName,value){var radios=document.getElementsByName(groupName.GetValue());for(var i=0;i<radios.length;i++){if(radios[i].value==value){radios[i].checked=true;return;}}}};D2L.LP.Web.UI.Desktop.Controls.RadioList={GetItemsNodes:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-radiolist-item',node);},GetRadioNode:function(itemNode){return D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode)));},GetSelectedValue:function(id){var radioNodes=document.getElementsByName(id.GetValue());for(var i=0;i<radioNodes.length;i++){if(radioNodes[i].checked==true){return radioNodes[i].value;}}},TryGetSelectedValue:function(id,defaultValue){var radioList=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(radioList===null){return defaultValue;}return this.GetSelectedValue(id);},SetIsAllEnabled:function(id,isEnabled){D2L.LP.Web.UI.Desktop.Controls.RadioButton.SetIsEnabled(id,isEnabled);},SetSelectedValue:function(id,value){D2L.LP.Web.UI.Desktop.Controls.RadioButton.SetSelected(id,value);}};D2L.LP.Web.UI.Desktop.Controls.RatingInput={ClearHoverClass:function(handle){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-rating-hover',handle.node);for(var j=0;j<6;j++){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-rating-hover-'+j,handle.node);}},GetValue:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null){throw'RatingInput control not found: \''+id.GetValue()+'\'.';}var inputs=node.getElementsByTagName('input');for(var i=0;i<inputs.length;i++){if(inputs[i].checked){return parseInt(inputs[i].value);}}return 0;},HandleBlur:function(handle,index){D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.Hide(handle);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-rating-input-focus',handle.labels[index]);},HandleFocus:function(handle,index){if(handle.ignoreFocus){return;}D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.Show(handle);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-rating-input-focus',handle.labels[index]);},HandleMouseOverLabel:function(handle,index){var isSaving=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-rating-input-saving',handle.node);if(isSaving){return;}if(index>0){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-rating-hover',handle.node);}D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-rating-hover-'+index,handle.node);},InitHandle:function(node){var handle={hover:false,ignoreFocus:false,labels:[],node:node,numRatings:0,rating:0,ratingSum:0,distribution:null};if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,'data-count')){handle.numRatings=parseInt(D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-count'));}if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,'data-sum')){handle.ratingSum=parseInt(D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-sum'));}if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-rating-1',node)){handle.rating=1;}else if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-rating-2',node)){handle.rating=2;}else if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-rating-3',node)){handle.rating=3;}else if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-rating-4',node)){handle.rating=4;}else if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-rating-5',node)){handle.rating=5;}handle.labels=node.getElementsByTagName('label');D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.InitHandle(node,handle);return handle;},SetSelected:function(handle,index,doFocus){var input=handle.labels[index].getElementsByTagName('input')[0];input.checked=true;if(doFocus){handle.ignoreFocus=true;input.focus();setTimeout(function(){handle.ignoreFocus=false;},0);}handle.ratingSum=handle.ratingSum-handle.rating+index;if(index===0&&handle.rating>0){handle.numRatings--;}else if(handle.rating===0&&index>0){handle.numRatings++;}handle.rating=index;var average=0;if(handle.numRatings>0){average=Math.round(handle.ratingSum/handle.numRatings);}for(var j=0;j<6;j++){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-rating-'+j,handle.node);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-rating-average-'+j,handle.node);}D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-rating-'+index,handle.node);if(average>0){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-rating-average-'+average,handle.node);}D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-rating-input-saving',handle.node);setTimeout(function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-rating-input-saving',handle.node);},2000);var onChange=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.node.id);if(onChange!==null){onChange();}}};D2L.LP.Web.UI.Desktop.Controls.RatingDistribution={ClassInitialize:function(handle){if(handle.distribution===null){return;}for(var i=0;i<handle.distribution.items.length;i++){var item=handle.distribution.items[i];D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseover',item.cellNode,function(t){return function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-offscreen',t);};}(item.textNode));D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseout',item.cellNode,function(t){return function(){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-offscreen',t);};}(item.textNode));}},Hide:function(handle){if(handle.distribution===null||!handle.distribution.isVisible){return;}handle.distribution.isVisible=false;for(var i=0;i<handle.distribution.items.length;i++){handle.distribution.items[i].barNode.style.height='0px';}setTimeout(function(){if(!handle.distributionIsVisible){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(handle.distribution,false);}},300);},InitHandle:function(node,handle){var distribution={node:null,isVisible:false,items:[]};distribution.node=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-rating-distribution',node);if(distribution.node===null){return;}for(var i=1;i<distribution.node.rows.length;i++){var cell=distribution.node.rows[i].cells[1];var value=parseInt(D2L.LP.Web.UI.Html.Dom.GetAttribute(cell,'data-val'));var barNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-rating-distribution-val',cell);var textNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-rating-distribution-text',cell);distribution.items.push({barNode:barNode,cellNode:cell,textNode:textNode,value:value});}handle.distribution=distribution;},Show:function(handle){if(handle.distribution===null||handle.distribution.isVisible){return;}handle.distribution.isVisible=true;for(var i=0;i<handle.distribution.items.length;i++){var item=handle.distribution.items[i];var height=0;if(item.value<11){height=1;}else if(item.value<41){height=4;}else if(item.value<71){height=7;}else{height=10;}(function(d,h){setTimeout(function(){d.style.height=h+'px';},0);})(item.barNode,height);}D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(handle.distribution.node,true);}};D2L.LP.Web.UI.Desktop.Controls.RoleSelector={GetSelectedRoles:function(id){var getSelectedValues=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue()+'$selectedRoles',"getSelectedValues");if(getSelectedValues!==null){var selectedRoles=getSelectedValues.call(getSelectedValues);return selectedRoles;}return[];}};D2L.LP.Web.UI.Desktop.Controls.SaveStatus={Start:function(id){var node=document.getElementById(id.GetValue());node.start();},End:function(id){var node=document.getElementById(id.GetValue());node.end();},ForceEnd:function(id){var node=document.getElementById(id.GetValue());node.forceEnd();},Error:function(id){var node=document.getElementById(id.GetValue());node.error();}};D2L.LP.Web.UI.Desktop.Controls.ScrollSpy={SetIsEnabled:function(isEnabled,isNoJQueryScrollSpyEnabled){if(isNoJQueryScrollSpyEnabled){if(!D2L||!D2L.ScrollSpy||!D2L.ScrollSpy.setEnabled){return;}D2L.ScrollSpy.setEnabled(isEnabled);}else{if(isEnabled){$(window).vui_scrollSpy().vui_scrollSpy('enable');}else{$(window).vui_scrollSpy().vui_scrollSpy('disable');}}}};D2L.LP.Web.UI.Desktop.Controls.ScrollPoint={IsVisible:function(scrollPointId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(scrollPointId.GetValue());var isNoJQueryScrollSpyEnabled=node.hasAttribute('data-no-jquery-scroll-spy');if(isNoJQueryScrollSpyEnabled){return node.hasAttribute('data-spy-visible');}else{return $(window).vui_scrollSpy('isVisible',node);}}};D2L.LP.Web.UI.Desktop.Controls.SearchSimple=D2L.LP.Web.UI.Desktop.Controls.SearchSimple||{};D2L.LP.Web.UI.Desktop.Controls.SearchSimple.Clear=function(id){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());elem.value='';elem.search();};D2L.LP.Web.UI.Desktop.Controls.SearchSimple.Focus=function(id){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(elem){elem.focus();}};D2L.LP.Web.UI.Desktop.Controls.SearchSimple.GetValue=function(id,defaultValue){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(elem===null){return defaultValue;}return elem.lastSearchValue;};D2L.LP.Web.UI.Desktop.Controls.SearchSimple.GetInputValue=function(id){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return elem.value;};D2L.LP.Web.UI.Desktop.Controls.SearchSimple.IsSearched=function(id){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return elem.lastSearchValue.length>0;};D2L.LP.Web.UI.Desktop.Controls.SearchSimple.Search=function(id){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());elem.search();};D2L.LP.Web.UI.Desktop.Controls.SearchSimple.SetValue=function(id,value){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());elem.value=value;};D2L.LP.Web.UI.Desktop.Controls.SearchSimple.InitWc=function(node){var search=node.querySelector('d2l-input-search');search.addEventListener('d2l-input-search-searched',function(e){if(e.detail.value.length===0){if(node.hasAttribute('data-on-clear')){var onClear=node.getAttribute('data-on-clear');eval(onClear);}}else{if(node.hasAttribute('data-on-search')){var onSearch=node.getAttribute('data-on-search');eval(onSearch);}}});search.addEventListener('input',function(){if(!node.hasAttribute('data-on-keypress')||search.value.length<1){return;}var onKeyPress=node.getAttribute('data-on-keypress');eval(onKeyPress);});};D2L.LP.Web.UI.Desktop.Controls.SelectAll={Get:function(){return D2L.LP.Web.UI.Desktop.Controls.SelectAll;},GetCheckboxNode:function(node){return D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);},GetEvent:function(id,events){var evt=events[id];if(evt===undefined){evt=new D2L.LP.Web.UI.Events.Event();events[id]=evt;}return evt;},GetOnResetEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;return me.GetEvent(id.GetValue(),me.OnResetEvents);},GetOnSelectionFilterTypeUpdateEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;return me.GetEvent(id.GetValue(),me.OnSelectionFilterTypeUpdateEvents);},GetOnSelectionUpdateEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;return me.GetEvent(id.GetValue(),me.OnSelectionUpdateEvents);},GetSelectableControlProvider:function(id){return D2L.LP.Web.UI.ObjectRepository.Get(id,0);},GetSelectableControlId:function(id){return D2L.LP.Web.UI.ObjectRepository.Get(id,1);},GetSelection:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;var selectAllId=id.GetValue();var selection=me.Selection[selectAllId];if(selection===undefined){selection={add:function(value){if(this.values[value]){return;}this.values[value]=true;this.selectedCount+=1;if(this.type!=D2L.LP.LayeredArch.SelectionFilterType.All){this.type=D2L.LP.LayeredArch.SelectionFilterType.Some;}},reset:function(){this.type=D2L.LP.LayeredArch.SelectionFilterType.None;this.persisted=false;this.selectedCount=0;this.values={};},getValuesArray:function(){var valuesArray=[];for(var value in this.values){if(this.values[value]){valuesArray.push(value);}}return valuesArray;},persisted:false,remove:function(value){if(!this.values[value]){return;}this.values[value]=false;this.selectedCount-=1;if(this.selectedCount==0){this.type=D2L.LP.LayeredArch.SelectionFilterType.None;}},selectedCount:0,type:D2L.LP.LayeredArch.SelectionFilterType.None,values:{}};me.Selection[selectAllId]=selection;}return selection;},GetSelectionInfo:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;var selection=me.GetSelection(id);var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var typeNode=me.GetTypeNode(node);var valuesNode=me.GetValuesNode(node);var valuesArray=selection.getValuesArray();typeNode.value=selection.type;valuesNode.value=D2L.LP.Web.UI.Selection.EncodeKeys(valuesArray);return new D2L.LP.Web.UI.Selection.SelectionInfo(typeNode.value,valuesArray);},GetTypeNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;return D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(me.GetCheckboxNode(node));},GetValuesNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;return D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(me.GetTypeNode(node));},OnSelectionFilterTypeUpdateEvents:{},OnSelectionUpdateEvents:{},OnResetEvents:{},IsUpdateStateEnabled:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;var isEnabled=me.UpdateStateEnabled[id];if(isEnabled===undefined){isEnabled=true;me.UpdateStateEnabled[id]=isEnabled;}return isEnabled;},RemoveItem:function(id,value){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;var selection=me.GetSelection(id);if(!selection.values[value]){return;}selection.remove(value);var selectionUpdateEvent=me.GetOnSelectionUpdateEvent(id);selectionUpdateEvent.Trigger(selection.type,selection.selectedCount);},Selection:{},SetIsSelectionReadOnly:function(id,isReadOnly){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(isReadOnly&&!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-readonly',node)){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-readonly',node);}else if(!isReadOnly&&D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-readonly',node)){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-readonly',node);}},SetIsUpdateStateEnabled:function(id,isEnabled){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;me.UpdateStateEnabled[id]=isEnabled;},SelectAll:function(id,selectionType){if(selectionType!=D2L.LP.LayeredArch.SelectionFilterType.Some&&selectionType!=D2L.LP.LayeredArch.SelectionFilterType.All){return;}var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;var selectAllId=id.GetValue();var values='';if(selectionType==D2L.LP.LayeredArch.SelectionFilterType.Some){var controlProvider=me.GetSelectableControlProvider(selectAllId);var selectableControl=controlProvider.call(controlProvider);values=selectableControl.GetValues(me.GetSelectableControlId(selectAllId));}me.SetSelectionInfo(id,new D2L.LP.Web.UI.Desktop.Controls.SelectAll.SelectionInfo(selectionType,D2L.LP.Web.UI.Selection.EncodeKeys(values)),false);var node=D2L.LP.Web.UI.Html.Dom.GetElementById(selectAllId);var checkboxNode=me.GetCheckboxNode(node);checkboxNode.checked=true;var selection=me.GetSelection(id);var selectionFilterTypeEvent=me.GetOnSelectionFilterTypeUpdateEvent(id);selectionFilterTypeEvent.Trigger(checkboxNode.checked,selection.type);var selectionUpdateEvent=me.GetOnSelectionUpdateEvent(id);selectionUpdateEvent.Trigger(selection.type,selection.selectedCount);},SetSelectionInfo:function(id,selectionInfo,triggerFilterTypeUpdateEvent){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;var selectAllId=id.GetValue();if(!D2L.LP.Web.UI.ObjectRepository.HasKey(selectAllId)){return;}var controlProvider=me.GetSelectableControlProvider(selectAllId);var selectableControlId=me.GetSelectableControlId(selectAllId);if(controlProvider===null||selectableControlId===null){return;}if(triggerFilterTypeUpdateEvent===undefined){triggerFilterTypeUpdateEvent=false;}var selectableControl=controlProvider.call(controlProvider);var type=selectionInfo.GetType();var values=selectionInfo.GetKeys();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(selectAllId);var checkboxNode=me.GetCheckboxNode(node);checkboxNode.checked=type==D2L.LP.LayeredArch.SelectionFilterType.All||type==D2L.LP.LayeredArch.SelectionFilterType.AllExcept;var selection=me.GetSelection(id);selection.type=type;selection.values={};selection.selectedCount=values.length;for(var i=0;i<values.length;i++){selection.values[values[i]]=true;}me.SetIsUpdateStateEnabled(selectAllId,false);selectableControl.SetSelection(selectableControlId,type,values);me.SetIsUpdateStateEnabled(selectAllId,true);if(triggerFilterTypeUpdateEvent){var selectionFilterTypeEvent=me.GetOnSelectionFilterTypeUpdateEvent(id);selectionFilterTypeEvent.Trigger(checkboxNode.checked,selection.type);}var selectionUpdateEvent=me.GetOnSelectionUpdateEvent(id);selectionUpdateEvent.Trigger(selection.type,selection.selectedCount);},UpdateStateEnabled:{}};D2L.LP.Web.UI.Desktop.Controls.SelectAll.SelectionInfo=D2L.Class.Create({Construct:function(type,values){if(type===undefined){type=D2L.LP.LayeredArch.SelectionFilterType.None;}if(values===undefined){values='';}this.m_type=type;this.m_values=values;},_deserialize:function(deserializer){this.m_type=deserializer.GetMember('type');this.m_values=deserializer.GetMember('values');},_serialize:function(serializer){serializer.AddMember('type',this.m_type);serializer.AddMember('values',this.m_values);},GetKeys:function(){return D2L.LP.Web.UI.Selection.DecodeKeys(this.m_values);},GetType:function(){return this.m_type;},GetEncodedValues:function(){return this.m_values;}});D2L.LP.Web.UI.Desktop.Controls.SelectAllLink={Clear:function(id){var node=D2L.LP.Web.UI.Desktop.Controls.SelectAllLink.GetNodeByChildId(id);node.d2l_selectionControl.SelectAll(node.d2l_selectionControlId,D2L.LP.LayeredArch.SelectionFilterType.Some);var infoNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-selectall-link-info',node);var pageResultNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(infoNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(pageResultNode));D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',pageResultNode);},GetNodeByChildId:function(id){return D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-selectall-link',D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));},SelectAll:function(id){var node=D2L.LP.Web.UI.Desktop.Controls.SelectAllLink.GetNodeByChildId(id);node.d2l_selectionControl.SelectAll(node.d2l_selectionControlId,D2L.LP.LayeredArch.SelectionFilterType.All);var infoNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-selectall-link-info',node);var pageResultNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(infoNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',pageResultNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(pageResultNode));}};D2L.LP.Web.UI.Desktop.Controls.SelectList={GetInput:function(id,noThrow){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!noThrow&&input===null){throw'SelectList not found: \''+id.GetValue()+'\'.';}return input;},GetSelectedValue:function(id,defaultValue){var noThrow=defaultValue!==undefined;var input=D2L.LP.Web.UI.Desktop.Controls.SelectList.GetInput(id,noThrow);if(input===null){return defaultValue;}var option=input.options[input.selectedIndex];return option.value;},GetValues:function(id){var input=D2L.LP.Web.UI.Desktop.Controls.SelectList.GetInput(id);var values=[];for(var i=0;i<input.options.length;i++){values.push(input.options[i].value);}return values;},SetIsVisibleFunction:function(id,isVisible){var node=D2L.LP.Web.UI.Desktop.Controls.SelectList.GetInput(id);var container=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-select-container',node);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(container,isVisible);},SetSelectedValue:function(id,value){var input=D2L.LP.Web.UI.Desktop.Controls.SelectList.GetInput(id);for(var i=0;i<input.options.length;i++){if(input.options[i].value===value){input.selectedIndex=i;break;}}},Focus:function(id){var input=D2L.LP.Web.UI.Desktop.Controls.SelectList.GetInput(id);input.focus();},ValidateRequired:function(id){var input=D2L.LP.Web.UI.Desktop.Controls.SelectList.GetInput(id);if(input.options.length===0){return false;}var option=input.options[input.selectedIndex];if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-selectlist-nonselectable',option)){return false;}return true;},GetSelectedText:function(id,defaultValue){var noThrow=defaultValue!==undefined;var input=D2L.LP.Web.UI.Desktop.Controls.SelectList.GetInput(id,noThrow);if(input===null){return defaultValue;}var option=input.options[input.selectedIndex];if(option===null){return defaultValue;}return option.text;}};D2L.LP.Web.UI.Desktop.Controls.SimpleOverlay={IsOpen:function(simpleOverlayId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(simpleOverlayId.GetValue());if(!node||!node.classList){return false;}return node.classList.contains('d2l-simple-overlay-open');},Open:function(simpleOverlayId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(simpleOverlayId.GetValue());if(!node||typeof node.open!=='function'){console.log('Unable to open the simple overlay.');return;}node.open();},Close:function(simpleOverlayId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(simpleOverlayId.GetValue());if(!node||typeof node.close!=='function'){console.log('Unable to close the simple overlay.');return;}node.close();}};D2L.LP.Web.UI.Desktop.Controls.SemanticEditor={CreateRange:function(start,end){return{Start:start,End:end};},GetContainedRanges:function(text,selection,tag){var me=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;var ranges=[];var startIndex=null;var endIndex=null;var index=text.indexOf(tag);while(index>-1){if(startIndex==null){startIndex=index;if(startIndex>selection.End){break;}}else{endIndex=index;if(startIndex<=selection.End&&endIndex>=selection.Start){ranges.push(me.CreateRange(startIndex,endIndex+tag.length));}if(endIndex>selection.End){break;}startIndex=null;endIndex=null;}index=text.indexOf(tag,index+tag.length);}return ranges;},GetTextAreaNode:function(node){return contentNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-semantic-editor-content',node);},GetLineRange:function(text,index){var me=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;if(index>text.length){return null;}var startIndex=text.substring(0,index).lastIndexOf('\n',index);if(startIndex==-1){startIndex=0;}var endIndex=text.indexOf('\n',index);if(endIndex==-1){endIndex=text.length;}return me.CreateRange(startIndex,endIndex);},GetSelectionRange:function(textAreaNode){var me=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;var selection;if(textAreaNode.selectionStart!==undefined){selection=me.CreateRange(textAreaNode.selectionStart,textAreaNode.selectionEnd);}else if(document.selection){var range=document.selection.createRange();var range1=textAreaNode.createTextRange();var range2=range1.duplicate();range1.moveToBookmark(range.getBookmark());range2.setEndPoint("EndToStart",range1);var newlineCount=0;var range2Length=range2.text.replace(/\r\n/g,function(){newlineCount++;return"\r";}).length;var offset=range2.moveStart("character",range2Length);while(range2.compareEndPoints("StartToEnd",range2)==-1){offset+=2;var a=range2.moveStart("character",1);}offset+=newlineCount;selection=me.CreateRange(offset,offset+range.text.length);}else{selection=me.CreateRange(0,0);}return selection;},IsContainedIn:function(index,ranges){for(var i=0;i<ranges.length;i++){if(index>ranges[i].Start&&index<ranges[i].End){return true;}}return false;},SetSelection:function(textAreaNode,selection){var node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-semantic-editor',textAreaNode);node.d2l_selectionStart=selection.Start;node.d2l_selectionEnd=selection.End;if(textAreaNode.selectionStart!==undefined){textAreaNode.selectionStart=selection.Start;textAreaNode.selectionEnd=selection.End;}else if(document.selection){var range=textAreaNode.createTextRange();range.moveStart("character",selection.Start);range.moveEnd("character",selection.End);range.select();}textAreaNode.focus();},ToggleSymmetricTags:function(node,tag){var me=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;var textAreaNode=me.GetTextAreaNode(node);var ranges=me.GetContainedRanges(textAreaNode.value,me.CreateRange(node.d2l_selectionStart,node.d2l_selectionEnd),tag);var startTag=me.IsContainedIn(node.d2l_selectionStart,ranges)?'':tag;var endTag=me.IsContainedIn(node.d2l_selectionEnd,ranges)?'':tag;if(ranges.length==1&&startTag==''&&endTag==''){startTag=tag;endTag=tag;}var tagPattern=tag.replace(/\*/g,'\\*');var singleTagPattern=new RegExp(tagPattern,"g");var doubleTagPattern=new RegExp(tagPattern+tagPattern,"g");var leadingText=(textAreaNode.value.substring(0,node.d2l_selectionStart)+startTag).replace(doubleTagPattern,'');var text=textAreaNode.value.substring(node.d2l_selectionStart,node.d2l_selectionEnd).replace(singleTagPattern,'');var trailingText=(endTag+textAreaNode.value.substring(node.d2l_selectionEnd)).replace(doubleTagPattern,'');textAreaNode.value=leadingText+text+trailingText;me.SetSelection(textAreaNode,me.CreateRange(leadingText.length,leadingText.length+text.length));}};D2L.LP.Web.UI.Desktop.Controls.SemanticEditor.IPlugin=function(){};D2L.LP.Web.UI.Desktop.Controls.SemanticEditor.IPlugin.prototype.OnEditorUpdate=function(){};D2L.LP.Web.UI.Desktop.Controls.SemanticEditor.BoldPlugin=D2L.Class.Create({Construct:function(){this.m_buttonId;this.m_isEnabled=false;},OnEditorUpdate:function(context){var isEnabled=context.Selection.End>context.Selection.Start;if(this.m_isEnabled!==isEnabled){D2L.LP.Web.UI.Desktop.Controls.Button.SetIsEnabled(this.m_buttonId,isEnabled);this.m_isEnabled=isEnabled;}},_deserialize:function(deserializer){this.m_buttonId=deserializer.GetMember('ButtonId');},_serialize:function(serializer){return;}});D2L.LP.Web.UI.Desktop.Controls.SemanticEditor.ToggleBold=function(editorId){var editor=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;var id=editorId.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);editor.ToggleSymmetricTags(node,'**');};D2L.LP.Web.UI.Desktop.Controls.SemanticEditor.UnorderedListPlugin=D2L.Class.Create({Construct:function(){this.m_buttonId;this.m_isEnabled=false;},OnEditorUpdate:function(context){var isEnabled=true;if(this.m_isEnabled!==isEnabled){D2L.LP.Web.UI.Desktop.Controls.Button.SetIsEnabled(this.m_buttonId,isEnabled);this.m_isEnabled=isEnabled;}},OnKeyUp:function(context,keyCode){var editor=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;var textAreaNode=context.TextAreaNode;if(keyCode==13){var lineRange=editor.GetLineRange(textAreaNode.value,context.Selection.Start-1);var isListItem=/^[\n\t\s]*\* /.test(textAreaNode.value.substring(lineRange.Start,lineRange.End));if(isListItem){var whiteSpace=textAreaNode.value.substring(lineRange.Start,textAreaNode.value.indexOf('*',lineRange.Start)).replace(/^\n/,'');textAreaNode.value=textAreaNode.value.substring(0,context.Selection.Start)+whiteSpace+'* '+textAreaNode.value.substring(context.Selection.Start);var updateLength=whiteSpace.length+2;editor.SetSelection(textAreaNode,editor.CreateRange(context.Selection.Start+updateLength,context.Selection.End+updateLength));}}},_deserialize:function(deserializer){this.m_buttonId=deserializer.GetMember('ButtonId');},_serialize:function(serializer){return;}});D2L.LP.Web.UI.Desktop.Controls.SemanticEditor.ToggleUnorderedList=function(editorId){var editor=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;var id=editorId.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var textAreaNode=editor.GetTextAreaNode(node);var lineRange=editor.GetLineRange(textAreaNode.value,node.d2l_selectionStart);var isListItem=/^[\n\t\s]*\* /.test(textAreaNode.value.substring(lineRange.Start,lineRange.End));var newSelection;if(!isListItem){textAreaNode.value=textAreaNode.value.substring(0,lineRange.Start)+'* '+textAreaNode.value.substring(lineRange.Start);newSelection=editor.CreateRange(node.d2l_selectionStart+2,node.d2l_selectionEnd+2);}else{textAreaNode.value=textAreaNode.value.substring(0,lineRange.Start)+textAreaNode.value.substring(textAreaNode.value.indexOf('* ',lineRange.Start)+2);newSelection=editor.CreateRange(node.d2l_selectionStart-2,node.d2l_selectionEnd-2);}editor.SetSelection(textAreaNode,newSelection);};D2L.LP.Web.UI.Desktop.Controls.Shim={m_shim:null,m_zIndex:1000,Delete:function(handle){if(!handle){return;}var ui=handle.rootWin?handle.rootWin.D2L.LP.Web.UI:D2L.LP.Web.UI;var me=ui.Desktop.Controls.Shim;var resetRoles=function(nodes){for(var i=0;i<nodes.length;i++){var node=nodes[i];if(node.setAttribute===undefined){continue;}if(node.d2l_role===''){node.removeAttribute('role');node.d2l_role=undefined;}else{D2L.LP.Web.UI.Html.Aria.SetRole(node,node.d2l_role);node.d2l_role=undefined;}}};var resetAria=function(nodes){for(var i=0;i<nodes.length;i++){var node=nodes[i];if(node.setAttribute===undefined){continue;}if(node.d2l_aria_hidden===''){node.removeAttribute('aria-hidden');node.d2l_aria_hidden=undefined;}else{D2L.LP.Web.UI.Html.Dom.SetAttribute(node,'aria-hidden',node.d2l_aria_hidden);node.d2l_aria_hidden=undefined;}}};var shimInfo=handle.infos[handle.infos.length-1];resetRoles(shimInfo.hiddenNodes);resetAria(shimInfo.hiddenAriaNodes);var me=handle.rootWin.D2L.LP.Web.UI.Desktop.Controls.Shim;if(handle.infos.length>1){handle.infos.pop();me.m_shim.shim.style.zIndex=handle.infos[handle.infos.length-1].zIndex;return;}me.RemoveShim(handle);me.m_shim=null;},GetZIndex:function(){D2L.LP.Web.UI.Desktop.Controls.Shim.m_zIndex++;return D2L.LP.Web.UI.Desktop.Controls.Shim.m_zIndex;},AddShim:function(handle,w,node,isTransparent){var me=handle.rootWin.D2L.LP.Web.UI.Desktop.Controls.Shim;var shim=document.createElement('div');shim.className='d2l-shim';shim.style.zIndex=handle.infos[handle.infos.length-1].zIndex;handle.shim=shim;if(!isTransparent){shim.classList.add('d2l-shim-opaque');document.body.classList.add('d2l-shim-body-overflow');}handle.rootWin.document.body.appendChild(shim);},RemoveShim:function(handle){var shim=handle.rootWin.D2L.LP.Web.UI.Desktop.Controls.Shim.m_shim.shim;if(shim.classList.contains('d2l-shim-opaque')){var removeNode=function(){shim.removeEventListener('transitionend',removeNode,false);D2L.LP.Web.UI.Html.Dom.RemoveElement(shim);};shim.addEventListener('transitionend',removeNode,false);shim.classList.remove('d2l-shim-opaque');document.body.classList.remove('d2l-shim-body-overflow');setTimeout(function(){removeNode();},300);}else{D2L.LP.Web.UI.Html.Dom.RemoveElement(shim);}},HideAccessibleElements:function(handle){var shimInfo=handle.infos[handle.infos.length-1];var recurse=function(node){if(node==handle.dialog||node==shimInfo.node||node.setAttribute===undefined||node.nodeName===undefined||node.nodeName.toLowerCase()==='iframe'){return;}var oldRole=node.getAttribute('role');if(node.d2l_role===undefined){shimInfo.hiddenNodes.push(node);if(oldRole!=null){node.d2l_role=oldRole;}else{node.d2l_role='';}}D2L.LP.Web.UI.Html.Aria.SetRole(node,'presentation');if(node.nodeName==='FORM'||node.nodeName==='A'){var oldHidden=node.getAttribute('aria-hidden');if(node.d2l_aria_hidden===undefined){shimInfo.hiddenAriaNodes.push(node);if(oldHidden!=null){node.d2l_aria_hidden=oldHidden;}else{node.d2l_aria_hidden='';}}D2L.LP.Web.UI.Html.Dom.SetAttribute(node,'aria-hidden','true');}for(var i=0;i<node.childNodes.length;i++){recurse(node.childNodes[i]);}};recurse(handle.rootWin.document.body);},Create:function(node,isTransparent){var rootWindow=null;var currWin=window;if(node.d2l_handle&&node.d2l_handle.rootWin){rootWindow=node.d2l_handle.rootWin;}else{while(currWin!==null&&currWin.D2L&&currWin.D2L.LP){if(currWin==rootWindow){break;}rootWindow=currWin;try{var throwsIfXDomain=currWin.parent.D2L;currWin=currWin.parent;}catch(xdomainErr){}}}var me=rootWindow.D2L.LP.Web.UI.Desktop.Controls.Shim;var shimInfo={node:node,zIndex:me.GetZIndex(),hiddenNodes:[],hiddenAriaNodes:[]};if(me.m_shim===null){var handle={shim:null,onresize:null,node:node,infos:[shimInfo],win:window,rootWin:rootWindow};me.AddShim(handle,window,window.document,isTransparent);me.m_shim=handle;}else{me.m_shim.infos.push(shimInfo);me.m_shim.shim.style.zIndex=shimInfo.zIndex;}me.HideAccessibleElements(me.m_shim);node.style.zIndex=me.GetZIndex();return me.m_shim;}};D2L.LP.Web.UI.Desktop.Controls.Sort={GetNode:function(id){var parent=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var node=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-sort',parent);if(node===null){throw'Sort not found: \''+id.GetValue()+'\'.';}return node[0];},GetSelectedSortField:function(id){var selectList=D2L.LP.Web.UI.Desktop.Controls.Sort.GetNode(id);return selectList.value;},GetSelectedSortFieldIsAscending:function(id){var selectList=D2L.LP.Web.UI.Desktop.Controls.Sort.GetNode(id);var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(selectList);return D2L.LP.Web.UI.Html.Dom.GetAttribute(hiddenNode,'value');}};D2L.LP.Web.UI.Desktop.Controls.Switch={GetIsOn:function(id){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(elem===null){throw'Switch not found \''+id.GetValue()+'\'.';}return elem.on;},SetIsEnabled:function(id,isEnabled){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(elem===null){throw'Switch not found \''+id.GetValue()+'\'.';}elem.disabled=!isEnabled;},SetIsOn:function(id,isOn){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(elem===null){return;}elem.on=isOn;}};D2L.LP.Web.UI.Desktop.Controls.TabMenu={Init:function(node){var direction=$('body').attr('dir');var isRtl=false;if(direction&&direction.toLowerCase()==='rtl'){isRtl=true;}node.is_rtl=isRtl;$('.vui-tabmenu-item a',$(node)).each(function(i){var clickStr=$(this).attr('onclick');if(clickStr&&clickStr.length>0){$(this).removeAttr('onclick');$(this).attr('data-tabmenu-onclick',clickStr);}$(this).on('click',function(e,data){if(!D2L.LP.Web.UI.Desktop.Controls.TabMenu.IsSelectedTab(node,this)){D2L.LP.Web.UI.Desktop.Controls.TabMenu.ClearSelectedTab(node);D2L.LP.Web.UI.Desktop.Controls.TabMenu.SelectTab(node,this);if(clickStr&&clickStr.length>0){eval(clickStr);}if(!data||!data.fromKeypress){$(node).trigger('vui.tabmenu.content.focus');}}});});$(node).on('keydown',function(e){if(e.keyCode===37||e.keyCode===38){D2L.LP.Web.UI.Desktop.Controls.TabMenu.SelectPreviousTab(node);e.preventDefault();e.stopPropagation();}else if(e.keyCode===39||e.keyCode===40){D2L.LP.Web.UI.Desktop.Controls.TabMenu.SelectNextTab(node);e.preventDefault();e.stopPropagation();}else if(e.keyCode===36){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();var tabNode;if(isRtl){tabNode=$('.vui-tabmenu-item a',$(node)).last();}else{tabNode=$('.vui-tabmenu-item a',$(node)).first();}tabNode.trigger('click',{fromKeypress:true});tabNode.trigger('focus');}else if(e.keyCode===35){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();var tabNode;if(isRtl){tabNode=$('.vui-tabmenu-item a',$(node)).first();}else{tabNode=$('.vui-tabmenu-item a',$(node)).last();}tabNode.trigger('click',{fromKeypress:true});tabNode.trigger('focus');}else if(e.keyCode===9){}else{e.preventDefault();e.stopPropagation();}});$(node).on('vui-tabmenu-select-prev',function(e){D2L.LP.Web.UI.Desktop.Controls.TabMenu.SelectPreviousTab(node);});$(node).on('vui-tabmenu-select-next',function(e){D2L.LP.Web.UI.Desktop.Controls.TabMenu.SelectNextTab(node);});var totalTabs=$('.vui-tabmenu-item',$(node)).length;var width=(100/totalTabs).toFixed(5)+'%';$('.vui-tabmenu-item',$(node)).width(width);var currentNode=$('.vui-tabmenu-item-select a',$(node));if(currentNode.length>0){D2L.LP.Web.UI.Desktop.Controls.TabMenu.SelectTab(node,currentNode);}$(node).one('vui.mediaplayer.focusoverride',function(){var currentNode=$('.vui-tabmenu-item-select a',$(node));if(currentNode.length>0){currentNode.focus();}});},ClearSelectedTab:function(parentNode){$('.vui-tabmenu-item',$(parentNode)).removeClass('vui-tabmenu-item-select').removeClass('vui-tabmenu-item-select-prev');var links=$('.vui-tabmenu-item a',$(parentNode));links.attr('aria-selected','false');links.attr('tabindex','-1');return;},SelectTab:function(parentNode,tabNode){var $tabNode=$(tabNode),onFirstVisible=$tabNode.attr('data-on-first-visible');$tabNode.parent().addClass('vui-tabmenu-item-select');$tabNode.parent().prev().addClass('vui-tabmenu-item-select-prev');$tabNode.attr('aria-selected','true');$tabNode.attr('tabindex','0');if(onFirstVisible){$tabNode.removeAttr('data-on-first-visible');eval(onFirstVisible);}},SelectPreviousTab:function(parentNode){var currentNode=D2L.LP.Web.UI.Desktop.Controls.TabMenu.GetCurrentTab(parentNode);var prevNode=currentNode.parent().prev().find('a');if(prevNode.length===0){prevNode=$('.vui-tabmenu-item a',$(parentNode)).last();}D2L.LP.Web.UI.Desktop.Controls.TabMenu.ClearSelectedTab(parentNode);prevNode.trigger('click',{fromKeypress:true});prevNode.trigger('focus');},SelectNextTab:function(parentNode){var currentNode=D2L.LP.Web.UI.Desktop.Controls.TabMenu.GetCurrentTab(parentNode);var nextNode=currentNode.parent().next().find('a');if(nextNode.length===0){nextNode=$('.vui-tabmenu-item a',$(parentNode)).first();}D2L.LP.Web.UI.Desktop.Controls.TabMenu.ClearSelectedTab(parentNode);nextNode.trigger('click',{fromKeypress:true});nextNode.trigger('focus');},GetCurrentTab:function(parentNode){var currentNode=$('.vui-tabmenu-item-select a',$(parentNode));if(currentNode.length===0){currentNode=$('.vui-tabmenu-item:first a',$(parentNode));}return currentNode;},IsSelectedTab:function(parentNode,tabNode){var current=$('.vui-tabmenu-item-select a',$(parentNode));if(current.length>0&&current[0]===tabNode){return true;}return false;}};D2L.LP.Web.UI.Desktop.Controls.TextBlock={Focus:function(id){id.$().attr('tabindex','-1').focus();},SetText:function(id,val){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node){return;}node.innerHTML=val;},GetText:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node){return;}return node.innerHTML;},SetTextEncoded:function(id,val){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node){return;}if(node.textContent!==undefined){node.textContent=val;}else if(node.innerText!==undefined){node.innerText=val;}}};D2L.LP.Web.UI.Desktop.Controls.TimeSelector={IntervalEnum:{Five:5,Ten:10,Fifteen:15,Twenty:20,Thirty:30,Sixty:60},BuildSelectList:function(nodes,timeInterval){if(timeInterval===null||timeInterval==undefined||timeInterval<5||timeInterval>60){timeInterval=30;}if(nodes.list===null){nodes.list=document.createElement('ul');D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.list,'role','listbox');nodes.list.className='d2l-time-selector-list';nodes.floatingContainer.appendChild(nodes.list);}while(nodes.list.childNodes.length>0){nodes.list.removeChild(nodes.list.firstChild);}var locale=D2L.LP.Globalization.Locale;var dateTimeFormatter=locale.GetDateTimeFormatter();var hour=0;var minute=0;while(hour<24){var time=new D2L.LocalTime(hour,minute,0);var timeStr=dateTimeFormatter.FormatTime(time);var item=document.createElement('li');D2L.LP.Web.UI.Html.Dom.SetAttribute(item,'role','option');var id=new D2L.LP.Web.UI.Html.UniqueHtmlId();item.id=id.GetValue();item.d2l_time=time;item.d2l_index=nodes.list.childNodes.length;item.appendChild(document.createTextNode(timeStr));nodes.list.appendChild(item);minute+=timeInterval;if(minute>=60){++hour;minute-=60;}}},GetNodes:function(id){var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null){throw'TimeSelector not found: \''+idVal+'\'.';}var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;return me.GetUseLegacySelector()?me.GetNodesByNodeLegacy(node):me.GetNodesByNode(node);},GetNodesByNodeLegacy:function(node){var container=node.parentNode;var hour=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-form-balloon',hour)){hour=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(hour);}var minute=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(hour);var isEnabled=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(minute);var floatingContainer=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(isEnabled);var list=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-time-selector-list',floatingContainer);return{container:container,floatingContainer:floatingContainer,hour:hour,minute:minute,isEnabled:isEnabled,edit:node,list:list};},GetNodesByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;if(me.GetUseLegacySelector()){return me.GetNodesByNodeLegacy(node);}var container=node.parentNode;var hour=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-form-balloon',hour)){hour=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(hour);}var minute=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(hour);var isEnabled=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(minute);return{container:container,hour:hour,minute:minute,isEnabled:isEnabled,edit:node};},GetTime:function(id){var nodes=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetNodes(id);return D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetTimeNodes(nodes);},GetTimeNodes:function(nodes){var hour=parseInt(nodes.hour.value);var minute=parseInt(nodes.minute.value);var result=new D2L.LocalTime(hour,minute,0);return result;},IsEnabledNodes:function(nodes){return!nodes.edit.disabled;},SetEnforceTimeIntervals:function(id,isEnforced){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;if(me.GetUseLegacySelector()){id.$().data('enforcetimeintervals',isEnforced);return;}var nodes=me.GetNodes(id);if(isEnforced)nodes.edit.setAttribute('enforce-time-intervals','enforce-time-intervals');else nodes.edit.removeAttribute('enforce-time-intervals');},SetIsEnabled:function(id,isEnabled){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;me.SetIsEnabledNodes(me.GetNodes(id),isEnabled);},SetIsEnabledNodes:function(nodes,isEnabled){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;nodes.isEnabled.value=isEnabled?'1':'0';if(isEnabled)nodes.edit.removeAttribute('disabled');else nodes.edit.setAttribute('disabled','disabled');var time=me.GetTimeNodes(nodes);var customEvent=new CustomEvent('d2l-time-selector-change',{detail:{time:time,prevTime:time},bubbles:true});nodes.container.dispatchEvent(customEvent);},SetIsVisible:function(id,isVisible){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;me.SetIsVisibleNode(me.GetNodes(id).container,isVisible);},SetIsVisibleNode:function(node,isVisible){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,isVisible);},SetTime:function(id,time){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var nodes=me.GetNodes(id);me.SetTimeNodes(nodes,time);},SetTimeInterval:function(id,interval){interval=parseInt(interval);var intervalValue='thirty';if(isNaN(interval)){interval=30;}var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var intervalEnum=me.IntervalEnum;for(var timeInterval in intervalEnum){var timeValue=intervalEnum[timeInterval];if(interval<=timeValue){interval=timeValue;intervalValue=timeInterval;break;}}if(interval>intervalEnum.Sixty){interval=60;intervalValue='sixty';}if(me.GetUseLegacySelector()){id.$().data('timeinterval',interval);}else{var nodes=me.GetNodes(id);nodes.edit.setAttribute('time-interval',intervalValue.toLowerCase());}},SetTimeNodesLegacy:function(nodes,time){var prevTime=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetTimeNodes(nodes);var locale=D2L.LP.Globalization.Locale;var dateTimeFormatter=locale.GetDateTimeFormatter();var timeStr=dateTimeFormatter.FormatTime(time);var oldTimeStr=nodes.edit.value;nodes.edit.value=timeStr;nodes.hour.value=time.GetHour();nodes.minute.value=time.GetMinute();var customEvent=new CustomEvent('d2l-time-selector-change',{detail:{time:time,prevTime:prevTime},bubbles:true});nodes.container.dispatchEvent(customEvent);if(timeStr!=oldTimeStr){$(nodes.edit).trigger('change');}},SetTimeNodeValues:function(nodes,hour,minute){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var prevTime=me.GetTimeNodes(nodes);nodes.hour.value=hour;nodes.minute.value=minute;var currTime=me.GetTimeNodes(nodes);var customEvent=new CustomEvent('d2l-time-selector-change',{detail:{time:currTime,prevTime:prevTime},bubbles:true});nodes.container.dispatchEvent(customEvent);},SetTimeNodes:function(nodes,time){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;if(me.GetUseLegacySelector()){return me.SetTimeNodesLegacy(nodes,time);}var hour=time.GetHour();var minute=time.GetMinute();var hourString=hour.toString();var minuteString=minute.toString();if(hourString.length<2)hourString='0'+hourString;if(minuteString.length<2)minuteString='0'+minuteString;nodes.edit.value=hourString+':'+minuteString+':00';me.SetTimeNodeValues(nodes,hour,minute);},GetUseLegacySelector:function(){return!D2L.LP.Web.UI.Flags.Flag('US112810-date-time-components',true);}};D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder={Init:function(startId,endId,autoShiftTimes,inclusive){var me=D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder;var ts=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var startNodes=ts.GetNodes(startId);var endNodes=ts.GetNodes(endId);$(startNodes.container).on('d2l-time-selector-change',function(evt){var time=evt.detail.time;var prevTime=evt.detail.prevTime;me.OnStartChange(startNodes,endNodes,time,prevTime,true,autoShiftTimes,inclusive);});$(endNodes.container).on('d2l-time-selector-change',function(){me.RenderValidation(startNodes,endNodes,true,inclusive);});},OnStartChange:function(startNodes,endNodes,time,prevTime,isSameDay,autoShiftTimes,inclusive){var me=D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder;var ts=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var endTime=ts.GetTimeNodes(endNodes);var wasValid=me.Validate(prevTime,endTime,inclusive);if(isSameDay&&wasValid&&autoShiftTimes){var hourDiff=time.GetHour()-prevTime.GetHour();var minuteDiff=time.GetMinute()-prevTime.GetMinute();var newEndHour=endTime.GetHour()+hourDiff;var newEndMinute=endTime.GetMinute()+minuteDiff;if(newEndMinute>59){newEndHour++;newEndMinute-=60;}else if(newEndMinute<0){newEndHour--;newEndMinute+=60;}if(newEndHour>23){newEndHour=23;newEndMinute=59;}else if(newEndHour<0){newEndHour=0;newEndMinute=0;}ts.SetTimeNodes(endNodes,new D2L.LocalTime(newEndHour,newEndMinute,0));}me.RenderValidation(startNodes,endNodes,isSameDay,inclusive);},RenderValidation:function(startNodes,endNodes,isSameDay,inclusive){var me=D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder;var isVisible=D2L.LP.Web.UI.Html.Dom.IsVisible(endNodes.edit);var isValid=me.ValidateNodes(startNodes,endNodes,inclusive);if(!isSameDay||isValid){endNodes.edit.removeAttribute('aria-invalid');startNodes.edit.removeAttribute('aria-invalid');}else{endNodes.edit.setAttribute('aria-invalid','true');if(!isVisible){startNodes.edit.setAttribute('aria-invalid','true');}}},ValidateIds:function(startId,endId,inclusive){var ts=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;return D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder.ValidateNodes(ts.GetNodes(startId),ts.GetNodes(endId),inclusive);},ValidateNodes:function(startNodes,endNodes,inclusive){var ts=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var startIsEnabled=ts.IsEnabledNodes(startNodes);var endIsEnabled=ts.IsEnabledNodes(endNodes);if(!startIsEnabled||!endIsEnabled){return true;}var startTime=ts.GetTimeNodes(startNodes);var endTime=ts.GetTimeNodes(endNodes);return D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder.Validate(startTime,endTime,inclusive);},Validate:function(startTime,endTime,inclusive){if(startTime.GetHour()===endTime.GetHour()){return inclusive?startTime.GetMinute()<=endTime.GetMinute():startTime.GetMinute()<endTime.GetMinute();}return startTime.GetHour()<endTime.GetHour();}};D2L.LP.Web.UI.Desktop.Controls.Toggle={GetNodes:function(id){var node=document.getElementById(id.GetValue());return{node:node,activeNode:document.getElementById(node.getAttribute('data-active-id')),inactiveNode:document.getElementById(node.getAttribute('data-inactive-id'))};},SetIsActiveFunction:function(id,setActive){var nodes=D2L.LP.Web.UI.Desktop.Controls.Toggle.GetNodes(id);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(nodes.activeNode,setActive);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(nodes.inactiveNode,!setActive);},GetIsActiveFunction:function(id){var nodes=D2L.LP.Web.UI.Desktop.Controls.Toggle.GetNodes(id);var isActive=!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',nodes.activeNode);return isActive;},Focus:function(id){var nodes=D2L.LP.Web.UI.Desktop.Controls.Toggle.GetNodes(id);var isActive=D2L.LP.Web.UI.Desktop.Controls.Toggle.GetIsActiveFunction(id);D2L.LP.Web.UI.Html.Dom.FocusNode(isActive?nodes.activeNode:nodes.inactiveNode);},ToggleFunction:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Toggle;var isActive=me.GetIsActiveFunction(id);me.SetIsActiveFunction(id,!isActive);}};D2L.LP.Web.UI.Desktop.Controls.ToggleContainer={Expand:function(id){var node=document.getElementById(id.GetValue());var toggleButtons=node.querySelectorAll('d2l-button-icon');if(!toggleButtons[0].classList.contains('d2l-hidden')){toggleButtons[0].click();}},Collapse:function(id){var node=document.getElementById(id.GetValue());var toggleButtons=node.querySelectorAll('d2l-button-icon');if(!toggleButtons[1].classList.contains('d2l-hidden')){toggleButtons[1].click();}}};D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput={GetValue:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var inputs=node.getElementsByTagName('input');var value='none';var originalValue='none';for(var i=0;i<inputs.length;i++){if(D2L.LP.Web.UI.Html.Dom.GetAttribute(inputs[i],'type')=='radio'&&inputs[i].checked){value=inputs[i].value;}else if(D2L.LP.Web.UI.Html.Dom.GetAttribute(inputs[i],'type')=='hidden'){originalValue=inputs[i].value;}}var param=new D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput.Param(value,originalValue);return param;},InitHandle:function(node){var handle={node:node,labels:[],noneInput:null,votesNode:null,votesNodeAccessibleNone:null,votesNodeAccessibleSingular:null,votesNodeAccessiblePlural:null,currentMessageNode:null,upMessageNode:null,downMessageNode:null,noneMessageNode:null,showToolTip:true,upVotes:0,downVotes:0};handle.labels=node.getElementsByTagName('label');var noneLabel=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-updownvote-none',node)[0];handle.noneInput=noneLabel.getElementsByTagName('input')[0];handle.votesNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-updownvote-votes',node)[0];handle.showToolTip=D2L.LP.Web.UI.Html.Dom.HasAttribute(handle.votesNode,'title');var messages=handle.votesNode.getElementsByTagName('span');for(var i=0;i<messages.length;i++){if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',messages[i])){handle.currentMessageNode=messages[i];break;}}handle.upMessageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-updownvote-msg-up',handle.votesNode)[0];handle.downMessageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-updownvote-msg-down',handle.votesNode)[0];handle.noneMessageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-updownvote-msg-none',handle.votesNode)[0];handle.upVotes=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-d2l-upvotes');handle.downVotes=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-d2l-downvotes');handle.votesNodeAccessibleNone=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-accessible-none",handle.votesNode)[0];handle.votesNodeAccessibleSingular=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-accessible-singular",handle.votesNode)[0];handle.votesNodeAccessiblePlural=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-accessible-plural",handle.votesNode)[0];return handle;},SetMessage:function(handle,messageNode){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',handle.currentMessageNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',messageNode);if(handle.showToolTip){var title=D2L.LP.Web.UI.Html.Dom.GetAttribute(messageNode,'data-d2l-title');D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.votesNode,'title',title);}handle.currentMessageNode=messageNode;},SetSelected:function(handle,index,clickLabel){var me=D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput;var label=handle.labels[index];var input=label.getElementsByTagName('input')[0];if(clickLabel){if(input.checked){handle.noneInput.checked=true;}else{input.checked=true;}}if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-updownvote-active',label)){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-updownvote-active',label);if(index==0){handle.upVotes--;}else if(index==1){handle.downVotes--;}me.SetMessage(handle,handle.noneMessageNode);}else{var selectedNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-updownvote-active',handle.node)[0];D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-updownvote-active',selectedNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-updownvote-active',label);if(index==0){handle.upVotes++;me.SetMessage(handle,handle.upMessageNode);}else if(index==1){handle.downVotes++;me.SetMessage(handle,handle.downMessageNode);}}var sum=handle.currentMessageNode.textContent;var textContentBlocks=handle.votesNodeAccessiblePlural.textContent.split(' ');for(var i=0;i<textContentBlocks.length;i++){if(isNaN(textContentBlocks[i]))continue;textContentBlocks[i]=sum;break;}handle.votesNodeAccessiblePlural.textContent=textContentBlocks.join(' ');switch(sum){case 0:D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',handle.votesNodeAccessibleNone);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',handle.votesNodeAccessibleSingular);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',handle.votesNodeAccessiblePlural);break;case 1:D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',handle.votesNodeAccessibleNone);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',handle.votesNodeAccessibleSingular);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',handle.votesNodeAccessiblePlural);break;default:D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',handle.votesNodeAccessibleNone);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',handle.votesNodeAccessibleSingular);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',handle.votesNodeAccessiblePlural);break;}var onChange=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.node.id);if(onChange!==null){onChange();}}};D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput.Param=D2L.Class.Create({Construct:function(value,originalValue){if(value===undefined){value='';originalValue='';}this.m_value=value;this.m_originalValue=originalValue;},_serialize:function(serializer){serializer.AddMember('value',this.m_value);serializer.AddMember('originalValue',this.m_originalValue);},GetValue:function(){return this.m_value;},GetOriginalValue:function(){return this.m_originalValue;}});D2L.LP.Web.UI.Desktop.Controls.ValidatorCustom={Init:function(form,node){if(form===null||node===null){return;}if(form.d2l_validators===undefined){form.d2l_validators=[];}var validator=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id);if(validator===null){throw'Validator not found: \''+node.id+'\'.';}var initFunc=validator[3];if(initFunc!=null){initFunc();}form.d2l_validators.push(function(){var newNode=D2L.LP.Web.UI.Html.Dom.GetElementById(node.id);var sourceNode=D2L.LP.Web.UI.Html.Dom.GetElementById(validator[0]);var isVisible=true;if(sourceNode!==null){isVisible=D2L.LP.Web.UI.Html.Dom.IsVisible(sourceNode);}validator=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id);if(validator===null){throw'Validator not found: \''+node.id+'\'.';}if(newNode===null||!isVisible){validator[1]=function(){return true;};}var validateNode=D2L.LP.Web.UI.Html.Dom.GetElementById(validator[0]);var focusId=null;var inputId=null;if(validateNode!==null){focusId=D2L.LP.Web.UI.Html.Dom.GetAttribute(validateNode,'data-d2l-validatefocus');if(focusId==null){focusId=validator[0];}inputId=D2L.LP.Web.UI.Html.Dom.GetAttribute(validateNode,'data-d2l-validateinput');if(inputId==null){inputId=validator[0];}}return D2L.LP.Web.UI.Desktop.Controls.ValidatorCustom.GenerateValidatorObject(inputId,validator[1],validator[2],focusId);});},GenerateValidatorObject:function(inputId,validationFunc,errMessage,focusId){return{inputId:inputId,validation:validationFunc,message:errMessage,focusId:focusId};}};D2L.LP.Web.UI.Legacy={MasterPages:{}};D2L.LP.Web.UI.Legacy.MasterPages.Dialog={InstallTitle:function(handle,closeText,titleText){var doc=handle.container.ownerDocument;var nodeWin=handle.frame.contentWindow;var title='';if(typeof titleText==='string'&&titleText!==''){title=titleText;}var titleNode=D2L.LP.Web.UI.Html.Dom.GetElementById('d_page_title',doc);if(titleNode!==null){titleNode.style.display='none';title=titleNode.innerHTML;}handle.nodes.title=doc.createElement('div');handle.nodes.title.className='d2l-dialog-title';handle.nodes.heading=doc.createElement('h1');handle.nodes.heading.className='d2l-heading';handle.nodes.heading.id=nodeWin.UI.GetUniqueHtmlId();handle.nodes.heading.innerHTML=title;handle.nodes.title.appendChild(handle.nodes.heading);handle.nodes.close=doc.createElement('a');handle.nodes.close.className='d2l-dialog-close';var closeImg=doc.createElement('span');handle.nodes.close.appendChild(closeImg);var closeTextElem=doc.createElement('span');closeTextElem.className='d2l-offscreen';closeTextElem.appendChild(doc.createTextNode(closeText));closeImg.appendChild(closeTextElem);handle.nodes.title.appendChild(handle.nodes.close);handle.container.insertBefore(handle.nodes.title,handle.container.firstChild);},InstallTitleFullscreen:function(handle,titleText){var doc=handle.container.ownerDocument;var nodeWin=handle.frame.contentWindow;var title='';if(typeof titleText==='string'&&titleText!=='')title=titleText;var titleNode=D2L.LP.Web.UI.Html.Dom.GetElementById('d_page_title',doc);if(titleNode!==null){titleNode.style.display='none';title=titleNode.textContent;}handle.dialog.titleText=title;},InstallButtons:function(adapter,buttons){if(buttons.length===0)return;for(var i=0;i<buttons.length;i++){var buttonAdapter=adapter.AddCustomButton(new D2L.LP.Web.UI.Legacy.MasterPages.Dialog.TextAdapter(buttons[i].Text),0,buttons[i].ResponseType,buttons[i].Param,buttons[i].Key,buttons[i].IsPrimary);buttonAdapter.SetIsEnabled(buttons[i].IsEnabled);}},InstallFooterCommon:function(handle,adapter,buttons){var doc=handle.container.ownerDocument;adapter.m_footerNode=doc.createElement('div');adapter.m_footerNode.className='d2l-dialog-footer';D2L.LP.Web.UI.Legacy.MasterPages.Dialog.InstallButtons(adapter,buttons);handle.container.appendChild(adapter.m_footerNode);handle.nodes.footer=adapter.m_footerNode;},InstallFooter:function(handle,adapter,buttons){D2L.LP.Web.UI.Legacy.MasterPages.Dialog.InstallFooterCommon(handle,adapter,buttons);var doc=handle.container.ownerDocument;var resize=doc.createElement('span');resize.className='d2l-dialog-resize';adapter.m_footerNode.appendChild(resize);},InstallFooterFullscreen:function(handle,adapter,buttons){D2L.LP.Web.UI.Legacy.MasterPages.Dialog.InstallFooterCommon(handle,adapter,buttons);},CreateSettings:function(openerId,location,srcCallback,resizeCallback,responseDataKey,width,height,closeText,buttons,forceTriggerOnCancel,titleText,byPassOpenerFocus){var me=D2L.LP.Web.UI.Legacy.MasterPages.Dialog;var onload=function(handle){var nodeWin=handle.frame.contentWindow;if(nodeWin.D2L===undefined){return;}handle.m_forceTriggerOnCancel=forceTriggerOnCancel;me.adapter=new D2L.LP.Web.UI.Legacy.MasterPages.Dialog.DialogAdapter(handle,responseDataKey,srcCallback,resizeCallback);me.InstallTitle(handle,closeText,titleText);me.InstallFooter(handle,me.adapter,buttons);handle.body.style.overflow='auto';nodeWin.UI.SetParentDialog(me.adapter);nodeWin.d2l_Onload();};var preferredSize={PreferredWidth:width!==null?width:undefined,PreferredHeight:height!==null?height:undefined,MinVerticalMargin:60,MinHorizontalMargin:60};var settings={byPassOpenerFocus:byPassOpenerFocus,Onload:onload,PreferredSize:preferredSize};return settings;},CreateSettingsFullscreen:function(location,srcCallback,responseDataKey,buttons,forceTriggerOnCancel,titleText){var me=D2L.LP.Web.UI.Legacy.MasterPages.Dialog;var onload=function(handle){var nodeWin=handle.frame.contentWindow;if(nodeWin.D2L===undefined){return;}handle.m_forceTriggerOnCancel=forceTriggerOnCancel;me.adapter=new D2L.LP.Web.UI.Legacy.MasterPages.Dialog.DialogAdapter(handle,responseDataKey,srcCallback,undefined,D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen);me.InstallTitleFullscreen(handle,titleText);me.InstallFooterFullscreen(handle,me.adapter,buttons);nodeWin.UI.SetParentDialog(me.adapter);nodeWin.d2l_Onload();};var settings={Onload:onload};return settings;},Open:function(opener,location,srcCallback,resizeCallback,responseDataKey,width,height,closeText,buttons,forceTriggerOnCancel,titleText,byPassOpenerFocus){var me=D2L.LP.Web.UI.Legacy.MasterPages.Dialog;location=new D2L.LP.Web.Http.UrlLocation(location.GetUrl()).WithQueryString('d2l_body_type','2');var settings=me.CreateSettings(opener,location,srcCallback,resizeCallback,responseDataKey,width,height,closeText,buttons,forceTriggerOnCancel,titleText,byPassOpenerFocus);return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Open(opener,location,settings);},OpenFullscreen:function(location,srcCallback,responseDataKey,buttons,forceTriggerOnCancel,titleText){var me=D2L.LP.Web.UI.Legacy.MasterPages.Dialog;location=new D2L.LP.Web.Http.UrlLocation(location.GetUrl()).WithQueryString('d2l_body_type','2');var settings=me.CreateSettingsFullscreen(location,srcCallback,responseDataKey,buttons,forceTriggerOnCancel,titleText);return D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen.Open(location,settings);},OpenFullscreenWithParam:function(location,srcCallback,responseDataKey,buttons,params){var me=D2L.LP.Web.UI.Legacy.MasterPages.Dialog;location=new D2L.LP.Web.Http.UrlLocation(location.GetUrl()).WithQueryString('d2l_body_type','2');var settings=me.CreateSettingsFullscreen(location,srcCallback,responseDataKey,buttons);return D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen.OpenWithParam(location,params,settings);},OpenWithParam:function(openerId,location,srcCallback,resizeCallback,responseDataKey,width,height,closeText,buttons,params){var me=D2L.LP.Web.UI.Legacy.MasterPages.Dialog;location=new D2L.LP.Web.Http.UrlLocation(location.GetUrl()).WithQueryString('d2l_body_type','2');var settings=me.CreateSettings(openerId,location,srcCallback,resizeCallback,responseDataKey,width,height,closeText,buttons);return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenWithParam(openerId,location,params,settings);},AbortFullscreen:function(win){D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen.Abort(win);},CloseFullscreen:function(result){D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen.Close(result);},DestroyAdapter:function(){var me=D2L.LP.Web.UI.Legacy.MasterPages.Dialog;if(me.adapter){me.adapter.RemoveButtons();}me.adapter=null;}};D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen={Build:function(handle,form,location,settings){var me=D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen;var loadedOnce=false;return handle.rootWin.D2L.LP.Web.UI.Html.Bsi.LoadAssets(['node_modules/@brightspace-ui/core/components/dialog/dialog-fullscreen.js']).then(function(){window.D2L.DialogMixin.preferNative=false;handle.dialog=handle.rootWin.document.createElement('d2l-dialog-fullscreen');handle.dialog.async=true;handle.dialog.d2l_handle=handle;handle.firstLoadEvent=new D2L.LP.Web.UI.Events.Event();var frameId=new D2L.LP.Web.UI.Html.UniqueHtmlId().GetValue();handle.frame=handle.rootWin.document.createElement('iframe');handle.frame.setAttribute('src','/d2l/tools/blank.html');handle.frame.setAttribute('name',frameId);handle.frame.setAttribute('allow','microphone *; camera *; fullscreen *');handle.frame.setAttribute('frameBorder','0');handle.frame.setAttribute('scrolling','no');handle.frame.className='d2l-dialog-frame-loading';handle.frame.style.height='100%';handle.frame.style.width='100%';var resolveLoadingPromise;var loadedPromise=new Promise(function(resolve){resolveLoadingPromise=resolve;});D2L.LP.Web.UI.Html.Dom.AddEventListener('load',handle.frame,function(){if(!loadedOnce){loadedOnce=true;handle.firstLoadEvent.Trigger();return;}resolveLoadingPromise();handle.frame.contentDocument.body.classList.add('d2l-dialog-document-body');handle.container=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-dialog-width',handle.frame.contentWindow.document);handle.body=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-dialog-body',handle.container);if(handle.body===null){handle.body=handle.container;}if(settings.Onload!==undefined){settings.Onload.call(settings.Onload,handle);}D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-dialog-frame-loading',handle.frame);me.Focus(handle.container,handle.frame.contentWindow);});D2L.LP.Web.UI.Html.Dom.AddEventListener('d2l-dialog-close',handle.dialog,function(){handle.evt.Release();});if(form===null){handle.firstLoadEvent.AddListener(function(){var frameLocation=location.GetUrl();try{handle.frame.contentWindow.location=frameLocation;}catch(e){handle.frame.src=frameLocation;}});}handle.dialog.appendChild(handle.frame);handle.dialog.updateComplete.then(function(){handle.frame.dispatchEvent(new CustomEvent('pending-state',{bubbles:true,composed:true,detail:{promise:loadedPromise}}));});});},Abort:function(win){D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen.CloseHelper(false,undefined,win);},Close:function(result){D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen.CloseHelper(true,result);},CloseHelper:function(doTrigger,result,win){var handle=D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen.GetHandle(win);if(handle===null){return result;}D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen.CloseHelperWithHandle(doTrigger,true,result,handle);},CloseHelperWithHandle:function(doTrigger,doFocus,result,handle){if(handle.m_isClosed)return;if(doTrigger){handle.evt.Trigger(result);}else{if(handle.m_forceTriggerOnCancel){handle.evt.Trigger({});}else{handle.evt.Release();}}setTimeout(function(){handle.dialog.opened=false;if(D2L&&D2L.LP){D2L.LP.Web.UI.Legacy.MasterPages.Dialog.DestroyAdapter();}},0);handle.m_isClosed=true;},Focus:function(container,win){D2L.LP.Web.UI.Desktop.MasterPages.DialogCommon.Focus(container,win);},GetHandle:function(win){win=win||window;var dialogs=win.parent.document.querySelectorAll('d2l-dialog-fullscreen');for(var i=0;i<dialogs.length;i++){if(dialogs[i].querySelector('iframe').contentWindow==win){return dialogs[i].d2l_handle;}}return null;},Open:function(location,settings){return D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen.OpenSubmit(null,location,settings);},OpenSubmit:function(form,location,settings){document.body.dispatchEvent(new CustomEvent('d2l-mvc-dialog-open',{bubbles:true,composed:true}));var me=D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen;if(settings===undefined||settings===null)settings={};var evt=new D2L.LP.Web.UI.Events.Event();var rootWin=D2L.LP.Web.UI.Desktop.MasterPages.DialogCommon.GetRootWindow();if(settings.Window){rootWin=settings.Window;}var handle={container:null,dialog:null,evt:evt,frame:null,nodes:{title:null,heading:null,close:null,footer:null},rootWin:rootWin,settings:settings,win:window};me.Build(handle,form,location,settings,rootWin).then(function(){var appendToDom=function(){rootWin.document.body.appendChild(handle.dialog);handle.dialog.opened=true;};if(form!==null){appendToDom();handle.firstLoadEvent.AddListener(function(){D2L.LP.Web.UI.Desktop.Controls.Form.SubmitToIFrameHelper(form,handle.frame,location).AddListener(function(result){if(!result){me.CloseHelperWithHandle(false,false,undefined,handle);}});});}else{appendToDom();}});return evt;},OpenWithParam:function(location,params,settings){var evt=new D2L.LP.Web.UI.Events.Event();var form=D2L.LP.Web.UI.Desktop.MasterPages.DialogCommon.CreateForm(params);document.body.appendChild(form);var openSubmitEvent=D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen.OpenSubmit(form,location,settings);openSubmitEvent.AddListener(function(result){evt.Trigger(result);});openSubmitEvent.AddReleaseListener(function(){evt.Release();});return evt;},SetHeading:function(title){var me=D2L.LP.Web.UI.Legacy.MasterPages.DialogFullscreen;var handle=me.GetHandle();handle.dialog.titleText=title;},SetSize:function(){}};D2L.LP.Web.UI.Legacy.MasterPages.Dialog.ButtonAdapter=D2L.Class.Create({Construct:function(dialog,srcCallback,win,doc,text,responseType,responseParam,key,isPrimary){if(responseType===undefined){responseType=1;}if(responseParam===undefined){responseParam='';}this.m_domNode=null;this.m_dialog=dialog;this.m_srcCallback=srcCallback;this.m_win=win;this.m_doc=doc;this.m_text=text;this.m_dialog=dialog;this.m_responseType=responseType;this.m_responseParam=responseParam;this.m_key=key;this.m_isEnabled=true;this.m_isDisplayed=true;this.m_onClick=null;this.m_isPrimary=isPrimary;this.m_isRendered=false;},BuildDom:function(){var me=this;var b=D2L.LP.Web.UI.Desktop.Controls.Button;this.m_onClick=function(){var response=new D2L.LP.Web.UI.Legacy.MasterPages.Dialog.Response(me.m_dialog,me.m_responseType,me.m_responseParam);if(me.m_win[me.m_srcCallback]!==undefined){me.m_win[me.m_srcCallback](response);}else{me.m_dialog.CallCallback(response);}};this.m_domNode=b.Build(this.m_doc);return this.m_domNode;},Init:function(){this.m_isRendered=true;var b=D2L.LP.Web.UI.Desktop.Controls.Button;D2L.LP.Web.UI.Desktop.Controls.Button.Init(this.m_domNode);b.SetIsPrimaryNode(this.m_domNode,this.m_isPrimary);this.SetIsDisplayed(this.m_isDisplayed);this.SetIsEnabled(this.m_isEnabled);this.SetOnClick(this.m_onClick);this.SetText(this.m_text);},GetDomNode:function(){return this.m_domNode;},GetText:function(){return this.m_text;},SetIsDisplayed:function(isDisplayed){this.m_isDisplayed=isDisplayed;if(!this.m_isRendered){return;}D2L.LP.Web.UI.Desktop.Controls.Button.SetIsVisibleNode(this.m_domNode,isDisplayed);},SetIsEnabled:function(isEnabled){this.m_isEnabled=isEnabled;if(!this.m_isRendered){return;}D2L.LP.Web.UI.Desktop.Controls.Button.SetIsEnabledNode(this.m_domNode,isEnabled);},SetIsPrimary:function(isPrimary){this.m_isPrimary=isPrimary;if(!this.m_isRendered){return;}D2L.LP.Web.UI.Desktop.Controls.Button.SetIsPrimaryNode(this.m_domNode,isPrimary);},SetText:function(text){this.m_text=text;if(!this.m_isRendered){return;}var me=this;this.m_text.GetText().Register(function(val){D2L.LP.Web.UI.Desktop.Controls.Button.SetTextNode(me.m_domNode,val);});},SetOnClick:function(onClick){this.m_onClick=null;if(!this.m_isRendered){return;}D2L.LP.Web.UI.Desktop.Controls.Button.SetOnClickNode(this.m_domNode,onClick);}});D2L.LP.Web.UI.Legacy.MasterPages.Dialog.DialogAdapter=D2L.Class.Create({Construct:function(handle,dataKey,srcCallback,resizeCallback,mvcDialogNS){this.m_handle=handle;this.m_footerNode=null;this.m_dataKey=dataKey;this.m_positiveButton=null;this.m_srcCallback=srcCallback;this.m_buttons=[];if(mvcDialogNS){this.m_mvcDialogNS=mvcDialogNS;}else{this.m_mvcDialogNS=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;}if(resizeCallback!==undefined){resizeCallback=handle.frame.contentWindow[resizeCallback];if(resizeCallback!==undefined){handle.dialog.OnResize.AddListener(function(){try{resizeCallback();}catch(ex){}});}}},AddButton:function(type,responseParam,key,isPrimary){if(responseParam===undefined){responseParam='';}var win=this.m_handle.frame.contentWindow;var text=win.D2L.Control.Button.GetTermForType(type);var responseType=1;if(type==1||type==9){responseType=0;}else if(type==4){responseType=2;}return this.AddCustomButton(text,0,responseType,responseParam,key,isPrimary);},AddCustomButton:function(text,position,responseType,responseParam,key,isPrimary){var doc=this.m_handle.container.ownerDocument;var nodeWin=this.m_handle.frame.contentWindow;var button=new D2L.LP.Web.UI.Legacy.MasterPages.Dialog.ButtonAdapter(this,this.m_srcCallback,this.m_handle.frame.contentWindow,doc,text,responseType,responseParam,key,isPrimary);this.m_buttons.push(button);button.BuildDom();if(responseType===1){this.m_positiveButton=button;}var buttonsNode=null;var buttonsNodes=nodeWin.D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-dialog-buttons',this.m_footerNode);if(buttonsNodes.length===0){buttonsNode=doc.createElement('div');buttonsNode.className='d2l-dialog-buttons';this.m_footerNode.appendChild(buttonsNode);}else{buttonsNode=buttonsNodes[0];}buttonsNode.appendChild(button.GetDomNode());button.Init();buttonsNode.appendChild(doc.createTextNode(' '));return button;},CallCallback:function(response){var result=[];var dataKeys=[];if(this.m_dataKey.length>0){dataKeys=this.m_dataKey.split(',');}for(var j=0;j<dataKeys.length;j++){var itemResult=undefined;var dataItemKeys=dataKeys[j].split('.');if(dataItemKeys.length>0){itemResult=response.GetData(dataItemKeys[0]);if(itemResult!==undefined){for(var i=1;i<dataItemKeys.length;i++){if(itemResult[dataItemKeys[i]]!==undefined){itemResult=itemResult[dataItemKeys[i]];}}}}result.push(itemResult);}if(result.length==0){result=undefined;}else if(result.length==1){result=result[0];}this.m_mvcDialogNS.CloseHelperWithHandle(response.GetType()>0,true,result,this.m_handle);},Close:function(){this.m_mvcDialogNS.CloseHelperWithHandle(true,true,undefined,this.m_handle);},GetButton:function(key){for(var i=0;i<this.m_buttons.length;i++){if(this.m_buttons[i].m_key==key){return this.m_buttons[i];}}return null;},GetButtonCount:function(){return 0;},GetContentHeight:function(){return this.m_handle.body.clientHeight;},GetPositiveButton:function(){return this.m_positiveButton;},GetFooterText:function(){return'';},RemoveButton:function(button){for(var i=0;i<this.m_buttons.length;i++){if(this.m_buttons[i]==button){button.m_domNode.parentNode.removeChild(button.m_domNode);this.m_buttons.splice(i,1);}}},RemoveButtons:function(){for(var i=0;i<this.m_buttons.length;i++){D2L.LP.Web.UI.Desktop.Controls.Button.UnbindEvents(this.m_buttons[i].m_domNode);this.m_buttons[i].m_domNode.parentNode.removeChild(this.m_buttons[i].m_domNode);}this.m_buttons=[];},SetFooterText:function(text){},SetSize:function(width,height){this.m_mvcDialogNS.SetSize(this.m_handle,width,height);},SetTitle:function(text){}});D2L.LP.Web.UI.Legacy.MasterPages.Dialog.Response=D2L.Class.Create({Construct:function(dialog,type,param){this.m_data=[];this.m_dialog=dialog;this.m_type=type;this.m_param=param;},CallCallback:function(){this.GetDialog().CallCallback(this);},GetData:function(key){return this.m_data[key];},GetDialog:function(){return this.m_dialog;},GetParam:function(){return this.m_param;},GetType:function(){return this.m_type;},SetData:function(key,value){this.m_data[key]=value;}});D2L.LP.Web.UI.Legacy.MasterPages.Dialog.TextAdapter=D2L.Class.Create({Construct:function(text){this.m_text=text;},AssignText:function(obj,attrName){obj[attrName]=this.m_text;},GetText:function(){var text=this.m_text;return{Register:function(callback){callback(text);}};}});D2L.LP.Web.UI.Events.OnClick=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnContentHeightChange=new D2L.LP.Web.UI.Events.Event(function(){var body=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-dialog-body');if(body===null){body=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-body');}var height=Math.max(body.scrollHeight,body.offsetHeight);return[height];});D2L.LP.Web.UI.Events.OnFraUserEvent=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnMouseMove=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnMouseUp=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnInit=D2L.LP.Web.UI.Events.OnInit||new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnKeyPress=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnLoad=D2L.LP.Web.UI.Events.OnLoad||new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnOrientationChange=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnResize=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnScroll=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnSizingFinished=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnStorage=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnViewRender=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnVisibilityChange=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnProcessingBegin=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.OnProcessingEnd=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Events.VisibilityManager={AddListener:function(node,callback){D2L.LP.Web.UI.Events.VisibilityManager.Listeners.push({node:node,callback:callback});},Initialize:function(){D2L.LP.Web.UI.Events.OnVisibilityChange.AddListener(function(node,isDisplayed){var listeners=D2L.LP.Web.UI.Events.VisibilityManager.Listeners;for(var i=0;i<listeners.length;i++){if(D2L.LP.Web.UI.Html.Dom.IsAncestor(node,listeners[i].node)){if(D2L.LP.Web.UI.Html.Css.GetStyle(listeners[i].node,'display')!='none'){listeners[i].callback.call(listeners[i].callback,isDisplayed);}}}});},Listeners:[]};D2L.LP.Web.UI.Events.VisibilityManager.Initialize();D2L.LP.Web.UI.Rpc.OnFailure=new D2L.LP.Web.UI.Events.Event();D2L.LP.Web.UI.Rpc.FailureReasons={Unknown:1,NotAuthenticated:2};D2L.LP.Web.UI.Events.OnLoad.AddListener(function(){D2L.LP.Web.UI.Events.OnViewRender.Trigger(document);});D2L.LP.Web.UI.Html.LastPage={StorageKey:'LastPage',TrackingPage:true,Set:function(url,title){var me=D2L.LP.Web.UI.Html.LastPage;var documentHref=document.location.href;var isQuicklinkRedirect=documentHref.indexOf('quicklink')>-1;var isInnerIframe=window.top!==window;if(me.TrackingPage&&!isQuicklinkRedirect&&!isInnerIframe){var data={url:url||documentHref,title:title||document.title};var json=JSON.stringify(data);D2L.LP.Web.UI.Html.Dom.Storage.Session.Set(me.StorageKey,json,false);}},Get:function(){var me=D2L.LP.Web.UI.Html.LastPage;var json=D2L.LP.Web.UI.Html.Dom.Storage.Session.Get(me.StorageKey);if(json===undefined||json===null){return null;}var data=D2L.LP.Web.Serialization.Json.Deserialize(json);return data;},DoNotTrackPage:function(){var me=D2L.LP.Web.UI.Html.LastPage;me.TrackingPage=false;}};D2L.LP.Web.UI.Html.Dom.AddEventListener('unload',window,function(){D2L.LP.Web.UI.Html.LastPage.Set();});D2L.LP.Web.UI.Events.OnViewRender.AddListener(function(node){if(node.nodeType!=9&&node.nodeType!=1){return;}D2L.LP.Web.UI.Html.Dom.ApplyClassFunctions(D2L.LP.Web.UI.Html.Dom.ClassInitializers,node);});D2L.LP.Web.UI.Html.PartialRendering.OnBefore.AddListener(function(placeholderId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId.GetValue());if(node===null||node.nodeType!=9&&node.nodeType!=1){return;}D2L.LP.Web.UI.Html.Dom.ApplyClassFunctions(D2L.LP.Web.UI.Html.Dom.ClassDestructors,node);});D2L.LP.Web.UI.Events.OnViewRender.AddListener(function(sourceNode){if(sourceNode===document){return;}D2L.LP.Web.UI.Html.Math.UpdateNode(sourceNode);});D2L.LP.Web.UI.Desktop.Controls.HtmlBlock.OnAfterRender.AddListener(function(node){D2L.LP.Web.UI.Html.Math.UpdateNode(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-fuzzydate',function(node){D2L.LP.Globalization.Formatting.DateTime.FuzzyDate.initialize(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-dialog-close',function(node){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitClose(node,window);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-dialog-title',function(node){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitTitle(node,window);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-dialog-resize',function(node){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitResize(node,window);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-page-main',function(node){try{var topWindow=window.top;var topMost=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-page-main',topWindow.contentDocument);if(topMost==node){D2L.LP.Web.UI.Html.Aria.SetRole(node,'main');}}catch(e){}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-popup',function(node){var title=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-popup-title',node);var body=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-popup-body',node);var isIosIframe=body&&body.querySelector('iframe')&&navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&navigator.userAgent.match(/AppleWebKit/);if(isIosIframe){body.classList.add('d2l-popup-body-ios');}var footer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-popup-buttons',node);var onResize=function(){body.style.height='1px';var offset=0;var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(title);offset+=rect.height;if(footer!==null){rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(footer);offset+=rect.height;}var pageSize=D2L.LP.Web.UI.Html.Dom.GetPageSize(window);var viewportSize=D2L.LP.Web.UI.Html.Dom.GetViewportSize();if(isIosIframe){body.style.height=viewportSize.height-offset-5+'px';}else{body.style.height=Math.max(pageSize.height,viewportSize.height)-offset+'px';}};onResize();D2L.LP.Web.UI.Events.OnResize.AddListener(onResize);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-page-buttons',function(node){D2L.LP.Web.UI.Desktop.Controls.PageButtons.Init(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('dba',function(node){var isBottom=$(node).is('.dba_b');if(!isBottom){return;}setTimeout(function(){D2L.LP.Web.UI.Desktop.Controls.PageButtons.Init(node);},300);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-page-collapsepane-container',function(node){D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane.Init(node);});D2L.LP.Web.UI.Events.OnViewRender.AddListener(function(node){var container=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-page-collapsepane-container',node);if(container!=null&&node.nodeType==1){var context=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane.GetContext(node);D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane.OnScroll(context);}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-tool-areas',function(node){var isRtl=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var selected=null;var bar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-tool-areas-bar',node);var applyBar=function(link,first){var item=link.parentNode;var prev=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(item);var pos=item.offsetLeft;var itemWidth=$(item).width();var width=itemWidth-(prev!==null?30:15);var properties={'width':width+'px'};if(isRtl){properties.right=$(item.offsetParent).width()-(pos+itemWidth)+(prev!==null?15:0);}else{properties.left=pos+(prev!==null?15:0);}if(!first){$(bar).animate(properties,100);}else{$(bar).css(properties).show();}};var over=false;var newSelection=false;var onOver=function(){if(newSelection){return;}over=true;applyBar(this,false);};var onOut=function(){if(newSelection){return;}over=false;setTimeout(function(){if(!over){applyBar(selected,false);}},300);};$(node).find('.d2l-tool-areas-link').each(function(index,item){if($(item).parent().hasClass('d2l-tool-areas-item-selected')){selected=item;applyBar(selected,true);var offset=selected.offsetLeft-($(node).width()/2-$(item).width()/2);if(isRtl){offset=-offset;}node.scrollDistance&&node.scrollDistance(offset);}$(item).hover(onOver,onOut).focus(onOver).blur(onOut).click(function(){newSelection=true;});});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-token-receiver',function(node){var scope=node.getAttribute('data-token-receiver-scope');if(!scope){return;}function tokenGetter(){return D2L.LP.Web.Authentication.OAuth2.GetToken(scope);}node.token=tokenGetter;});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-dragdrop-draggable',function(node){var ddType=D2L.LP.Web.UI.Html.DragDrop.DragDropType.Draggable;if(D2L.LP.Web.UI.ObjectRepository.HasKey(node.id)){var ddSettings=D2L.LP.Web.UI.ObjectRepository.Get(node.id);D2L.LP.Web.UI.Html.DragDrop.InstallNode(node,ddType,ddSettings['drag'],ddSettings['drop']);}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-dragdrop-droppable',function(node){var ddType=D2L.LP.Web.UI.Html.DragDrop.DragDropType.Droppable;if(D2L.LP.Web.UI.ObjectRepository.HasKey(node.id)){var ddSettings=D2L.LP.Web.UI.ObjectRepository.Get(node.id);D2L.LP.Web.UI.Html.DragDrop.InstallNode(node,ddType,ddSettings['drag'],ddSettings['drop']);}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-filedrop',function(node){var me=D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default;me.MakeFileDropNode(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-action-container',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.ActionContainer;var selectionUpdatedEvent=me.TryGetSelectionUpdatedEventByNode(node);if(selectionUpdatedEvent==null){return;}var itemButtonIds;var getItemButtonIds=function(){if(itemButtonIds!==undefined){return itemButtonIds;}var itemButtonNodes=D2L.LP.Web.UI.Html.Dom.GetImmediateChildElementsByClassName('d2l-action-container-itembutton',node);itemButtonIds=[];for(var i=0;i<itemButtonNodes.length;i++){itemButtonIds.push(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(itemButtonNodes[i].getAttribute('id')));}return itemButtonIds;};node.d2l_dataControlSelectionHandler=function(selectionInfo){node.d2l_selectionInfo=selectionInfo;var buttonIds=getItemButtonIds();var isEnabled=selectionInfo.GetType()!=D2L.LP.LayeredArch.SelectionFilterType.None;for(var i=0;i<buttonIds.length;i++){D2L.LP.Web.UI.Desktop.Controls.Button.SetIsEnabled(buttonIds[i],isEnabled);}};selectionUpdatedEvent.AddListener(node.d2l_dataControlSelectionHandler);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-alert',function(node){node.addEventListener('d2l-alert-button-pressed',function(){var onClick=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onClick');if(onClick){onClick.call(onClick);}});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-autocomplete-static',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var handle=me.InitHandle(node);handle.processFunction=me.Static.Filter;handle.highlight=true;me.Initialize(handle);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-autocomplete-dynamic',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var handle=me.InitHandle(node);handle.processFunction=me.Dynamic.PartialFunction;handle.highlight=me.GetDataAttribute(handle.containerNode,'data-d2l-highlight');handle.lastSearch=null;var totalResults=me.GetDataAttribute(handle.containerNode,'data-d2l-totalresults');if(totalResults>0){handle.totalResults=totalResults;}me.Initialize(handle);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-button',function(node){D2L.LP.Web.UI.Desktop.Controls.Button.Init(node);});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-button');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-button-checkbox',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.ButtonCheckbox;var id=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(node.id);D2L.LP.Web.UI.Html.Dom.SetAttribute(node,'href','javascript:void(0);');var id1=new D2L.LP.Web.UI.Html.UniqueHtmlId();var nodes=me.GetNodesNode(node);nodes.text.id=id1.GetValue();if(nodes.textSelected!==undefined){var id2=new D2L.LP.Web.UI.Html.UniqueHtmlId();nodes.textSelected.id=id2.GetValue();}D2L.LP.Web.UI.Html.Aria.SetRole(node,'checkbox');me.AdjustAria(nodes);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',node,function(){var isSelected=me.GetIsSelectedNode(nodes.hidden);me.SetIsSelected(id,!isSelected,true);});});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-button-checkbox');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-button-filter',function(node){var labels=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-heading',node);var lists=node.getElementsByTagName('ul');if(labels.length===1&&lists.length===1){D2L.LP.Web.UI.Html.Aria.SetRole(lists[0],'toolbar');D2L.LP.Web.UI.Html.Aria.SetAttribute(lists[0],'labelledby',labels[0].id);}var anchors=node.getElementsByTagName('a');for(var i=0;i<anchors.length;i++){D2L.LP.Web.UI.Html.Aria.SetRole(anchors[i].parentNode,'presentation');D2L.LP.Web.UI.Html.Aria.SetRole(anchors[i],'button');if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(anchors[i],'href')){D2L.LP.Web.UI.Html.Dom.SetAttribute(anchors[i],'href','javascript:void(0);');}if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-button-filter-selected',anchors[i])){D2L.LP.Web.UI.Html.Aria.SetAttribute(anchors[i],'pressed',true);}D2L.LP.Web.UI.Html.Dom.AddEventListener('click',anchors[i],function(index){return function(){var isEnabled=D2L.LP.Web.UI.Desktop.Controls.Button.IsEnabledNode(anchors[index]);if(!isEnabled){return;}var f=D2L.LP.Web.UI.ObjectRepository.TryGet(anchors[index].getAttribute('id'));if(f===null){return;}for(var j=0;j<anchors.length;j++){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-button-filter-selected',anchors[j]);D2L.LP.Web.UI.Html.Aria.SetAttribute(anchors[j],'pressed',false);}D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-button-filter-selected',anchors[index]);D2L.LP.Web.UI.Html.Aria.SetAttribute(anchors[index],'pressed',true);f.call(f);};}(i));}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-button-filter');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-button-menu-dropdown',function(node){D2L.LP.Web.UI.Desktop.Controls.ButtonMenu.Init(node);});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-button-menu-dropdown');D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-button-subtle');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-calendar-mini',function(node){var navMatrix=new Array();var prevMonthArrow=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-calendar-mini-prevmonth",node);var nextMonthArrow=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-calendar-mini-nextmonth",node);var navLocation={col:0,row:0,daysPerWeek:7};var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var handleOnClickDayFocus=function(days,i,j){var day=days[i+j];navFocusDay(day.firstChild.nodeValue);};var setOnClick=function(onclick,days,i,j){days[i+j].onclick=function(event){if(node.editNode!=null&&node.editNode.closeMiniCalendar){node.editNode.closeMiniCalendar();}handleOnClickDayFocus(days,i,j);onclick(event);};days[i+j].onkeypress=function(kpEvent){var keyCodeEvent=kpEvent||window.event;var keyCode=keyCodeEvent.keyCode;if(keyCode==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter||keyCode==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Space){if(node.editNode!=null&&node.editNode.closeMiniCalendar){node.editNode.closeMiniCalendar();}handleOnClickDayFocus(days,i,j);onclick(kpEvent);}};};var monthChangeAdditionalOnClick=function(){setTimeout(function(){if(node.editNode!=null&&node.editNode.onMiniCalendarChange){node.editNode.onMiniCalendarChange();}},200);};var initNavMatrix=function(){D2L.LP.Web.UI.Desktop.Controls.ImageLink.AddOnClick(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(prevMonthArrow.id),monthChangeAdditionalOnClick);D2L.LP.Web.UI.Desktop.Controls.ImageLink.AddOnClick(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(nextMonthArrow.id),monthChangeAdditionalOnClick);var days=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-calendar-mini-day",node);for(var i=0;i<days.length;i+=7){navMatrix.push(new Array());for(var j=0;j<7;j++){setOnClick(days[i+j].onclick,days,i,j);navMatrix[navMatrix.length-1].push(days[i+j]);days[i+j].tabIndex=0;}}};var navMatrixBoundaryCheck=function(){return navLocation.row>=0&&navLocation.row<navMatrix.length&&navLocation.col>=0&&navLocation.col<navLocation.daysPerWeek;};var navFocusSelectedDay=function(){var day=1;var selectedDay=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-calendar-mini-selected',node);if(selectedDay!==undefined&&selectedDay!==null){if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-calendar-mini-other',selectedDay)){day=D2L.LP.Web.UI.Html.Dom.GetAttribute(selectedDay,'data-date');}}navFocusDay(day);};var navRestoreColumnFocus=function(col,startFromBottom){var row=startFromBottom?navMatrix.length-1:0;var day=navMatrix[row][col];while(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-calendar-mini-other',day)){row=startFromBottom?row-1:row+1;day=navMatrix[row][col];if(row<0||row>navMatrix.length){return;}}navLocation.col=col;navLocation.row=row;day.focus();};var navFocusDay=function(day){if(day===undefined||day===null){day=1;}var days=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-calendar-mini-day',node);var firstDayOffset=0;for(var i=0;i<days.length;i++){if(D2L.LP.Web.UI.Html.Dom.GetAttribute(days[i],'data-date')==='1'){firstDayOffset=i;break;}}day=day-0;firstDayOffset=firstDayOffset-0;var row=Math.floor(day/navLocation.daysPerWeek);if(day%navLocation.daysPerWeek==0){row=row-1;}var col=day%navLocation.daysPerWeek;if(col==0){col=navLocation.daysPerWeek;}col=col+firstDayOffset;if(col>navLocation.daysPerWeek){row=row+1;col=col%navLocation.daysPerWeek;}if(row!=null&&row!=undefined&&col!=null&&col!=undefined){navFocusNode(row,col-1);}};var navFocusNode=function(optRow,optCol){if(optRow!=null&&optRow!=undefined&&optCol!=null&&optCol!=undefined){navLocation.row=optRow;navLocation.col=optCol;preserveDate(optCol,optRow);}if(navMatrixBoundaryCheck()){if(navMatrix[navLocation.row][navLocation.col]!==null){navMatrix[navLocation.row][navLocation.col].focus();}}};var changeMonth=function(changeMonthEvent){changeMonthEvent.click(changeMonthEvent);};var preserveColumn=function(col,startFromBottom){if(col!==undefined&&col!==null&&node.parentNode&&node.parentNode.parentNode){var placeHolder=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-placeholder',node);D2L.LP.Web.UI.Html.Dom.SetAttribute(placeHolder,'data-restoreColumn',col);D2L.LP.Web.UI.Html.Dom.SetAttribute(placeHolder,'data-startFromBottom',startFromBottom);}};var preserveDate=function(col,row){if(col===undefined||col===null||row===undefined||row===null){return;}var placeHolder=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-placeholder',node);if(placeHolder===undefined||placeHolder===null){return;}if(navMatrix.length>row&&navMatrix[row].length>col){var day=navMatrix[row][col];if(day!==null&&D2L.LP.Web.UI.Html.Dom.HasAttribute(day,'data-date')){var dayStr=D2L.LP.Web.UI.Html.Dom.GetAttribute(day,'data-date');D2L.LP.Web.UI.Html.Dom.SetAttribute(placeHolder,'data-restoreDate',dayStr);}}};var navArrowHandler=function(col,row){navLocation.col+=col*(isRTL?-1:1);navLocation.row+=row;var rowMax=navMatrix.length-1;if(navLocation.row<0){preserveColumn(navLocation.col,true);changeMonth(prevMonthArrow);return;}else if(navLocation.row>rowMax){preserveColumn(navLocation.col,false);changeMonth(nextMonthArrow);return;}else{if(navLocation.col<0&&navLocation.row==0){preserveColumn(6,true);changeMonth(prevMonthArrow);return;}else if(navLocation.col>=navLocation.daysPerWeek&&navLocation.row==rowMax){preserveColumn(0,false);changeMonth(nextMonthArrow);return;}else if(navLocation.col<0){navLocation.row=navLocation.row-1;navLocation.col=navLocation.daysPerWeek-1;}else if(navLocation.col>navLocation.daysPerWeek-1){navLocation.row=navLocation.row+1;navLocation.col=0;}else{var day=navMatrix[navLocation.row][navLocation.col];if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-calendar-mini-other",day)){preserveDate(navLocation.col,navLocation.row);navLocation.row==0?changeMonth(prevMonthArrow):changeMonth(nextMonthArrow);return;}}}navFocusNode();};var navOnKeyPress=function(kpArgs){var result=false;var e=kpArgs.GetEventObject();if(!D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.IsControlPressed){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowUp){navArrowHandler(0,-1);result=true;}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown){navArrowHandler(0,1);result=true;}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowLeft){navArrowHandler(-1,0);result=true;}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowRight){navArrowHandler(1,0);result=true;}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape||kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab){if(node.editNode!=null&&node.editNode.closeMiniCalendar){node.editNode.closeMiniCalendar();}}}else{if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowLeft){changeMonth(prevMonthArrow);result=true;}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowRight){changeMonth(nextMonthArrow);result=true;}}return result;};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,function(kpArgs){var result=navOnKeyPress(kpArgs);if(result){var event=kpArgs.GetEventObject();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(event);}});initNavMatrix();node.navLocation=navLocation;node.navFocusNode=navFocusNode;node.navFocusDay=navFocusDay;node.navRestoreColumnFocus=navRestoreColumnFocus;node.navFocusSelectedDay=navFocusSelectedDay;var miniCalPlaceholder=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-placeholder',node);if(D2L.LP.Web.UI.Html.Dom.HasAttribute(miniCalPlaceholder,'data-restoreDate')){var restoreDay=D2L.LP.Web.UI.Html.Dom.GetAttribute(miniCalPlaceholder,'data-restoreDate');D2L.LP.Web.UI.Html.Dom.RemoveAttribute(miniCalPlaceholder,'data-restoreDate');node.navFocusDay(restoreDay);}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-checkbox',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StartTracking(node);var hidden=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);if(hidden===null){return;}D2L.LP.Web.UI.Html.Dom.AddEventListener('change',node,function(){hidden.value=node.checked?'1':'0';});$(node.form).on('vui-reset',function(){hidden.value=node.checked?'1':'0';});});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-checkbox');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-checkboxlist',function(node){var cascadeSelection=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-cascadeSelection');if(cascadeSelection===undefined||cascadeSelection===null||cascadeSelection==D2L.LP.Web.UI.Desktop.Controls.CheckboxList.CascadeOptions.None){return;}if(cascadeSelection){var childNodes=D2L.LP.Web.UI.Desktop.Controls.CheckboxList.GetItemsNodesByNode(node);for(var i=0;i<childNodes.length;i++){(function(index){var checkBox=D2L.LP.Web.UI.Desktop.Controls.CheckboxList.GetCheckboxNode(childNodes[index]);D2L.LP.Web.UI.Html.Dom.AddEventListener('change',checkBox,function(){D2L.LP.Web.UI.Desktop.Controls.CheckboxList.CascadeSelection(childNodes[index],cascadeSelection);});})(i);}}});D2L.LP.Web.UI.Desktop.Controls.ClassListFilterInlineGroup={GetSelectedViewKey:function(id){if(D2L.LP.Web.UI.ObjectRepository.HasKeys(id.GetValue(),'HiddenSelectedViewKey')){return D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),'HiddenSelectedViewKey');}else{return D2L.LP.Web.UI.Desktop.Controls.FilterInlineFlyout.GetKey(id);}}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-collapsepane-header',function(node){var actionNode=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName('d2l-collapsepane-action',node);var expandCollapse=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-onclick');D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,'data-onclick');D2L.LP.Web.UI.Html.Dom.AddEventListener('click',node,function(e){if(actionNode===null){eval(expandCollapse);return;}var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);if(eventTarget!==actionNode&&eventTarget.parentNode!==actionNode){eval(expandCollapse);}});D2L.LP.Web.UI.Html.Dom.AddEventListener('toggle',node,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e||window.event);D2L.LP.Web.UI.Html.Dom.ToggleClassName('d2l-collapsepane-collapsed',node);});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-collapsible-section',function(node){var toggle=node.querySelector('.d2l-collapsible-section-toggle');var target=document.getElementById(toggle.getAttribute('aria-controls'));toggle.addEventListener('click',function(){var isCollapsed=toggle.getAttribute('aria-expanded')==='false';target.expanded=isCollapsed;toggle.setAttribute('aria-expanded',isCollapsed?'true':'false');});target.addEventListener('d2l-expand-collapse-content-expand',function(evt){evt.detail.expandComplete.then(function(){toggle.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"});});});var $target=$(target);D2L.LP.Web.UI.Html.ChangeTracking.Tracker.TrackChanges(target);$target.on('vui-change vui-restore',function(){if(D2L.LP.Web.UI.Html.ChangeTracking.Tracker.ContainsChanges(this)){toggle.classList.add('d2l-collapsible-section-changed');}else{toggle.classList.remove('d2l-collapsible-section-changed');}});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-contextmenu-ph-dropdown',function(node){if(!node.hasAttribute("data-contextMenuId")){return;}var contextMenuId=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(node.getAttribute("data-contextMenuId"));var isOnDemand=D2L.LP.Web.UI.ObjectRepository.HasKeys(contextMenuId.GetValue(),'LoadHandler');var placeholderKey=node.getAttribute("data-placeholderKey");var opener=node.shadowRoot.querySelector('d2l-button-icon');var loadFunction=function(e){if(node.disabled||!isOnDemand&&!D2L.LP.Web.UI.Html.Dom.GetElementById(contextMenuId.GetValue()))return;if(D2L.LP.Web.UI.Desktop.Controls.ContextMenu.IsOpen(contextMenuId)){D2L.LP.Web.UI.Desktop.Controls.ContextMenu.Close(contextMenuId);return;}var keypress=e.type==='keypress'?true:false;if(keypress&&e.which!==13&&e.which!==32)return;if(isOnDemand&&!D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.IsLoaded(contextMenuId)){D2L.LP.Web.UI.Desktop.Controls.ContextMenu.OpenOnDemand(node,contextMenuId,opener,placeholderKey,keypress);}else{D2L.LP.Web.UI.Desktop.Controls.ContextMenu.CreateDropdownMenu(node,contextMenuId,opener,placeholderKey,keypress);}};opener.addEventListener('mouseup',loadFunction);opener.addEventListener('keypress',loadFunction);var closeFunction=function(){var dropdownMenuContent=node.querySelector('d2l-dropdown-menu');if(dropdownMenuContent){node.removeChild(dropdownMenuContent);}};node.addEventListener('d2l-dropdown-close',closeFunction);});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-contextmenu');D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-contextmenu-ph-dropdown');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-colourselector-button',function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,'button');if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-colourselector-disabled',node)){return;}D2L.LP.Web.UI.Html.Dom.SetAttribute(node,'href','javascript:void(0);');});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-colourselector',function(node){D2L.LP.Web.UI.Desktop.Controls.ColourSelector.Init(node);});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-colourselector-button');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-datalist',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var dataListId=node.parentNode.getAttribute('id');if(dataListId!=null){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(dataListId);var totalItemCount;if(D2L.LP.Web.UI.ObjectRepository.HasKeys(dataListId,2)){totalItemCount=D2L.LP.Web.UI.ObjectRepository.Get(dataListId,2);}var pageNumber;if(D2L.LP.Web.UI.ObjectRepository.HasKeys(dataListId,3)){pageNumber=D2L.LP.Web.UI.ObjectRepository.Get(dataListId,3);}var itemNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-datalist-item',node);me.SetIsNewItems(itemNodes);setTimeout(function(){var hasMoreItems=me.GetHasMoreItems(id);if(!hasMoreItems&&totalItemCount!==undefined&&itemNodes.length<totalItemCount){hasMoreItems=true;}me.GetOnLoadCompletedEvent(id).Trigger(hasMoreItems,itemNodes,totalItemCount,pageNumber);});}D2L.LP.Web.UI.Desktop.Controls.DataList.AdjustLastVisibleChild(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-datalist-checkboxitem',function(node){D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems.InitializeCheckboxItem(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-datalist-radioitem',function(node){D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems.InitializeRadioItem(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-datalist-placeholder',function(node){var dataListNode=node.parentNode;D2L.LP.Web.UI.Html.PartialRendering.OnAfter.AddListener(function(id){if(id.GetValue()==node.id){D2L.LP.Web.UI.Desktop.Controls.DataList.AdjustLastVisibleChild(dataListNode);}});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-datalist-item-actionable',function(node){var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList;var contentNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-item-content',node);var actionNode;var actionControlId=node.getAttribute('data-d2l-actionId');if(actionControlId!=null){actionNode=D2L.LP.Web.UI.Html.Dom.GetElementById(actionControlId);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-datalist-item-actioncontrol',actionNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('vui-outline',actionNode);}var getActionFunction=function(){if(actionControlId!==null){return D2L.LP.Web.UI.ObjectRepository.TryGet(actionControlId);}else{return null;}};if(actionNode){D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',actionNode,function(){D2L.LP.Web.UI.Html.Dom.AddClassName('vui-active',node);});D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',actionNode,function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('vui-active',node);});D2L.LP.Web.UI.Html.Dom.AddEventListener('click',actionNode,function(){var action=getActionFunction();if(action){action.call(action);}});}D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseover',contentNode,function(){D2L.LP.Web.UI.Html.Dom.AddClassName('vui-active',node);});D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseout',contentNode,function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('vui-active',node);});D2L.LP.Web.UI.Html.Dom.AddEventListener('click',contentNode,function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);while(eventTarget!==contentNode&&eventTarget!==null){var onClickRule=dataList.CaptureOnClickRules[eventTarget.nodeName.toUpperCase()];if(onClickRule!==undefined&&onClickRule===true){return;}eventTarget=eventTarget.parentNode;}var href=actionNode.getAttribute('href');actionNode.removeAttribute('href');var action=getActionFunction();if(action){action.call(action);}actionNode.href=href;if(href!==null&&href!=='javascript:void(0);'){D2L.LP.Web.UI.Html.Dom.Navigate(new D2L.LP.Web.Http.UrlLocation(href));}});});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-datalist-item-actionable');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-datalist-item-dragdrop',function(node){var dataListItem=D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop;dataListItem.InstallDragDropEvents(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-datalist-empty-drop',function(node){var droppableSettings=new D2L.LP.Web.UI.Html.DragDrop.DroppableSettings();droppableSettings.SetDropEffect(D2L.LP.Web.UI.Html.DragDrop.DropEffect.None);var acceptableDragGroups=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'EmptyListAcceptableDragGroups');var fileDropNode=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName('d2l-filedrop',node);if(acceptableDragGroups){for(var i=0;i<acceptableDragGroups.length;i++){droppableSettings.AddAcceptableDragGroup(acceptableDragGroups[i]);}}var handleDrop=function(dragObject){var draggedNodeSettings=dragObject.GetDraggableSettings();node.d2l_draggedNodeKey=draggedNodeSettings.GetKey();node.d2l_dragObjectParam=draggedNodeSettings.GetParam();node.d2l_dragObject=dragObject;var emptyListOnItemDrop=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'EmptyListOnItemDrop');if(emptyListOnItemDrop){emptyListOnItemDrop.call(this);}handleDragout();};var handleDragIn=function(){var hoverNode=fileDropNode||node;D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-filedropstyle-container-dragover',hoverNode);};var handleDragout=function(){var hoverNode=fileDropNode||node;D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-filedropstyle-container-dragover',hoverNode);};droppableSettings.GetDropEvent().AddListener(handleDrop);droppableSettings.GetDragInEvent().AddListener(handleDragIn);droppableSettings.GetDragOutEvent().AddListener(handleDragout);D2L.LP.Web.UI.Html.DragDrop.MakeDroppableNode(node,droppableSettings);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-datalist-item-dragdrop-reorder',function(node){var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.GetParentDataList(node);var reorderId=D2L.LP.Web.UI.ObjectRepository.Get(dataList.id,'ReorderId');var hiddens=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-datalist-item-dragdrop-reorder-hidden",node);for(var i=0;i<hiddens.length;i++){hiddens[i].name=reorderId;}setTimeout(function(){node.d2l_DraggableSettings.SetDragGroup('d2l.datalist.reorder.'+dataList.id);node.d2l_DroppableSettings.SetAcceptableDragGroups(['d2l.datalist.reorder.'+dataList.id]);node.d2l_DroppableSettings.GetDropEvent().AddListener(function(){D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder.UpdateDataListReorderState(dataList);});});var $dataList=$(dataList);if($dataList.data('initialChangeKey')===undefined){var initialChangeKey=D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder.GetOrderedKeysNode(dataList).join();$dataList.data('initialChangeKey',initialChangeKey).data('changeKey',initialChangeKey);$(document).on('vui-reset',function(evt){var changeKey=$dataList.data('changeKey');var hasChanged=changeKey!==$dataList.data('initialChangeKey');var isParentTracker=$dataList.closest(evt.target).length>0;if(!isParentTracker||!hasChanged){return;}$dataList.data('initialChangeKey',changeKey);D2L.LP.Web.UI.Html.ChangeTracking.Trackable.TriggerRestore(dataList);});}D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder.InstallKeyboardEvents(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-datalist-summary',function(node){var selectAllNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-selectall',node);if(selectAllNode==null){return;}var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList;var dataListNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-datalist-container',selectAllNode);var dataListId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(dataListNode.getAttribute('id'));var listNode=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName('d2l-datalist',dataListNode);var itemCount=dataList.GetItemCount(dataListId);var selectAllId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(selectAllNode.getAttribute('id'));node.d2l_onRemoveItemHandler=function(itemNode){D2L.LP.Web.UI.Desktop.Controls.SelectAll.RemoveItem(selectAllId,dataList.CheckboxItems.GetCheckboxNode(itemNode).value);};dataList.GetOnRemoveItemEvent(dataListId).AddListener(node.d2l_onRemoveItemHandler);var clearLinkNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-summary-clear',node);var selectEverythingNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-summary-selecteverything',node);var noSearchTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-summary-count-nosearch',node);var selectedTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-summary-count-selected',node);var allSelectedTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-summary-count-all-selected',node);var updateShownCount=function(){if(itemCount===0){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',noSearchTextNode);}if(noSearchTextNode.innerHTML.indexOf('{count}')>=0){noSearchTextNode.innerHTML=noSearchTextNode.innerHTML.replace('{count}','<span class="d2l-datalist-summary-count-shown-counter"></span>');}var counterNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-summary-count-shown-counter',noSearchTextNode);if(counterNode==null){return;}var numShownFormatted=D2L.LP.Globalization.Locale.GetNumberFormatter().FormatInteger(itemCount);if(counterNode.textContent!==undefined){counterNode.textContent=numShownFormatted;}else if(counterNode.innerText!==undefined){counterNode.innerText=numShownFormatted;}};node.d2l_updateSelectAllVisibilityHandler=function(){itemCount=dataList.GetItemCount(dataListId);updateShownCount();var isMultiSelectAlllowed=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName('d2l-datalist-checkboxitem',listNode)!=null;if(itemCount>0){if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',node)){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',node);}}else{D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',node);}if(!isMultiSelectAlllowed&&!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',selectAllNode)){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',selectAllNode);return;}if(isMultiSelectAlllowed&&D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',selectAllNode)){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',selectAllNode);return;}};dataList.GetOnLoadCompletedEvent(dataListId).AddListener(node.d2l_updateSelectAllVisibilityHandler);dataList.GetOnLoadMoreCompletedEvent(dataListId).AddListener(node.d2l_updateSelectAllVisibilityHandler);dataList.GetOnRemoveItemEvent(dataListId).AddListener(node.d2l_updateSelectAllVisibilityHandler);var selectionUpdatedEvent=dataList.Summary.GetSelectionUpdatedEvent(dataListId);node.d2l_selectionUpdateHandler=function(type,count){var selectionInfo=D2L.LP.Web.UI.Desktop.Controls.SelectAll.GetSelectionInfo(selectAllId);if(selectionInfo!=null){selectionUpdatedEvent.Trigger(selectionInfo);}if(type==D2L.LP.LayeredArch.SelectionFilterType.All){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',selectedTextNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',noSearchTextNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',allSelectedTextNode);if(clearLinkNode!=null){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',clearLinkNode);}if(selectEverythingNode!=null){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',selectEverythingNode);}}else if(type!=D2L.LP.LayeredArch.SelectionFilterType.None){if(selectedTextNode.innerHTML.indexOf('{count}')>=0){selectedTextNode.innerHTML=selectedTextNode.innerHTML.replace('{count}','<span class="d2l-datalist-summary-count-selected-counter"></span>');}var numSelectedFormatted=D2L.LP.Globalization.Locale.GetNumberFormatter().FormatInteger(count);var counterNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datalist-summary-count-selected-counter',selectedTextNode);if(counterNode.textContent!==undefined){counterNode.textContent=numSelectedFormatted;}else if(counterNode.innerText!==undefined){counterNode.innerText=numSelectedFormatted;}setTimeout(function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',selectedTextNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',noSearchTextNode);},0);if(clearLinkNode!=null){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',clearLinkNode);}if(selectEverythingNode!=null){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',selectEverythingNode);}}else{updateShownCount();setTimeout(function(){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',selectedTextNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',allSelectedTextNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',noSearchTextNode);},0);if(clearLinkNode!=null){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',clearLinkNode);}if(selectEverythingNode!=null){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',selectEverythingNode);}}};D2L.LP.Web.UI.Desktop.Controls.SelectAll.GetOnSelectionUpdateEvent(selectAllId).AddListener(node.d2l_selectionUpdateHandler);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-datetime-range',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeRange;var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.id);var nodes=me.GetNodes(id);var onChange=function(){var startDateTime=node.startValue;var endDateTime=node.endValue;me.SetNodeValues(nodes,startDateTime,endDateTime);var onChangeFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(nodes.edit.id,'OnDateTimeRangeChangeFunction');if(onChangeFunction){onChangeFunction.call(onChangeFunction);}};D2L.LP.Web.UI.Html.Dom.AddEventListener('change',node,onChange);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-datetime-selector-wc',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var edit=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datetime-selector-date-input',node);var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(edit.id);var nodes=me.GetNodes(id);var onSelectorChangeEvent=function(){var onChangeFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(nodes.edit.id,'OnDateTimeChangeFunction');if(onChangeFunction){onChangeFunction.call(onChangeFunction);}};var onChange=function(){try{var re=/([0-9]{4})-([0-9]{2})-([0-9]{2})[T]?([0-9]{1,2})?[:]?([0-9]{1,2})?/;var match=edit.value.match(re);if(!match){throw new Error('Invalid date format');}else{dateTime={year:parseInt(match[1]),month:parseInt(match[2]),day:parseInt(match[3]),hour:match[4]!==undefined?parseInt(match[4]):undefined,minute:match[5]!==undefined?parseInt(match[5]):undefined};me.SetNodeValues(nodes,dateTime);}}catch(e){}};D2L.LP.Web.UI.Html.Dom.AddEventListener('change',nodes.edit,onChange);D2L.LP.Web.UI.Html.Dom.AddEventListener('d2l-datetime-selector-change',nodes.container,onSelectorChangeEvent);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-datetime-selector-legacy',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var edit=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-datetime-selector-date-input',node);var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(edit.id);var nodes=me.GetNodes(id);var phid=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-placeholder',nodes.floatingContainer).id;$(nodes.container).on('d2l-datetime-selector-change',function(){var onChangeFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(nodes.edit.id,'OnDateTimeChangeFunction');if(onChangeFunction){onChangeFunction.call(onChangeFunction);}});edit.d2l_lastGoodDate=me.GetSelectedDateTimeNodes(nodes);var dateTimeParser=null;var getDateTimeParser=function(){if(dateTimeParser===null){dateTimeParser=D2L.LP.Globalization.Locale.GetDateTimeParser();}return dateTimeParser;};var closing=false;var onMiniCalendarChange=function(){nodes=me.GetNodes(id,phid);if(nodes.floatingContainer!=null&&nodes.floatingContainer!=undefined){nodes.floatingContainer.tabIndex=-1;}if(nodes.miniCalendar!=null&&nodes.miniCalendar!=undefined){nodes.miniCalendar.editNode=nodes.edit;}};var isMiniCalendarOpen=function(){return D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpenNode(nodes.floatingContainer);};var openMiniCalendarFunc=D2L.LP.Web.UI.ObjectRepository.Get(nodes.edit.id,'OpenMiniCalendar');var openMiniCalendar=function(){if(closing||nodes.floatingContainer==null||isMiniCalendarOpen()){return;}openMiniCalendarFunc.call(openMiniCalendarFunc);onMiniCalendarChange();};var closeMiniCalendar=function(){closing=true;if(nodes.floatingContainer!=null&&isMiniCalendarOpen()){D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.CloseNode(nodes.floatingContainer);}setTimeout(function(){closing=false;},200);};var onChange=function(){var dateTime=edit.d2l_lastGoodDate;try{var parsedDate=getDateTimeParser().TryParseInputDate(edit.value);var time=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetTimeNodes(nodes.timeNodes);if(parsedDate!==null){dateTime=parsedDate;dateTime.m_hour=time.m_hour;dateTime.m_minute=time.m_minute;}}catch(e){}me.SetSelectedDateTimeByNode(nodes,dateTime);};var navOnKeyPress=function(kpArgs){var result=false;if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown){openMiniCalendar();if(nodes.miniCalendar!=null&&nodes.miniCalendar.navFocusDay){nodes.miniCalendar.navFocusSelectedDay();}result=true;}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab||kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape){closeMiniCalendar();}return result;};var onFocus=function(e){openMiniCalendar();};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(nodes.edit,function(kpArgs){var result=navOnKeyPress(kpArgs);if(result){var event=kpArgs.GetEventObject();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(event);}});D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',nodes.edit,onFocus);D2L.LP.Web.UI.Html.Dom.AddEventListener('change',nodes.edit,onChange);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',nodes.edit,openMiniCalendar);nodes.edit.closeMiniCalendar=closeMiniCalendar;nodes.edit.onMiniCalendarChange=onMiniCalendarChange;});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-datetime-selector');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-edit-required',function(node){D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'required','true');});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-edit',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StartTracking(node);if(!D2L.LP.Web.UI.ObjectRepository.HasKey(node.id)){return;}var prevNodeVal=node.value;var onKeyPress=function(kpArgs){if(D2L.LP.Web.UI.ObjectRepository.HasKeys(node.id,'key')){var onKeyPressFunction=D2L.LP.Web.UI.ObjectRepository.Get(node.id,'key');setTimeout(function(){onKeyPressFunction.call(onKeyPressFunction);},0);}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter&&D2L.LP.Web.UI.ObjectRepository.HasKeys(node.id,'enter')){var onEnterFunction=D2L.LP.Web.UI.ObjectRepository.Get(node.id,'enter');onEnterFunction.call(onEnterFunction);}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter&&D2L.LP.Web.UI.ObjectRepository.HasKeys(node.id,'change')){var dispatchOnChange=function(){if(prevNodeVal!==node.value){node.value=node.value;D2L.LP.Web.UI.Html.Dom.DispatchEvent("change",node);}};setTimeout(dispatchOnChange);}};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,function(kpArgs){onKeyPress(kpArgs);});if(D2L.LP.Web.UI.ObjectRepository.HasKeys(node.id,'change')){var onChangeFunction=D2L.LP.Web.UI.ObjectRepository.Get(node.id,'change');D2L.LP.Web.UI.Html.Dom.AddEventListener('change',node,function(){prevNodeVal=node.value;onChangeFunction.call(onChangeFunction);});}if(D2L.LP.Web.UI.ObjectRepository.HasKeys(node.id,'input')){var onInputFunction=D2L.LP.Web.UI.ObjectRepository.Get(node.id,'input');D2L.LP.Web.UI.Html.Dom.AddEventListener('input',node,function(){prevNodeVal=node.value;onInputFunction.call(onInputFunction);});}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-edit-suppress-form-submission',function(node){var onKeyPress=function(kpArgs){if(kpArgs.GetKey()===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter){var event=kpArgs.GetEventObject();event.preventDefault();}};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,onKeyPress);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-editable',function(node){if(!D2L.LP.Web.UI.ObjectRepository.HasKey(node.id)){return;}var anchor=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);D2L.LP.Web.UI.Html.Dom.SetAttribute(anchor,'href','javascript:void(0);');var autoResize=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-editable-autosize',node);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',node,function(){D2L.LP.Web.UI.Desktop.Controls.EditInPlace.ClickHelper(node,autoResize);});D2L.LP.Web.UI.Html.Dom.AddEventListener('click',anchor,function(e){var target=e.srcElement||e.target;if(target.isEqualNode(node)){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);return false;}D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',node);});D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',anchor,function(){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-editable-focus',node);});D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',anchor,function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-editable-focus',node);});D2L.LP.Web.UI.Desktop.Controls.EditInPlace.ModifyAnchors(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-editable-target-edit',function(node){var isRequired=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-editable-target-edit-required',node);var input=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-edit',node);var finish2=function(hasChanged,isEmpty){input.d2l_value=null;D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(node,hasChanged,isEmpty);};var finish=function(bypassType){if(input.d2l_value===null){return;}var value=input.value.trim();var isEmpty=value.length===0;var bypassValidation=true;if(bypassType===1){input.value=input.d2l_value;}else if(bypassType===2&&isEmpty&&isRequired){input.value=input.d2l_value;}else{input.value=value;bypassValidation=false;}value=input.value;isEmpty=value.length===0;var hasChanged=input.d2l_value.trim()!==value;if(!bypassValidation&&isRequired){if(!isEmpty){finish2(hasChanged,isEmpty);}}else{finish2(hasChanged,isEmpty);}};var handleKeyPress=function(kpArgs){var key=kpArgs.GetKey();if(key==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter){finish(0);}else if(key==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape){finish(1);}};D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',input,function(){finish(2);});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(input,handleKeyPress);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-editable-target-longedit',function(node){var input=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-longedit',node);var finish=function(bypassType){if(input.d2l_value===null){return;}var value=input.value.trim();if(bypassType==1){value=input.d2l_value;}var hasChanged=input.d2l_value!==value;var isEmpty=value.length===0;input.value=value;input.d2l_value=null;D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(node,hasChanged,isEmpty);};var handleKeyPress=function(kpArgs){var key=kpArgs.GetKey();if(key==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape){finish(1);}};D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',input,finish);D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(input,handleKeyPress);});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-editable');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-latexeditor',function(node){var dom=D2L.LP.Web.UI.Html.Dom,latexEditor=D2L.LP.Web.UI.Desktop.Controls.EquationEditor.LatexEditor;var latexnode=dom.GetFirstElementByClassName("d2l-latexedit",node);var previewNode=dom.GetFirstElementByClassName("d2l-mathpreview",node);var typingTimer;var doneTypingInterval=800;var inputCallback=function(){clearTimeout(typingTimer);var doneTyping=function(){latexEditor.GetMathML(node,function(mathml){latexEditor.SetPreviewMathML(previewNode,mathml);});};typingTimer=setTimeout(doneTyping,doneTypingInterval);};dom.AddEventListener('input',latexnode,inputCallback);var help=dom.GetFirstElementByClassName("d2l-equation-latexhelp",node);help.focus();window.onload=function(){setTimeout(function(){if(window.MathJax){MathJax.Hub.Config({tex2jax:{displayMath:[['$$','$$'],['\\[','\\]']],inlineMath:[['\\(','\\)']]}});}inputCallback();},0);};});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-equationeditor',function(node){var mathml=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-mathml");var toolbarType=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-wiristoolbartype");if(!toolbarType){toolbarType="general";}var graphicalNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-graphicalequationeditor",node);var culture=D2L.LP.Globalization.Locale.GetCultureCode();if(culture!=null){culture=culture.Culture;}else{culture="en";}if(graphicalNode!=null){function parseUrl(inputStr){var matches=inputStr.match(/^([^/]+\/\/[^/]+)(\/.+)$/);return{origin:matches[1],pathname:matches[2]};}var currentUrl=parseUrl(document.URL);var wiris_defaultBasePath=parseUrl(com.wiris.jsEditor.defaultBasePath);var wiris_defaultServicePath=parseUrl(com.wiris.jsEditor.defaultServicePath);com.wiris.jsEditor.defaultBasePath=currentUrl.origin+wiris_defaultBasePath.pathname;com.wiris.jsEditor.defaultServicePath=currentUrl.origin+wiris_defaultServicePath.pathname;var editorOptions={'language':culture,'toolbar':'<toolbar ref="'+toolbarType+'"/>','checkSyntax':'false','detectHand':'false'};var editor=com.wiris.jsEditor.JsEditor.newInstance(editorOptions);editor.insertInto(graphicalNode);}D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.SetMath(node,mathml);var win=win||window;var dialogs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-dialog-frame',win.parent.document);var dialog=null;for(var i=0;i<dialogs.length;i++){if(dialogs[i].contentWindow==win){dialog=dialogs[i].parentNode.parentNode;}}if(dialog!=null){var h=dialog.d2l_handle.frame.contentWindow.D2L.LP.Web.UI.ObjectRepository.TryGet('DialogHeight',0);D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"data-d2l-initialheight",h);}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-expandcollapse',function(node){var links=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-imagelink',node);var key=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-key');var groupName=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-group');var onStateChanged=null;if(groupName!==null){onStateChanged=D2L.LP.Web.UI.ObjectRepository.TryGet(groupName,'ItemStateChanged');}var triggerChange=function(state){if(!D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.SuppressStateChangeEvent){if(groupName!==null&&key!==null){D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.SetChangedKey(key,state);if(onStateChanged!==null){onStateChanged.call(onStateChanged);}}}};D2L.LP.Web.UI.Html.Dom.AddEventListener('click',links[0],function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(evt||window.event);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(links[1],true);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(links[0],false);D2L.LP.Web.UI.Html.Dom.DispatchEvent('toggle',node);if(!D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.SuppressFocusChange){D2L.LP.Web.UI.Html.Dom.FocusNode(links[1]);}triggerChange(false);});D2L.LP.Web.UI.Html.Dom.AddEventListener('click',links[1],function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(evt||window.event);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(links[0],true);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(links[1],false);D2L.LP.Web.UI.Html.Dom.DispatchEvent('toggle',node);if(!D2L.LP.Web.UI.Desktop.Controls.ExpandCollapse.SuppressFocusChange){D2L.LP.Web.UI.Html.Dom.FocusNode(links[0]);}triggerChange(true);});});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-expandcollapse');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('vui-field-row',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Tracker.TrackChanges(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('vui-change-tracker',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Tracker.TrackChanges(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-fileinput',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var initialChangeKey=me.GetChangeKey(node);$(node).data('changeKey',initialChangeKey);me.SetAddFileVisibility(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-fileinput-upload-progress',function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,'progressbar');D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'aria-valuemin','0');D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'aria-valuemax','100');D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'aria-valuenow','0');});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-fileinput');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-filterinline-group',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;var isSingle=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-filterinline-group-single',node);var nodes=me.GetNodesNode(node);var label=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);label.id=new D2L.LP.Web.UI.Html.UniqueHtmlId().GetValue();D2L.LP.Web.UI.Html.Aria.SetRole(node,isSingle?'radiogroup':'group');D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'labelledby',label.id);for(var i=0;i<nodes.anchors.length;i++){var anchors=nodes.anchors;D2L.LP.Web.UI.Html.Aria.SetRole(anchors[i].parentNode,'presentation');D2L.LP.Web.UI.Html.Aria.SetRole(anchors[i],isSingle?'radio':'checkbox');if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(anchors[i],'href')){D2L.LP.Web.UI.Html.Dom.SetAttribute(anchors[i],'onclick','this.focus(); return false;');D2L.LP.Web.UI.Html.Dom.SetAttribute(anchors[i],'href','javascript:void(0);');}var newIsSelected=me.IsSelectedNode(anchors[i]);me.SetIsSelectedNodes(node.id,nodes,anchors[i],newIsSelected,false);D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',anchors[i],function(index){return function(){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-filterinline-item-focus',anchors[index]);};}(i));D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',anchors[i],function(index){return function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-filterinline-item-focus',anchors[index]);};}(i));D2L.LP.Web.UI.Html.Dom.AddEventListener('click',anchors[i],function(index){return function(){if(isSingle){for(var j=0;j<anchors.length;j++){me.SetIsSelectedNodes(node.id,nodes,anchors[j],false,false);}}newIsSelected=me.IsSelectedNode(anchors[index]);me.SetIsSelectedNodes(node.id,nodes,anchors[index],!newIsSelected,true);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-filterinline-item-focus',anchors[index]);};}(i));}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-filterinline',function(node){if(D2L.LP.Web.UI.ObjectRepository.HasKeys(node.id,'IsEmpty')){var isEmpty=D2L.LP.Web.UI.ObjectRepository.Get(node.id,'IsEmpty');if(isEmpty){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',node);}return;};var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;me.RenderClear(node);});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-filterinline');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-fileupload',function(node){var fu_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileupload-cont",node);var fu_input=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileupload-input",node);var fu_input_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileupload-fileinput-cont",node);var fu_input_progressbar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileupload-progressbar-cont",node);var fu_hidden_tempFileId=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(fu_cont);var fu_filelink;var fu_deleteIcon=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filelink-deleteicon",node);var fu_abortButton=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileupload-abortbutton",node);D2L.LP.Web.UI.Html.Dom.RemoveElement(fu_deleteIcon);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",fu_deleteIcon);var fu_filelink_placeholder_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filelink-placeholder",node);var fu_hidden_iFrame;var fu_temp_form;var fu_hiddenIFrameName="uploadIFrame";var fu_addProgressBar;var fu_removeProgressBar;var fu_getFileUploadErrorMessage;var fu_generateValidators;var fu_uploadCallback;var fu_generateForm;var fu_handleDelete;var fu_handleAbort;var fu_handleFileLinkChange;fu_addProgressBar=function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",fu_input_progressbar);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",fu_abortButton);};fu_removeProgressBar=function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",fu_input_progressbar);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",fu_abortButton);};fu_getFileUploadErrorMessage=function(errCode){var errMessage="";var subkey="";if(errCode==D2L.LP.Web.UI.Desktop.Controls.FileUpload.ErrCodeMaxFileSize){subkey="InvalidFileSizeMessage";}else if(errCode==D2L.LP.Web.UI.Desktop.Controls.FileUpload.ErrCodeTotalFileSize){subkey="InvalidTotalFileSizeMessage";}else if(errCode==D2L.LP.Web.UI.Desktop.Controls.FileUpload.ErrCodeRestrictedFile){subkey="InvalidRestrictedFileMessage";}else{return false;}var getErrorMessageFunc=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,subkey);errMessage=getErrorMessageFunc(getErrorMessageFunc);return errMessage;};fu_generateValidators=function(inputId,validationFunc,errMessage){var validators=[];var validatorFunc=function(){return D2L.LP.Web.UI.Desktop.Controls.ValidatorCustom.GenerateValidatorObject(inputId,validationFunc,errMessage);};validators.push(validatorFunc());return validators;};fu_uploadCallback=function(fileData){var jsonblob=fileData.replace(/\'/g,"\"");var json=D2L.LP.Web.Serialization.Json.Deserialize(jsonblob);var deserializer=new D2L.LP.Web.Serialization.Json.Deserializer(json);var fileId=deserializer.GetMember("FileId",false);var failReason=deserializer.GetMember("FailReason",false);var failCode=deserializer.GetMember("FailCode",false);fu_cont.appendChild(fu_input_cont);var validationFunction=function(){return fileId?true:false;};var validationSourceId=fu_input.id;var validationErrorMessage=fu_getFileUploadErrorMessage(failCode);var validators=fu_generateValidators(validationSourceId,validationFunction,validationErrorMessage);D2L.LP.Web.UI.Desktop.Controls.Form.Validate(fu_temp_form,validators);if(fileId){fu_hidden_tempFileId.value=fileId;var fileUploadPartialRenderFunction=D2L.LP.Web.UI.ObjectRepository.Get(node.id,'FileLinkPartial');var func=function(){fu_filelink_placeholder_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filelink-placeholder",node);fu_filelink=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filelink",node);var _anchor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filelink-link",fu_filelink);D2L.LP.Web.UI.Html.Dom.InsertElementAfter(fu_deleteIcon,fu_filelink);D2L.LP.Web.UI.Html.Dom.SetAttribute(fu_deleteIcon,"href","javascript:void(0);");D2L.LP.Web.UI.Html.Dom.AddEventListener("click",fu_deleteIcon,fu_handleDelete);_anchor.focus();};fileUploadPartialRenderFunction.call(fileUploadPartialRenderFunction).AddListener(func);D2L.LP.Web.UI.Html.Dom.RemoveElement(fu_input_cont);}else{fu_input.focus();}D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",fu_input_cont);fu_removeProgressBar();setTimeout(function(){fu_cont.removeChild(fu_hidden_iFrame);fu_cont.removeChild(fu_temp_form);},0);};fu_generateForm=function(){var maxFileSizeFunc=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"MaxFileSize");var maxFileSize=maxFileSizeFunc(maxFileSizeFunc);var totalFileSizeFunc=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"TotalFileSize");var totalFileSize=totalFileSizeFunc(totalFileSizeFunc);var _form=document.createElement("FORM");D2L.LP.Web.UI.Html.Dom.SetAttribute(_form,"action",D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetAction(fu_input.value,fu_uploadCallback,node.id,fu_input.id,maxFileSize,totalFileSize,0));D2L.LP.Web.UI.Html.Dom.SetAttribute(_form,"id",node.id+"_form");D2L.LP.Web.UI.Html.Dom.SetAttribute(_form,"method","post");D2L.LP.Web.UI.Html.Dom.SetAttribute(_form,"enctype","multipart/form-data");D2L.LP.Web.UI.Html.Dom.SetAttribute(_form,"encoding","multipart/form-data");_form.target=fu_hiddenIFrameName;_form.onsubmit="return false;";return _form;};fu_handleDelete=function(){D2L.LP.Web.UI.Html.Dom.RemoveElement(fu_filelink);D2L.LP.Web.UI.Html.Dom.RemoveElement(fu_deleteIcon);fu_cont.appendChild(fu_input_cont);setTimeout(function(){fu_input.focus();},0);};fu_handleAbort=function(){D2L.LP.Web.UI.Html.Dom.RemoveElement(fu_input_cont);D2L.LP.Web.UI.Html.Dom.RemoveElement(fu_temp_form);fu_cont.appendChild(fu_input_cont);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",fu_input_cont);D2L.LP.Web.UI.Html.Dom.RemoveElement(fu_hidden_iFrame);setTimeout(function(){fu_input_cont.focus();fu_removeProgressBar();fu_input.focus();},0);};fu_handleFileLinkChange=function(){var validateFileTypeFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'ValidateFileType');var invalidFileExtensionMessageFunc=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'InvalidFileExtensionMessage');var validateFileTypeInputId=fu_input.id;var result=validateFileTypeFunction(validateFileTypeFunction);var validationFunction=function(){return result;};var validateFileTypeMessage=invalidFileExtensionMessageFunc(invalidFileExtensionMessageFunc);fu_hidden_iFrame=D2L.LP.Web.UI.Desktop.Controls.FileUpload.GenerateIFrame(fu_hiddenIFrameName,fu_cont);D2L.LP.Web.UI.Html.Dom.SetAttribute(fu_input,"name","uploadFile");fu_temp_form=null;fu_temp_form=fu_generateForm();fu_cont.removeChild(fu_input_cont);fu_temp_form.appendChild(fu_input_cont);fu_cont.appendChild(fu_temp_form);var validators=fu_generateValidators(validateFileTypeInputId,validationFunction,validateFileTypeMessage);var failed=true;D2L.LP.Web.UI.Desktop.Controls.Form.Validate(fu_temp_form,validators).AddListener(function(passed){if(passed){failed=false;fu_cont.removeChild(fu_temp_form);fu_hidden_iFrame.appendChild(fu_temp_form);fu_addProgressBar();fu_temp_form.submit();}else{}});setTimeout(function(){if(failed){fu_cont.removeChild(fu_temp_form);fu_hidden_iFrame.appendChild(fu_temp_form);}fu_temp_form.reset();fu_temp_form.removeChild(fu_input_cont);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",fu_input_cont);fu_cont.appendChild(fu_input_cont);fu_cont.removeChild(fu_input_cont);if(failed){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",fu_input_cont);fu_cont.appendChild(fu_input_cont);fu_cont.removeChild(fu_hidden_iFrame);}else{fu_hidden_iFrame.removeChild(fu_temp_form);fu_cont.appendChild(fu_temp_form);}D2L.LP.Web.UI.Html.Dom.SetAttribute(fu_input,"name","");fu_input.value="";fu_abortButton.focus();},0);};D2L.LP.Web.UI.Html.Dom.AddEventListener("change",fu_input,fu_handleFileLinkChange);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",fu_abortButton,fu_handleAbort);});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-fileupload');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-fileviewer-image',function(node){var content=$(node);var viewer=content.closest('.d2l-fileviewer');var location=content.attr('data-location');var altText=content.attr('data-alt');var maxHeight=content.attr('data-max-height');var expandFullHeight=content.attr('data-expand-full-height')==='1';var useScrollableContainer=content.attr('data-use-scrollable-container')==='1';var isDialogStyle=content.attr('data-is-dialog-style')==='1';var rotationClass=content.attr('data-rotation-class');var imageRatio=content.attr('data-img-ratio');viewer.css('overflow','hidden');viewer.css('min-height','100%');content.append('<img class="d2l-fileviewer-rendered-image"/>');var renderedImage=content.find('.d2l-fileviewer-rendered-image');if(expandFullHeight){var viewport=$(document).height();var dialogBody=$('.d2l-dialog-body');dialogBody.css('font-size',0);renderedImage.css('max-height',viewport);}if(maxHeight!==undefined){renderedImage.css('max-height',maxHeight);}if(rotationClass){renderedImage.addClass(rotationClass);var ratio=parseFloat(imageRatio);if(ratio){var transform=renderedImage.css('transform');renderedImage.css('transform',transform+" scale("+ratio+","+ratio+")");}}renderedImage.load(function(){var viewport=$(document).height();D2L.LP.Web.UI.Desktop.Controls.FileViewer.OnPluginLoad('.d2l-fileviewer-rendered-image',viewport);}).attr({src:location,alt:altText});var adjustImageSize=function(dialogBodyHeight,content,renderedImage){renderedImage.css('max-width','100%');var dialogPadding=$('.d2l-dialog-padding');var dialogPaddingHeight=dialogPadding.innerWidth()-dialogPadding.width();renderedImage.css('max-height',dialogBodyHeight-dialogPaddingHeight);};var resize=function(){var viewport=$(window).height();var dialogBody=$('.d2l-dialog-body');var dialogBodyHeight=dialogBody.height();dialogBody.height(viewport);if(isDialogStyle){if(useScrollableContainer){dialogBodyHeight=viewport;}adjustImageSize(dialogBodyHeight,content,renderedImage);}else{var contentHeight=expandFullHeight?viewport:renderedImage.innerHeight();renderedImage.css('max-width','100%');D2L.LP.Web.UI.Desktop.Controls.FileViewer.OnPluginLoad(renderedImage,contentHeight);}};$(window).resize(resize);resize();});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-floating-container',function(elem){D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(elem,function(kpArgs){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape){D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.CloseNode(elem,true);}});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-form',function(form){var $form=$(form);var submitFormOnEnterBuster=document.createElement('input');submitFormOnEnterBuster.type='text';submitFormOnEnterBuster.className='d2l-hidden';submitFormOnEnterBuster.setAttribute('aria-label','ignore');form.appendChild(submitFormOnEnterBuster);var trackChanges=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-form-track-changes',form)&&D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-dialog-body',document)==null&&D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-form-track-changes',form)==null;if(trackChanges){D2L.LP.Web.UI.Html.ChangeTracking.Tracker.TrackChanges(form,false);}$form.on('vui-change',function(evt){var onChangeFunc=D2L.LP.Web.UI.ObjectRepository.TryGet(form.id,'change');if(onChangeFunc!==null&&D2L.LP.Web.UI.Html.Dom.IsAncestor(form,evt.target)){onChangeFunc.call(onChangeFunc);}});if(!trackChanges)return;form.m_stopChangeTrackingPrompt=false;window.onbeforeunload=function(){if(form.m_stopChangeTrackingPrompt){return;}if(D2L.LP.Web.UI.Desktop.Controls.Form.HasChangedNode(form)){return'Unsaved Changes';}};});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-fragment',function(node){D2L.LP.Web.UI.Desktop.Controls.Fragment.Init(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-grid-sel-input',function(node){var gridId=D2L.LP.Web.UI.Desktop.Controls.Grid.GetGridIdByDescendantNode(node);var cellNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-grid-cell-sel',node);var clickFunction=function(){if(node.type=='radio'){D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateSelectionStyleForAllInputs(gridId);D2L.LP.Web.UI.Desktop.Controls.Grid.ResetSelectionState(gridId);}D2L.LP.Web.UI.Desktop.Controls.Grid.AddOrUpdateSelectionStateAndStyle(gridId,node);D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateCountText(gridId);D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateActionButtons(gridId);};D2L.LP.Web.UI.Html.Dom.AddEventListener('click',node,clickFunction);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',cellNode,function(e){var target=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);if(target!==node){node.checked=!node.checked;clickFunction();}});var row=cellNode.parentNode;var rowHeader=row.getElementsByTagName('th')[0];var labelledById=D2L.LP.Web.UI.Html.Dom.GetAttribute(row,"data-sel-labelled-by");if(labelledById){D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'labelledby',labelledById);}else{D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'labelledby',rowHeader.id);}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-grid-sel-page-input',function(node){var gridId=D2L.LP.Web.UI.Desktop.Controls.Grid.GetGridIdByDescendantNode(node);var isGridEmpty=D2L.LP.Web.UI.Desktop.Controls.Grid.IsEmpty(gridId);if(isGridEmpty){node.disabled=true;node.title='';return;}var cellNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-grid-cell-sel',node);var clickFunction=function(){D2L.LP.Web.UI.Desktop.Controls.Grid.SetAllPageIsSelected(gridId,node.checked);};D2L.LP.Web.UI.Html.Dom.AddEventListener('click',node,clickFunction);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',cellNode,function(e){var target=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);if(target!==node){node.checked=!node.checked;clickFunction();}});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-grid-wrapper',function(node){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.id);var isEmpty=D2L.LP.Web.UI.Desktop.Controls.Grid.IsEmpty(id);var sortField=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),"SortField");if(sortField){D2L.LP.Web.UI.Desktop.Controls.Grid.SetSortField(id,sortField);}D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateCountText(id);D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateActionButtons(id);if(D2L.LP.Web.UI.Desktop.Controls.Grid.GetHasMoreItems(id)===false&&!isEmpty){D2L.LP.Web.UI.Desktop.Controls.Grid.SetFooterIsVisible(id,false);}var onBeforeSubmit=function(form){if(D2L.LP.Web.UI.Html.Dom.IsAncestor(form,node)){var selectionInfoHidden=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-selection-info-hidden',node);if(!selectionInfoHidden){var hiddenContainerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-selected-keys-hidden-container',node);if(hiddenContainerNode){D2L.LP.Web.UI.Html.Dom.RemoveChildElements(hiddenContainerNode);}return;}var selectionInfo=D2L.LP.Web.UI.Desktop.Controls.Grid.GetSelectionInfo(id);var hiddenName=selectionInfoHidden.name;var serializer=new D2L.LP.Web.Serialization.Serializer();serializer.AddMember(hiddenName,selectionInfo);var hiddenContainer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-grid-selected-keys-hidden-container',node);if(hiddenContainer){D2L.LP.Web.UI.Html.Dom.RemoveChildElements(hiddenContainer);}else{hiddenContainer=document.createElement('div');hiddenContainer.className='d2l-grid-selected-keys-hidden-container';node.appendChild(hiddenContainer);}var serializeMembers=serializer.GetMembers();for(var i=0;i<serializeMembers.length;i++){var hidden=document.createElement('input');hidden.type='hidden';hidden.name=serializeMembers[i][0];hidden.value=serializeMembers[i][1];hiddenContainer.appendChild(hidden);}}};node.d2l_onBeforeSubmitHandle=onBeforeSubmit;D2L.LP.Web.UI.Desktop.Controls.Form.OnBeforeSubmit.AddListener(onBeforeSubmit);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-grid-header-sort-field',function(node){var gridId=D2L.LP.Web.UI.Desktop.Controls.Grid.GetGridIdByDescendantNode(node);var isCurrentSort=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-iscurrentsort')=='1';var fieldName=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-fieldname');var isClickable=!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-grid-header-sort-field-no-click',node);var isGridEmpty=D2L.LP.Web.UI.Desktop.Controls.Grid.IsEmpty(gridId);if(isGridEmpty){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-grid-header-sort-field-disabled',node);if(isCurrentSort){var isAscending=!D2L.LP.Web.UI.Html.Dom.HasAttribute(node,'desc');D2L.LP.Web.UI.Desktop.Controls.Grid.SetSortField(gridId,fieldName,isAscending?D2L.LP.Web.UI.Desktop.Controls.Grid.SortDirection.Ascending:D2L.LP.Web.UI.Desktop.Controls.Grid.SortDirection.Descending);}return;}if(!isClickable){return;}D2L.LP.Web.UI.Html.Aria.SetRole(node,'button');D2L.LP.Web.UI.Desktop.Controls.Link.InstallClickable(node);var onClickSortDirection;if(isCurrentSort){var isAscending=!D2L.LP.Web.UI.Html.Dom.HasAttribute(node,'desc');var sortDirection=isAscending?D2L.LP.Web.UI.Desktop.Controls.Grid.SortDirection.Ascending:D2L.LP.Web.UI.Desktop.Controls.Grid.SortDirection.Descending;onClickSortDirection=isAscending?D2L.LP.Web.UI.Desktop.Controls.Grid.SortDirection.Descending:D2L.LP.Web.UI.Desktop.Controls.Grid.SortDirection.Ascending;D2L.LP.Web.UI.Desktop.Controls.Grid.SetSortField(gridId,fieldName,sortDirection);if(D2L.LP.Web.UI.Desktop.Controls.Grid.m_reloadTriggeredBySort){node.focus();}}else{var defaultSortDirection=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-defaultsortdirection');onClickSortDirection=defaultSortDirection;}D2L.LP.Web.UI.Html.Dom.AddEventListener('click',node,function(){D2L.LP.Web.UI.Desktop.Controls.Grid.SetSortFieldAndReload(gridId,fieldName,onClickSortDirection);});var mouseOver=false;D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseover',node,function(){if(!mouseOver){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-grid-header-cell-hover',node.parentNode);}mouseOver=true;});D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseout',node,function(){if(mouseOver){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-grid-header-cell-hover',node.parentNode);}mouseOver=false;});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-grid-header-sort-field-multikey',function(node){var gridId=D2L.LP.Web.UI.Desktop.Controls.Grid.GetGridIdByDescendantNode(node);var parentHeader=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-grid-header-cell',node);var flyoutOpener=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-menuflyout-opener',node);parentHeader.style.overflow='visible';var isGridEmpty=D2L.LP.Web.UI.Desktop.Controls.Grid.IsEmpty(gridId);if(isGridEmpty){return;}var handleClick=function(evt){var target=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(evt);if(target===node||target===parentHeader){D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',flyoutOpener);}};D2L.LP.Web.UI.Html.Dom.AddEventListener('click',parentHeader,handleClick);D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseover',parentHeader,function(){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-grid-header-sort-field-multikey-hover',parentHeader);});D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseout',parentHeader,function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-grid-header-sort-field-multikey-hover',parentHeader);});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-hidden-track',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StartTracking(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-hour-selector',function(node){var select=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-select',node);var hidden=D2L.LP.Web.UI.Html.Dom.GetLastElementChild(node);D2L.LP.Web.UI.Html.Dom.AddEventListener('change',select,function(){var option=select.options[select.selectedIndex];hidden.value=option.value;});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmlblock',function(node){if(node.classList.contains('d2l-htmlblock-deferred'))return;D2L.LP.Web.UI.Desktop.Controls.HtmlBlock.RenderMentionsLinks(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmlblock-deferred',function(node){var replaceTemplate=function(template){var clone=document.importNode(template.content,true);node.replaceChild(clone,template);if(node.querySelector('math')){var nodes=node.getElementsByTagName('math');if(!nodes||nodes.length===0){node.innerHTML=node.innerHTML;}}D2L.LP.Web.UI.Desktop.Controls.HtmlBlock.RenderMentionsLinks(node);D2L.LP.Web.UI.Desktop.Controls.HtmlBlock.OnAfterRender.Trigger(node,clone);};var stamp=function(){var template=node.querySelector('template');if(!template){return;}if(!template.content){setTimeout(function(){replaceTemplate(template);},0);}else{replaceTemplate(template);}};D2L.WebComponentsReady.then(stamp);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmleditor-wc',function(node){if(window.D2L&&window.D2L.Provider)window.D2L.Provider.provideInstance(node,'isfContextId',node.getAttribute('data-d2l-isf-contextid'));var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var id=node.getAttribute('id');var initialChangeKey=htmlEditor.GetChangeKey(node);node.d2l_initialChangeKey=initialChangeKey;node.d2l_changeKey=initialChangeKey;document.addEventListener('vui-reset',function(evt){var changeKey=node.d2l_changeKey;var hasChanged=changeKey!==node.d2l_initialChangeKey;var isParentTracker=D2L.LP.Web.UI.Html.Dom.IsAncestor(evt.target,node);if(!isParentTracker||!hasChanged)return;node.d2l_initialChangeKey=changeKey;D2L.LP.Web.UI.Html.ChangeTracking.Trackable.TriggerRestore(node);});D2L.LP.Web.UI.Html.Dom.AddEventListener('d2l-htmleditor-image-upload-start',node,function(){htmlEditor.OnImageUploadStart(id);});D2L.LP.Web.UI.Html.Dom.AddEventListener('d2l-htmleditor-image-upload-complete',node,function(){htmlEditor.OnImageUploadComplete(id);});D2L.LP.Web.UI.Html.Dom.AddEventListener('d2l-htmleditor-update',node,function(){htmlEditor.TriggerChangeEvent(node);});node.d2l_onBeforeFormSubmitListener=function(){htmlEditor.UpdateFilesNodeByNode(node);htmlEditor.SetHiddenHtml(id);};D2L.LP.Web.UI.Desktop.Controls.Form.OnBeforeSubmit.AddListener(node.d2l_onBeforeFormSubmitListener);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmleditor-toolbar',function(node){var toolbarLabel=node.getAttribute('data-d2l-toolbar-label');if(toolbarLabel!=null){D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'label',toolbarLabel);}D2L.LP.Web.UI.Html.Aria.SetRole(node,'toolbar');});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmleditor-wysiwyg',function(node){if(tinyMCE.majorVersion&&tinyMCE.majorVersion>=4&&node.d2l_initialized){return;}var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core;var id=node.getAttribute('id');var textAreaId=me.GetTextAreaId(node);var isInline=htmlEditor.IsInlineByNode(node);var allowSpellChecker=htmlEditor.AllowSpellCheckerByNode(node);var pluginInitializers=D2L.LP.Web.UI.ObjectRepository.TryGet(id,'pluginInitializers');var contentCss=node.getAttribute('data-d2l-editor-content-css');node.d2l_control=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;if(tinyMCE.majorVersion&&tinyMCE.majorVersion>=4&&!node.d2l_initialized){core.CleanUp(textAreaId);}if(!node.d2l_initialized){node.d2l_files=[];node.d2l_files_queued=0;node.d2l_onContentFocus=new D2L.LP.Web.UI.Events.Event();}core.Initialize({'allowSpellChecker':allowSpellChecker,'contentCss':contentCss,'editorId':id,'fullPage':{'fontSize':node.getAttribute('data-d2l-editor-fullpage-fontsize'),'fontFamily':node.getAttribute('data-d2l-editor-fullpage-fontface')},'initializeCallback':function(){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.InitializeCallback(textAreaId);},'initializers':pluginInitializers,'isInline':isInline,'isRTL':isRTL,'langTermsLocation':node.getAttribute('data-d2l-langterms-location'),'layoutCallback':D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.InitializeLayout,'textAreaId':textAreaId});if(!node.d2l_initialized){node.d2l_initialized=true;core.Add(textAreaId);}node.d2l_onBeforeSubmitHandle=function(form){htmlEditor.UpdateFilesNodeByNode(node);me.UpdateTextArea(textAreaId);};D2L.LP.Web.UI.Desktop.Controls.Form.OnBeforeSubmit.AddListener(node.d2l_onBeforeSubmitHandle);var skipToolbarsNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-skiptoolbars',node);var onClickSkipToolbars=skipToolbarsNode.getAttribute('data-onclick');D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',skipToolbarsNode,function(){setTimeout(function(){skipToolbarsNode.d2l_onClickHandle=function(){eval(onClickSkipToolbars);};D2L.LP.Web.UI.Html.Dom.AddEventListener('click',skipToolbarsNode,skipToolbarsNode.d2l_onClickHandle);},0);});D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',skipToolbarsNode,function(){D2L.LP.Web.UI.Html.Dom.RemoveEventListener('click',skipToolbarsNode,skipToolbarsNode.d2l_onClickHandle);});D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',node,function(e){node.d2l_hasFocus=true;D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-htmleditor-frosted',node);},true);D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',node,function(e){node.d2l_hasFocus=false;setTimeout(function(){if(!node.d2l_hasFocus){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-htmleditor-frosted',node);}},0);},true);var focus=function(){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.FocusByNode(node);};node.focus=focus;D2L.LP.Web.UI.Events.VisibilityManager.AddListener(node,function(isDisplayed){if(isDisplayed){htmlEditor.UpdateComponentVisibilityByNode(node);}});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmleditor-texteditor',function(node){node.d2l_control=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.TextEditor;if(!node.d2l_initialized){node.d2l_initialized=true;node.d2l_isDirty=false;node.d2l_files=[];node.d2l_files_queued=0;}var controlWidth=node.getAttribute('data-d2l-width');var controlHeight=node.getAttribute('data-d2l-height');var footerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-footer',node);var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-textarea',node);var setSize=function(height,width){node.style.width=width;node.style.height=height;var controlRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);var footerRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(footerNode);textAreaNode.style.height=controlRect.height-footerRect.height-10+'px';};setSize(controlHeight,controlWidth);var resizeHandle=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-resize',node);var resizeSettings={Handle:resizeHandle,DisplayType:'hidden',GhostType:D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow};var onResize=D2L.LP.Web.UI.Html.DragDrop.MakeResizeableNode(node,resizeSettings,window,window);onResize.AddListener(function(size){setSize(size.height+'px',size.width+'px');});D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StartTracking(textAreaNode);D2L.LP.Web.UI.Html.Dom.AddEventListener('change',textAreaNode,function(){node.d2l_isDirty=true;});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmleditor-noeditor',function(node){node.d2l_control=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.NoEditor;if(!node.d2l_initialized){node.d2l_initialized=true;node.d2l_files=[];node.d2l_files_queued=0;}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmleditor-fraeditor',function(node){node.d2l_control=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.FraEditor;if(!node.d2l_initialized){node.d2l_initialized=true;node.d2l_isDirty=false;node.d2l_files=[];node.d2l_files_queued=0;}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmleditor-button',function(node){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.InitializeByNode(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmleditor-buttonmenuitem',function(node){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.InitializeByNode(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmleditor-color-button',function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,'button');var title=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'title');if(title!=null&&title.length>0){D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'label',title);}D2L.LP.Web.UI.Desktop.Controls.Link.InstallClickable(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmleditor-split-button',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton;D2L.LP.Web.UI.Html.Aria.SetRole(node,'button');var title=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'title');if(title!=null&&title.length>0){D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'label',title);}D2L.LP.Web.UI.Desktop.Controls.Link.InstallClickable(node);var onClick=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-onclick');D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,'data-onclick');D2L.LP.Web.UI.Html.Dom.AddEventListener('click',node,function(){eval(onClick);});var iconNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-split-button-icon',node);var menuContainer=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);var menuItems=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-htmleditor-buttonmenuitem',menuContainer);var activeKey=null;var itemsData={};var registerMenuItemEvents=function(menuItemNode){var menuItemKey=menuItemNode.getAttribute('data-d2l-key');menuItemNode.d2l_activeHandler=function(isActive){if(menuItemKey===node.getAttribute('data-d2l-key')){me.SetIsActiveByNode(node,isActive);}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.GetOnActiveChangeByNode(menuItemNode).AddListener(menuItemNode.d2l_activeHandler);menuItem.d2l_enabledHandler=function(isEnabled){if(menuItemKey===node.getAttribute('data-d2l-key')){me.SetIsEnabledByNode(node,isEnabled);}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.GetOnEnabledChangeByNode(menuItemNode).AddListener(menuItem.d2l_enabledHandler);};for(var i=0;i<menuItems.length;i++){var menuItem=menuItems[i];var key=menuItem.getAttribute('data-d2l-key');var txtNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-buttonmenuitem-text',menuItem);var imgNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-buttonmenuitem-icon',menuItem);if(key!==undefined&&key!=null){itemsData[key]={className:imgNode.className.replace('d2l-htmleditor-buttonmenuitem-icon',''),key:key,src:imgNode.src,title:D2L.LP.Web.UI.Html.Dom.GetTextContent(txtNode)};if(activeKey===null){activeKey=key;}}registerMenuItemEvents(menuItem);}node.d2l_itemsData=itemsData;if(activeKey===null){return;}D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.UpdateByNode(node,activeKey);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmleditor-texttype-text',function(node){D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,'aria-label');});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-htmleditor-symbol',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View;var listNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-symbol-list',node);var charNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-htmleditor-symbol-char',listNode);var editId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.getAttribute('data-d2l-editId'));var installOnClick=function(charNode){D2L.LP.Web.UI.Desktop.Controls.Link.InstallClickable(charNode);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',charNode,function(){var numCode=charNode.getAttribute('data-d2l-numcode');D2L.LP.Web.UI.Desktop.Controls.Edit.SetValue(editId,numCode);me.SetSelectedSymbolByNode(node,numCode);});};for(var i=0;i<charNodes.length;i++){var charNode=charNodes[i];installOnClick(charNode);}D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',charNodes[0]);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-iframe',function(iframe){var onClick=D2L.LP.Web.UI.Events.OnClick;var $iframe=$(iframe);var loadingIcon=$iframe.prev('.d2l-iframe-loading-container');if(!loadingIcon.length){loadingIcon=$iframe.parent().prev('.d2l-iframe-loading-container');}var showContent=function(){loadingIcon.hide();$iframe.removeClass('d2l-iframe-offscreen');};D2L.LP.Web.UI.Desktop.Controls.IFrame.AddOnLoadHandler(iframe,showContent);var loadHandler=function(){var handleClick=function(evt){onClick.Trigger(evt);};try{D2L.LP.Web.UI.Html.Dom.AddEventListener('click',iframe.contentWindow.document,handleClick);}catch(e){}try{var mathJaxMessageNode=D2L.LP.Web.UI.Html.Dom.GetElementById('MathJax_MSIE_Frame',iframe.contentWindow.document);if(mathJaxMessageNode&&mathJaxMessageNode.parentNode&&mathJaxMessageNode.parentNode.parentNode){mathJaxMessageNode.parentNode.parentNode.removeChild(mathJaxMessageNode.parentNode);}}catch(e){}};D2L.LP.Web.UI.Desktop.Controls.IFrame.AddOnLoadHandler(iframe,loadHandler);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-iframe-fullscreen',function(iframe){document.body.style.overflow='hidden';var pagePadding=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-page-main-padding',document);if(pagePadding!==null&&pagePadding!==undefined){pagePadding.style.paddingBottom=0;}var dialogBody=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-dialog-body',document);if(dialogBody===null){dialogBody=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-popup-body',document);}var resize=function(){var viewportHeight;if(dialogBody===null){viewportHeight=D2L.LP.Web.UI.Html.Dom.GetViewportSize().height;}else{viewportHeight=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(dialogBody).height;}var height=viewportHeight;if(dialogBody===null){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(iframe);height-=rect.top;}else{height-=5;}if($(iframe).parent().hasClass('d2l-fileviewer-text')){try{var iframeBody=$(iframe).contents();iframeBody.find('body pre').css('white-space','pre-wrap');iframeBody.find('body').css('word-wrap','break-word');}catch(e){}}iframe.style.height=height+'px';};D2L.WebComponentsReady.then(resize);D2L.LP.Web.UI.Desktop.Controls.IFrame.AddOnLoadHandler(iframe,resize);setTimeout(function(){D2L.LP.Web.UI.Events.OnResize.AddListener(function(){resize();});});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-iframe-fit',function(iframe){var resize=function(){try{var body=iframe.contentWindow.document.body;if(body){if($(iframe).parent().hasClass('d2l-fileviewer-text')){try{var iframeBody=$(iframe).contents();iframeBody.find('body pre').css('white-space','pre-wrap');}catch(e){}}var scrollHeight=body.scrollHeight;if(iframe.contentWindow.document.documentElement){var documentElementHeight=iframe.contentWindow.document.documentElement.scrollHeight;if(documentElementHeight>0&&scrollHeight>0){scrollHeight=Math.min(documentElementHeight,scrollHeight);}else{scrollHeight=Math.max(documentElementHeight,scrollHeight);}}body.style.overflowY='hidden';iframe.style.height=scrollHeight+'px';}}catch(e){};setTimeout(function(){resize();},500);};D2L.LP.Web.UI.Desktop.Controls.IFrame.AddOnLoadHandler(iframe,resize);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-iframe-fit-user-content',function(iframe){var id=D2L.LP.Web.UI.Desktop.Controls.IFrame.GetNextGeneratedId();var doResize=function(lastHtml,lastDocWidth,lastDocHeight,lastLocation){var height,body,innerLorFrame=null;var currentHtml,currentDocWidth;var pollingInterval=500;try{if(iframe.contentWindow.document.getElementsByTagName('frameset').length>0){throw'cannot determine size with legacy framesets';}body=iframe.contentWindow.document.body;var innerIframe=iframe.contentWindow.document.getElementsByTagName('iframe')[0];var innerIframeName=innerIframe&&innerIframe.attributes['name'];if(innerIframeName&&innerIframeName.value==='frmContentObject'){innerLorFrame=innerIframe;body=innerLorFrame.contentWindow.document.body||innerLorFrame.document.body;}body.style.overflowY='hidden';currentHtml=body.outerHTML;currentDocWidth=window.innerWidth||document.documentElement.clientWidth;var doRecalculate=!(currentHtml==lastHtml)||!(currentDocWidth==lastDocWidth);if(!doRecalculate){setTimeout(function(){doResize(currentHtml,currentDocWidth,lastDocHeight,lastLocation);},pollingInterval);return;}iframe.style.height='auto';if(innerLorFrame){innerLorFrame.style.height='auto';innerLorFrame.style.overflowY='hidden';if(innerLorFrame.contentWindow.document.getElementsByTagName('frameset').length>0){throw'cannot determine size with legacy framesets';}var lorContentType=innerLorFrame.attributes['data-contenttype'].value;switch(lorContentType){case'html':break;case'image':innerLorFrame.contentWindow.document.getElementsByTagName('img')[0].style.maxWidth='100%';break;default:throw'cannot determine size with unknown content type';}}height=Math.max(body.scrollHeight,body.offsetHeight,body.clientHeight);var heightSourceIframe=innerLorFrame||iframe;var docElement=heightSourceIframe.contentWindow.document.documentElement;if(docElement){height=Math.max(height,docElement.scrollHeight,docElement.offsetHeight,docElement.clientHeight);}if(heightSourceIframe.contentWindow.innerHeight){height=Math.max(height,heightSourceIframe.contentWindow.innerHeight);}iframe.style.height=getSafeHeight(height);if(docElement){height=Math.max(height,docElement.scrollHeight);iframe.style.height=getSafeHeight(height);}if(innerLorFrame){innerLorFrame.style.height=iframe.style.height;}iframe.parentElement.style.minHeight=iframe.style.height;}catch(e){iframe.style.height=getSafeHeight();if(body){body.style.overflowY='auto';}if(innerLorFrame){innerLorFrame.style.height=iframe.style.height;innerLorFrame.style.overflowY='auto';}}var location;if(innerLorFrame){location=innerLorFrame.contentWindow.location.href;}else{location=iframe.contentWindow.location.href;}if(location!==lastLocation&&height!==lastDocHeight){window.parent.scroll(0,0);}setTimeout(function(){doResize(currentHtml,currentDocWidth,height,location);},pollingInterval);};var resize=function(){try{var body=iframe.contentWindow.document.body;doResize();}catch(e){window.addEventListener('message',listenForCrossDomainSizeChanges,false);requestIframeSize();}};var requestIframeSize=function(){iframe.contentWindow.postMessage(JSON.stringify({handler:'d2l.iframe.client',id:id}),'*');};var listenForCrossDomainSizeChanges=function(event){try{var data=JSON.parse(event.data);if(!(data.handler==='d2l.iframe.host')||data.id&&!(data.id===id)){return;}iframe.style.overflowY='hidden';iframe.style.height=getSafeHeight(data.height);}catch(e){D2L.LP.Web.UI.Html.JavaScript.Console.Warn('iframe resize: not handling unexpected message posted by another window: ',event.data);}};var getSafeHeight=function(height){if(!height||height<200){height=$(iframe).attr('data-default-height');}return height+'px';};D2L.LP.Web.UI.Desktop.Controls.IFrame.AddOnLoadHandler(iframe,resize);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-content-service-content',function(iframe){var intervalHandle=null;var $iframe=$(iframe);var loadingIcon=$iframe.prev('.d2l-iframe-loading-container-cs');if(!loadingIcon.length){loadingIcon=$iframe.parent().prev('.d2l-iframe-loading-container-cs');}var clearIntervalHandle=function(){if(intervalHandle){clearInterval(intervalHandle);}};var showContent=function(){loadingIcon.hide();$iframe.removeClass('d2l-iframe-offscreen-cs');};var contentServiceiFrameMessageHandler=function(event){if(event.data==='CS:ContentLoaded'||event.data&&event.data.type==='d2l-error'){showContent();clearIntervalHandle();}};window.addEventListener('message',contentServiceiFrameMessageHandler,false);setTimeout(showContent,60000);var checkIframeContentWindow=function(){var iframeContentWindowLocation='';var iframeContentWindowBodyInnerHtml='';try{iframeContentWindowLocation=iframe.contentWindow.location.href;iframeContentWindowBodyInnerHtml=iframe.contentWindow.document.body.innerHTML;}catch(error){clearIntervalHandle();return;}if(iframeContentWindowLocation.includes('d2l/error')||iframeContentWindowBodyInnerHtml.includes('Bad Request')){clearIntervalHandle();showContent();}};intervalHandle=setInterval(checkIframeContentWindow,1000);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-image',function(node){if(node.alt!==''){node.title=node.alt;}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-imagelink',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.ImageLink;var isDisabled=!me.IsEnabledNode(node);if(isDisabled){D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'disabled','true');}var hasOnClick=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,'data-onclick');if(hasOnClick){D2L.LP.Web.UI.Html.Aria.SetRole(node,'button');var onClick=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-onclick');D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,'data-onclick');if(onClick){D2L.LP.Web.UI.Html.Dom.AddEventListener('click',node,function(){if(D2L.LP.Web.UI.Desktop.Controls.ImageLink.IsEnabledNode(node)){eval(onClick);}});}}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-imagelink');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-integer-selector',function(node){var inputNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-edit',node)[0];var textBlockNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-textblock',node);var textBlockNode=null;if(textBlockNodes.length>=1){textBlockNode=textBlockNodes[0];}D2L.LP.Web.UI.Html.Aria.SetAttribute(inputNode,'live',D2L.LP.Web.UI.Html.Aria.Politeness.Assertive);if(textBlockNode!=null){D2L.LP.Web.UI.Html.Aria.SetAttribute(textBlockNode,'live',D2L.LP.Web.UI.Html.Aria.Politeness.Assertive);}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-integer-selector');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-input-number-wc',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StartTracking(node);var onChangeFunction=D2L.LP.Web.UI.ObjectRepository.HasKey(node.id)&&D2L.LP.Web.UI.ObjectRepository.HasKeys(node.id,'change')?D2L.LP.Web.UI.ObjectRepository.Get(node.id,'change'):undefined;D2L.LP.Web.UI.Html.Dom.AddEventListener('change',node,function(){D2L.LP.Web.UI.Desktop.Controls.InputNumber.UpdateHidden(node.id);if(onChangeFunction!==undefined)onChangeFunction.call(onChangeFunction);});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-iterator',function(node){var anchors=node.getElementsByTagName('a');for(var i=0;i<anchors.length;i++){D2L.LP.Web.UI.Html.Dom.AddEventListener('click',anchors[i],function(index){return function(){var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-iterator-button-disabled',anchors[index]);if(isDisabled){return;}for(var j=0;j<anchors.length;j++){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-iterator-button-selected',anchors[j]);}D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-iterator-button-selected',anchors[index]);};}(i));}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-newwindow',function(node){var hasHref=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,'href');if(!hasHref){return;}node.target='_blank';});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-clickable',function(node){D2L.LP.Web.UI.Desktop.Controls.Link.InstallClickable(node);});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-clickable');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-longedit',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StartTracking(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-longedit-autoresize',function(node){var cloneTextArea=document.createElement('textarea');cloneTextArea.className=node.className;D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-longedit-offscreen',cloneTextArea);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',cloneTextArea);document.body.appendChild(cloneTextArea);var heightOffset=0;var first=true;var updateHeight=function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',cloneTextArea);cloneTextArea.style.width=rect.width+'px';if(first){D2L.LP.Web.UI.Html.Dom.SetAttribute(node,'data-height',50);heightOffset=(rect.height?rect.height:50)-cloneTextArea.scrollHeight;first=false;}cloneTextArea.value=node.value;var setHeight=parseInt(D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-height'));var newHeight=Math.max(setHeight,cloneTextArea.scrollHeight+heightOffset);if(newHeight>setHeight){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-longedit-resized',node);}else{D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-longedit-resized',node);}node.style.height=newHeight+'px';D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',cloneTextArea);};D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',node,updateHeight);D2L.LP.Web.UI.Html.Dom.AddEventListener('input',node,updateHeight);node.d2l_onChange=updateHeight;updateHeight();D2L.LP.Web.UI.Events.OnSizingFinished.Trigger();});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('vui-mediaplayer',function(node){var baseLocation=node.getAttribute('data-mediaplayer-baselocation');var loadPlayer=function(){var id=node.id;var source=node.getAttribute('data-mediaplayer-src');var originalSource=node.getAttribute('data-mediaplayer-src-original');var srts=node.getAttribute('data-mediaplayer-srts');var autoSize=node.getAttribute('data-mediaplayer-enableautosize');var linkIfError=node.getAttribute('data-mediaplayer-showlinkiferror');var youtubeApiKey=node.getAttribute('data-mediaplayer-youtubeapikey');var enableAutoSize=true;var showLinkIfError=true;if(srts){srts=JSON.parse(srts);}if(autoSize&&autoSize.toLowerCase()==='false'){enableAutoSize=false;}if(linkIfError&&linkIfError.toLowerCase()==='false'){showLinkIfError=false;}var VideoSuccessMessage=function(){$node=$(node);var msg=$node.attr('data-mediaplayer-successOffScreenMsg');if(msg){var $alert=$('<span role="alert" class="d2l-offscreen"></span>');$node.append($alert);$alert.text(msg);}};$(node).css('margin','0 auto');var onMediaDataChangeHandler=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onMediaDataChange');node.d2l_onMediaDataChangeHandler=function(sender,args){if(args&&args.Id===id){onMediaDataChangeHandler.call(onMediaDataChangeHandler);}};if(onMediaDataChangeHandler!==null){$(window).on('MediaPlayerDataChange',node.d2l_onMediaDataChangeHandler);}var onWarningsErrorsChangeHandler=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onWarningsErrorsChange');node.d2l_onWarningsErrorsChangeHandler=function(sender,args){if(args&&args.Id===id){onWarningsErrorsChangeHandler.call(onWarningsErrorsChangeHandler);}};if(onWarningsErrorsChangeHandler!==null){$(window).on('MediaPlayerWarningsErrorsChange',node.d2l_onWarningsErrorsChangeHandler);}var onPageUrlChangeHandler=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onPageUrlChange');node.d2l_onPageUrlChangeHandler=function(){onPageUrlChangeHandler.call(onPageUrlChangeHandler);};if(onPageUrlChangeHandler!==null){$(window).on('MediaPlayerPageUrlChange',node.d2l_onPageUrlChangeHandler);}setTimeout(function(){VideoPlayer.create(id,source,{allowDownload:$(node).attr('data-mediaplayer-show-download-button')==='true',pluginPath:baseLocation,customErrorMessage:D2L.LP.Web.UI.Desktop.Controls.MediaPlayer.VideoError,customAttachWarningMessagesOnError:false,customSuccessMessage:VideoSuccessMessage,enableAutoSize:enableAutoSize,showLinkIfError:showLinkIfError,originalSource:originalSource},srts,youtubeApiKey);},0);};D2L.LP.Web.UI.Desktop.Controls.MediaPlayer.AddCssUrl(baseLocation+'mediaelementplayer.min.css');$.when($.getScript(baseLocation+'URI.min.js'),$.getScript(baseLocation+'mediaelement-and-player.min.js'),$.getScript(baseLocation+'D2L.Valence.UI.MediaPlayer.min.js'),$.Deferred(function(deferred){$(deferred.resolve);})).done(function(){D2L.LP.Web.UI.Desktop.Controls.MediaPlayer.PlayerInitializer(node);loadPlayer();});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-menu-mvc',function(node){function execFunc(e,name){if(!e.target||!e.target.hasAttribute('id'))return;var func=D2L.LP.Web.UI.ObjectRepository.TryGet(e.target.id,name);if(func){func.call(func);}}node.addEventListener('d2l-menu-item-change',function(e){execFunc(e,'change');});node.addEventListener('d2l-menu-item-select',function(e){execFunc(e,'select');});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-menuflyout-dropdown',function(node){var openFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"MenuFlyout.OpenFunction");var openFirstFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"MenuFlyout.OpenFirstFunction");var closeFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"MenuFlyout.CloseFunction");var contentsNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-menuflyout-dropdown-contents',node);if(contentsNode===null&&node.getAttribute('data-contextMenuId')!==null){D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.InitContextMenu(node,openFunction,openFirstFunction,closeFunction);}if(contentsNode!=null){D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.Init(node,contentsNode,openFunction,openFirstFunction,closeFunction);}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-menuflyout-link');D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-menuflyout');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-messagearea',function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,'alert');node.tabIndex=0;if(node.childNodes.length>0){D2L.LP.Web.UI.Desktop.Controls.MessageArea.SetIsVisible(true);}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('vui-moreless',function(node){$(node).vui_moreless();var onExpandHandler=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onExpand');node.d2l_expandHandler=function(sender,args){onExpandHandler.call(onExpandHandler);};if(onExpandHandler!==null){$(node).on('vui-moreless-expand',node.d2l_expandHandler);}var onCollapseHandler=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onCollapse');node.d2l_collapseHandler=function(sender,args){onCollapseHandler.call(onCollapseHandler);};if(onCollapseHandler!==null){$(node).on('vui-moreless-collapse',node.d2l_collapseHandler);}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-multiselect',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.MultiSelect;var handle=me.InitHandle(node);me.Initialize(handle);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',handle.node,function(){handle.inputNode.focus();});D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseover',handle.node,function(){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-multiselect-active',handle.node);});D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseout',handle.node,function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-multiselect-active',handle.node);});D2L.LP.Web.UI.Html.Dom.AddEventListener('paste',handle.inputNode,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);setTimeout(function(){var text=handle.inputNode.value;if(!D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetForceSelection(handle.autoCompleteId)){me.OnItemAdded(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(handle.node.id),text,"");}},0);});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-multiselect-clearicon',function(node){D2L.LP.Web.UI.Html.Dom.AddEventListener('click',node,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);});D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseover',node,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,function(kpArgs){var key=kpArgs.GetKey();if(key===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Backspace||key===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Delete){var parentNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-multiselect-choice',node);var id=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(parentNode.id);D2L.LP.Web.UI.Desktop.Controls.MultiSelect.OnClickClearIcon(id);D2L.LP.Web.UI.Html.Dom.CancelEventBubble(kpArgs.GetEventObject());D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(kpArgs.GetEventObject());}});});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-multiselect');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-numericpager-container',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;var id=node.getAttribute('id');var handle=me.GetHandleByNode(node);D2L.LP.Web.UI.Html.Aria.SetRole(handle.previousNode,'button');handle.previousNode.tabIndex=0;D2L.LP.Web.UI.Html.Aria.SetRole(handle.nextNode,'button');handle.nextNode.tabIndex=0;if(handle.controlProvider!=null){var pageableControlId=D2L.LP.Web.UI.ObjectRepository.Get(id,'pageableControlId');var pageableControl=handle.controlProvider.call(handle.controlProvider);var onLoadCompletedHandler=function(hasMoreItems,itemNodes,totalItemCount,pageNumber){var noItems=totalItemCount===0;D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,!noItems);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(document.getElementsByClassName('d2l-numericpager-pagesize-container')[0],!noItems);if(totalItemCount!==undefined){var pageSize=parseInt(me.GetPageSize(handle.id));var pageCount=Math.ceil(parseInt(totalItemCount,10)/pageSize);me.SetPageCountHandle(handle,pageCount);}if(pageNumber){me.SetPageNumberHandle(handle,pageNumber,false);}};pageableControl.GetOnLoadCompletedEvent(pageableControlId).AddListener(onLoadCompletedHandler);node.d2l_onLoadCompletedHandle=onLoadCompletedHandler;if(pageableControl.GetOnPageCompletedEvent&&pageableControl.ScrollToFirstItem){var onPageCompletedHandler=function(){pageableControl.ScrollToFirstItem(pageableControlId);};pageableControl.GetOnPageCompletedEvent(pageableControlId).AddListener(onPageCompletedHandler);node.d2l_onPageCompletedHandle=onPageCompletedHandler;}node.d2l_pageableControlId=pageableControlId;node.d2l_pageableControl=pageableControl;}node.d2l_pageCount=D2L.LP.Web.UI.ObjectRepository.Get(id,'pageCount');me.UpdateNextPrevious(handle);});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-numericpager');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-onoff-switch',function(node){D2L.LP.Web.UI.Desktop.Controls.OnOff.Initialize(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-panel',function(node){var prevSibling=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);if(prevSibling===null||!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-panel-title',prevSibling)){return;}var links=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-imagelink',prevSibling);if(links.length!==2){return;}D2L.LP.Web.UI.Html.Dom.AddEventListener('click',links[0],function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-panel-collapsed',node);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-panel-title-collapsed',prevSibling);});D2L.LP.Web.UI.Html.Dom.AddEventListener('click',links[1],function(){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-panel-collapsed',node);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-panel-title-collapsed',prevSibling);});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-placeholder-live',function(node){D2L.LP.Web.UI.Html.Aria.SetAttribute(node,'live',D2L.LP.Web.UI.Html.Aria.Politeness.Assertive);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-quickentry-long',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.QuickEntryLong;var handle=me.GetHandleNode(node);D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',handle.LongEdit,function(){me.FocusHandle(handle);});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-radio-track',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StartTracking(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-radio-suppress-form-submission',function(node){var onKeyPress=function(kpArgs){if(kpArgs.GetKey()===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter){var event=kpArgs.GetEventObject();event.preventDefault();}};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,onKeyPress);});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-radio');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-rating-input',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.RatingInput;var handle=me.InitHandle(node);for(var i=0;i<handle.labels.length;i++){var label=handle.labels[i];var input=label.getElementsByTagName('input')[0];D2L.LP.Web.UI.Html.Dom.AddEventListener('click',input,function(index){return function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);me.SetSelected(handle,index,false);};}(i));D2L.LP.Web.UI.Html.Dom.AddEventListener('click',label,function(index){return function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(e);me.SetSelected(handle,index,true);};}(i));D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseover',label,function(index){return function(){me.HandleMouseOverLabel(handle,index);};}(i));D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseout',label,function(){me.ClearHoverClass(handle);});D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',input,function(index){return function(){me.HandleFocus(handle,index);};}(i));D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',input,function(index){return function(){me.HandleBlur(handle,index);};}(i));}if(handle.distribution===null){return;}D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseover',node,function(){D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.Show(handle);handle.hover=true;});D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseout',node,function(){handle.hover=false;D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.Hide(handle);});D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.ClassInitialize(handle);});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-rating-input');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-rating',function(node){var handle={distribution:null};D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.InitHandle(node,handle);if(handle.distribution===null){return;}D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseover',node,function(){D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.Show(handle);});D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseout',node,function(){D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.Hide(handle);});D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.ClassInitialize(handle);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('vui-scroll-point',function(node){var isNoJQueryScrollSpyEnabled=node.hasAttribute('data-no-jquery-scroll-spy');var spyKey=node.getAttribute('data-spy-key');var onSpyHandler=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onSpy');var handleSpy=function(key){if(spyKey!==key){return;}onSpyHandler.call(onSpyHandler);};var onSkimSpyHandler=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,'onSkimSpy');var handleSkimSpy=function(key){if(spyKey!==key){return;}onSkimSpyHandler.call(onSkimSpyHandler);};if(!onSpyHandler&&!onSkimSpyHandler){return;}if(isNoJQueryScrollSpyEnabled){if(onSpyHandler!==null){node.addEventListener('d2l-scroll-spy',function(e){if(e.detail.visible){node.setAttribute('data-spy-visible','');}else{node.removeAttribute('data-spy-visible');}handleSpy(e.detail.key);});}if(onSkimSpyHandler!==null){node.addEventListener('d2l-scroll-spy-once',function(e){handleSkimSpy(e.detail.key);});}var init=function(){document.removeEventListener('d2l-scroll-spy-ready',init);D2L.ScrollSpy.registerPoint(spyKey,node);D2L.ScrollSpy.setEnabled(true);D2L.LP.Web.UI.Events.OnViewRender.AddListener(function(){D2L.ScrollSpy.spy();});};if(D2L.ScrollSpy){init();}else{document.addEventListener('d2l-scroll-spy-ready',init);}}else{$(window).vui_scrollSpy().vui_scrollSpy('registerScrollPoint',node);D2L.LP.Web.UI.Events.OnViewRender.AddListener(function(){$(window).vui_scrollSpy('spy');});node.d2l_spyHandler=function(sender,args){handleSpy(args.key);};if(onSpyHandler!==null){$(window).on('vui-spy',node.d2l_spyHandler);}node.d2l_skimSpyHandler=function(sender,args){handleSkimSpy(args.key);};if(onSkimSpyHandler!==null){$(window).on('vui-skim-spy',node.d2l_skimSpyHandler);}}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-search-simple-wc',function(node){D2L.LP.Web.UI.Desktop.Controls.SearchSimple.InitWc(node);});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-search-simple-wc-input');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-selectall-track',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StartTracking(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-selectall',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;var id=node.getAttribute('id');var selectAllId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id);if(!D2L.LP.Web.UI.ObjectRepository.HasKey(id)){return;}var controlProvider=me.GetSelectableControlProvider(id);var selectableControlId=me.GetSelectableControlId(id);if(controlProvider===null||selectableControlId===null){return;}var selectableControl=controlProvider.call(controlProvider);var selectionFilterTypeEvent=me.GetOnSelectionFilterTypeUpdateEvent(selectAllId);var selectionUpdateEvent=me.GetOnSelectionUpdateEvent(selectAllId);var checkboxNode=me.GetCheckboxNode(node);var typeNode=me.GetTypeNode(node);var valuesNode=me.GetValuesNode(node);var selection=me.GetSelection(selectAllId);var updateSelectionControl=function(itemNodes){selectableControl.SetIsAllSelected(selectableControlId,checkboxNode.checked,itemNodes);};var updateState=function(){if(!me.IsUpdateStateEnabled(id)){return;}if(checkboxNode.checked){var unSelectedValues=selectableControl.GetValues(selectableControlId,false);if(unSelectedValues.length>0){checkboxNode.checked=false;selection.type=D2L.LP.LayeredArch.SelectionFilterType.Some;}}selection.selectedCount=0;for(var value in selection.values){if(selection.values[value]){selection.selectedCount+=1;}}if(selection.selectedCount>0){if(selection.type!=D2L.LP.LayeredArch.SelectionFilterType.All){selection.type=D2L.LP.LayeredArch.SelectionFilterType.Some;}}else{selection.type=D2L.LP.LayeredArch.SelectionFilterType.None;}selectionFilterTypeEvent.Trigger(checkboxNode.checked,selection.type);selectionUpdateEvent.Trigger(selection.type,selection.selectedCount);};var updateBulk=function(itemNodes){me.SetIsUpdateStateEnabled(id,false);updateSelectionControl(itemNodes);me.SetIsUpdateStateEnabled(id,true);updateState();};D2L.LP.Web.UI.Html.Dom.AddEventListener('click',checkboxNode,function(){updateBulk();});var onPageHandler=function(){selection.persisted=true;};selectableControl.GetOnPageEvent(selectableControlId).AddListener(onPageHandler);var onPageCompletedHandler=function(itemNodes){if(selection.type==D2L.LP.LayeredArch.SelectionFilterType.None){updateState();return;}if(selection.type==D2L.LP.LayeredArch.SelectionFilterType.All){checkboxNode.checked=true;updateBulk(itemNodes);return;}me.SetIsUpdateStateEnabled(id,false);selectableControl.SetSelection(selectableControlId,D2L.LP.LayeredArch.SelectionFilterType.Some,selection.getValuesArray());me.SetIsUpdateStateEnabled(id,true);updateState();};selectableControl.GetOnPageCompletedEvent(selectableControlId).AddListener(onPageCompletedHandler);var onLoadMoreCompletedHandler=function(hasMoreItems,itemNodes){if(checkboxNode.checked){for(var i=0;i<itemNodes.length;i++){selectableControl.HighlightItemByNode(itemNodes[i]);}}updateBulk(itemNodes);};selectableControl.GetOnLoadMoreCompletedEvent(selectableControlId).AddListener(onLoadMoreCompletedHandler);var selectableControlItemSelectedHandler=function(itemValue,isSelected){if(isSelected){selection.add(itemValue);}else{selection.remove(itemValue);}updateState();};selectableControl.GetItemSelectedEvent(selectableControlId).AddListener(selectableControlItemSelectedHandler);var onBeforeSubmitHandler=function(form){typeNode.value=selection.type;valuesNode.value=D2L.LP.Web.UI.Selection.EncodeKeys(selection.getValuesArray());};D2L.LP.Web.UI.Desktop.Controls.Form.OnBeforeSubmit.AddListener(onBeforeSubmitHandler);if(!selection.persisted){var intialSelectedValues=selectableControl.GetSelectedValues(selectableControlId);selection.reset();for(var i=0;i<intialSelectedValues.length;i++){selection.add(intialSelectedValues[i]);}updateState();}else{if(selection.type==D2L.LP.LayeredArch.SelectionFilterType.All){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-readonly',node);}}selection.persisted=false;node.d2l_onLoadMoreCompletedHandler=onLoadMoreCompletedHandler;node.d2l_selectableControlId=selectableControlId;node.d2l_selectableControl=selectableControl;node.d2l_selectableControlItemSelectedHandler=selectableControlItemSelectedHandler;node.d2l_pageHandler=onPageHandler;node.d2l_pageCompletedHandler=onPageCompletedHandler;node.d2l_onBeforeSubmitHandler=onBeforeSubmitHandler;});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-selectall-link',function(node){var id=node.getAttribute('id');var controlProvider=D2L.LP.Web.UI.ObjectRepository.Get(id,0);node.d2l_status='init';node.d2l_selectionControl=controlProvider.call(controlProvider);node.d2l_selectionControlId=D2L.LP.Web.UI.ObjectRepository.Get(id,1);var updateInfo=function(infoNode,selectionType){var pageResultNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(infoNode);if(selectionType==D2L.LP.LayeredArch.SelectionFilterType.Some){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(pageResultNode),node.d2l_hasMoreItems);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',pageResultNode);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(pageResultNode));}};var updateMe=function(isSelectAll,selectionType){var nodeExists=D2L.LP.Web.UI.Html.Dom.GetElementById(node.id);if(nodeExists===null){return;}var infoNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-selectall-link-info',node);var placeholderId=infoNode.getAttribute('id');var isVisible=!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-hidden',node);if(isSelectAll&&selectionType!=D2L.LP.LayeredArch.SelectionFilterType.None){if(isVisible){updateInfo(infoNode,selectionType);return;}var infoPartial=D2L.LP.Web.UI.ObjectRepository.TryGet(id,2);if(infoPartial!=null&&node.d2l_status=='init'){node.d2l_status='loading';infoPartial.call(infoPartial).AddListener(function(){var newInfoNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-selectall-link-info',node);newInfoNode.id=placeholderId;updateInfo(newInfoNode,selectionType);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',node);node.d2l_status='loaded';});}else{updateInfo(infoNode,selectionType);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-hidden',node);}}else if(isVisible){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-hidden',node);}};node.d2l_selectionControl.GetOnSelectionFilterTypeUpdateEvent(node.d2l_selectionControlId).AddListener(updateMe);node.d2l_onSelectionFilterTypeUpdateEventHandler=updateMe;node.d2l_selectionControl.GetOnResetEvent(node.d2l_selectionControlId).AddListener(function(hasMoreItems){node.d2l_status='init';node.d2l_hasMoreItems=hasMoreItems;});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-select',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StartTracking(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-select-optgroup',function(node){for(var i=0;i<node.childNodes.length;i++){var option=node.childNodes[i];if(option.nodeType==1){option.title=node.label;}}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-select');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-semantic-editor',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;var id=node.getAttribute('id');var toolbarNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(toolbarNode);var positionNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(textAreaNode);var plugins=D2L.LP.Web.UI.ObjectRepository.TryGet(id,'plugins');var echoPosition=function(selection){positionNode.innerHTML='Start: '+selection.Start+'<br>'+'End: '+selection.End+'<br>'+'Value: \"'+textAreaNode.value.substring(selection.Start,selection.End)+'\"';};var updatePlugins=function(selection){echoPosition(selection);node.d2l_selectionStart=selection.Start;node.d2l_selectionEnd=selection.End;var context={Selection:selection,TextAreaNode:textAreaNode};for(var i=0;i<plugins.length;i++){if(plugins[i].OnEditorUpdate){plugins[i].OnEditorUpdate(context);}}};D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',textAreaNode,function(){updatePlugins(me.GetSelectionRange(textAreaNode));});D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',textAreaNode,function(){updatePlugins(me.GetSelectionRange(textAreaNode));});D2L.LP.Web.UI.Html.Dom.AddEventListener('click',textAreaNode,function(){updatePlugins(me.GetSelectionRange(textAreaNode));});D2L.LP.Web.UI.Html.Dom.AddEventListener('select',textAreaNode,function(){updatePlugins(me.GetSelectionRange(textAreaNode));});D2L.LP.Web.UI.Html.Dom.AddEventListener('keyup',textAreaNode,function(e){updatePlugins(me.GetSelectionRange(textAreaNode));var key;if(window.event){key=e.keyCode;}else if(e.which){key=e.which;}var context={Selection:me.CreateRange(node.d2l_selectionStart,node.d2l_selectionEnd),TextAreaNode:textAreaNode};for(var i=0;i<plugins.length;i++){if(plugins[i].OnKeyUp){plugins[i].OnKeyUp(context,key);}}});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-sort',function(node){var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);$(node).on('change',function(){var optionNode=node.options[node.selectedIndex];var isAscendingValue=D2L.LP.Web.UI.Html.Dom.GetAttribute(optionNode,'data-isAscending');D2L.LP.Web.UI.Desktop.Controls.Hidden.SetValueNode(hiddenNode,isAscendingValue);});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('vui-tabmenu',function(node){D2L.LP.Web.UI.Desktop.Controls.TabMenu.Init(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-time-selector-wc',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var edit=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);var nodes=me.GetNodesByNode(edit);var onSelectorChangeEvent=function(){var onChangeFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(nodes.edit.id,'OnDateTimeChangeFunction');if(onChangeFunction){onChangeFunction.call(onChangeFunction);}};var onChange=function(){var value=edit.value;var re=/([0-9]{1,2}):([0-9]{1,2})(:([0-9]{1,2}))?/;var match=value.match(re);if(match&&match.length>=2){me.SetTimeNodeValues(nodes,parseInt(match[1]),parseInt(match[2]));}};D2L.LP.Web.UI.Html.Dom.AddEventListener('change',nodes.edit,onChange);D2L.LP.Web.UI.Html.Dom.AddEventListener('d2l-time-selector-change',nodes.container,onSelectorChangeEvent);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-time-selector-legacy',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var timeSelectorData=$(node).data();var edit=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(edit.id);id.$().data(timeSelectorData);var data=id.$().data();var nodes=me.GetNodesByNode(edit);var useEditValue=true;$(nodes.container).on('d2l-time-selector-change',function(){var onChangeFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(nodes.edit.id,'OnDateTimeChangeFunction');if(onChangeFunction){onChangeFunction.call(onChangeFunction);}});var dateTimeParser=null;var getDateTimeParser=function(){if(dateTimeParser===null){dateTimeParser=D2L.LP.Globalization.Locale.GetDateTimeParser();}return dateTimeParser;};var closing=false;var selectedIndex=0;var lastGoodTime=me.GetTimeNodes(nodes);var refreshSelectedIndex=function(){var interval=data.timeinterval;if(interval===null||interval===undefined||interval<5||interval>60){data.timeinterval=30;interval=30;}var time=getDateTimeParser().TryParseTime(nodes.edit.value);if(time===null||time===undefined){time=lastGoodTime;}var hour=time.GetHour();var minute=time.GetMinute();if(data.enforcetimeintervals){var remainder=minute%interval;if(minute>0&&minute<interval){minute=interval;}else if(remainder>0){minute+=interval-remainder;}while(minute>=60){minute-=60;++hour;}hour=Math.min(23,hour);time=new D2L.LocalTime(hour,minute,0);}lastGoodTime=time;me.SetTimeNodes(nodes,time);var index=hour*60/interval;index+=minute/interval;selectedIndex=Math.floor(index);};var selectSelectedItem=function(){var item=nodes.list.childNodes[selectedIndex];me.SetTimeNodes(nodes,item.d2l_time);};var updateSelectedItem=function(applyOffset){var selectedItem=null;for(var i=0;i<nodes.list.childNodes.length;i++){var item=nodes.list.childNodes[i];if(i===selectedIndex){item.className='d2l-time-selector-listitem-selected';selectedItem=item;D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,'aria-activedescendant',item.id);D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,'aria-activedescendant',item.id);}else{item.className='';}}if(selectedItem===null){D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,'aria-activedescendant','');D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,'aria-activedescendant','');return;}var divBox=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(nodes.floatingContainer);var itemBox=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(selectedItem);var offset=applyOffset?(divBox.height-itemBox.height)/2:0;if(itemBox.bottom>divBox.bottom){nodes.floatingContainer.scrollTop+=itemBox.bottom-divBox.bottom+offset;}else if(itemBox.top<divBox.top){nodes.floatingContainer.scrollTop-=divBox.top-itemBox.top-offset;}};var close=function(doDelay,ignoreFocus){closing=true;setTimeout(function(){D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.CloseNode(nodes.floatingContainer,ignoreFocus);setTimeout(function(){closing=false;},0);D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,'aria-expanded','false');D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,'aria-hidden','true');},doDelay?200:0);};var open=function(){if(isOpen()||closing){return;}me.BuildSelectList(nodes,data.timeinterval);refreshSelectedIndex();D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.OpenNode(nodes.floatingContainer,id,{AttachToBody:true,AutoCloseExclusions:[edit],FocusOnOpen:false,Position:D2L.LP.Web.UI.Html.Style.OverlayPosition.Bottom,TabIndex:-1});updateSelectedItem(true);nodes.edit.focus();D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,'aria-expanded','true');D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,'aria-hidden','false');};var isOpen=function(){return D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpenNode(nodes.floatingContainer);};D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',nodes.edit,open);D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',nodes.edit,function(){refreshSelectedIndex();D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,'aria-expanded','false');D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,'aria-hidden','true');});D2L.LP.Web.UI.Html.Dom.AddEventListener('click',nodes.edit,open);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',nodes.floatingContainer,function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);if(eventTarget&&eventTarget.tagName.toLowerCase()=='li'){selectedIndex=eventTarget.d2l_index;selectSelectedItem();close(false,false);}});var keys=D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key;D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(nodes.edit,function(kpArgs){var key=kpArgs.GetKey();if(key==keys.ArrowUp||key==keys.ArrowDown){if(!isOpen()){open();}else{var maxIndex=60/data.timeinterval*24-1;if(key==keys.ArrowUp){--selectedIndex;if(selectedIndex==-1){selectedIndex=maxIndex;}}else{++selectedIndex;if(selectedIndex==maxIndex+1){selectedIndex=0;}}updateSelectedItem(false);}useEditValue=false;D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(kpArgs.GetEventObject());}else if(key==keys.Enter){useEditValue?refreshSelectedIndex():selectSelectedItem();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(kpArgs.GetEventObject());close(false,false);}else if(key==keys.Escape||key==keys.Tab){close(false,true);nodes.edit.focus();}else if(key!=keys.Shift&&key!=keys.Control&&key!=keys.PageUp&&key!=keys.PageDown&&key!=keys.End&&key!=keys.Home&&key!=keys.ArrowLeft&&key!=keys.ArrowRight){close(false,false);useEditValue=true;}});D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,'aria-haspopup','true');D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,'aria-owns',nodes.floatingContainer.id);D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,'role','combobox');D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,'aria-autocomplete','list');D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,'aria-expanded','false');D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,'tabindex','0');D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,'aria-hidden','true');});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-time-selector');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-updownvote-input',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput;var handle=me.InitHandle(node);for(var i=0;i<handle.labels.length;i++){var label=handle.labels[i];var input=label.getElementsByTagName('input')[0];D2L.LP.Web.UI.Html.Dom.AddEventListener('click',label,function(index){return function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(e);me.SetSelected(handle,index,true);};}(i));D2L.LP.Web.UI.Html.Dom.AddEventListener('click',input,function(index){return function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);me.SetSelected(handle,index,false);};}(i));}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList('d2l-updownvote-input');D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-validator',function(node){setTimeout(function(){var form=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-form',node);if(form===null){return;}D2L.LP.Web.UI.Desktop.Controls.ValidatorCustom.Init(form,node);},0);});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-action-container',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.ActionContainer;if(node.d2l_dataControlSelectionHandler!=null){var selectionUpdatedEvent=me.TryGetSelectionUpdatedEventByNode(node);if(selectionUpdatedEvent!=null){selectionUpdatedEvent.RemoveListener(node.d2l_dataControlSelectionHandler);}}});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-checkbox',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StopTracking(node);});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-datalist-summary',function(node){var dataListNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-datalist-container',node);var dataListId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(dataListNode.getAttribute('id'));if(node.d2l_updateSelectAllVisibilityHandler!==undefined){D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnLoadCompletedEvent(dataListId).RemoveListener(node.d2l_updateSelectAllVisibilityHandler);D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnLoadMoreCompletedEvent(dataListId).RemoveListener(node.d2l_updateSelectAllVisibilityHandler);D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnRemoveItemEvent(dataListId).RemoveListener(node.d2l_updateSelectAllVisibilityHandler);}if(node.d2l_onRemoveItemHandler!==undefined){D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnRemoveItemEvent(dataListId).RemoveListener(node.d2l_onRemoveItemHandler);}if(node.d2l_selectionUpdateHandler!==undefined){var selectAllNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-selectall',node);var selectAllId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(selectAllNode.getAttribute('id'));D2L.LP.Web.UI.Desktop.Controls.SelectAll.GetOnSelectionUpdateEvent(selectAllId).RemoveListener(node.d2l_selectionUpdateHandler);}});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-edit',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StopTracking(node);});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-form',function(node){D2L.LP.Web.UI.Desktop.Controls.MessageArea.Reset(node);});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-hidden-track',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StopTracking(node);});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-htmleditor-split-button',function(node){var menuContainer=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);var menuItems=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-htmleditor-buttonmenuitem',menuContainer);for(var i=0;i<menuItems.length;i++){var menuItem=menuItems[i];D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.GetOnActiveChangeByNode(menuItem).RemoveListener(menuItem.d2l_activeHandler);menuItem.d2l_activeHandler=null;D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.GetOnEnabledChangeByNode(menuItem).RemoveListener(menuItem.d2l_enabledHandler);menuItem.d2l_enabledHandler=null;}});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-htmleditor-wysiwyg',function(node){if(node.d2l_onBeforeSubmitHandle!==undefined){D2L.LP.Web.UI.Desktop.Controls.Form.OnBeforeSubmit.RemoveListener(node.d2l_onBeforeSubmitHandle);}var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var textAreaId=me.GetTextAreaId(node);var core=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core;core.CleanUp(textAreaId);});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-htmleditor-texteditor',function(node){var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-htmleditor-textarea',node);D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StopTracking(textAreaNode);});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-htmleditor',function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;me.ActionIdMap[node.id]={};});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-htmleditor-wc',function(node){if(node.d2l_onBeforeFormSubmitListener!==undefined){D2L.LP.Web.UI.Desktop.Controls.Form.OnBeforeSubmit.RemoveListener(node.d2l_onBeforeFormSubmitListener);}});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-input-number-wc',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StopTracking(node);});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-loadmore-pager',function(node){if(node.d2l_pageableControl!==undefined){node.d2l_pageableControl.GetOnLoadCompletedEvent(node.d2l_pageableControlId).RemoveListener(node.d2l_onLoadCompleteHandle);node.d2l_pageableControl.GetOnLoadMoreCompletedEvent(node.d2l_pageableControlId).RemoveListener(node.d2l_onLoadMoreHandle);}});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-longedit',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StopTracking(node);});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('vui-mediaplayer',function(node){if(node.d2l_onMediaDataChangeHandler!==undefined){$(window).off('MediaPlayerDataChange',null,node.d2l_onMediaDataChangeHandler);}if(node.d2l_onWarningsErrorsChangeHandler!==undefined){$(window).off('MediaPlayerWarningsErrorsChange',null,node.d2l_onWarningsErrorsChangeHandler);}if(node.d2l_onPageUrlChangeHandler!==undefined){$(window).off('MediaPlayerPageUrlChange',null,node.d2l_onPageUrlChangeHandler);}});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('vui-moreless',function(node){if(node.d2l_expandHandler!==undefined){$(node).off('vui-moreless-expand',null,node.d2l_expandHandler);}if(node.d2l_collapseHandler!==undefined){$(node).off('vui-moreless-collapse',null,node.d2l_collapseHandler);}});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-numericpager',function(node){if(node.d2l_pageableControl!==undefined){node.d2l_pageableControl.GetOnLoadCompletedEvent(node.d2l_pageableControlId).RemoveListener(node.d2l_onLoadCompletedHandle);if(node.d2l_onPageCompletedHandle!==undefined){node.d2l_pageableControl.GetOnPageCompletedEvent(node.d2l_pageableControlId).RemoveListener(node.d2l_onPageCompletedHandle);}}});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-radio-track',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StopTracking(node);});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('vui-scroll-point',function(node){var isNoJQueryScrollSpyEnabled=node.hasAttribute('data-no-jquery-scroll-spy');if(isNoJQueryScrollSpyEnabled){D2L.ScrollSpy.unregisterPoint(node.getAttribute('data-spy-key'));}else{if(node.d2l_spyHandler!==undefined){$(window).off('vui-spy',null,node.d2l_spyHandler);}if(node.d2l_skimSpyHandler!==undefined){$(window).off('vui-skim-spy',null,node.d2l_skimSpyHandler);}}});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-selectall',function(node){node.d2l_selectableControl.GetOnLoadMoreCompletedEvent(node.d2l_selectableControlId).RemoveListener(node.d2l_onLoadMoreCompletedHandler);node.d2l_selectableControl.GetItemSelectedEvent(node.d2l_selectableControlId).RemoveListener(node.d2l_selectableControlItemSelectedHandler);node.d2l_selectableControl.GetOnPageEvent(node.d2l_selectableControlId).RemoveListener(node.d2l_pageHandler);node.d2l_selectableControl.GetOnPageCompletedEvent(node.d2l_selectableControlId).RemoveListener(node.d2l_pageCompletedHandler);D2L.LP.Web.UI.Desktop.Controls.Form.OnBeforeSubmit.RemoveListener(node.d2l_onBeforeSubmitHandler);});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-selectall-track',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StopTracking(node);});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-selectall-link',function(node){node.d2l_selectionControl.GetOnSelectionFilterTypeUpdateEvent(node.d2l_selectionControlId).RemoveListener(node.d2l_onSelectionFilterTypeUpdateEventHandler);});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('d2l-select',function(node){D2L.LP.Web.UI.Html.ChangeTracking.Trackable.StopTracking(node);});D2L.LP.Web.UI.Html.Dom.AddClassDestructor('vui-tabmenu',function(node){$('.vui-tabmenu-item a',$(node)).off("click");});$(document).ready(function(){var handleMove=function(e){D2L.LP.Web.UI.Events.OnMouseMove.Trigger(e.originalEvent);};var handleUp=function(e){D2L.LP.Web.UI.Events.OnMouseUp.Trigger(e.originalEvent);};var handleDown=function(e){D2L.LP.Web.UI.Events.m_lastMouseDownPosition=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,e.originalEvent);};window.addEventListener('resize',function(){D2L.WebComponentsReady.then(function(){D2L.LP.Web.UI.Events.OnResize.Trigger();});});window.addEventListener('scroll',function(){D2L.WebComponentsReady.then(function(){D2L.LP.Web.UI.Events.OnScroll.Trigger();});});D2L.LP.Web.UI.Html.Dom.AddEventListener('storage',window,D2L.LP.Web.UI.Html.Dom.Storage.OnStorage);D2L.LP.Web.UI.Html.Dom.AddEventListener('FraUserEvent',window,function(){D2L.LP.Web.UI.Events.OnFraUserEvent.Trigger();});D2L.LP.Web.UI.Html.Dom.AddEventListener('dom-change',window,function(e){if(e.composedPath){var composedPath=e.composedPath();if(composedPath.length>0){D2L.LP.Web.UI.Events.OnViewRender.Trigger(composedPath[0]);return;}}D2L.LP.Web.UI.Events.OnViewRender.Trigger(e.target);});$(document).click(function(e){D2L.LP.Web.UI.Events.OnClick.Trigger(e);}).mousemove(handleMove).mouseup(handleUp).mousedown(handleDown).on('touchmove',handleMove).on('touchend',handleUp).on('touchstart',handleDown);if(document.body){$(document.body).on('orientationchange',function(){D2L.LP.Web.UI.Events.OnOrientationChange.Trigger();});}D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(document,function(keyPressEventArg){D2L.LP.Web.UI.Events.OnKeyPress.Trigger(keyPressEventArg);});D2L.LP.Web.UI.Html.PartialRendering.History.AddPopStateListener();D2L.WebComponentsReady.then(function(){D2L.LP.Web.UI.Events.OnInit.Trigger();D2L.LP.Web.UI.Events.OnLoad.Trigger();});});D2L.LP.DocumentViewers={};D2L.LP.DocumentViewers.Legacy={};D2L.LP.DocumentViewers.FileViewerRenderers={};D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-documentViewer',function(node){var parent=$(node).closest('.d2l-fileviewer');parent.css('overflow','hidden');var dialogBody=$(node).closest('.d2l-dialog-body');dialogBody.css('overflow','hidden');var viewer=$('.d2l-documentViewer');var isAlwaysFullExpanded=viewer.attr('data-is-always-fully-expanded')==='1';if(isAlwaysFullExpanded){viewer.addClass('d2l-documentViewer-dialog');}var resize=function(){var contentHeight=dialogBody.height();if(isAlwaysFullExpanded){contentHeight=$(window).height();}$('.d2l-documentViewer').height(contentHeight);};$(window).resize(resize);resize();});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-fileviewer-pdf-native',function(node){D2L.LP.DocumentViewers.FileViewerRenderers.PdfRenderer_Native.Init(node);});D2L.LP.DocumentViewers.FileViewerRenderers.PdfRenderer_Native={Init:function(node){var content=$(node);var hasReader=content.attr('data-has-native-reader')==='1';if(!hasReader){hasReader=D2L.LP.DocumentViewers.FileViewerRenderers.PdfRenderer_Native.HasReader();}var isTablet=content.attr('data-is-tablet')==='1';if(isTablet||!hasReader){var id=content.attr('id');var docViewerPartial=D2L.LP.Web.UI.ObjectRepository.Get(id);docViewerPartial();return;}content.append('<iframe class="d2l-fileviewer-rendered-pdf"/>');var renderedPdf=content.find('.d2l-fileviewer-rendered-pdf');renderedPdf.css({width:'100%',overflow:'hidden'});var isAlwaysFullyExpanded=content.attr('data-is-always-fully-expanded')==='1';if(isAlwaysFullyExpanded){renderedPdf.addClass('d2l-fileviewer-rendered-pdf-dialog');}var maxHeight=content.attr('data-max-height');if(maxHeight){renderedPdf.css('max-height',maxHeight);}var resize=function(){var contentHeight=$(window).height();renderedPdf.height(contentHeight);D2L.LP.Web.UI.Desktop.Controls.FileViewer.OnPluginLoad(renderedPdf,contentHeight);};var location=content.attr('data-location');var titleText=content.attr('data-title');$(window).resize(resize);renderedPdf.load().attr({src:location,title:titleText,onload:resize});},HasReader:function(){var plugins=['Chrome PDF Viewer'];for(var i=0;i<plugins.length;i++){if(navigator.plugins[plugins[i]]!==undefined){return true;}}return false;}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-fileviewer-pdf-pdfjs',function(node){D2L.LP.DocumentViewers.FileViewerRenderers.PdfRenderer_PdfJs.Init(node);});D2L.LP.DocumentViewers.FileViewerRenderers.PDFjsToolbar=D2L.Class.extend({Construct:function(id){this.id=id;arguments.callee.$.Construct.call(this);},InsertTool:function(position,tool){var toolbar=$('.d2l-fileviewer-rendered-pdf').contents().find('#'+this.id);var children=toolbar.children();if(position>=children.length){toolbar.appendChild(tool);return;}if(position===0){toolbar.prepend(tool);return;}},GetTool:function(toolName){var tool=$('.d2l-fileviewer-rendered-pdf').contents().find('#'+this.id+' #'+toolName);return tool.length?tool[0]:null;}});D2L.LP.DocumentViewers.FileViewerRenderers.PdfRenderer_PdfJs={Init:function(node){var content=$(node);var renderedPdf=$('<iframe class="d2l-fileviewer-rendered-pdf" scrolling="no" seamless="seamless"/>').css('width','100%').data('d2l_loaded',false);var isAlwaysFullyExpanded=content.attr('data-is-always-fully-expanded')==='1';if(isAlwaysFullyExpanded){renderedPdf.addClass('d2l-fileviewer-rendered-pdf-dialog');}var maxHeight=content.attr('data-max-height');if(maxHeight){renderedPdf.css('max-height',maxHeight);}var resize=function(){var contentHeight=$(window).height();renderedPdf.height(contentHeight);D2L.LP.Web.UI.Desktop.Controls.FileViewer.OnPluginLoad(renderedPdf,contentHeight);};var updatePdfJs=content.attr('data-update-pdfjs')==='1';var onLoad=function(event){var target=$(event.target);$(event.target).data('d2l_loaded',true);target[0].ViewerToolbars={Left:new D2L.LP.DocumentViewers.FileViewerRenderers.PDFjsToolbar("toolbarViewerLeft"),Right:new D2L.LP.DocumentViewers.FileViewerRenderers.PDFjsToolbar("toolbarViewerRight")};fixLtiCmsCustomization(updatePdfJs);resize();var pdfFileLocation=$('.d2l-fileviewer-pdf-pdfjs').attr('data-location');var d2lOnLoad=D2L.LP.DocumentViewers.FileViewerRenderers.PdfRenderer_PdfJs.GetOnLoad(node);d2lOnLoad.Trigger(target,pdfFileLocation);};$(window).resize(resize);renderedPdf.appendTo(content);renderedPdf.on('load',onLoad).attr({src:D2L.LP.DocumentViewers.FileViewerRenderers.PdfRenderer_PdfJs.GenerateLocation(content,isAlwaysFullyExpanded,updatePdfJs),title:content.attr('data-title')});},GetOnLoad:function(node){return node.d2l_onLoad?node.d2l_onLoad:node.d2l_onLoad=new D2L.LP.Web.UI.Events.Event();},GenerateLocation:function(node,isAlwaysFullyExpanded,updatePdfJs){var location=D2L.LP.Web.UI.Html.JavaScript.UrlEncode(node.attr('data-location'));var culture=D2L.LP.Web.UI.Html.JavaScript.UrlEncode(node.attr('data-culture'));var contentHeight=$(window).height();var containerClass=isAlwaysFullyExpanded?'d2l-fileviewer-rendered-pdf-dialog':'d2l-fileviewer-rendered-pdf';var viewerPath=updatePdfJs?'pdfjs-d2l-dist/1.0.5/web/viewer.html':'pdfjs/1.0.0.30/web/viewer.html';return'/d2l/common/assets/'+viewerPath+'?file='+location+"&lang="+culture+"&container="+containerClass+"&fullscreen=d2l-fileviewer-rendered-pdf-dialog&height="+contentHeight+"#0";},SetLocation:function(id,location,updatePdfJs){var view=$('.d2l-fileviewer-pdf-pdfjs').attr('data-location',location.GetUrl());var newUrl=D2L.LP.DocumentViewers.FileViewerRenderers.PdfRenderer_PdfJs.GenerateLocation(view,false,updatePdfJs);$('.d2l-fileviewer-rendered-pdf')[0].contentWindow.location.replace(newUrl);}};function fixLtiCmsCustomization(updatePdfJs){var renderedPdf=$('.d2l-fileviewer-rendered-pdf');if(!renderedPdf.length)return;var contents=renderedPdf.contents();if(!contents.length)return;var head=contents.find("head");fixMobileView(head);var pdfjs=$('.d2l-fileviewer-pdf-pdfjs');if(!pdfjs.length)return;if(!updatePdfJs){fixDownloadButton(pdfjs.attr('data-is-download-enabled'),head,contents);}setFullscreenButtonVisibility(pdfjs.attr('data-is-fullscreen-button-hidden'),contents);}function fixMobileView(head){if(head.length){$(head).append('<style type="text/css">#mainContainer {    min-width: 200px;}</style>');$(head).append('<style type="text/css">@media all and (max-width: 600px) {    html[dir=\'ltr\'] .innerCenter {        right: -8%;    }}</style>');$(head).append('<style type="text/css">@media all and (max-width: 600px) {    html[dir=\'rtl\'] .innerCenter {        left: -8%;    }}</style>');$(head).append('<style type="text/css">@media all and (max-width: 465px) {    html[dir=\'ltr\'] .innerCenter {        right: 14%;    }}</style>');$(head).append('<style type="text/css">@media all and (max-width: 465px) {    html[dir=\'rtl\'] .innerCenter {        left: 14%;    }}</style>');$(head).append('<style type="text/css">@media all and (max-width: 369px) {    html[dir=\'ltr\'] .innerCenter {        right: 18%;    }}</style>');$(head).append('<style type="text/css">@media all and (max-width: 369px) {    html[dir=\'rtl\'] .innerCenter {        left: 18%;    }}</style>');$(head).append('<style type="text/css">@media all and (max-width: 369px) {    html[dir=\'ltr\'] #previous {        position: absolute;    }    html[dir=\'ltr\'] #next {        position: absolute;    }}</style>');$(head).append('<style type="text/css">@media all and (max-width: 369px) {    html[dir=\'rtl\'] #previous {        position: absolute;    }    html[dir=\'rtl\'] #next {        position: absolute;    }}</style>');$(head).append('<style type="text/css">@media all and (max-width: 369px) {    html[dir=\'ltr\'] #previous {        left: -1000px;    }    html[dir=\'ltr\'] #next {        left: -1000px;    }}</style>');$(head).append('<style type="text/css">@media all and (max-width: 369px) {    html[dir=\'rtl\'] #previous {        right: -1000px;    }    html[dir=\'rtl\'] #next {        right: -1000px;    }}</style>');}}function fixDownloadButton(isDownloadEnabled,head,contents){if(isDownloadEnabled==='1'){var downloadButton=contents.find('#download');if(head.length&&downloadButton.length){$(head).append('<style type="text/css">.toolbarButton.download::before {  content: url(images/toolbarButton-download.png);}@media screen and (min-resolution: 2dppx) {    .toolbarButton.download::before,    .secondaryToolbarButton.download::before {        content: url(images/toolbarButton-download@2x.png);    }}</style>');$(downloadButton).removeClass().addClass('toolbarButton download visible');$(downloadButton).attr('style','display: inline-block !important');$(downloadButton).attr('tabindex',18);}var body=contents.find("body");if(body.length){$(body).append('<style type="text/css">a {    cursor: pointer;}</style>');}}}function setFullscreenButtonVisibility(isFullscreenButtonHidden,contents){if(isFullscreenButtonHidden==='1'){var fullscreenMode=contents.find('#fullscreenMode');if(fullscreenMode.length){$(fullscreenMode).removeClass().addClass('hidden');}}}D2L.LP.Profile={Web:{Desktop:{Controls:{}}}};D2L.LP.Profile.Web.Desktop.Controls.UserProfileCard={GetHandle:function(node){if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-user-profile-card',node)){node=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-user-profile-card',node)[0];}return node.handle;},InitHandle:function(node){var handle={node:node,cornerNode:null,loadFunction:null,isCardOpen:false,initializedOffsets:false,isVertical:true,horizontalOffset:0,verticalOffset:0};handle.cornerNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-user-profile-card-corner',handle.node)[0];handle.loadFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.node.id,'load');node.handle=handle;return handle;},ShowCard:function(node,updatePosition){if(updatePosition==null){updatePosition=true;}var me=D2L.LP.Profile.Web.Desktop.Controls.UserProfileCard;var handle=me.GetHandle(node);if(!handle.isCardOpen){if(updatePosition){me.UpdatePosition(handle,node);}if(handle.loadFunction){handle.loadFunction();handle.loadFunction=null;}handle.isCardOpen=true;}},HideCard:function(node){var me=D2L.LP.Profile.Web.Desktop.Controls.UserProfileCard;var handle=me.GetHandle(node);handle.isCardOpen=false;},UpdatePosition:function(handle,containerNode){var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-user-profile-card-left',handle.node);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-user-profile-card-right',handle.node);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-user-profile-card-corner-left',handle.cornerNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-user-profile-card-corner-right',handle.cornerNode);if(!handle.initializedOffsets){var parentHandle=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-user-profile-handle',handle.node);var parentHandleRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(parentHandle);if(D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-user-profile-card-horizontal',handle.node)){handle.isVertical=false;handle.horizontalOffset=parentHandleRect.width+20;handle.verticalOffset-=parentHandleRect.height;}else{handle.verticalOffset+=15;}handle.initializedOffsets=true;}var parent=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-max-width',handle.node)||document.body;var flyoutRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(containerNode);var parentRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(parent);var contentsRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.node);var left=Math.max(flyoutRect.right-parentRect.left,0);var right=Math.max(parentRect.right-flyoutRect.left,0);var rightOverflow;if(isRTL){rightOverflow=left-contentsRect.width;}else{rightOverflow=right-contentsRect.width;}var cornerClassName="";if(rightOverflow<=0&&(isRTL?right:left)-contentsRect.width>0){if(isRTL){handle.node.style.marginRight=flyoutRect.width-contentsRect.width-handle.horizontalOffset+'px';}else{handle.node.style.marginLeft=flyoutRect.width-contentsRect.width-handle.horizontalOffset+'px';}cornerClassName='d2l-user-profile-card-corner-right';}else{if(isRTL){handle.node.style.marginRight+=handle.horizontalOffset+'px';}else{handle.node.style.marginLeft+=handle.horizontalOffset+'px';}cornerClassName='d2l-user-profile-card-corner-left';}if(cornerClassName!=""){D2L.LP.Web.UI.Html.Dom.AddClassName(cornerClassName,handle.cornerNode);}handle.node.style.marginTop+=handle.verticalOffset+'px';}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-user-profile-card',function(node){D2L.LP.Profile.Web.Desktop.Controls.UserProfileCard.InitHandle(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-user-profile-card-online-edit',function(node){var menu=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-menuflyout',node)[0];var onClick=function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);var node=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);var clickedInMenu=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-user-profile-card-online-edit',node)!=null;if(clickedInMenu==false){var id=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(menu.id);D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.Close(id);}};var card=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-user-profile-card',node);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',card,onClick);});D2L.LP.Profile.Web.Desktop.Controls.UserProfileHandle={GetHandle:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-user-profile-handle',node)){node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-user-profile-handle',node);}return node.handle;},FreezeCard:function(id){var handle=D2L.LP.Profile.Web.Desktop.Controls.UserProfileHandle.GetHandle(id);handle.keepOpen=true;handle.suppressEsc=true;},ThawCard:function(id){var handle=D2L.LP.Profile.Web.Desktop.Controls.UserProfileHandle.GetHandle(id);handle.keepOpen=false;setTimeout(function(){handle.suppressEsc=false;if(handle.hoveredOpen||handle.clickedOpen||handle.keepOpen){return;}D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-user-profile-handle-hide',handle.node);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-user-profile-handle-hide-fast',handle.node);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-user-profile-handle-show',handle.node);D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-user-profile-handle-hide',handle.node);},500);},Init:function(infoList){for(var i=0;i<infoList.length;i++){(function(idx){setTimeout(function(){var handleId=infoList[idx].HandleId.GetValue();var profileHandle=D2L.LP.Web.UI.Html.Dom.GetElementById(handleId);var node=D2L.LP.Web.UI.Html.Dom.GetElementById(infoList[idx].ImageId.GetValue());if(node!==null&&infoList[idx].Size!==0){node.style.width=infoList[idx].Size+'px';node.style.height=infoList[idx].Size+'px';}D2L.LP.Web.UI.Html.Dom.SetAttribute(profileHandle,'data-d2l-pid',infoList[idx].ProfileId);var span=profileHandle.getElementsByTagName('span')[0];span.innerText=infoList[idx].Title;var image=profileHandle.querySelector('img');image.src=infoList[idx].ImageUrl;image.height=infoList[idx].Size;image.width=infoList[idx].Size;},1);})(i);}},InitHandle:function(node){var handle={node:node,imageNode:null,clickedOpen:false,hoveredOpen:false,keepOpen:false,fadeInThreshold:400,fadeOutThreshold:600,noShow:false};handle.imageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName('d2l-imagelink',node)[0];handle.noShow=D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-user-profile-handle-print',node);node.handle=handle;return handle;},ShowCard:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!D2L.LP.Web.UI.Html.Dom.HasClassName('d2l-user-profile-handle',node)){node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-user-profile-handle',node);}D2L.LP.Profile.Web.Desktop.Controls.UserProfileCard.ShowCard(node);},GetProfileId:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var pid=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,'data-d2l-pid');return pid;}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-user-profile-handle-normal',function(node){var handle=D2L.LP.Profile.Web.Desktop.Controls.UserProfileHandle.InitHandle(node);var userProfileCard=D2L.LP.Profile.Web.Desktop.Controls.UserProfileCard;if(handle.noShow){return;}var fadeOutThreshold=600;var dismissibleId=null;var removeClassNames=function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-user-profile-handle-hide',node);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-user-profile-handle-hide-fast',node);D2L.LP.Web.UI.Html.Dom.RemoveClassName('d2l-user-profile-handle-show',node);};var fadeCardIn=function(){removeClassNames();D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-user-profile-handle-show',node);if(dismissibleId===null){dismissibleId=D2L.Dismissible.Set(function(){dismissibleId=null;if(!handle.keepOpen){handle.clickedOpen=false;fadeCardOut(true);}});}userProfileCard.ShowCard(node);};var fadeCardOut=function(fast){removeClassNames();D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-user-profile-handle-hide',node);if(fast){D2L.LP.Web.UI.Html.Dom.AddClassName('d2l-user-profile-handle-hide-fast',node);}setTimeout(function(){if(handle.clickedOpen||handle.hoveredOpen||handle.keepOpen){return;}if(dismissibleId!==null){D2L.Dismissible.Clear(dismissibleId);dismissibleId=null;}userProfileCard.HideCard(node);removeClassNames();},fadeOutThreshold);};var onMouseOver=function(){if(handle.clickedOpen){return;}handle.hoveredOpen=true;fadeCardIn();};var onMouseOut=function(){handle.hoveredOpen=false;if(handle.clickedOpen||handle.keepOpen){return;}fadeCardOut(false);};var showCard=function(){if(handle.clickedOpen||handle.keepOpen){return;}handle.clickedOpen=true;handle.hoveredOpen=false;D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',document.body,onFocus,true);if(!handle.hoveredOpen){fadeCardIn();}handle.imageNode.focus();};var hideCard=function(){if(!handle.clickedOpen||handle.hoveredOpen){return;}handle.clickedOpen=false;D2L.LP.Web.UI.Html.Dom.RemoveEventListener('focus',document.body,onFocus,true);fadeCardOut(true);};var onFocus=function(){var activeNode=D2L.LP.Web.UI.Html.Dom.GetActiveElement();if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(node,activeNode)){hideCard();}};var onClick=function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);var node=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);var clickedInCard=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-user-profile-card',node)!=null;if(handle.clickedOpen&&clickedInCard==false){hideCard();}else{showCard();}};D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseover',node,onMouseOver);D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseout',node,onMouseOut);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',node,onClick);D2L.LP.Web.UI.Events.OnClick.AddListener(function(){if(!handle.clickedOpen){return;}hideCard();});});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-user-profile-handle-always-show',function(node){var handle=D2L.LP.Profile.Web.Desktop.Controls.UserProfileHandle.InitHandle(node);D2L.LP.Profile.Web.Desktop.Controls.UserProfileCard.ShowCard(node,false);});D2L.LP.Tools={QuickLinks:{Web:{UnavailableLinks:{}}}};D2L.LP.Tools.QuickLinks.Web.UnavailableLinks.GoBack=function(){window.history.go(-1);};D2L.LP.QuickLinks={Web:{Desktop:{Controls:{},Dialog:{},HtmlEditor:{},AddLinkButton:{}}}};D2L.LP.QuickLinks.Web.Desktop.Controls.AddLinkButton={AddFile:function(fileInputId,openFunction){openFunction().AddListener(function(link){if(link==null){return;}var linkInputLinks=[];linkInputLinks.push(new D2L.LP.Web.UI.Links.Link(link.location,link.title,link.location));D2L.LP.Web.UI.Desktop.Controls.FileInput.AddLinks(fileInputId,linkInputLinks);});}};D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector={ClearSelection:function(id){var controlId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(controlId);node.d2l_selectedItems=[];var onSelectionChanged=D2L.LP.Web.UI.ObjectRepository.TryGet(controlId,'onSelectionChanged');if(onSelectionChanged!=null){onSelectionChanged.call(onSelectionChanged);}},GetOutputFormat:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var outputFormat=node.getAttribute('data-d2l-outputformat');if(outputFormat===undefined||outputFormat===null){return'';}else{return outputFormat;}},GetSelectedItem:function(id){var me=D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector;var items=me.GetSelectedItems(id);if(items.length==0){return null;}return items[items.length-1];},GetSelectedItems:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.d2l_selectedItems!=null){return node.d2l_selectedItems;}return[];},OnSelectItem:function(id,typeKey,itemId,itemTitle,itemProperties){if(itemId==null){return;}if(itemTitle==null){itemTitle='';}var me=D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector;me.OnSelectItemHelper(id,new me.ItemData(typeKey,itemId,null,itemTitle,itemProperties,me.GetOutputFormat(id)));},OnSelectPublicItem:function(id,typeKey,itemUrl,itemTitle,itemProperties){if(itemUrl==null){return;}if(itemTitle==null){itemTitle='';}var me=D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector;me.OnSelectItemHelper(id,new me.ItemData(typeKey,null,itemUrl,itemTitle,itemProperties,me.GetOutputFormat(id)));},OnSelectItemHelper:function(id,item){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.d2l_selectedItems===undefined){node.d2l_selectedItems=[];}node.d2l_selectedItems.push(item);var onSelect=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),'onSelect');if(onSelect!=null){onSelect.call(onSelect);}var onSelectionChanged=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),'onSelectionChanged');if(onSelectionChanged!=null){onSelectionChanged.call(onSelectionChanged);}},TriggerOnManage:function(id){setTimeout(function(){var onManage=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),'onManage');if(onManage!=null){onManage.call(onManage);}},0);},SetDialogButtonVisibility:function(show){var dialogButtons=document.getElementsByClassName('d2l-dialog-buttons')[0];if(dialogButtons){if(!show){dialogButtons.style.display='none';}else{dialogButtons.style.display='block';}}}};D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.AddFileItem={GetTitle:function(fileParam){var files=fileParam.GetFiles();if(files==null||fileParam.length===0){return'Placeholder';}return files[0].GetFileName();}};D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.ItemData=D2L.Class.Create({Construct:function(typeKey,id,url,title,properties,outputFormat){this.m_typeKey=typeKey;if(id==null){id='';}this.m_id=id;if(url==null){url='';}this.m_url=url;this.m_title=title;if(properties==null){properties=[];}this.m_properties=properties;if(outputFormat==null){outputFormat='';}this.m_outputFormat=outputFormat;},_serialize:function(serializer){serializer.AddMember('typeKey',this.m_typeKey);serializer.AddMember('id',this.m_id);serializer.AddMember('url',this.m_url);serializer.AddMember('title',this.m_title);serializer.AddMember('outputFormat',this.m_outputFormat);var properties=this.m_properties;for(var i=0;i<properties.length;i++){serializer.AddMember(properties[i].name,properties[i].value);}}});D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.SearchSimpleFilter={GetParam:function(value){var me=D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.SearchSimpleFilter;var param=new me.Param(value);return param;}};D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.SearchSimpleFilter.Param=D2L.Class.Create({Construct:function(value){if(value===undefined){value='';}this.m_value=value;},_serialize:function(serializer){serializer.AddMember('type','searchsimple');serializer.AddMember('value',this.m_value);}});D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.IFrame={Create:function(location,title,target){var iFrameContainer=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-quicklinkselector-iframe',frameElement);if(!iFrameContainer){return;}var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(iFrameContainer.getAttribute('data-d2l-id'));var typeKey=iFrameContainer.getAttribute('data-d2l-typekey');if(!title){title=location.GetUrl();}if(target){target=[{'name':'target','value':target}];}var createPublicItem=parent.D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.OnSelectPublicItem;createPublicItem(id,typeKey,location.GetUrl(),title,target);},CreateItem:function(itemId,title,target){var iFrameContainer=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName('d2l-quicklinkselector-iframe',frameElement);if(!iFrameContainer){return;}var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(iFrameContainer.getAttribute('data-d2l-id'));var typeKey=iFrameContainer.getAttribute('data-d2l-typekey');if(target){target=[{'name':'target','value':target}];}var createItem=parent.D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.OnSelectItem;createItem(id,typeKey,itemId,title,target);},BuildSetIFrameSourceJavaScript:function(htmlId,baseUrl,returnRoute){setTimeout(function(){var iFrame=document.querySelectorAll('#'+htmlId)[0];if(!iFrame)return;var returnUrl=window.location.protocol+'//'+window.location.host+returnRoute;var srcUrl=baseUrl;if(baseUrl.indexOf('?')>-1){srcUrl=srcUrl+"&";}else{srcUrl=srcUrl+"?";}srcUrl=srcUrl+'returnUrl='+encodeURIComponent(returnUrl);iFrame.src=srcUrl;},0);},ResizeIframeSelector:function(iframeHtmlId,initialDialogWidth,initialDialogHeight){var iFrame=document.getElementById(iframeHtmlId);var dialog=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var handle=dialog.GetHandle();var hasLoaded=function(){return handle&&handle.container&&handle.nodes&&handle.nodes.title&&handle.nodes.footer;};var resizeIframe=function(){var iFrame=document.getElementById(iframeHtmlId);if(iFrame){var containerHeight=$(handle.container).height();var containerHeader=$('.d2l-quicklinkselector-header');var headerHeight=containerHeader.length>0?(containerHeader.outerHeight()||0)+10:0;var titleSize=handle.nodes.title.offsetHeight;var footerSize=handle.nodes.footer.offsetHeight;var offset=0;if(footerSize===0){var resizeHandle=document.getElementsByClassName('d2l-dialog-resize')[0];if(resizeHandle){footerSize=resizeHandle.clientHeight;}}if(headerHeight===0&&footerSize===0){offset=10;}var frameHeight=containerHeight-headerHeight-titleSize-footerSize-offset+'px';iFrame.style.height=frameHeight;}};var initResizeListener=function(){iFrame.focus();D2L.LP.Web.UI.Html.Dom.AddEventListener('load',iFrame,function(){resizeIframe(handle);});D2L.LP.Web.UI.Events.OnResize.AddListener(function(){if(!hasLoaded()){return;}resizeIframe(handle);});if(initialDialogWidth&&initialDialogHeight){handle.container.dataset['height']=initialDialogHeight;dialog.SetSize(handle,initialDialogWidth,initialDialogHeight);}};if(hasLoaded()){initResizeListener();}else{D2L.LP.Web.UI.Html.Dom.AddEventListener('load',handle.frame,initResizeListener);}}};D2L.LP.QuickLinks.Web.Desktop.Dialog.Default={FreeRangeAppIFramePlugin:function(selectLocation,createLocation){return function(host){var service={create:function(settings,data){return new Promise(function(resolve,reject){var frameId=host.iframe.id;var openerId;if(frameId){openerId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(frameId);}else{openerId=new D2L.LP.Web.UI.Html.UniqueHtmlId();host.iframe.id=openerId.GetValue();}var selectUrl=selectLocation.WithQueryString('typeKey',settings.typeKey?settings.typeKey:'').WithQueryString('initialViewType',settings.initialViewType?settings.initialViewType:'Default').WithQueryString('outputFormat',settings.outputFormat?settings.outputFormat:'html').WithQueryString('selectedText',settings.selectedText?settings.selectedText:'').WithQueryString('parentModuleId',settings.parentModuleId?settings.parentModuleId:'0').WithQueryString('canChangeType',settings.canChangeType?'true':'false').WithQueryString('showCancelButton',settings.showCancelButton?'true':'false').WithQueryString('urlShowTarget',settings.urlShowTarget?'true':'false').WithQueryString('urlShowCancelButtonInline',settings.urlShowCancelButtonInline?'true':'false').WithQueryString('contextId',settings.contextId?settings.contextId:'');if(data)selectUrl=selectUrl.WithQueryString('itemData',new D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.ItemData('',null,data.href,data.text,[{name:'target',value:data.target==='_top'?'WholeWindow':data.target==='_blank'?'NewWindow':'SameFrame'}],data.outputFormat));var selectResult=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Open(openerId,selectUrl);selectResult.AddReleaseListener(resolve);selectResult.AddListener(function(quicklinks){if(!quicklinks||quicklinks.length===0){resolve();return;}var createResult=D2L.LP.Web.UI.Rpc.ConnectObject('POST',createLocation,{'items':quicklinks});createResult.AddReleaseListener(resolve);createResult.AddListener(function(quicklinks){resolve(quicklinks);});});});}};host.registerService('quicklinks','0.1',service);};},OnSelectionChanged:function(itemIds){}};D2L.LP.QuickLinks.Web.Desktop.HtmlEditor.QuickLinksDialogComponent={Plugin:function(action,isEnabled,host){host.registerService('fra-html-editor-link','0.1',{click:function(quickLinkData){if(!isEnabled){return Promise.reject('disabled');}var promise=new Promise(function(resolve,reject){var locationOverrides={selectedText:quickLinkData.selectedText};if(quickLinkData.itemData){locationOverrides.itemData=new D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.ItemData('',null,quickLinkData.itemData.href,quickLinkData.itemData.title,quickLinkData.itemData.properties,quickLinkData.itemData.outputFormat,quickLinkData.itemData.urlShowTarget,quickLinkData.itemData.urlShowCancelButtonInline);}action(locationOverrides,resolve,reject);});return promise;},config:function(){return{isEnabled:isEnabled};}});},GetQuickLinkItems:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());if(node.d2l_quicklinks!==undefined){return node.d2l_quicklinks;}return[];},GetQuickLinkData:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node==null||node.nodeName!='A'){return null;}var href=node.getAttribute('href');var title=D2L.LP.Web.UI.Html.Dom.GetTextContent(node);var target=node.getAttribute('target');if(target=='_top'){target='WholeWindow';}else if(target=='_blank'){target='NewWindow';}else{target='SameFrame';}var properties=[];properties.push({name:'target',value:target});return new D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.ItemData('',null,href,title,properties,'html');},GetQuickLinkSelectedText:function(editorId){var text;var selectedNode=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(selectedNode&&selectedNode.nodeName==='A'){text=D2L.LP.Web.UI.Html.Dom.GetTextContent(selectedNode);}else{text=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectionContent(editorId);}if(text===undefined||text===null){text='';}return text;},Insert:function(editorId,openerId,dialogUrl,quicklinksProvider,selectionProvider,locationOverrides,resolve,reject){if(locationOverrides){dialogUrl.RemoveQueryString("selectedText");dialogUrl.RemoveQueryString("itemData");dialogUrl=dialogUrl.WithQueryString("selectedText",locationOverrides.selectedText);dialogUrl=dialogUrl.WithQueryString("itemData",locationOverrides.itemData);}function opener(){return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Open(openerId,dialogUrl);}D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.PasteDelayed(editorId,opener,selectionProvider,function(quicklinkItems){var evt=new D2L.LP.Web.UI.Events.Event();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());node.d2l_quicklinks=quicklinkItems;quicklinksProvider.call(quicklinksProvider).AddListener(function(quicklinks){if(quicklinks==null||quicklinks.length==0){evt.Trigger('');return;}var quicklinksHtml='';for(var i=0;i<quicklinks.length;i++){quicklinksHtml+=quicklinks[i].html;}evt.Trigger(quicklinksHtml);});return evt;},resolve,reject);},SelectLink:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var selectedNode=htmlEditor.GetSelectedNode(editorId);if(selectedNode==null){return;}if(selectedNode.nodeName=='A'){htmlEditor.SelectNode(editorId,selectedNode);}}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-quicklinkselector-iframe',function(node){var id=node.getAttribute('id');var setWidth=D2L.LP.Web.UI.ObjectRepository.TryGet(id,'setWidth');if(setWidth!=null){setWidth.call(setWidth);}D2L.LP.Web.UI.Events.OnContentHeightChange.Trigger();});D2L.LP.Web.UI.Desktop.Controls.GooglePlusOne={Init:function(node){var data={'size':'medium','count':'true'};if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,'data-href')){data['href']=node.getAttribute('data-href');}gapi.plusone.render(node,data);}};D2L.LP.Web.UI.Desktop.Controls.TweetButton={Init:function(node){D2L.LP.Web.UI.Html.Dom.AddEventListener('click',node,function(){var win=window.open(node.getAttribute('href'),'twitterWin','height=420,width=555,menubar=no,toolbar=no');if(win){win.focus();}});}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-gplusone',function(node){D2L.LP.Web.UI.Desktop.Controls.GooglePlusOne.Init(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-twitter',function(node){D2L.LP.Web.UI.Desktop.Controls.TweetButton.Init(node);});D2L.LP.Minibar={CourseSelector:{}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-courseselector-wrapper',function(node){var onCoursePinEvent=function(e){var listItemContent=node.querySelector('[data-org-unit-id="'+e.detail.orgUnitId+'"]');if(!listItemContent){return;}var datalistItem=D2L.LP.Web.UI.Html.Dom.GetAncestorElementsByClassName('d2l-datalist-simpleitem',listItemContent)[0];D2L.LP.Web.UI.Desktop.Controls.DataList.SimpleItems.SetIsSelected(D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(datalistItem.id),e.detail.isPinned);if(e.target.id!=='courseSelectorId'){var toggleItem=datalistItem.querySelector('.d2l-toggle');D2L.LP.Web.UI.Desktop.Controls.Toggle.ToggleFunction(D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(toggleItem.id));}};document.body.addEventListener('d2l-course-pinned-change',onCoursePinEvent);});D2L.LP.Minibar.CourseSelector.FirePinEvent=function(id,orgUnitId,isPinned){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(target){var customEvent=new CustomEvent('d2l-course-pinned-change',{detail:{orgUnitId:orgUnitId,isPinned:isPinned},bubbles:true});target.dispatchEvent(customEvent);}};D2L.LP.ActivityBar={OnNotification:new D2L.LP.Web.UI.Events.Event(),Init:function(pollLocation,pollInterval){var myWindow=window;var findTopWindow=function(win){try{if(win&&win['D2L']!==undefined){if(win.parent&&win.parent!=win){return findTopWindow(win.parent);}return win;}}catch(e){}};var topWindow=findTopWindow(myWindow);if(myWindow!==topWindow||myWindow===null){return;}var processPollResponse=function(data){for(var i=0;i<data.length;i++){D2L.LP.ActivityBar.OnNotification.Trigger(data[i]);}};pollInterval=pollInterval*1000;var supportsVisibilityApi=typeof document.hidden!=="undefined";var shouldImmediatelyPoll=false;var setupNextPoll=function(){shouldImmediatelyPoll=false;setTimeout(poll,pollInterval);};var poll=function(){if(supportsVisibilityApi&&document.hidden){shouldImmediatelyPoll=true;return;}var expired=D2L.PT.Auth.SessionTimeout.IsExpired();if(expired){setupNextPoll();return;}var rpcEvt=D2L.LP.Web.UI.Rpc.ConnectObject(D2L.LP.Web.UI.Rpc.Verbs.GET,pollLocation,null,{keepAlive:false,failure:function(){return true;}});rpcEvt.AddListener(function(data){processPollResponse(data);setupNextPoll();});};setupNextPoll();if(supportsVisibilityApi){var onVisibilityChange=function(){if(!document.hidden&&shouldImmediatelyPoll){poll();}};document.addEventListener("visibilitychange",onVisibilityChange,false);}}};D2L.Tools=D2L.Tools||{};D2L.Tools.Logger=function(){var loggingBaseUrl="/d2l/logging/{logtype}/";var logMessage=function(type,message,callback){if(type===null||type===undefined||message===null||message===undefined||message.length<=0){return;}var postUrl=loggingBaseUrl.replace(/{logtype}/,type);var successFunction=null;if(callback!==undefined&&callback!==null){successFunction=function(result){callback(result);};}D2L.LP.Web.UI.Rpc.Connect(D2L.LP.Web.UI.Rpc.Verbs.POST,new D2L.LP.Web.Http.UrlLocation(postUrl),{message:message},{success:successFunction});};return{Error:function(message,callback){logMessage("Error",message,callback);},Warn:function(message,callback){logMessage("Warn",message,callback);},Info:function(message,callback){logMessage("Info",message,callback);}};}();D2L.Video={};D2L.Video.Integrations={};D2L.Video.Integrations.Content={Config:{Ids:{WebEmbedSource:'WebEmbedSource',Title:'Title',Preview:'Preview',VideoDialogCreateButton:'VideoDialogCreateButton',WebVideoStatusCtn:'WebVideoStatusCtn',VideoPlayer:'VideoPlayer',VideoWarningsPlaceholder:'VideoWarningsPlaceholder',WebUrlSource:'WebUrlSource',PreviewButton:'PreviewButton',Upload:'Upload',ContentServiceUpload:'ContentServiceUpload'},Delay:800},WebPreview:{_Previewing:'',_LastValue:'',Init:function(){var config=D2L.Video.Integrations.Content.Config.Ids;var previewButtonId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(config.PreviewButton);var previewButtonNode=D2L.LP.Web.UI.Html.Dom.GetElementById(previewButtonId);var clickPreview=function(){D2L.LP.Web.UI.Html.Dom.DispatchEvent('click',previewButtonNode);};var WebSource=$('#'+config.WebEmbedSource);if(WebSource.length){WebSource.on("keyup",function(){D2L.Video.Integrations.Content.WebPreview.DisablePreview($(this).val());if(D2L.Video.Integrations.Content.WebPreview.NotLastValue(WebSource.val())){D2L.Video.Integrations.Content.WebPreview._LastValue=WebSource.val();D2L.Video.Integrations.Content.WebPreview.PreviewTimeout(clickPreview);}});WebSource.on("change",function(){clearTimeout(D2L.Video.Integrations.Content.WebPreview._Previewing);var val=$(this).val();if(D2L.Video.Integrations.Content.WebPreview.NotLastValue(val)){clickPreview();}D2L.Video.Integrations.Content.WebPreview.DisablePreview(val);D2L.Video.Integrations.Content.WebPreview._LastValue=val;});WebSource.on("paste",function(e){clearTimeout(D2L.Video.Integrations.Content.WebPreview._Previewing);setTimeout(function(){if(D2L.Video.Integrations.Content.WebPreview.NotLastValue(WebSource.val())){clickPreview();}D2L.Video.Integrations.Content.WebPreview.DisablePreview(WebSource.val());D2L.Video.Integrations.Content.WebPreview._LastValue=WebSource.val();},0);});}D2L.Video.Integrations.Content.WebPreview.ListenForWebShown();},ListenForWebShown:function(){var config=D2L.Video.Integrations.Content.Config.Ids;$('#Preview').on('D2L.Video.Add.WebShown',function(){if(!$('#'+config.Preview).hasClass('d2l-hidden')){$('#'+config.WebVideoStatusCtn).addClass('d2l-hidden');}else{$('#'+config.WebVideoStatusCtn).removeClass('d2l-hidden');}if($('#'+config.VideoPlayer).children().length===0){$('#'+config.VideoWarningsPlaceholder).addClass('warnings-big');}else{$('#'+config.VideoWarningsPlaceholder).addClass('warnings-small');}});},HideItAll:function(){var config=D2L.Video.Integrations.Content.Config.Ids;D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(config.Preview),false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(config.Title),false);D2L.LP.Web.UI.Desktop.Controls.Button.SetIsEnabled(D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(config.VideoDialogCreateButton),false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(config.WebVideoStatusCtn),true);var videoPlayerNode=document.querySelector('#'+config.VideoPlayer);if(videoPlayerNode&&videoPlayerNode.parentNode){videoPlayerNode.parentNode.removeChild(videoPlayerNode);}D2L.LP.Web.UI.Desktop.Controls.Hidden.SetValue(D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(config.WebUrlSource),'');},NotLastValue:function(val){return D2L.Video.Integrations.Content.WebPreview._LastValue!==val;},DisablePreview:function(val){if(D2L.Video.Integrations.Content.WebPreview.NotLastValue(val)){D2L.Video.Integrations.Content.WebPreview.HideItAll();}},PreviewTimeout:function(event){clearTimeout(D2L.Video.Integrations.Content.WebPreview._Previewing);D2L.Video.Integrations.Content.WebPreview._Previewing=setTimeout(event,D2L.Video.Integrations.Content.Config.Delay);}},ContentServiceUpload:{Init:function(){var ids=D2L.Video.Integrations.Content.Config.Ids,preview=$('#'+ids.Preview);preview.addClass('d2l-hidden');}},Init:function(){var ids=D2L.Video.Integrations.Content.Config.Ids,upload=$('#'+ids.Upload),preview=$('#'+ids.Preview),webVideo=$('#'+ids.Webvideo),webEmbedSource=$('#'+ids.WebEmbedSource),webVideoStatusCtn=$('#'+ids.WebVideoStatusCtn),videoPlayer=$('#'+ids.VideoPlayer);var tabListNode=$('.vui-tabmenu');var map={18:false,33:false,34:false};upload.parent().on('keydown',function(e){if(e.keyCode in map){map[e.keyCode]=true;if(map[18]&&map[33]){tabListNode.trigger('vui-tabmenu-select-prev');}else if(map[18]&&map[34]){tabListNode.trigger('vui-tabmenu-select-next');}}});var focusOnTabPanel=false;tabListNode.on('vui.tabmenu.content.focus',function(){focusOnTabPanel=true;});$(document).on('keyup',function(e){if(e.keyCode in map){map[e.keyCode]=false;}});preview.on('D2L.Video.Add.ChangeView',function(){if(focusOnTabPanel){$(':focusable',$('> div',upload.parent()).not('.d2l-hidden').not('#'+ids.Preview).not('#'+ids.Title).first()).first().focus();focusOnTabPanel=false;}if(preview.hasClass('d2l-hidden')){videoPlayer.remove();}if($('#'+ids.VideoPlayer).children().length===0){$('#'+ids.VideoWarningsPlaceholder).addClass('warnings-big');}else{$('#'+ids.VideoWarningsPlaceholder).addClass('warnings-small');}});setTimeout(function(){if(!webVideo.hasClass('d2l-hidden')&&webEmbedSource.val().length>0){webVideoStatusCtn.addClass('d2l-hidden');}$('#'+ids.VideoWarningsPlaceholder).addClass('warnings-small');if(webEmbedSource.val().length){lastValue=webEmbedSource.val();}},0);},EmptyGallery:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.RemoveChildElements(node);}};D2L.PT.Auth=D2L.PT.Auth||{};D2L.PT.Auth.SessionTimeout={InitData:{ExpireIsVisible:false,ExpireFunc:function(){},Extending:false,ExtendFunc:function(){},IsInit:false,LogoutFunc:function(){},NewUserFunc:function(){},DismissNewUserFunc:function(){},RequiresSession:false,SessionTimeout:180*60000,UserId:0,WarningBuffer:5*60000,WarningIsVisible:false,WarningMessageId:null,WarningAlertId:null,WarningCheckId:null,WarningTimeoutIntervalIds:[]},SessionManager:null,ApplyTimeoutConstraints:function(oldTimeout){var newTimeout=oldTimeout;if(oldTimeout<1){newTimeout=1;}if(oldTimeout>35796){newTimeout=35796;}return newTimeout;},Expire:function(sm,expiredState){if(!sm.InitData.RequiresSession||sm.InitData.ExpireIsVisible){return;}sm.InitData.ExpireIsVisible=true;D2L.LP.Web.UI.Html.JavaScript.Console.Debug('Session: Expired',expiredState);sm.HideWarning(sm);if(expiredState==='1'){sm.InitData.LogoutFunc();}else if(expiredState==='2'){sm.InitData.ExpireFunc();}},ExpiryInit:function(closeDialogFunc){var handleStorageChange=function(e){if(e.Key==='Session.Expired'&&e.NewValue==='0'){closeDialogFunc();}};D2L.LP.Web.UI.Events.OnStorage.AddListener(handleStorageChange);},FinalizeLogin:function(){if(!window.opener){return;}window.close();},FinalizeLoginUsernamePassword:function(){D2L.LP.Web.UI.Html.Dom.Storage.Local.Set('Session.Expired','0');},GetWarningBuffer:function(){var me=D2L.PT.Auth.SessionTimeout;var buffer=10*60*1000;if(me.InitData.SessionTimeout<=buffer){if(me.InitData.SessionTimeout>60000){buffer=60000;}else{buffer=0;}}return buffer;},HandleSessionStorageChange:function(sm,expired){if(expired==='1'||expired==='2'){sm.Expire(sm,expired);}else{sm.InitData.ExpireIsVisible=false;D2L.LP.Web.UI.Html.JavaScript.Console.Debug('Session: Resumed');D2L.PT.Auth.SessionTimeout.HideWarning(sm);}},HandleLastAccessedStorageChange:function(sm){if(sm.InitData.SessionTimeout<180000){return;}if(sm.InitData.WarningTimeoutIntervalIds.length>0){sm.HideWarning(sm);for(var i=0;i<sm.InitData.WarningTimeoutIntervalIds.length;i++){clearTimeout(sm.InitData.WarningTimeoutIntervalIds[i]);}}var timeout=sm.InitData.SessionTimeout-sm.InitData.WarningBuffer;D2L.LP.Web.UI.Html.JavaScript.Console.Debug('Session: Resetting timeout');sm.InitData.WarningTimeoutIntervalIds=[setTimeout(function(){sm.ShowWarning(sm);},timeout)];},HandleUserStorageChange:function(sm,e){D2L.LP.Web.UI.Html.JavaScript.Console.Debug('Session: User change',e.OldValue,e.NewValue);sm.InitData.DismissNewUserFunc();if(e.NewValue!==sm.InitData.UserId){sm.InitData.NewUserFunc();}},HideWarning:function(sm){if(!sm.InitData.WarningIsVisible){return;}var isExpired=sm.IsExpired();D2L.LP.Web.UI.Html.JavaScript.Console.Debug('Session: hiding warning');sm.InitData.WarningIsVisible=false;sm.InitData.Extending=false;var timeout=0;if(!isExpired){var $alert=$('#'+sm.InitData.WarningAlertId);var height=$alert.height();$alert.css('display','none');$('#'+sm.InitData.WarningCheckId).css({'height':height+'px','display':'block'});timeout=1000;}setTimeout(function(){D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Close(sm.InitData.WarningMessageId);},timeout);},IsExpired:function(){var expiredState=D2L.LP.Web.UI.Html.Dom.Storage.Local.Get('Session.Expired');var isExpired=expiredState==='1'||expiredState==='2';return isExpired;},Init:function(userId,sessionTimeout,warningBuffer,warningMessageId,warningAlertId,warningCheckId,extendFunc,expireFunc,logoutFunc,newUserFunc,dismissNewUserFunc){var me=D2L.PT.Auth.SessionTimeout;sessionTimeout=me.ApplyTimeoutConstraints(sessionTimeout);me.InitData.ExpireFunc=expireFunc;me.InitData.ExtendFunc=extendFunc;me.InitData.IsInit=true;me.InitData.LogoutFunc=logoutFunc;me.InitData.NewUserFunc=newUserFunc;me.InitData.DismissNewUserFunc=dismissNewUserFunc;me.InitData.RequiresSession=true;me.InitData.SessionTimeout=sessionTimeout*60000;me.InitData.UserId=userId;me.InitData.WarningBuffer=warningBuffer*60000;me.InitData.WarningAlertId=warningAlertId;me.InitData.WarningCheckId=warningCheckId;me.InitData.WarningMessageId=warningMessageId;var findSessionManager=function(win){try{if(win&&win.D2L!==undefined){if(win.D2L.PT.Auth.SessionTimeout.InitData.IsInit){me.SessionManager=win.D2L.PT.Auth.SessionTimeout;}if(win.parent&&win.parent!=win){findSessionManager(win.parent);}}}catch(e){}};findSessionManager(window);if(me.SessionManager===null){return;}var expired='0';var lastAccessed='0';if(me.SessionManager!==D2L.PT.Auth.SessionTimeout){D2L.LP.Web.UI.Html.Dom.Storage.Local.Set('Session.LastAccessed',new Date().getTime().toString());D2L.LP.Web.UI.Html.Dom.Storage.Local.Set('Session.UserId',userId);return;}var handleStorageChange=function(e){if(e.Key==='Session.Expired'){if(expired!==e.NewValue){expired=e.NewValue;me.HandleSessionStorageChange(me,expired);}}else if(e.Key==='Session.UserId'){if(userId!==e.NewValue){userId=e.NewValue;me.HandleUserStorageChange(me,e);}}else if(e.Key==='Session.LastAccessed'){if(lastAccessed!==e.NewValue){lastAccessed=e.NewValue;me.HandleLastAccessedStorageChange(me);}}};var handleClickKey=function(){if(!me.InitData.WarningIsVisible||me.InitData.Extending){return;}me.InitData.Extending=true;me.InitData.ExtendFunc();};D2L.LP.Web.UI.Html.Dom.Storage.Local.Set('Session.Expired',expired);D2L.LP.Web.UI.Html.Dom.Storage.Local.Set('Session.UserId',userId);D2L.LP.Web.UI.Events.OnClick.AddListener(handleClickKey);D2L.LP.Web.UI.Events.OnKeyPress.AddListener(handleClickKey);D2L.LP.Web.UI.Events.OnFraUserEvent.AddListener(handleClickKey);D2L.LP.Web.UI.Events.OnStorage.AddListener(handleStorageChange);D2L.LP.Web.UI.Html.Dom.Storage.Local.Set('Session.LastAccessed',new Date().getTime().toString());},RpcReceivePayloadProvider:function(result){var sm=D2L.PT.Auth.SessionTimeout.SessionManager;if(sm===null){return;}D2L.LP.Web.UI.Html.JavaScript.Console.Debug('Session: Rpc update, has expired:',result.HasExpired,'Keep alive:',result.KeepAlive);if(sm.IsExpired()){D2L.LP.Web.UI.Html.JavaScript.Console.Debug('Session: already expired');return;}if(result.HasExpired){D2L.LP.Web.UI.Html.Dom.Storage.Local.Set('Session.Expired','2');}else if(result.KeepAlive){D2L.LP.Web.UI.Html.Dom.Storage.Local.Set('Session.LastAccessed',new Date().getTime().toString());}},ShowWarning:function(sm){if(sm.InitData.WarningIsVisible||sm.IsExpired()){return;}var timeout=50000;var shake=function(){D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Shake(sm.InitData.WarningMessageId);sm.InitData.WarningTimeoutIntervalIds.push(setTimeout(shake,timeout));timeout=60000;};D2L.LP.Web.UI.Html.JavaScript.Console.Debug('Session: showing warning');sm.InitData.WarningIsVisible=true;D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Open(sm.InitData.WarningMessageId);setTimeout(function(){var checkNode=D2L.LP.Web.UI.Html.Dom.GetElementById(sm.InitData.WarningCheckId);if(checkNode){checkNode.style.display='none';}var alertNode=D2L.LP.Web.UI.Html.Dom.GetElementById(sm.InitData.WarningAlertId);if(alertNode){alertNode.style.display='block';}sm.InitData.WarningTimeoutIntervalIds.push(setTimeout(shake,5000));},50);}};D2L.PT.Auth.Logout=function(logoutLocation){var frm=document.createElement('form');frm.target='_top';frm.action=logoutLocation;frm.method='post';var hidden=document.createElement('input');hidden.type='hidden';hidden.name=D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName();hidden.value=D2L.LP.Web.Authentication.Xsrf.GetXsrfToken();frm.appendChild(hidden);document.dispatchEvent(new CustomEvent('d2l-logout',{bubbles:true}));document.body.appendChild(frm);frm.submit();D2L.LP.Web.UI.Html.JavaScript.Console.Debug('Session: logging out...');D2L.LP.Web.UI.Html.Dom.Storage.Local.Set('Session.Expired','1',false);};D2L.PT.Navbars={};D2L.PT.Navbars.Daylight={Init:function(node){D2L.PT.Navbars.Daylight.ShowNavbar().then(function(showNavbar){if(!showNavbar){node.setAttribute('suppressed','suppressed');return;}D2L.PT.Navbars.Daylight.Chomper.Init(node);var dropdowns=node.querySelectorAll('d2l-dropdown');for(var i=0;i<dropdowns.length;i++){D2L.PT.Navbars.Daylight.InitDropdown(dropdowns[i]);}D2L.PT.Navbars.Daylight.InitPopups(node);D2L.PT.Navbars.Daylight.InitNotifications(node);D2L.PT.Navbars.Daylight.MobileMenu.Init(node);});},InitDropdown:function(dropdown){var opener=dropdown.querySelector('.d2l-dropdown-opener');if(opener===null){return;}dropdown.addEventListener('d2l-dropdown-open',function(){opener.setAttribute('data-active','true');if(dropdown.parentNode.classList.contains('d2l-navigation-s-notification')){opener.removeAttribute('notification');}});dropdown.addEventListener('d2l-dropdown-close',function(){opener.removeAttribute('data-active');});if(opener.hasAttribute('data-prl')){var first=true;opener.addEventListener('click',function(){if(first){first=false;D2L.PT.Navbars.Daylight.PartialDropdown(opener,dropdown).AddListener(function(){dropdown.toggleOpen(true);});}else{dropdown.toggleOpen(true);}});}},InitNotifications:function(node){D2L.LP.ActivityBar.OnNotification.AddListener(function(category){var selector='.d2l-navigation-s-notification[data-category="'+category.toLowerCase()+'"]';var notification=node.querySelector(selector);if(notification){var opener=notification.querySelector('.d2l-dropdown-opener');if(opener){opener.setAttribute('notification','');}D2L.LP.Web.UI.Html.Aria.LogMessage(notification.getAttribute('data-aria-message'));}});},InitPopups:function(node){var popups=node.querySelectorAll('.d2l-navigation-s-link-popup');for(var i=0;i<popups.length;i++){D2L.PT.Navbars.Daylight.InitPopup(popups[i]);}},InitPopup:function(node){node.addEventListener('click',function(e){e.preventDefault();var href=node.getAttribute('href');var width=node.hasAttribute('data-popup-width')?node.getAttribute('data-popup-width'):0;var height=node.hasAttribute('data-popup-height')?node.getAttribute('data-popup-height'):0;D2L.LP.Web.UI.Html.Dom.OpenWindow(href,D2L.LP.Web.Http.UrlLocation.Create(href),width,height,node.hasAttribute('data-popup-menubar'),node.hasAttribute('data-popup-toolbar'),null,true);});},ShowNavbar:function(){if(window===window.parent){return Promise.resolve(true);}var win=window;do{win=win.parent;var doc;try{doc=win.document;}catch(e){return crossOriginStrategy();}if(documentHasAVisibleNav(doc)){return Promise.resolve(false);}if(documentHasASuppressionElement(doc)){return Promise.resolve(false);}}while(win!==win.parent);return Promise.resolve(true);function documentHasAVisibleNav(doc){var navElems=doc.getElementsByClassName('d2l-navigation-s');for(var i=0;i<navElems.length;i++){if(navElems[i].offsetParent){return true;}}return false;}function documentHasASuppressionElement(doc){var suppressedElems=doc.getElementsByClassName('d2l-suppress-nav');return suppressedElems.length>0;}function crossOriginStrategy(){return new Promise(function(resolve){var timeout=setTimeout(function(){window.removeEventListener('message',suppressionListener);resolve(true);},1000);var suppressionListener=window.addEventListener('message',function(event){var data;try{data=JSON.parse(event.data);}catch(e){return;}if(data.eventType!=='d2l-suppress-nav'){return;}clearTimeout(timeout);window.removeEventListener('message',suppressionListener);resolve(false);});window.parent.postMessage(JSON.stringify({eventType:'d2l-suppress-nav-question'}),'*');});}},PartialDropdown:function(opener,dropdown){var dropdownContent=dropdown.querySelector('d2l-dropdown-content');if(!dropdownContent){return;}var partialRenderLocation=D2L.LP.Web.Http.UrlLocation.Create(opener.getAttribute('data-prl'));var placeholderId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(opener.getAttribute('data-prid'));dropdownContent.forceRender();return D2L.LP.Web.UI.Html.PartialRendering.PartialRender(placeholderId,function(){return D2L.LP.Web.UI.Rpc.ConnectPartial(placeholderId,'GET',partialRenderLocation);});}};D2L.PT.Navbars.Daylight.Chomper={Chomp:function(handle){var success=D2L.PT.Navbars.Daylight.Chomper.InitWidths(handle);if(!success){return;}var availableWidth=handle.groupNode.clientWidth;if(handle.totalWidth>availableWidth){availableWidth=availableWidth-handle.moreWidth;}var moreItemNodes=handle.moreNode.querySelectorAll('.d2l-navigation-s-menu-item-root:not(d2l-menu)');var someItemHasFocus=D2L.LP.Web.UI.Html.Dom.IsAncestor(handle.groupNode,document.activeElement);var usedWidth=0;var focusMore=false;for(var i=0;i<handle.itemNodes.length;i++){usedWidth+=handle.itemWidths[i];var itemNode=handle.itemNodes[i];if(usedWidth<availableWidth){itemNode.removeAttribute('data-hidden');if(moreItemNodes.length>i){moreItemNodes[i].classList.add('d2l-hidden');}}else{var isFocused=someItemHasFocus&&D2L.LP.Web.UI.Html.Dom.IsAncestor(itemNode,document.activeElement);if(isFocused){focusMore=true;}itemNode.setAttribute('data-hidden','1');if(moreItemNodes.length>i){moreItemNodes[i].classList.remove('d2l-hidden');}}}if(handle.totalWidth<=availableWidth){var moreIsFocused=someItemHasFocus&&D2L.LP.Web.UI.Html.Dom.IsAncestor(handle.moreNode,document.activeElement);if(moreIsFocused){D2L.PT.Navbars.Daylight.Chomper.FocusItem(handle,handle.itemNodes.length-1);}handle.moreNode.setAttribute('data-hidden','1');handle.groupNode.removeAttribute('data-more');}else{handle.moreNode.removeAttribute('data-hidden');handle.groupNode.setAttribute('data-more','1');if(focusMore){D2L.LP.Web.UI.Html.Dom.FocusNode(handle.moreFocusNode);}}handle.groupNode.removeAttribute('data-loading');},FocusItem:function(handle,index){var elem=handle.itemNodes[index].querySelector('.d2l-navigation-s-link');if(elem===null){elem=handle.itemNodes[index].querySelector('.d2l-dropdown-opener');}requestAnimationFrame(function(){D2L.LP.Web.UI.Html.Dom.FocusNode(elem);});},Init:function(node){var groupNode=node.querySelector('.d2l-navigation-s-main-wrapper');if(groupNode===null){return;}var moreNode=groupNode.querySelector('.d2l-navigation-s-more');var handle={node:node,groupNode:groupNode,itemNodes:groupNode.querySelectorAll('.d2l-navigation-s-item:not(.d2l-navigation-s-more)'),itemWidths:null,moreNode:moreNode,moreFocusNode:moreNode.querySelector('.d2l-dropdown-opener'),moreWidth:null,totalWidth:0};function doChomp(){requestAnimationFrame(function(){D2L.PT.Navbars.Daylight.Chomper.Chomp(handle);});}window.addEventListener('resize',doChomp);doChomp();},InitWidths:function(handle){if(!handle.groupNode.hasAttribute('data-unmeasured')){return true;}if(handle.moreNode.offsetParent===null){return false;}if(handle.itemWidths===null){handle.itemWidths=[];for(var i=0;i<handle.itemNodes.length;i++){var w=handle.itemNodes[i].offsetWidth+20;handle.totalWidth+=w;handle.itemWidths.push(w);}}if(handle.moreWidth===null){handle.moreNode.removeAttribute('data-hidden');handle.moreWidth=handle.moreNode.offsetWidth;handle.moreNode.setAttribute('data-hidden','1');}handle.groupNode.removeAttribute('data-unmeasured');return true;}};D2L.PT.Navbars.Daylight.LinksArea={};D2L.PT.Navbars.Daylight.LinksArea.ImageBased={CloseTray:function(handle){requestAnimationFrame(function(){var handleAnimationEnd=function(){handle.listNode.removeEventListener('transitionend',handleAnimationEnd);requestAnimationFrame(function(){handle.trayNode.removeAttribute('closing');this.HandleListOverflow(handle);}.bind(this));}.bind(this);handle.listNode.addEventListener('transitionend',handleAnimationEnd);handle.trayNode.removeAttribute('scrollable');handle.trayNode.setAttribute('closing','closing');handle.trayNode.removeAttribute('opened');handle.listNode.style.maxHeight='';}.bind(this));},GetItems:function(handle){return handle.listNode.parentNode.querySelectorAll('.d2l-navigation-main-ib-list > .d2l-navigation-ib-item');},HandleListOverflow:function(handle){var items=this.GetItems(handle);if(!items||items.length===0){return;}requestAnimationFrame(function(){var isOpen=handle.trayNode.hasAttribute('opened');if(isOpen){return;}if(handle.itemRect===null){var itemRect=items[0].getBoundingClientRect();if(itemRect.height===0||itemRect.width===0){return;}handle.itemRect={height:itemRect.height,width:itemRect.width};}var listRect=handle.listNode.getBoundingClientRect();if(handle.minListHeight===null){handle.minListHeight=listRect.height;}var containerWidth=listRect.width-8;if(handle.itemRect.width<=0){return;}var itemsPerRow=Math.floor(containerWidth/handle.itemRect.width);if(itemsPerRow===0){return;}var isPullyShown=handle.pullyNode.hasAttribute('shown');var isOverflowing=items.length>itemsPerRow;requestAnimationFrame(function(){if(isOverflowing!==isPullyShown){if(isOverflowing){handle.pullyNode.setAttribute('shown','shown');}else{handle.pullyNode.removeAttribute('shown');}}for(var j=0;j<items.length;j++){var item=items[j];if(j<itemsPerRow){item.removeAttribute('overflow-item');item.style.display='';}else{item.setAttribute('overflow-item','overflow-item');item.style.display='none';}}if(isOverflowing){handle.pullyNode.setAttribute('title',handle.pullyNode.getAttribute('data-show-text'));handle.pullyNode.setAttribute('role','button');handle.pullyNode.tabIndex=0;}else{handle.pullyNode.removeAttribute('title');handle.pullyNode.removeAttribute('role');handle.pullyNode.tabIndex=-1;}});}.bind(this));},HandleResize:function(handle){this.HandleListOverflow(handle);var isOpen=handle.trayNode.hasAttribute('opened');if(!isOpen){return;}requestAnimationFrame(function(){var heightAvailable=this.GetAvailableHeight(handle);requestAnimationFrame(function(){handle.listNode.style.maxHeight=heightAvailable+'px';});}.bind(this));},Init:function(node){var pullyNode=node.querySelector('.d2l-navigation-main-ib-pully');pullyNode.addEventListener('focus',function(){node.setAttribute('ib-pully-focus','');},true);pullyNode.addEventListener('blur',function(){node.removeAttribute('ib-pully-focus');},true);pullyNode.addEventListener('mouseenter',function(){node.setAttribute('ib-pully-hover','');});pullyNode.addEventListener('mouseleave',function(){node.removeAttribute('ib-pully-hover');});window.D2L.Gestures.Swipe.register(node);var handle={itemRect:null,listNode:null,minListHeight:null,node:node,trayNode:null,pullyNode:pullyNode};this.InitTray(handle);},InitTray:function(handle){handle.trayNode=handle.node.querySelector('.d2l-navigation-main-ib-tray');handle.listNode=handle.node.querySelector('.d2l-navigation-main-ib-list');handle.pullyNode.addEventListener('click',function(){if(handle.pullyNode.hasAttribute('shown')){this.ToggleOverflow(handle,false);}}.bind(this));handle.pullyNode.addEventListener('keypress',function(e){if(e.keyCode===13&&handle.pullyNode.hasAttribute('shown')){this.ToggleOverflow(handle,true);}}.bind(this));handle.node.addEventListener('d2l-gesture-swipe',function(e){var isOpen=handle.trayNode.hasAttribute('opened');if(isOpen&&e.detail.direction.vertical==='up'){this.CloseTray(handle);}else if(!isOpen&&e.detail.direction.vertical==='down'){this.OpenTray(handle,false);}}.bind(this));window.addEventListener('resize',function(){this.HandleResize(handle);}.bind(this));handle.listNode.addEventListener('scroll',function(){this.ToggleListCaps(handle);}.bind(this));this.HandleListOverflow(handle);},GetAvailableHeight:function(handle){var listRect=handle.listNode.getBoundingClientRect();var heightAbove=listRect.top+document.body.scrollTop;var availableHeight=window.innerHeight-heightAbove-80;return availableHeight<handle.minListHeight?handle.minListHeight:availableHeight;},OpenTray:function(handle,applyFocus){var items=this.GetItems(handle);var firstOverflowItem=handle.listNode.querySelector('[overflow-item]');if(!firstOverflowItem)return;requestAnimationFrame(function(){for(var i=0;i<items.length;i++){items[i].style.display='';}});requestAnimationFrame(function(){var heightAvailable=this.GetAvailableHeight(handle);requestAnimationFrame(function(){var handleAnimationEnd=function(){firstOverflowItem.removeEventListener('animationend',handleAnimationEnd);this.ToggleListCaps(handle);requestAnimationFrame(function(){handle.trayNode.setAttribute('scrollable','scrollable');if(applyFocus){var firstOverflowLink=firstOverflowItem.querySelector('.d2l-navigation-ib-item-link');if(firstOverflowLink){firstOverflowLink.focus();}}});}.bind(this);firstOverflowItem.addEventListener('animationend',handleAnimationEnd);handle.listNode.style.maxHeight=heightAvailable+'px';handle.trayNode.setAttribute('opened','opened');handle.pullyNode.setAttribute('title',handle.pullyNode.getAttribute('data-hide-text'));}.bind(this));}.bind(this));},ToggleListCaps:function(handle){requestAnimationFrame(function(){var scrollTop=handle.listNode.scrollTop;var isScrolledTop=scrollTop===0;var isScrolledBottom=handle.listNode.scrollHeight-(scrollTop+handle.listNode.clientHeight)<5;requestAnimationFrame(function(){if(isScrolledTop){handle.trayNode.removeAttribute('overflow-top');}else{handle.trayNode.setAttribute('overflow-top','overflow-top');}if(isScrolledBottom){handle.trayNode.removeAttribute('overflow-bottom');}else{handle.trayNode.setAttribute('overflow-bottom','overflow-bottom');}}.bind(this));}.bind(this));},ToggleOverflow:function(handle,applyFocus){var isOpen=handle.trayNode.hasAttribute('opened');if(isOpen){this.CloseTray(handle);}else{this.OpenTray(handle,applyFocus);}}};D2L.PT.Navbars.Daylight.MobileMenu={Init:function(node){var mobileMenu=node.querySelector('.d2l-navigation-s-mobile-menu');var handle={focusTrapEnd:null,focusTrapStart:null,closeButton:null,courseMenuButton:null,courseMenuPartialled:false,first:null,getState:function(){return mobileMenu.getAttribute('data-state');},hideCourseMenuButton:null,itemMenu:null,initialized:false,mobileMenu:mobileMenu,opener:node.querySelector('.d2l-navigation-s-header-open-button-wrapper d2l-navigation-button-notification-icon'),setState:function(state){mobileMenu.setAttribute('data-state',state);}};if(handle.opener){handle.opener.addEventListener('click',function(){D2L.PT.Navbars.Daylight.MobileMenu.Open(handle);});mobileMenu.addEventListener('d2l-organization-consortium-tabs-notification-update',function(e){if(e.detail.hasOrgTabNotifications){handle.opener.setAttribute('notification-text',e.detail.notificationText);handle.opener.setAttribute('notification','notification');}else{handle.opener.removeAttribute('notification');}});}},InitOnFirstOpen:function(handle){if(handle.initialized){return;}handle.initialized=true;handle.focusTrapStart=handle.mobileMenu.querySelector('.d2l-navigation-s-mobile-menu-focus-trap-start');handle.focusTrapEnd=handle.mobileMenu.querySelector('.d2l-navigation-s-mobile-menu-focus-trap-end');handle.first=handle.mobileMenu.querySelector('.d2l-navigation-s-mobile-menu-first');handle.hideCourseMenuButton=handle.mobileMenu.querySelector('.d2l-navigation-s-mobile-menu-header-course-menu button');handle.courseMenuButton=handle.mobileMenu.querySelector('.d2l-navigation-s-mobile-menu-course-selector d2l-navigation-button-notification-icon');handle.itemMenu=handle.mobileMenu.querySelector('.d2l-navigation-s-mobile-menu-nav d2l-menu');handle.closeButton=handle.mobileMenu.querySelector('.d2l-navigation-s-mobile-menu-mask-close button');handle.orgTabs=handle.mobileMenu.querySelector('d2l-organization-consortium-tabs');handle.closeButton.addEventListener('touchend',function(){D2L.PT.Navbars.Daylight.MobileMenu.Close(handle);});handle.focusTrapStart.addEventListener('focus',function(){window.D2L.Dom.Focus.getPreviousFocusable(handle.focusTrapEnd).focus();});handle.focusTrapEnd.addEventListener('focus',function(){handle.closeButton.focus();});var mask=handle.mobileMenu.querySelector('.d2l-navigation-s-mobile-menu-mask');if(mask){mask.addEventListener('click',function(){D2L.PT.Navbars.Daylight.MobileMenu.Close(handle);});}if(handle.courseMenuButton){handle.courseMenuButton.addEventListener('click',function(){D2L.PT.Navbars.Daylight.MobileMenu.ShowCourseMenu(handle);});}if(handle.hideCourseMenuButton){handle.hideCourseMenuButton.addEventListener('click',function(){D2L.PT.Navbars.Daylight.MobileMenu.HideCourseMenu(handle,false);});}if(handle.orgTabs){handle.orgTabs.tryRequestScroll();}},Close:function(handle){if(handle.getState()!=='opened'){return;}handle.setState('transition');document.body.style.overflow='auto';document.body.style.position='static';document.body.style.width='auto';setTimeout(function(){handle.setState('closed');D2L.PT.Navbars.Daylight.MobileMenu.HideCourseMenu(handle,true);},350);handle.opener.focus();},Open:function(handle){if(handle.getState()!=='closed'){return;}D2L.PT.Navbars.Daylight.MobileMenu.InitOnFirstOpen(handle);handle.setState('transition');document.body.style.overflow='hidden';document.body.style.position='fixed';document.body.style.width='100%';handle.first.focus();if(handle.itemMenu){handle.itemMenu.resize();handle.itemMenu.show();}setTimeout(function(){handle.setState('opened');},50);},HideCourseMenu:function(handle,bypassFocus){handle.mobileMenu.classList.remove('d2l-navigation-s-mobile-menu-show-course-menu');if(!bypassFocus){handle.courseMenuButton.focus();}if(handle.itemMenu){handle.itemMenu.show();}},ShowCourseMenu:function(handle){handle.mobileMenu.classList.add('d2l-navigation-s-mobile-menu-show-course-menu');handle.hideCourseMenuButton.focus();if(handle.courseMenuPartialled){return;}handle.courseMenuPartialled=true;var partialRenderLocation=D2L.LP.Web.Http.UrlLocation.Create(handle.mobileMenu.getAttribute('data-cprl'));var placeholderId=new D2L.LP.Web.UI.Html.UniqueHtmlId();var placeholder=document.createElement('div');placeholder.setAttribute('id',placeholderId.GetValue());var parent=handle.mobileMenu.querySelector('.d2l-navigation-s-mobile-menu-course-menu');parent.appendChild(placeholder);D2L.LP.Web.UI.Html.PartialRendering.PartialRender(placeholderId,function(){return D2L.LP.Web.UI.Rpc.ConnectPartial(placeholderId,'GET',partialRenderLocation);});}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-navbar',function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,'navigation');var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var editLink=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-navbar-edit',node);var manageLink=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-navbar-manage',node);var container=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName('d2l-max-width',node);if(editLink===null||container===null){return;}var show=function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(container);editLink.style.top=rect.top+25+'px';manageLink.style.top=rect.top+5+'px';var left;if(isRTL){left=rect.right;if(rect.right-13<rect.width){left=left+-13;}editLink.style.left=left+'px';editLink.style.right='auto';manageLink.style.left=left+'px';manageLink.style.right='auto';}else{left=rect.left+-13;if(left<0){left=0;}editLink.style.left=left+'px';manageLink.style.left=left+'px';}};var hide=function(){if(isRTL){editLink.style.right='-10000px';manageLink.style.right='-10000px';}else{editLink.style.left='-10000px';manageLink.style.left='-10000px';}};D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseover',node,show);D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',editLink,show);D2L.LP.Web.UI.Html.Dom.AddEventListener('focus',manageLink,show);D2L.LP.Web.UI.Html.Dom.AddEventListener('mouseout',node,hide);D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',editLink,hide);D2L.LP.Web.UI.Html.Dom.AddEventListener('blur',manageLink,hide);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-navigation-s',function(node){D2L.PT.Navbars.Daylight.Init(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-skipnav',function(node){if(D2L.LP.Web.UI.Flags.Flag('skipnav-skip-to-h1s',true)){node.addEventListener('click',function(){var elem=document.querySelector('h1')||document.querySelector('.d2l-skipnav-target');if(elem){elem.tabIndex=-1;elem.focus();}});}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-navigation-main-ib',function(node){D2L.PT.Navbars.Daylight.LinksArea.ImageBased.Init(node);});D2L.LP.Web.UI.Html.Dom.AddClassInitializer('d2l-navigation-ib-item-group',function(node){var mobileMenuNode,groupContent;var onCloseGroup=function(){if(mobileMenuNode){mobileMenuNode.style.position='';mobileMenuNode.style.zIndex='';}};var showGroup=function(){if(!mobileMenuNode){var tempNode=node.parentNode;while(tempNode&&tempNode.nodeType!==9){if(tempNode.classList.contains('d2l-navigation-s-mobile-menu')){mobileMenuNode=tempNode;break;}tempNode=tempNode.parentNode;}}if(!groupContent){groupContent=node.querySelector(".d2l-navigation-ib-item-group-content");if(groupContent===null){return;}}groupContent=groupContent.cloneNode(true);var itemCount=groupContent.querySelectorAll('.d2l-navigation-ib-item').length;groupContent.classList.add(itemCount<5?'d2l-navigation-ib-item-group-content-2x2':'d2l-navigation-ib-item-group-content-3x3');if(node.parentNode.parentNode.classList.contains('d2l-navigation-mobile-ib-list')){groupContent.classList.add('d2l-navigation-mobile-ib-item-group-content');}D2L.PT.Navbars.Daylight.InitPopups(groupContent);groupContent.style.display='';var titleElement=node.querySelector(".d2l-navigation-ib-item-link-text");D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.OpenWithElement(titleElement!==null?titleElement.textContent:"",groupContent,true,null,null,node.getAttribute('data-close-text'),null,null,null,onCloseGroup,node.id,null,null);if(mobileMenuNode){mobileMenuNode.style.position='relative';mobileMenuNode.style.zIndex='1000';}};node.addEventListener('click',function(){showGroup();});});D2L.PT.ExternalUrls={Web:{Desktop:{HtmlEditor:{},Whitelisting:{},XSPL:{IFrame:{}}}}};D2L.PT.ExternalUrls.Web.Desktop.HtmlEditor.XSPLScript={Initialize:function(){var events={_convertXSPLIFrameToXSPLImagePlaceholder:function(context){var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin;if(context.content===null||context.content.length===0){return;}var tempContent=context.content;var replace=function(match){var originalContent=events._getOriginalContent(match);var originalContentEncoded=plugin.EncodeAllRaw(originalContent);var img='<img style="border:1px solid #333399;background-color: #ffffcc;padding: 75px 153px;" class="d2l-xspl-image-placehoder" src="/d2l/img/lp/xspl/html_editor_media.png" data-d2l-xspl-original-html="'+originalContentEncoded+'"/>';return img;};tempContent=tempContent.replace(events._xsplIFrameRegEx(),replace);context.content=tempContent;},_xsplIFrameRegEx:function(){return /<iframe[^>]*class=\"d2l-xspl-box\"[^>]*>(.|\n|\r)*?<\/iframe>/gi;},_getOriginalContent:function(html){var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin;var tempContent=html;var replace=function(match){var originalContent=match;var originalContentHtmlEncodedMatch=match.match(/ data-original-html=\"([^\"]*)\"/i);if(originalContentHtmlEncodedMatch&&originalContentHtmlEncodedMatch[1]){var originalContentHtmlEncoded=originalContentHtmlEncodedMatch[1];originalContent=plugin.Decode(originalContentHtmlEncoded);originalContent=events._getOriginalContent(originalContent);}return originalContent;};tempContent=tempContent.replace(events._xsplIFrameRegEx(),replace);return tempContent;},_convertXSPLImagePlaceholderToOriginalContent:function(context){var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin;if(context.content===null||context.content.length===0){return;}var tempContent=context.content;var replace=function(match){var originalContent=match;var originalContentHtmlEncodedMatch=match.match(/ data-d2l-xspl-original-html=\"([^\"]*)\"/i);if(originalContentHtmlEncodedMatch&&originalContentHtmlEncodedMatch[1]){var originalContentHtmlEncoded=originalContentHtmlEncodedMatch[1];originalContent=plugin.Decode(originalContentHtmlEncoded);}return originalContent;};tempContent=tempContent.replace(/<img[^>]*class=\"d2l-xspl-image-placehoder\"[^>]*>/gi,replace);context.content=tempContent;},onBeforeSetContent:function(o){events._convertXSPLIFrameToXSPLImagePlaceholder(o);return;},onPostProcess:function(o){events._convertXSPLImagePlaceholderToOriginalContent(o);return;}};var plugin=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.Core.Plugin.InitializeScript('Script',{'name':'d2l_xspl','onSetContent':function(obj){events.onBeforeSetContent(obj);},'onGetContent':function(obj){events.onPostProcess(obj);}});return plugin;}};D2L.PT.ExternalUrls.Web.Desktop.Whitelisting.ClearGridEdit=function(idString){var grid=$('.d2l-grid-wrapper');var editTargets=grid.find('.d2l-editable-target');var editables=grid.find('.d2l-editable-padding');var edits=grid.find('.d2l-edit');for(i=0;i<editTargets.length;++i){if(editTargets[i].id===idString)continue;D2L.LP.Web.UI.Desktop.Controls.EditInPlace.Finish(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(editTargets[i].id));D2L.LP.Web.UI.Desktop.Controls.Edit.SetValue(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(edits[i].id),editables[i].children[0].textContent);}};D2L.PT.ExternalUrls.Web.Desktop.Whitelisting.StripLRM=function(id){var input=id.$();var value=input.val();value=value.replace(/\u200E/g,'');input.val(value);};D2L.PT.ExternalUrls.Web.Desktop.XSPL.ReplaceXSPLWithOriginalHtml=function(url,xsplNode){var originalHtml=D2L.LP.Web.UI.Html.Dom.GetAttribute(xsplNode,'data-original-html');originalHtml=D2L.PT.ExternalUrls.Web.Desktop.XSPL.FixNestedXSPLIFrames(url,originalHtml);if(originalHtml){$(xsplNode).replaceWith(originalHtml);}};D2L.PT.ExternalUrls.Web.Desktop.XSPL.Allow=function(xsplNode,url,blockLinkText){var linkContainer=document.createElement('div');var originalXSPLCode;if(xsplNode.outerHTML!==undefined){originalXSPLCode=xsplNode.outerHTML;}else{originalXSPLCode=$('<div>').append($(xsplNode).clone()).html();}var onClickHandler=function(){originalXSPLCode=D2L.PT.ExternalUrls.Web.Desktop.XSPL.AddUnTrustParam(originalXSPLCode);$(linkContainer).prev().replaceWith(originalXSPLCode);$(linkContainer).remove();};var link=D2L.PT.ExternalUrls.Web.Desktop.XSPL.BuildBlockLink(blockLinkText,onClickHandler);linkContainer.appendChild(link);D2L.LP.Web.UI.Html.Dom.InsertElementAfter(linkContainer,xsplNode);D2L.PT.ExternalUrls.Web.Desktop.XSPL.ReplaceXSPLWithOriginalHtml(url,xsplNode);return true;};D2L.PT.ExternalUrls.Web.Desktop.XSPL.FixNestedXSPLIFrames=function(url,originalXSPLCode){var tempContent=originalXSPLCode;var replace=function(match){var originalContent=match;var src=match.match(/ src=\"([^\"]*)\"/i);if(src&&src[1]&&decodeURIComponent(src[1]).indexOf(url)>=-1){var encodedOriginalContentMatch=match.match(/ data-original-html=\"([^\"]*)\"/i);if(encodedOriginalContentMatch&&encodedOriginalContentMatch[1]){var originalContentHtmlEncoded=encodedOriginalContentMatch[1];originalContent=$("<div/>").html(originalContentHtmlEncoded).text();originalContent=D2L.PT.ExternalUrls.Web.Desktop.XSPL.FixNestedXSPLIFrames(url,originalContent);}}return originalContent;};tempContent=tempContent.replace(/<iframe[^>]*class=\"d2l-xspl-box\"[^>]*>(.|\n|\r)*?<\/iframe>/gi,replace);return tempContent;};D2L.PT.ExternalUrls.Web.Desktop.XSPL.BuildBlockLink=function(blockLinkText,onClickHandler){var link=document.createElement('a');link.className='xspl-block-link';if(link.textContent!==undefined){link.textContent=blockLinkText;}else if(node.innerText!==undefined){link.innerText=blockLinkText;}D2L.LP.Web.UI.Html.Aria.SetRole(link,'button');D2L.LP.Web.UI.Desktop.Controls.Link.InstallClickable(link);D2L.LP.Web.UI.Html.Dom.AddEventListener('click',link,onClickHandler);return link;};D2L.PT.ExternalUrls.Web.Desktop.XSPL.AddUnTrustParam=function(originalXSPLCode){if(originalXSPLCode.indexOf("/lp/externalUrls/xspl?untrust=1")<0){originalXSPLCode=originalXSPLCode.replace("/lp/externalUrls/xspl?","/lp/externalUrls/xspl?untrust=1&");}return originalXSPLCode;};D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.ReplaceMeWithOriginalHtml=function(url){var parentWindow=window.parent;var iframeNode=D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.GetIFrame();parentWindow.D2L.PT.ExternalUrls.Web.Desktop.XSPL.ReplaceXSPLWithOriginalHtml(url,iframeNode);};D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.Allow=function(url,blockLinkText){var parentWindow=window.parent;var iframeNode=D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.GetIFrame();if(parentWindow.D2L){parentWindow.D2L.PT.ExternalUrls.Web.Desktop.XSPL.Allow(iframeNode,url,blockLinkText);}else{window.D2L.PT.ExternalUrls.Web.Desktop.XSPL.Allow(iframeNode,url,blockLinkText);}var css=".d2l-xspl-box { width: 330px; min-height: 173px; } .xspl-block-link { text-decoration: none; color: #888888 !important; font-size: 0.85em; font-family:arial, helvetica, sans-serif; font-style: italic; cursor: pointer; outline: none !important; background-image: url(/d2l/img/lp/xspl/block.png); background-position: left center; background-repeat: no-repeat; padding-left: 15px; } .xspl-block-link:hover, .xspl-block-link:focus { text-decoration: underline; } .xspl-container { background-color: #F8F8F8; padding: 12px; border: 1px solid #CCCCCC; box-shadow: inset 2px 4px 4px 0px rgba(0,0,0,.08); border-radius: 4px; }";var style=parentWindow.document.createElement('style');if(style.styleSheet){style.styleSheet.cssText=css;}else{style.appendChild(parentWindow.document.createTextNode(css));}parentWindow.document.getElementsByTagName('head')[0].appendChild(style);};D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.ResizeToContent=function(){var iframeNode=D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.GetIFrame();var height=D2L.LP.Web.UI.Html.Dom.GetPageSize(window).height;iframeNode.style.height=height+'px';};D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.GetIFrame=function(){var doc=undefined;try{doc=window.parent.document;}catch(e){}if(doc===undefined){return null;}var iframes=window.parent.document.getElementsByTagName('iframe');for(var i=0;i<iframes.length;i++){if(iframes[i].contentWindow==window){return iframes[i];}}return null;};D2L.WCS={};D2L.WCS.Integrations={};D2L.WCS.Integrations.Content={Init:function(){}};